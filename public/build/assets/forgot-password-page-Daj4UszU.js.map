{"version":3,"file":"forgot-password-page-Daj4UszU.js","sources":["../../../common/foundation/resources/client/auth/requests/send-reset-password-email.ts","../../../common/foundation/resources/client/auth/ui/forgot-password-page.tsx"],"sourcesContent":["import {useMutation} from '@tanstack/react-query';\nimport {toast} from '@ui/toast/toast';\nimport {UseFormReturn} from 'react-hook-form';\nimport {onFormQueryError} from '../../errors/on-form-query-error';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {apiClient} from '../../http/query-client';\nimport {useNavigate} from '../../ui/navigation/use-navigate';\n\ninterface Response extends BackendResponse {\n  message: string;\n}\n\nexport interface SendPasswordResetEmailPayload {\n  email: string;\n}\n\nexport function useSendPasswordResetEmail(\n  form: UseFormReturn<SendPasswordResetEmailPayload>,\n) {\n  const navigate = useNavigate();\n  return useMutation({\n    mutationFn: sendResetPasswordEmail,\n    onSuccess: response => {\n      toast(response.message);\n      navigate('/login');\n    },\n    onError: r => onFormQueryError(r, form),\n  });\n}\n\nfunction sendResetPasswordEmail(\n  payload: SendPasswordResetEmailPayload,\n): Promise<Response> {\n  return apiClient\n    .post('auth/forgot-password', payload)\n    .then(response => response.data);\n}\n","import {GuestRoute} from '@common/auth/guards/guest-route';\nimport {Button} from '@ui/buttons/button';\nimport {LinkStyle} from '@ui/buttons/external-link';\nimport {Form} from '@ui/forms/form';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Trans} from '@ui/i18n/trans';\nimport {useSettings} from '@ui/settings/use-settings';\nimport {useForm} from 'react-hook-form';\nimport {Link, useSearchParams} from 'react-router';\nimport {StaticPageTitle} from '../../seo/static-page-title';\nimport {\n  SendPasswordResetEmailPayload,\n  useSendPasswordResetEmail,\n} from '../requests/send-reset-password-email';\nimport {AuthLayout} from './auth-layout/auth-layout';\n\nexport function Component() {\n  const {registration} = useSettings();\n\n  const [searchParams] = useSearchParams();\n  const searchParamsEmail = searchParams.get('email') || undefined;\n\n  const form = useForm<SendPasswordResetEmailPayload>({\n    defaultValues: {email: searchParamsEmail},\n  });\n  const sendEmail = useSendPasswordResetEmail(form);\n\n  const message = !registration?.disable && (\n    <Trans\n      values={{\n        a: parts => (\n          <Link className={LinkStyle} to=\"/register\">\n            {parts}\n          </Link>\n        ),\n      }}\n      message=\"Don't have an account? <a>Sign up.</a>\"\n    />\n  );\n\n  return (\n    <GuestRoute>\n      <AuthLayout message={message}>\n        <StaticPageTitle>\n          <Trans message=\"Forgot Password\" />\n        </StaticPageTitle>\n        <Form\n          form={form}\n          onSubmit={payload => {\n            sendEmail.mutate(payload);\n          }}\n        >\n          <div className=\"mb-32 text-sm\">\n            <Trans message=\"Enter your email address below and we will send you a link to reset or create your password.\" />\n          </div>\n          <FormTextField\n            disabled={!!searchParamsEmail}\n            className=\"mb-32\"\n            name=\"email\"\n            type=\"email\"\n            autoComplete=\"off\"\n            autoCorrect=\"off\"\n            spellCheck=\"false\"\n            label={<Trans message=\"Email\" />}\n            required\n          />\n          <Button\n            className=\"block w-full\"\n            type=\"submit\"\n            variant=\"flat\"\n            color=\"primary\"\n            size=\"md\"\n            disabled={sendEmail.isPending}\n          >\n            <Trans message=\"Continue\" />\n          </Button>\n        </Form>\n      </AuthLayout>\n    </GuestRoute>\n  );\n}\n"],"names":["useSendPasswordResetEmail","form","navigate","useNavigate","useMutation","sendResetPasswordEmail","response","toast","r","onFormQueryError","payload","apiClient","Component","registration","useSettings","searchParams","useSearchParams","searchParamsEmail","useForm","sendEmail","message","jsx","Trans","Link","LinkStyle","parts","GuestRoute","jsxs","AuthLayout","StaticPageTitle","Form","FormTextField","Button"],"mappings":"uPAgBO,SAASA,EACdC,EACA,CACA,MAAMC,EAAWC,EAAA,EACjB,OAAOC,EAAY,CACjB,WAAYC,EACZ,UAAWC,GAAY,CACrBC,EAAMD,EAAS,OAAO,EACtBJ,EAAS,QAAQ,CACnB,EACA,QAASM,GAAKC,EAAiBD,EAAGP,CAAI,CAAA,CACvC,CACH,CAEA,SAASI,EACPK,EACmB,CACnB,OAAOC,EACJ,KAAK,uBAAwBD,CAAO,EACpC,KAAKJ,GAAYA,EAAS,IAAI,CACnC,CCpBO,SAASM,GAAY,CAC1B,KAAM,CAAC,aAAAC,CAAA,EAAgBC,EAAA,EAEjB,CAACC,CAAY,EAAIC,EAAA,EACjBC,EAAoBF,EAAa,IAAI,OAAO,GAAK,OAEjDd,EAAOiB,EAAuC,CAClD,cAAe,CAAC,MAAOD,CAAA,CAAiB,CACzC,EACKE,EAAYnB,EAA0BC,CAAI,EAE1CmB,EAAU,EAACP,GAAA,MAAAA,EAAc,UAC7BQ,EAAAA,IAACC,EAAA,CACC,OAAQ,CACN,KACED,EAAAA,IAACE,EAAA,CAAK,UAAWC,EAAW,GAAG,YAC5B,SAAAC,CAAA,CACH,CAAA,EAGJ,QAAQ,wCAAA,CAAA,EAIZ,OACEJ,EAAAA,IAACK,EAAA,CACC,SAAAC,EAAAA,KAACC,EAAA,CAAW,QAAAR,EACV,SAAA,CAAAC,MAACQ,EAAA,CACC,SAAAR,EAAAA,IAACC,EAAA,CAAM,QAAQ,kBAAkB,EACnC,EACAK,EAAAA,KAACG,EAAA,CACC,KAAA7B,EACA,SAAUS,GAAW,CACnBS,EAAU,OAAOT,CAAO,CAC1B,EAEA,SAAA,CAAAW,EAAAA,IAAC,OAAI,UAAU,gBACb,eAACC,EAAA,CAAM,QAAQ,+FAA+F,CAAA,CAChH,EACAD,EAAAA,IAACU,EAAA,CACC,SAAU,CAAC,CAACd,EACZ,UAAU,QACV,KAAK,QACL,KAAK,QACL,aAAa,MACb,YAAY,MACZ,WAAW,QACX,MAAOI,EAAAA,IAACC,EAAA,CAAM,QAAQ,OAAA,CAAQ,EAC9B,SAAQ,EAAA,CAAA,EAEVD,EAAAA,IAACW,EAAA,CACC,UAAU,eACV,KAAK,SACL,QAAQ,OACR,MAAM,UACN,KAAK,KACL,SAAUb,EAAU,UAEpB,SAAAE,EAAAA,IAACC,EAAA,CAAM,QAAQ,UAAA,CAAW,CAAA,CAAA,CAC5B,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CACF,CAEJ"}