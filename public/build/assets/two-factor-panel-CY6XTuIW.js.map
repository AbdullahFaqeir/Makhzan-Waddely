{"version":3,"file":"two-factor-panel-CY6XTuIW.js","sources":["../../../common/foundation/resources/client/auth/ui/account-settings/change-password-panel/use-update-password.ts","../../../common/foundation/resources/client/auth/ui/account-settings/change-password-panel/change-password-panel.tsx","../../../common/foundation/resources/client/auth/ui/account-settings/sessions-panel/requests/use-logout-other-sessions.ts","../../../common/foundation/resources/client/auth/ui/account-settings/sessions-panel/requests/use-user-sessions.ts","../../../common/foundation/resources/client/auth/ui/confirm-password/requests/use-confirm-password.ts","../../../common/foundation/resources/client/auth/ui/confirm-password/confirm-password-dialog.tsx","../../../common/foundation/resources/client/auth/ui/confirm-password/requests/use-password-confirmation-status.ts","../../../common/foundation/resources/client/auth/ui/confirm-password/use-password-confirmed-action.ts","../../../common/foundation/resources/client/auth/ui/account-settings/sessions-panel/sessions-panel.tsx","../../../common/foundation/resources/client/auth/ui/account-settings/social-login-panel.tsx","../../../common/foundation/resources/client/auth/ui/two-factor/requests/use-enable-two-factor.ts","../../../common/foundation/resources/client/auth/ui/two-factor/stepper/two-factor-stepper-layout.tsx","../../../common/foundation/resources/client/auth/ui/two-factor/stepper/two-factor-disabled-step.tsx","../../../common/foundation/resources/client/auth/ui/two-factor/requests/use-two-factor-qr-code.ts","../../../common/foundation/resources/client/auth/ui/two-factor/requests/use-confirm-two-factor.ts","../../../common/foundation/resources/client/auth/ui/two-factor/requests/use-disable-two-factor.ts","../../../common/foundation/resources/client/auth/ui/two-factor/stepper/two-factor-confirmation-step.tsx","../../../common/foundation/resources/client/auth/ui/two-factor/requests/use-regenerate-two-factor-codes.ts","../../../common/foundation/resources/client/auth/ui/two-factor/stepper/two-factor-enabled-step.tsx","../../../common/foundation/resources/client/auth/ui/two-factor/stepper/two-factor-auth-stepper.tsx","../../../common/foundation/resources/client/auth/ui/account-settings/two-factor-panel.tsx"],"sourcesContent":["import {useMutation} from '@tanstack/react-query';\nimport {UseFormReturn} from 'react-hook-form';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {toast} from '@ui/toast/toast';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {message} from '@ui/i18n/message';\nimport {apiClient} from '@common/http/query-client';\n\ninterface Response extends BackendResponse {}\n\nexport interface UpdatePasswordPayload {\n  current_password: string;\n  password: string;\n  password_confirmation: string;\n}\n\nexport function useUpdatePassword(form: UseFormReturn<UpdatePasswordPayload>) {\n  return useMutation({\n    mutationFn: (props: UpdatePasswordPayload) => updatePassword(props),\n    onSuccess: () => {\n      toast(message('Password changed'));\n    },\n    onError: r => onFormQueryError(r, form),\n  });\n}\n\nfunction updatePassword(payload: UpdatePasswordPayload): Promise<Response> {\n  return apiClient.put('auth/user/password', payload).then(r => r.data);\n}\n","import {useForm} from 'react-hook-form';\nimport {useId} from 'react';\nimport {Form} from '@ui/forms/form';\nimport {AccountSettingsPanel} from '@common/auth/ui/account-settings/account-settings-panel';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {UpdatePasswordPayload, useUpdatePassword} from './use-update-password';\nimport {Button} from '@ui/buttons/button';\nimport {Trans} from '@ui/i18n/trans';\nimport {AccountSettingsId} from '@common/auth/ui/account-settings/account-settings-sidenav';\n\nexport function ChangePasswordPanel() {\n  const form = useForm<UpdatePasswordPayload>();\n  const formId = useId();\n  const updatePassword = useUpdatePassword(form);\n  return (\n    <AccountSettingsPanel\n      id={AccountSettingsId.Password}\n      title={<Trans message=\"Update password\" />}\n      actions={\n        <Button\n          type=\"submit\"\n          form={formId}\n          variant=\"flat\"\n          color=\"primary\"\n          disabled={!form.formState.isValid || updatePassword.isPending}\n        >\n          <Trans message=\"Update password\" />\n        </Button>\n      }\n    >\n      <Form\n        form={form}\n        id={formId}\n        onSubmit={newValues => {\n          updatePassword.mutate(newValues, {\n            onSuccess: () => {\n              form.reset();\n            },\n          });\n        }}\n      >\n        <FormTextField\n          className=\"mb-24\"\n          name=\"current_password\"\n          label={<Trans message=\"Current password\" />}\n          type=\"password\"\n          autoComplete=\"current-password\"\n          required\n        />\n        <FormTextField\n          className=\"mb-24\"\n          name=\"password\"\n          label={<Trans message=\"New password\" />}\n          type=\"password\"\n          autoComplete=\"new-password\"\n          required\n        />\n        <FormTextField\n          name=\"password_confirmation\"\n          label={<Trans message=\"Confirm password\" />}\n          type=\"password\"\n          autoComplete=\"new-password\"\n          required\n        />\n      </Form>\n    </AccountSettingsPanel>\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\n\ninterface Response extends BackendResponse {}\n\ninterface Payload {\n  password: string;\n}\n\nexport function useLogoutOtherSessions() {\n  return useMutation({\n    mutationFn: (payload: Payload) => logoutOther(payload),\n    onError: r => showHttpErrorToast(r),\n  });\n}\n\nfunction logoutOther(payload: Payload): Promise<Response> {\n  return apiClient\n    .post('user-sessions/logout-other', payload)\n    .then(response => response.data);\n}\n","import {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\nimport {useQuery} from '@tanstack/react-query';\n\nexport interface UserSession {\n  id: string;\n  platform?: string;\n  device?: 'mobile' | 'tablet' | 'desktop';\n  browser?: string;\n  country?: string;\n  city?: string;\n  ip_address?: string;\n  token?: string;\n  is_current_device: boolean;\n  updated_at: string;\n  created_at: string;\n}\n\ninterface Response extends BackendResponse {\n  sessions: UserSession[];\n}\n\nexport function useUserSessions() {\n  return useQuery({\n    queryKey: ['user-sessions'],\n    queryFn: () => fetchUserSessions(),\n  });\n}\n\nfunction fetchUserSessions() {\n  return apiClient\n    .get<Response>(`user-sessions`)\n    .then(response => response.data);\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\nimport {UseFormReturn} from 'react-hook-form';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\n\ninterface Response extends BackendResponse {}\n\nexport interface ConfirmPasswordPayload {\n  password: string;\n}\n\nexport function useConfirmPassword(\n  form: UseFormReturn<ConfirmPasswordPayload>,\n) {\n  return useMutation({\n    mutationFn: (payload: ConfirmPasswordPayload) => confirm(payload),\n    onError: r => onFormQueryError(r, form),\n  });\n}\n\nfunction confirm(payload: ConfirmPasswordPayload): Promise<Response> {\n  return apiClient\n    .post('auth/user/confirm-password', payload)\n    .then(response => response.data);\n}\n","import {Dialog} from '@ui/overlays/dialog/dialog';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {\n  ConfirmPasswordPayload,\n  useConfirmPassword,\n} from '@common/auth/ui/confirm-password/requests/use-confirm-password';\nimport {useForm} from 'react-hook-form';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {Trans} from '@ui/i18n/trans';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {Form} from '@ui/forms/form';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {DialogFooter} from '@ui/overlays/dialog/dialog-footer';\nimport {Button} from '@ui/buttons/button';\n\nexport function ConfirmPasswordDialog() {\n  const {close, formId} = useDialogContext();\n  const form = useForm<ConfirmPasswordPayload>();\n  const confirmPassword = useConfirmPassword(form);\n  return (\n    <Dialog>\n      <DialogHeader>\n        <Trans message=\"Confirm password\" />\n      </DialogHeader>\n      <DialogBody>\n        <p className=\"mb-16 text-sm\">\n          <Trans message=\"For your security, please confirm your password to continue.\" />\n        </p>\n        <Form\n          id={formId}\n          form={form}\n          onSubmit={values =>\n            confirmPassword.mutate(values, {\n              onSuccess: () => close(values.password),\n            })\n          }\n        >\n          <FormTextField\n            name=\"password\"\n            label={<Trans message=\"Password\" />}\n            type=\"password\"\n            required\n            autoFocus\n          />\n        </Form>\n      </DialogBody>\n      <DialogFooter>\n        <Button onClick={() => close()}>\n          <Trans message=\"Cancel\" />\n        </Button>\n        <Button\n          type=\"submit\"\n          variant=\"flat\"\n          color=\"primary\"\n          form={formId}\n          disabled={confirmPassword.isPending}\n        >\n          <Trans message=\"Confirm\" />\n        </Button>\n      </DialogFooter>\n    </Dialog>\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient, queryClient} from '@common/http/query-client';\n\ninterface Response extends BackendResponse {\n  confirmed: boolean;\n}\n\nexport function usePasswordConfirmationStatus() {\n  return useQuery({\n    queryKey: ['password-confirmation-status'],\n    queryFn: () => fetchStatus(),\n  });\n}\n\nfunction fetchStatus(): Promise<Response> {\n  return apiClient\n    .get('auth/user/confirmed-password-status', {params: {seconds: 9000}})\n    .then(response => response.data);\n}\n\nexport function setPasswordConfirmationStatus(confirmed: boolean) {\n  queryClient.setQueryData(['password-confirmation-status'], {confirmed});\n}\n","import { ConfirmPasswordDialog } from '@common/auth/ui/confirm-password/confirm-password-dialog';\nimport {\n  setPasswordConfirmationStatus,\n  usePasswordConfirmationStatus,\n} from '@common/auth/ui/confirm-password/requests/use-password-confirmation-status';\nimport { openDialog } from '@ui/overlays/store/dialog-store';\nimport { useCallback, useRef } from 'react';\n\ninterface Props {\n  needsPassword?: boolean;\n}\nexport function usePasswordConfirmedAction({needsPassword}: Props = {}) {\n  const {data, isLoading} = usePasswordConfirmationStatus();\n  const passwordRef = useRef<string>(null);\n\n  const withConfirmedPassword = useCallback(\n    async (action: (password?: string | null) => void) => {\n      if (data?.confirmed && (passwordRef.current || !needsPassword)) {\n        action(passwordRef.current);\n      } else {\n        const password = await openDialog(ConfirmPasswordDialog);\n        if (password) {\n          passwordRef.current = password;\n          setPasswordConfirmationStatus(true);\n          action(passwordRef.current);\n        }\n      }\n    },\n    [data?.confirmed, needsPassword],\n  );\n\n  return {\n    isLoading,\n    withConfirmedPassword,\n  };\n}\n","import {AccountSettingsId} from '@common/auth/ui/account-settings/account-settings-sidenav';\nimport {useLogoutOtherSessions} from '@common/auth/ui/account-settings/sessions-panel/requests/use-logout-other-sessions';\nimport {\n  UserSession,\n  useUserSessions,\n} from '@common/auth/ui/account-settings/sessions-panel/requests/use-user-sessions';\nimport {usePasswordConfirmedAction} from '@common/auth/ui/confirm-password/use-password-confirmed-action';\nimport {Button} from '@ui/buttons/button';\nimport {FormattedRelativeTime} from '@ui/i18n/formatted-relative-time';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {ComputerIcon} from '@ui/icons/material/Computer';\nimport {SmartphoneIcon} from '@ui/icons/material/Smartphone';\nimport {TabletIcon} from '@ui/icons/material/Tablet';\nimport {SvgIconProps} from '@ui/icons/svg-icon';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport {toast} from '@ui/toast/toast';\nimport {Fragment, ReactNode} from 'react';\nimport {AccountSettingsPanel} from '../account-settings-panel';\n\nexport function SessionsPanel() {\n  const {data, isLoading} = useUserSessions();\n  const logoutOther = useLogoutOtherSessions();\n  const {withConfirmedPassword, isLoading: checkingPasswordStatus} =\n    usePasswordConfirmedAction({needsPassword: true});\n\n  const sessionList = (\n    <div className=\"max-h-400 overflow-y-auto\">\n      {data?.sessions?.map(session => (\n        <SessionItem key={session.id} session={session} />\n      ))}\n    </div>\n  );\n\n  return (\n    <AccountSettingsPanel\n      id={AccountSettingsId.Sessions}\n      title={<Trans message=\"Sessions\" />}\n    >\n      <p className=\"text-sm\">\n        <Trans message=\"If necessary, you may log out of all of your other browser sessions across all of your devices. Your recent sessions are listed below. If you feel your account has been compromised, you should also update your password.\" />\n      </p>\n      <div className=\"my-30\">\n        {isLoading ? (\n          <div className=\"min-h-60\">\n            <ProgressCircle isIndeterminate />\n          </div>\n        ) : (\n          sessionList\n        )}\n      </div>\n      <Button\n        variant=\"outline\"\n        color=\"primary\"\n        disabled={checkingPasswordStatus || logoutOther.isPending}\n        onClick={() => {\n          withConfirmedPassword(password => {\n            logoutOther.mutate(\n              {password: password!},\n              {\n                onSuccess: () => {\n                  toast(message('Logged out other sessions.'));\n                },\n              },\n            );\n          });\n        }}\n      >\n        <Trans message=\"Logout other sessions\" />\n      </Button>\n    </AccountSettingsPanel>\n  );\n}\n\ninterface SessionItemProps {\n  session: UserSession;\n}\nfunction SessionItem({session}: SessionItemProps) {\n  return (\n    <div className=\"mb-14 flex items-start gap-14 text-sm\">\n      <div className=\"flex-shrink-0 text-muted\">\n        <DeviceIcon device={session.device} size=\"lg\" />\n      </div>\n      <div className=\"flex-auto\">\n        <div>\n          <ValueOrUnknown>{session.platform}</ValueOrUnknown> -{' '}\n          <ValueOrUnknown>{session.browser}</ValueOrUnknown>\n        </div>\n        <div className=\"my-4 text-xs\">\n          {session.city}, {session.country}\n        </div>\n        <div className=\"text-xs\">\n          <IpAddress session={session} /> - <LastActive session={session} />\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface DeviceIconProps {\n  device: UserSession['device'];\n  size: SvgIconProps['size'];\n}\nfunction DeviceIcon({device, size}: DeviceIconProps) {\n  switch (device) {\n    case 'mobile':\n      return <SmartphoneIcon size={size} />;\n    case 'tablet':\n      return <TabletIcon size={size} />;\n    default:\n      return <ComputerIcon size={size} />;\n  }\n}\n\ninterface LastActiveProps {\n  session: UserSession;\n}\nfunction LastActive({session}: LastActiveProps) {\n  if (session.is_current_device) {\n    return (\n      <span className=\"text-positive\">\n        <Trans message=\"This device\" />\n      </span>\n    );\n  }\n\n  return <FormattedRelativeTime date={session.updated_at} />;\n}\n\ninterface IpAddressProps {\n  session: UserSession;\n}\nfunction IpAddress({session}: IpAddressProps) {\n  if (session.ip_address) {\n    return <span>{session.ip_address}</span>;\n  } else if (session.token) {\n    return <Trans message=\"API Token\" />;\n  }\n  return <Trans message=\"Unknown IP\" />;\n}\n\ninterface ValueOrUnknownProps {\n  children: ReactNode;\n}\nfunction ValueOrUnknown({children}: ValueOrUnknownProps) {\n  return children ? (\n    <Fragment>{children}</Fragment>\n  ) : (\n    <Trans message=\"Unknown\" />\n  );\n}\n","import {AccountSettingsId} from '@common/auth/ui/account-settings/account-settings-sidenav';\nimport {useAllSocialLoginsDisabled} from '@common/auth/ui/use-all-social-logins-disabled';\nimport {queryClient} from '@common/http/query-client';\nimport {Button} from '@ui/buttons/button';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {EnvatoIcon} from '@ui/icons/social/envato';\nimport {FacebookIcon} from '@ui/icons/social/facebook';\nimport {GoogleIcon} from '@ui/icons/social/google';\nimport {TwitterIcon} from '@ui/icons/social/twitter';\nimport {SvgIconProps} from '@ui/icons/svg-icon';\nimport {useSettings} from '@ui/settings/use-settings';\nimport {toast} from '@ui/toast/toast';\nimport {User} from '@ui/types/user';\nimport clsx from 'clsx';\nimport {cloneElement, ReactElement} from 'react';\nimport {SocialService, useSocialLogin} from '../../requests/use-social-login';\nimport {AccountSettingsPanel} from './account-settings-panel';\n\ninterface PartialUser {\n  id: number;\n  social_profiles?: User['social_profiles'];\n}\n\ninterface Props {\n  user: PartialUser;\n}\nexport function SocialLoginPanel({user}: Props) {\n  if (useAllSocialLoginsDisabled()) {\n    return null;\n  }\n\n  return (\n    <AccountSettingsPanel\n      id={AccountSettingsId.SocialLogin}\n      title={<Trans message=\"Manage social login\" />}\n    >\n      <SocialLoginPanelRow\n        icon={\n          <EnvatoIcon\n            viewBox=\"0 0 50 50\"\n            className=\"border-envato bg-envato text-white\"\n          />\n        }\n        service=\"envato\"\n        user={user}\n      />\n      <SocialLoginPanelRow\n        icon={<GoogleIcon viewBox=\"0 0 48 48\" />}\n        service=\"google\"\n        user={user}\n      />\n      <SocialLoginPanelRow\n        icon={<FacebookIcon className=\"text-facebook\" />}\n        service=\"facebook\"\n        user={user}\n      />\n      <SocialLoginPanelRow\n        icon={<TwitterIcon className=\"text-twitter\" />}\n        service=\"twitter\"\n        user={user}\n      />\n      <div className=\"pb-6 pt-16 text-sm text-muted\">\n        <Trans message=\"If you disable social logins, you'll still be able to log in using your email and password.\" />\n      </div>\n    </AccountSettingsPanel>\n  );\n}\n\ninterface SocialLoginPanelRowProps {\n  service: SocialService;\n  user: PartialUser;\n  className?: string;\n  icon: ReactElement<SvgIconProps>;\n}\n\nfunction SocialLoginPanelRow({\n  service,\n  user,\n  className,\n  icon,\n}: SocialLoginPanelRowProps) {\n  const {social} = useSettings();\n  const {connectSocial, disconnectSocial} = useSocialLogin();\n  const username = user?.social_profiles?.find(\n    s => s.service_name === service,\n  )?.username;\n\n  if (!social?.[service]?.enable) {\n    return null;\n  }\n\n  return (\n    <div\n      className={clsx(\n        'flex items-center gap-14 border-b px-10 py-20',\n        className,\n      )}\n    >\n      {cloneElement(icon, {\n        size: 'xl',\n        className: clsx(icon.props.className, 'border p-8 rounded'),\n      })}\n      <div className=\"mr-auto overflow-hidden text-ellipsis whitespace-nowrap\">\n        <div className=\"overflow-hidden text-ellipsis text-sm font-bold first-letter:capitalize\">\n          <Trans message=\":service account\" values={{service}} />\n        </div>\n        <div className=\"mt-2 text-xs\">\n          {username || <Trans message=\"Disabled\" />}\n        </div>\n      </div>\n      <Button\n        disabled={disconnectSocial.isPending}\n        size=\"xs\"\n        variant=\"outline\"\n        color={username ? 'danger' : 'primary'}\n        onClick={async () => {\n          if (username) {\n            disconnectSocial.mutate(\n              {service},\n              {\n                onSuccess: () => {\n                  queryClient.invalidateQueries({queryKey: ['users']});\n                  toast(\n                    message('Disabled :service account', {values: {service}}),\n                  );\n                },\n              },\n            );\n          } else {\n            const e = await connectSocial(service);\n            if (e?.status === 'SUCCESS') {\n              queryClient.invalidateQueries({queryKey: ['users']});\n              toast(message('Enabled :service account', {values: {service}}));\n            }\n          }\n        }}\n      >\n        {username ? <Trans message=\"Disable\" /> : <Trans message=\"Enable\" />}\n      </Button>\n    </div>\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\n\ninterface Response extends BackendResponse {}\n\nexport function useEnableTwoFactor() {\n  return useMutation({\n    mutationFn: enable,\n    onError: r => showHttpErrorToast(r),\n  });\n}\n\nfunction enable(): Promise<Response> {\n  return apiClient\n    .post('auth/user/two-factor-authentication')\n    .then(response => response.data);\n}\n","import {Fragment, ReactNode} from 'react';\nimport {Trans} from '@ui/i18n/trans';\n\ninterface Props {\n  title: ReactNode;\n  subtitle?: ReactNode;\n  description?: ReactNode;\n  actions?: ReactNode;\n  children?: ReactNode;\n}\nexport function TwoFactorStepperLayout({\n  title,\n  subtitle,\n  description,\n  actions,\n  children,\n}: Props) {\n  if (!subtitle) {\n    subtitle = (\n      <Trans message=\"When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application.\" />\n    );\n  }\n  return (\n    <Fragment>\n      <div className=\"mb-16 text-base font-medium\">{title}</div>\n      <div className=\"mb-24 text-sm\">{subtitle}</div>\n      <p className=\"my-16 text-sm font-medium\">{description}</p>\n      {children}\n      <div className=\"flex items-center gap-12\">{actions}</div>\n    </Fragment>\n  );\n}\n","import {useEnableTwoFactor} from '@common/auth/ui/two-factor/requests/use-enable-two-factor';\nimport {TwoFactorStepperLayout} from '@common/auth/ui/two-factor/stepper/two-factor-stepper-layout';\nimport {Trans} from '@ui/i18n/trans';\nimport {Button} from '@ui/buttons/button';\nimport {usePasswordConfirmedAction} from '@common/auth/ui/confirm-password/use-password-confirmed-action';\n\ninterface Props {\n  onEnabled: () => void;\n}\nexport function TwoFactorDisabledStep({onEnabled}: Props) {\n  const enableTwoFactor = useEnableTwoFactor();\n  const {withConfirmedPassword, isLoading: confirmPasswordIsLoading} =\n    usePasswordConfirmedAction();\n  const isLoading = enableTwoFactor.isPending || confirmPasswordIsLoading;\n\n  return (\n    <TwoFactorStepperLayout\n      title={\n        <Trans message=\"You have not enabled two factor authentication.\" />\n      }\n      actions={\n        <Button\n          variant=\"flat\"\n          color=\"primary\"\n          disabled={isLoading}\n          onClick={() => {\n            withConfirmedPassword(() => {\n              enableTwoFactor.mutate(undefined, {\n                onSuccess: onEnabled,\n              });\n            });\n          }}\n        >\n          <Trans message=\"Enable\" />\n        </Button>\n      }\n    />\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\n\ninterface Response extends BackendResponse {\n  svg: string;\n  secret: string;\n}\n\nexport function useTwoFactorQrCode() {\n  return useQuery({\n    queryKey: ['two-factor-qr-code'],\n    queryFn: () => fetchCode(),\n  });\n}\n\nfunction fetchCode(): Promise<Response> {\n  return apiClient\n    .get('auth/user/two-factor/qr-code')\n    .then(response => response.data);\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\nimport {UseFormReturn} from 'react-hook-form';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\n\ninterface Response extends BackendResponse {}\n\nexport interface ConfirmTwoFactorPayload {\n  code: string;\n}\n\nexport function useConfirmTwoFactor(\n  form: UseFormReturn<ConfirmTwoFactorPayload>,\n) {\n  return useMutation({\n    mutationFn: (payload: ConfirmTwoFactorPayload) => confirm(payload),\n    onError: r => onFormQueryError(r, form),\n  });\n}\n\nfunction confirm(payload: ConfirmTwoFactorPayload): Promise<Response> {\n  return apiClient\n    .post('auth/user/confirmed-two-factor-authentication', payload)\n    .then(response => response.data);\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\n\ninterface Response extends BackendResponse {}\n\nexport function useDisableTwoFactor() {\n  return useMutation({\n    mutationFn: disable,\n    onError: r => showHttpErrorToast(r),\n  });\n}\n\nfunction disable(): Promise<Response> {\n  return apiClient\n    .delete('auth/user/two-factor-authentication')\n    .then(response => response.data);\n}\n","import {AnimatePresence, m} from 'framer-motion';\nimport {opacityAnimation} from '@ui/animation/opacity-animation';\nimport {ReactNode} from 'react';\nimport {useTwoFactorQrCode} from '@common/auth/ui/two-factor/requests/use-two-factor-qr-code';\nimport {useForm} from 'react-hook-form';\nimport {\n  ConfirmTwoFactorPayload,\n  useConfirmTwoFactor,\n} from '@common/auth/ui/two-factor/requests/use-confirm-two-factor';\nimport {TwoFactorStepperLayout} from '@common/auth/ui/two-factor/stepper/two-factor-stepper-layout';\nimport {Trans} from '@ui/i18n/trans';\nimport {Skeleton} from '@ui/skeleton/skeleton';\nimport {Form} from '@ui/forms/form';\nimport {queryClient} from '@common/http/query-client';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {useDisableTwoFactor} from '@common/auth/ui/two-factor/requests/use-disable-two-factor';\nimport {usePasswordConfirmedAction} from '@common/auth/ui/confirm-password/use-password-confirmed-action';\nimport {Button} from '@ui/buttons/button';\n\ninterface Props {\n  onCancel: () => void;\n  onConfirmed: () => void;\n}\nexport function TwoFactorConfirmationStep(props: Props) {\n  const {data} = useTwoFactorQrCode();\n\n  return (\n    <TwoFactorStepperLayout\n      title={<Trans message=\"Finish enabling two factor authentication.\" />}\n      description={\n        <Trans message=\"To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code.\" />\n      }\n    >\n      <AnimatePresence initial={false}>\n        {!data ? (\n          <QrCodeLayout\n            animationKey=\"svg-skeleton\"\n            svg={<Skeleton variant=\"rect\" size=\"w-full h-full\" />}\n            secret={<Skeleton variant=\"text\" className=\"max-w-224\" />}\n          />\n        ) : (\n          <QrCodeLayout\n            animationKey=\"real-svg\"\n            svg={<div dangerouslySetInnerHTML={{__html: data.svg}} />}\n            secret={\n              <Trans message=\"Setup key: :key\" values={{key: data.secret}} />\n            }\n          />\n        )}\n      </AnimatePresence>\n      <CodeForm {...props} />\n    </TwoFactorStepperLayout>\n  );\n}\n\nfunction CodeForm({onCancel, onConfirmed}: Props) {\n  const form = useForm<ConfirmTwoFactorPayload>();\n  const confirmTwoFactor = useConfirmTwoFactor(form);\n  const disableTwoFactor = useDisableTwoFactor();\n  const {withConfirmedPassword, isLoading: confirmPasswordIsLoading} =\n    usePasswordConfirmedAction();\n  const isLoading =\n    confirmTwoFactor.isPending ||\n    disableTwoFactor.isPending ||\n    confirmPasswordIsLoading;\n\n  return (\n    <Form\n      form={form}\n      onSubmit={values =>\n        withConfirmedPassword(() => {\n          confirmTwoFactor.mutate(values, {\n            onSuccess: () => {\n              queryClient.invalidateQueries({queryKey: ['users']});\n              onConfirmed();\n            },\n          });\n        })\n      }\n    >\n      <FormTextField\n        required\n        name=\"code\"\n        label={<Trans message=\"Code\" />}\n        autoFocus\n      />\n      <div className=\"mt-24 flex items-center gap-12\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          disabled={isLoading}\n          onClick={() => {\n            withConfirmedPassword(() => {\n              disableTwoFactor.mutate(undefined, {onSuccess: onCancel});\n            });\n          }}\n        >\n          <Trans message=\"Cancel\" />\n        </Button>\n        <Button\n          type=\"submit\"\n          variant=\"flat\"\n          color=\"primary\"\n          disabled={isLoading}\n        >\n          <Trans message=\"Confirm\" />\n        </Button>\n      </div>\n    </Form>\n  );\n}\n\ninterface QrCodeLayoutProps {\n  animationKey: string;\n  svg: ReactNode;\n  secret: ReactNode;\n}\nfunction QrCodeLayout({animationKey, svg, secret}: QrCodeLayoutProps) {\n  return (\n    <m.div key={animationKey} {...opacityAnimation}>\n      <div className=\"mb-16 h-192 w-192\">{svg}</div>\n      <div className=\"mb-16 text-sm font-medium\">{secret}</div>\n    </m.div>\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\n\ninterface Response extends BackendResponse {}\n\nexport function useRegenerateTwoFactorCodes() {\n  return useMutation({\n    mutationFn: () => regenerate(),\n    onError: r => showHttpErrorToast(r),\n  });\n}\n\nfunction regenerate(): Promise<Response> {\n  return apiClient\n    .post('auth/user/two-factor-recovery-codes')\n    .then(response => response.data);\n}\n","import {useDisableTwoFactor} from '@common/auth/ui/two-factor/requests/use-disable-two-factor';\nimport {useRegenerateTwoFactorCodes} from '@common/auth/ui/two-factor/requests/use-regenerate-two-factor-codes';\nimport {Fragment} from 'react';\nimport {queryClient} from '@common/http/query-client';\nimport {Trans} from '@ui/i18n/trans';\nimport {TwoFactorStepperLayout} from '@common/auth/ui/two-factor/stepper/two-factor-stepper-layout';\nimport {toast} from '@ui/toast/toast';\nimport {message} from '@ui/i18n/message';\nimport {usePasswordConfirmedAction} from '@common/auth/ui/confirm-password/use-password-confirmed-action';\nimport {Button} from '@ui/buttons/button';\n\ninterface Props {\n  user: {\n    two_factor_confirmed_at?: string;\n    two_factor_recovery_codes?: string[];\n  };\n  onDisabled: () => void;\n}\nexport function TwoFactorEnabledStep({user, onDisabled}: Props) {\n  const disableTwoFactor = useDisableTwoFactor();\n  const regenerateCodes = useRegenerateTwoFactorCodes();\n  const {withConfirmedPassword, isLoading: confirmPasswordIsLoading} =\n    usePasswordConfirmedAction();\n  const isLoading =\n    disableTwoFactor.isPending ||\n    regenerateCodes.isPending ||\n    confirmPasswordIsLoading;\n\n  const actions = (\n    <Fragment>\n      <Button\n        type=\"button\"\n        onClick={() =>\n          withConfirmedPassword(() => {\n            regenerateCodes.mutate(undefined, {\n              onSuccess: () => {\n                queryClient.invalidateQueries({queryKey: ['users']});\n              },\n            });\n          })\n        }\n        variant=\"outline\"\n        disabled={isLoading}\n        className=\"mr-12\"\n      >\n        <Trans message=\"Regenerate recovery codes\" />\n      </Button>\n      <Button\n        type=\"submit\"\n        variant=\"flat\"\n        color=\"danger\"\n        disabled={isLoading}\n        onClick={() => {\n          withConfirmedPassword(() => {\n            disableTwoFactor.mutate(undefined, {\n              onSuccess: () => {\n                toast(message('Two factor authentication has been disabled.'));\n                onDisabled();\n              },\n            });\n          });\n        }}\n      >\n        <Trans message=\"Disable\" />\n      </Button>\n    </Fragment>\n  );\n\n  return (\n    <TwoFactorStepperLayout\n      title={<Trans message=\"You have enabled two factor authentication.\" />}\n      description={\n        <Trans message=\"Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost.\" />\n      }\n      actions={actions}\n    >\n      <div className=\"mb-16 rounded bg-alt p-14 font-mono text-sm\">\n        {user.two_factor_recovery_codes?.map(code => (\n          <div className=\"mb-4\" key={code}>\n            {code}\n          </div>\n        ))}\n      </div>\n    </TwoFactorStepperLayout>\n  );\n}\n","import {useState} from 'react';\nimport {TwoFactorDisabledStep} from '@common/auth/ui/two-factor/stepper/two-factor-disabled-step';\nimport {TwoFactorConfirmationStep} from '@common/auth/ui/two-factor/stepper/two-factor-confirmation-step';\nimport {TwoFactorEnabledStep} from '@common/auth/ui/two-factor/stepper/two-factor-enabled-step';\n\nenum Status {\n  Disabled,\n  WaitingForConfirmation,\n  Enabled,\n}\n\ninterface Props {\n  user: {\n    two_factor_confirmed_at?: string;\n    two_factor_recovery_codes?: string[];\n  };\n}\nexport function TwoFactorStepper({user}: Props) {\n  const [status, setStatus] = useState<Status>(getStatus(user));\n  switch (status) {\n    case Status.Disabled:\n      return (\n        <TwoFactorDisabledStep\n          onEnabled={() => setStatus(Status.WaitingForConfirmation)}\n        />\n      );\n    case Status.WaitingForConfirmation:\n      return (\n        <TwoFactorConfirmationStep\n          onCancel={() => {\n            setStatus(Status.Disabled);\n          }}\n          onConfirmed={() => {\n            setStatus(Status.Enabled);\n          }}\n        />\n      );\n    case Status.Enabled:\n      return (\n        <TwoFactorEnabledStep\n          user={user}\n          onDisabled={() => setStatus(Status.Disabled)}\n        />\n      );\n  }\n}\n\nfunction getStatus(user: Props['user']): Status {\n  if (user.two_factor_confirmed_at) {\n    return Status.Enabled;\n  } else if (user.two_factor_recovery_codes) {\n    return Status.WaitingForConfirmation;\n  }\n  return Status.Disabled;\n}\n","import {AccountSettingsPanel} from '@common/auth/ui/account-settings/account-settings-panel';\nimport {AccountSettingsId} from '@common/auth/ui/account-settings/account-settings-sidenav';\nimport {Trans} from '@ui/i18n/trans';\nimport {TwoFactorStepper} from '@common/auth/ui/two-factor/stepper/two-factor-auth-stepper';\n\ninterface Props {\n  user: {\n    two_factor_confirmed_at?: string;\n    two_factor_recovery_codes?: string[];\n  };\n}\nexport function TwoFactorPanel({user}: Props) {\n  return (\n    <AccountSettingsPanel\n      id={AccountSettingsId.TwoFactor}\n      title={<Trans message=\"Two factor authentication\" />}\n    >\n      <div className=\"max-w-580\">\n        <TwoFactorStepper user={user} />\n      </div>\n    </AccountSettingsPanel>\n  );\n}\n"],"names":["useUpdatePassword","form","useMutation","props","updatePassword","toast","message","r","onFormQueryError","payload","apiClient","ChangePasswordPanel","useForm","formId","useId","jsx","AccountSettingsPanel","AccountSettingsId","Trans","Button","jsxs","Form","newValues","FormTextField","useLogoutOtherSessions","logoutOther","showHttpErrorToast","response","useUserSessions","useQuery","fetchUserSessions","useConfirmPassword","confirm","ConfirmPasswordDialog","close","useDialogContext","confirmPassword","Dialog","DialogHeader","DialogBody","values","DialogFooter","usePasswordConfirmationStatus","fetchStatus","setPasswordConfirmationStatus","confirmed","queryClient","usePasswordConfirmedAction","needsPassword","data","isLoading","passwordRef","useRef","withConfirmedPassword","useCallback","action","password","openDialog","SessionsPanel","checkingPasswordStatus","sessionList","_a","session","SessionItem","ProgressCircle","DeviceIcon","ValueOrUnknown","IpAddress","LastActive","device","size","SmartphoneIcon","TabletIcon","ComputerIcon","FormattedRelativeTime","children","Fragment","SocialLoginPanel","user","useAllSocialLoginsDisabled","SocialLoginPanelRow","EnvatoIcon","GoogleIcon","FacebookIcon","TwitterIcon","service","className","icon","social","useSettings","connectSocial","disconnectSocial","useSocialLogin","username","_b","s","_c","clsx","cloneElement","e","useEnableTwoFactor","enable","TwoFactorStepperLayout","title","subtitle","description","actions","TwoFactorDisabledStep","onEnabled","enableTwoFactor","confirmPasswordIsLoading","useTwoFactorQrCode","fetchCode","useConfirmTwoFactor","useDisableTwoFactor","disable","TwoFactorConfirmationStep","AnimatePresence","QrCodeLayout","Skeleton","CodeForm","onCancel","onConfirmed","confirmTwoFactor","disableTwoFactor","animationKey","svg","secret","m","opacityAnimation","useRegenerateTwoFactorCodes","regenerate","TwoFactorEnabledStep","onDisabled","regenerateCodes","code","TwoFactorStepper","status","setStatus","useState","getStatus","TwoFactorPanel"],"mappings":"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"}