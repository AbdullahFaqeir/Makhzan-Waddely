import{r as d,ce as p,j as e,T as s,cH as h,D as c,B as f,aw as j,az as y,am as w,J as b,a8 as D,ap as S,aq as v,k as C,ax as E,aJ as F,x as N}from"./main-BdzhGpqn.js";import{a as P}from"./admin-config-DGty5VaU.js";import{D as T}from"./settings-links-CqCp-cYt.js";import{u as k,a as I,G as _,D as L,b as z,c as B}from"./use-datatable-query-CL53W5gM.js";import{D as H}from"./datatable-filters-Cd3MyVOw.js";import{a as A,D as q,b as R,c as M}from"./datatable-page-with-header-layout-T5QYry_g.js";import{T as Q}from"./table-BV_6nbvK.js";import{a as U}from"./file-preview-dialog-C3JXygxI.js";import{F as V}from"./formatted-bytes-n7lOD0MA.js";import{F as W}from"./formatted-date-hsbUwQxj.js";import{V as G}from"./Visibility-D64rxkqY.js";import{C as K}from"./confirmation-dialog-DtIJ4lxn.js";import{N as J}from"./name-with-avatar-oLONXEoV.js";import{a as m}from"./file-entry-index-filters-B6qMH1XZ.js";import"./external-link-BX7ebgFF.js";import"./FilterAlt-BkhHIgY7.js";import"./select-filter-panel-BD_PypVS.js";import"./use-normalized-models-yOhv1j4Y.js";import"./form-chip-field-Bj0OQHU9.js";import"./input-CDTJ1VfY.js";import"./ArrowRightAlt-DSM1kJ5L.js";import"./DateRange-DT2RCJ3g.js";import"./use-base-date-picker-state-DYteqbZD.js";import"./use-date-formatter-BlrPWK68.js";import"./KeyboardArrowRight-DFizyHtY.js";import"./use-date-range-picker-state-CEbm743A.js";import"./list-DRfBegha.js";import"./switch-DFT-JawA.js";import"./dialog-footer-DL2JkwrZ.js";import"./use-current-date-time-CnLDai64.js";import"./select-l28gQBMg.js";import"./Edit-AfuLMjS-.js";import"./skeleton-CTimao-U.js";import"./accordion-DxYXjiZR.js";import"./checkbox-B6q4SJqi.js";import"./CheckBoxOutlineBlank-DvnJQjlB.js";import"./timestamp-filters-Bn_q9MOg.js";import"./formatted-number-pJC-IR-x.js";import"./dashboard-layout-context-DDiFtkN0.js";import"./use-toggle-dashboard-left-sidebar-Dzdho4R0.js";import"./ArrowDownward-DXr7353z.js";import"./useEffectEvent-D8HiMrwe.js";import"./use-pointer-events-Dsln3OKq.js";import"./useGlobalListeners-C14jVC5X.js";import"./ChevronLeft-CFnMYWTj.js";import"./ChevronRight-C9FQjnQQ.js";import"./FileDownload-CzvSUcXm.js";import"./download-file-from-url-BVaKcxRP.js";import"./pretty-bytes-bO14ePu9.js";import"./user-D6GCMJ6c.js";const X=""+new URL("upload-DtVE1GoK.svg",import.meta.url).href,Y=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Name"}),body:t=>e.jsxs(d.Fragment,{children:[e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis",children:t.name}),e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis text-xs text-muted",children:t.file_name})]})},{key:"owner_id",allowsSorting:!0,width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Uploader"}),body:t=>{var i,o;const a=((i=t.users)==null?void 0:i.find(r=>r.owns_entry))??((o=t.users)==null?void 0:o[0]);return a?e.jsx(J,{image:a.image,label:a.name,description:a.email}):null}},{key:"type",width:"w-100 flex-shrink-0",allowsSorting:!0,header:()=>e.jsx(s,{message:"Type"}),body:t=>e.jsxs("div",{className:"flex items-center gap-12",children:[e.jsx(j,{type:t.type,className:"h-24 w-24 overflow-hidden"}),e.jsx("div",{className:"capitalize",children:t.type})]})},{key:"public",allowsSorting:!0,width:"w-60 flex-shrink-0",header:()=>e.jsx(s,{message:"Public"}),body:t=>t.public?e.jsx(y,{className:"text-positive icon-md"}):e.jsx(w,{className:"text-danger icon-md"})},{key:"file_size",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(s,{message:"File size"}),body:t=>e.jsx(V,{bytes:t.file_size})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(s,{message:"Last updated"}),body:t=>e.jsx(W,{date:t.updated_at})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:t=>e.jsxs(c,{type:"modal",children:[e.jsx(b,{size:"md",className:"text-muted",children:e.jsx(G,{})}),e.jsx(U,{entries:[t]})]})}];function Je(){const[t,a]=d.useState([]),{searchParams:i,sortDescriptor:o,mergeIntoSearchParams:r,setSearchQuery:x,isFiltering:g}=k(h),l=I(p.fileEntries.index(i)),u=e.jsxs(c,{type:"modal",children:[e.jsx(f,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx($,{selectedIds:t,onDelete:()=>a([])})]});return e.jsxs(A,{children:[e.jsx(_,{query:l}),e.jsx(q,{title:e.jsx(s,{message:"Uploaded files and folders"}),showSidebarToggleButton:!0,rightContent:e.jsx(T,{variant:"button",link:P.pages.files,size:"xs"})}),e.jsxs(R,{children:[e.jsx(L,{searchValue:i.query,onSearchChange:x,selectedItems:t,selectedActions:u,filters:m}),e.jsx(H,{filters:m}),e.jsxs(M,{children:[e.jsx(Q,{columns:Y,data:l.items,sortDescriptor:o,onSortChange:r,enableSelection:!0,selectedRows:t,onSelectionChange:a}),l.isEmpty&&e.jsx(z,{isFiltering:g,image:X,title:e.jsx(s,{message:"Nothing has been uploaded yet"}),filteringTitle:e.jsx(s,{message:"No matching files or folders"})}),e.jsx(B,{query:l,onPageChange:n=>r({page:n}),onPerPageChange:n=>r({perPage:n})})]})]})]})}function $({selectedIds:t,onDelete:a}){const{close:i}=D(),o=S({mutationFn:()=>C.delete(`file-entries/${t.join(",")}`),onSuccess:async()=>{await E.invalidateQueries({queryKey:p.fileEntries.invalidateKey}),F(N("File entries deleted")),a(),i()},onError:r=>v(r)});return e.jsx(K,{isDanger:!0,isLoading:o.isPending,title:e.jsx(s,{message:"Delete file entries"}),body:e.jsx(s,{message:"Are you sure you want to delete selected file entries?",values:{count:t.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>o.mutate()})}export{Je as Component};
