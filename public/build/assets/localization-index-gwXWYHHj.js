import{Z as M,c6 as N,ap as f,ar as U,aJ as y,x as g,ce as x,k as b,w as D,a8 as h,a3 as S,j as e,M as w,Q as C,T as s,R as L,ao as v,a4 as z,a6 as m,B as u,r as A,cH as E,D as j,aD as H,J as T,L as F,aq as B,ax as Q,ak as $,al as K,at as R}from"./main-BdzhGpqn.js";import{a as V,T as W}from"./admin-config-DGty5VaU.js";import{D as G}from"./settings-links-CqCp-cYt.js";import{u as J,a as O}from"./update-localization-Bz35bbML.js";import{u as Z,a as _,G as X,D as Y,b as ee,c as ae}from"./use-datatable-query-CL53W5gM.js";import{a as se,D as te,b as oe,c as ne}from"./datatable-page-with-header-layout-T5QYry_g.js";import{T as ie}from"./table-BV_6nbvK.js";import{F as re}from"./file-upload-provider-Cq9bpz4o.js";import{F as le}from"./formatted-date-hsbUwQxj.js";import{M as ce}from"./MoreVert-BJhX_Lfk.js";import{C as de}from"./confirmation-dialog-DtIJ4lxn.js";import{d as me}from"./download-file-from-url-BVaKcxRP.js";import{F as ue}from"./file-input-config-DrcTpI3-.js";import{o as ge}from"./open-upload-window-DBvxFCUj.js";import{D as pe}from"./data-table-add-item-button-DnF2ZiVm.js";import{F as P}from"./select-l28gQBMg.js";import{D as I}from"./dialog-footer-DL2JkwrZ.js";import{g as xe}from"./countries-BJ4WnA-N.js";import"./external-link-BX7ebgFF.js";import"./FilterAlt-BkhHIgY7.js";import"./select-filter-panel-BD_PypVS.js";import"./use-normalized-models-yOhv1j4Y.js";import"./form-chip-field-Bj0OQHU9.js";import"./input-CDTJ1VfY.js";import"./ArrowRightAlt-DSM1kJ5L.js";import"./DateRange-DT2RCJ3g.js";import"./use-base-date-picker-state-DYteqbZD.js";import"./use-date-formatter-BlrPWK68.js";import"./KeyboardArrowRight-DFizyHtY.js";import"./use-date-range-picker-state-CEbm743A.js";import"./list-DRfBegha.js";import"./switch-DFT-JawA.js";import"./use-current-date-time-CnLDai64.js";import"./Edit-AfuLMjS-.js";import"./skeleton-CTimao-U.js";import"./accordion-DxYXjiZR.js";import"./checkbox-B6q4SJqi.js";import"./CheckBoxOutlineBlank-DvnJQjlB.js";import"./dashboard-layout-context-DDiFtkN0.js";import"./use-toggle-dashboard-left-sidebar-Dzdho4R0.js";import"./ArrowDownward-DXr7353z.js";import"./useEffectEvent-D8HiMrwe.js";import"./use-pointer-events-Dsln3OKq.js";import"./useGlobalListeners-C14jVC5X.js";import"./uploaded-file-BYIHeonQ.js";import"./pretty-bytes-bO14ePu9.js";import"./Add-iOynMxF0.js";const he=""+new URL("around-the-world-DwONd8Eq.svg",import.meta.url).href,k=M((a="en")=>{const o=new Intl.DisplayNames([a],{type:"language"}),t=xe(a),i=[],r=[];for(let c=0;c<t.length;c++){const l=t[c].code.toLowerCase(),n=new Intl.Locale("und",{region:l}).maximize().language;try{const d=o.of(n);d&&!r.includes(n)&&n!==d&&(r.push(n),i.push({code:n,name:d}))}catch{}}return i});function je(a){return b.post("localizations",a).then(o=>o.data)}function fe(a){const o=N();return f({mutationFn:t=>je(t),onSuccess:()=>{y(g("Localization created")),o.invalidateQueries({queryKey:x.localizations.invalidateKey})},onError:t=>U(t,a)})}function ye(){const{trans:a}=D(),{formId:o,close:t}=h(),i=S({defaultValues:{language:"en"}}),r=k(),c=fe(i);return e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(s,{message:"Create localization"})}),e.jsx(L,{children:e.jsxs(v,{form:i,id:o,onSubmit:l=>{c.mutate(l,{onSuccess:t})},children:[e.jsx(z,{autoFocus:!0,name:"name",label:e.jsx(s,{message:"Name"}),className:"mb-30",required:!0}),e.jsx(P,{required:!0,name:"language",label:e.jsx(s,{message:"Language"}),selectionMode:"single",showSearchField:!0,searchPlaceholder:a(g("Search languages")),children:r.map(l=>e.jsx(m,{value:l.code,children:l.name},l.code))})]})}),e.jsxs(I,{children:[e.jsx(u,{onClick:t,children:e.jsx(s,{message:"Cancel"})}),e.jsx(u,{variant:"flat",color:"primary",type:"submit",form:o,disabled:c.isPending,children:e.jsx(s,{message:"Save"})})]})]})}function be({localization:a}){const{trans:o}=D(),{formId:t,close:i}=h(),r=S({defaultValues:{id:a.id,name:a.name,language:a.language}}),c=k(),l=J(r);return e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(s,{message:"Update localization"})}),e.jsx(L,{children:e.jsxs(v,{form:r,id:t,onSubmit:n=>{l.mutate(n,{onSuccess:i})},children:[e.jsx(z,{name:"name",label:e.jsx(s,{message:"Name"}),className:"mb-30",required:!0}),e.jsx(P,{required:!0,name:"language",label:e.jsx(s,{message:"Language"}),selectionMode:"single",showSearchField:!0,searchPlaceholder:o(g("Search languages")),children:c.map(n=>e.jsx(m,{value:n.code,children:n.name},n.code))})]})}),e.jsxs(I,{children:[e.jsx(u,{onClick:i,children:e.jsx(s,{message:"Cancel"})}),e.jsx(u,{variant:"flat",color:"primary",type:"submit",form:t,disabled:l.isPending,children:e.jsx(s,{message:"Save"})})]})]})}const De=[{key:"name",allowsSorting:!0,sortingKey:"name",visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Name"}),body:a=>a.name},{key:"language",allowsSorting:!0,sortingKey:"language",header:()=>e.jsx(s,{message:"Language code"}),body:a=>a.language},{key:"updatedAt",allowsSorting:!0,width:"w-100",header:()=>e.jsx(s,{message:"Last updated"}),body:a=>e.jsx(le,{date:a.updated_at})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-84 flex-shrink-0",visibleInMode:"all",body:a=>e.jsxs("div",{className:"text-muted",children:[e.jsx(H,{label:e.jsx(s,{message:"Translate"}),children:e.jsx(T,{size:"md",elementType:F,to:`${a.id}/translate`,children:e.jsx(W,{})})}),e.jsx(re,{children:e.jsx(Se,{locale:a})})]})}];function ja(){const[a,o]=A.useState([]),{searchParams:t,sortDescriptor:i,mergeIntoSearchParams:r,setSearchQuery:c,isFiltering:l}=Z(E),n=_(x.localizations.index(t)),d=e.jsxs(j,{type:"modal",children:[e.jsx(u,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx(we,{selectedIds:a,onDelete:()=>o([])})]}),q=e.jsxs(j,{type:"modal",children:[e.jsx(pe,{children:e.jsx(s,{message:"Add new localization"})}),e.jsx(ye,{})]});return e.jsxs(se,{children:[e.jsx(X,{query:n}),e.jsx(te,{title:e.jsx(s,{message:"Localizations"}),showSidebarToggleButton:!0,rightContent:e.jsx(G,{variant:"button",link:V.pages.translations,size:"xs"})}),e.jsxs(oe,{children:[e.jsx(Y,{searchValue:t.query,onSearchChange:c,actions:q,selectedItems:a,selectedActions:d}),e.jsxs(ne,{children:[e.jsx(ie,{columns:De,data:n.items,sortDescriptor:i,onSortChange:r,enableSelection:!0,selectedRows:a,onSelectionChange:o,cellHeight:"h-60"}),n.isEmpty&&e.jsx(ee,{isFiltering:l,image:he,title:e.jsx(s,{message:"No localizations have been created yet"}),filteringTitle:e.jsx(s,{message:"No matching localizations"})}),e.jsx(ae,{query:n,onPageChange:p=>r({page:p}),onPerPageChange:p=>r({perPage:p})})]})]})]})}function Se({locale:a}){const o=O();return e.jsxs($,{children:[e.jsx(T,{disabled:o.isPending,children:e.jsx(ce,{})}),e.jsxs(K,{children:[e.jsx(m,{value:"translate",elementType:F,to:`${a.id}/translate`,children:e.jsx(s,{message:"Translate"})}),e.jsx(m,{value:"rename",onSelected:()=>R(be,{localization:a}),children:e.jsx(s,{message:"Rename"})}),e.jsx(m,{value:"download",onSelected:()=>me(`api/v1/localizations/${a.id}/download`),children:e.jsx(s,{message:"Download"})}),e.jsx(m,{value:"upload",onSelected:async()=>{const t=await ge({types:[ue.json]});t.length==1&&o.mutate({localeId:a.id,file:t[0]})},children:e.jsx(s,{message:"Upload"})})]})]})}function we({selectedIds:a,onDelete:o}){const{close:t}=h(),i=f({mutationFn:()=>b.delete(`localizations/${a.join(",")}`),onSuccess:async()=>{await Q.invalidateQueries({queryKey:x.localizations.invalidateKey}),y(g("Localizations deleted")),o(),t()},onError:r=>B(r)});return e.jsx(de,{isDanger:!0,isLoading:i.isPending,title:e.jsx(s,{message:"Delete localizations"}),body:e.jsx(s,{message:"Are you sure you want to delete selected localizations?",values:{count:a.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>i.mutate()})}export{ja as Component,we as DeleteLocalizationsDialog};
