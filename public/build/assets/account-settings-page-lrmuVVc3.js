import{r as l,a2 as f,j as e,am as h,a3 as A,T as i,B as m,an as c,ao as u,k as d,a9 as v,aC as P,l as S,bq as b,aH as w,D,br as C,bs as N,a1 as T,N as F,P as I}from"./main-owSUWNVS.js";import{A as p,a as x,b as L}from"./account-settings-sidenav-Bc0nd4u6.js";import{u as U,S as z,C as E,T as k,a as O}from"./two-factor-panel-CY6XTuIW.js";import{A as V}from"./access-token-panel-ZIsCAjkc.js";import{I as B}from"./image-selector-DcLehUop.js";import{F as g}from"./file-upload-provider-B2470Xt4.js";import{A as _}from"./AlternateEmail-Bh0FPFee.js";import{u as R,L as H}from"./localization-panel-CGrJg3F5.js";import{C as $}from"./confirmation-dialog-DdZaouVf.js";import"./use-all-social-logins-disabled-CHM2Qt6Z.js";import"./PhonelinkLock-mWvIk7tX.js";import"./Lock-B2H2OiWG.js";import"./Login-zwoNlBsN.js";import"./list-B5Ky1WKX.js";import"./Tablet-CPmzcBq6.js";import"./envato-I9acLV69.js";import"./google-Csfw2XsG.js";import"./use-social-login-CDvSETdS.js";import"./dialog-footer-D_t7V-bM.js";import"./skeleton-xT-yudp1.js";import"./external-link-BpSO0s5u.js";import"./formatted-date-dVjFR1LG.js";import"./use-date-formatter-BiXQj-wq.js";import"./use-clipboard-D_WmY6Ld.js";import"./index-BwE6w5yz.js";import"./secure-files-DjSbgaf8.js";import"./use-active-upload-D5c4dCmN.js";import"./open-upload-window-Ckg_K7W2.js";import"./uploaded-file-0zTC6Yq4.js";import"./shallow-2-UK8gGu.js";import"./AddAPhoto-DEBtVm9g.js";import"./progress-bar-base-BNUfzFdJ.js";import"./file-input-config-DrcTpI3-.js";import"./pretty-bytes-bO14ePu9.js";import"./combobox-xgs1P5ps.js";import"./select-Bv69-mBO.js";import"./countries-CCRmM8df.js";function q({user:s}){const t=l.useId(),a=f({defaultValues:{name:s.name||"",image:s.image}});j(s.id);const r=R(s.id,a);return e.jsx(p,{id:x.AccountDetails,title:e.jsx(i,{message:"Update name and profile image"}),actions:e.jsx(m,{type:"submit",variant:"flat",color:"primary",form:t,disabled:r.isPending||!a.formState.isValid||!a.formState.isDirty,children:e.jsx(i,{message:"Save"})}),children:e.jsxs(h,{form:a,className:"flex flex-col items-center gap-40 md:flex-row md:gap-60",onSubmit:n=>{r.mutate(n,{onSuccess:()=>{a.reset({...a.getValues(),...n})}})},id:t,children:[e.jsx(g,{children:e.jsx(M,{user:s})}),e.jsxs("div",{className:"w-full flex-auto",children:[e.jsxs("div",{className:"mb-16 flex items-center gap-4 text-muted",children:[e.jsx(_,{size:"sm"}),s.email]}),e.jsx(A,{name:"name",label:e.jsx(i,{message:"Name"})})]})]})})}function M({user:s}){const[t,a]=l.useState(s.image),r=j(s.id);return e.jsx(g,{children:e.jsx(B,{value:t,uploadType:v.avatars,variant:"avatar",stretchPreview:!0,previewSize:"w-90 h-90",placeholderIcon:e.jsx(P,{label:s.name,size:"w-full h-full text-2xl",circle:!0}),showRemoveButton:!0,onChange:(n,o)=>{a(o==null?void 0:o.url),r.mutate({image:(o==null?void 0:o.url)??null,image_entry_id:(o==null?void 0:o.id)??null})}})})}function j(s){return c({mutationFn:t=>d.put(`users/${s}`,t).then(a=>a.data),onError:t=>u(t)})}function Y(){const{user:s}=S(),t=b();return c({mutationFn:()=>Z(s.id),onSuccess:()=>{w("Account deleted"),t.mutate()},onError:a=>u(a)})}function Z(s){return d.delete(`users/${s}`,{params:{deleteCurrentUser:!0}}).then(t=>t.data)}function y(){const s=Y(),{withConfirmedPassword:t,isLoading:a}=U(),[r,n]=l.useState(!1);return e.jsxs(p,{id:x.DeleteAccount,title:e.jsx(i,{message:"Danger zone"}),children:[e.jsx(D,{type:"modal",isOpen:r,onOpenChange:n,onClose:o=>{o&&s.mutate()},children:e.jsx($,{isDanger:!0,title:e.jsx(i,{message:"Delete account?"}),body:e.jsx(i,{message:"Your account will be deleted immediately and permanently. Once deleted, accounts can not be restored."}),confirm:e.jsx(i,{message:"Delete"})})}),e.jsx(m,{variant:"flat",color:"danger",disabled:a||s.isPending,onClick:()=>{t(()=>{n(!0)})},children:e.jsx(i,{message:"Delete account"})})]})}function Le({panels:s,sidenavItems:t}){const{data:a,isLoading:r}=C("me",{with:["roles","social_profiles","tokens"]});return e.jsx(N,{children:e.jsxs("div",{className:"min-h-screen bg",children:[e.jsx(T,{children:e.jsx(i,{message:"Account Settings"})}),e.jsx(F,{menuPosition:"account-settings-page",color:"bg",className:"sticky top-0 z-10"}),e.jsx("div",{children:e.jsxs("div",{className:"container mx-auto px-24 py-24",children:[e.jsx("h1",{className:"text-3xl",children:e.jsx(i,{message:"Account settings"})}),e.jsx("div",{className:"mb-40 text-base text-muted",children:e.jsx(i,{message:"View and update your account details, profile and more."})}),r||!a?e.jsx(I,{className:"my-80","aria-label":"Loading user..",isIndeterminate:!0}):e.jsxs("div",{className:"flex items-start gap-24",children:[e.jsx(L,{items:t}),e.jsxs("main",{className:"flex-auto",children:[s?s(a.user):null,e.jsx(q,{user:a.user}),e.jsx(z,{user:a.user}),e.jsx(E,{}),e.jsx(k,{user:a.user}),e.jsx(O,{}),e.jsx(H,{user:a.user}),e.jsx(V,{user:a.user}),e.jsx(y,{})]})]})]})})]})})}export{Le as AccountSettingsPage};
//# sourceMappingURL=account-settings-page-lrmuVVc3.js.map
