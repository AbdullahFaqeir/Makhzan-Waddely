{"version":3,"file":"open-upload-window-Ckg_K7W2.js","sources":["../../../common/foundation/resources/client/ui/library/utils/files/create-upload-input.ts","../../../common/foundation/resources/client/ui/library/utils/files/open-upload-window.ts"],"sourcesContent":["import {FileInputConfig} from '@ui/utils/files/file-input-config';\n\nexport function createUploadInput(\n  config: FileInputConfig = {},\n): HTMLInputElement {\n  const old = document.querySelector('#hidden-file-upload-input');\n  if (old) old.remove();\n\n  const input = document.createElement('input');\n  input.type = 'file';\n  input.multiple = config.multiple ?? false;\n  input.classList.add('hidden');\n  input.style.display = 'none';\n  input.style.visibility = 'hidden';\n  input.id = 'hidden-file-upload-input';\n\n  input.accept = buildUploadInputAccept(config);\n\n  if (config.directory) {\n    input.webkitdirectory = true;\n  }\n\n  document.body.appendChild(input);\n\n  return input;\n}\n\nexport interface UploadAccentProps {\n  extensions?: string[];\n  types?: string[];\n}\nexport function buildUploadInputAccept({\n  extensions = [],\n  types = [],\n}: UploadAccentProps): string {\n  const accept = [];\n  if (extensions?.length) {\n    extensions = extensions.map(e => {\n      return e.startsWith('.') ? e : `.${e}`;\n    });\n    accept.push(extensions.join(','));\n  }\n\n  if (types?.length) {\n    accept.push(types.join(','));\n  }\n\n  return accept.join(',');\n}\n","import {createUploadInput} from '@ui/utils/files/create-upload-input';\nimport {FileInputConfig} from '@ui/utils/files/file-input-config';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\n\n/**\n * Open browser dialog for uploading files and\n * resolve promise with uploaded files.\n */\nexport function openUploadWindow(\n  config: FileInputConfig = {},\n): Promise<UploadedFile[]> {\n  return new Promise(resolve => {\n    const input = createUploadInput(config);\n\n    input.onchange = e => {\n      const fileList = (e.target as HTMLInputElement).files;\n      if (!fileList) {\n        return resolve([]);\n      }\n\n      const uploads = Array.from(fileList)\n        .filter(f => f.name !== '.DS_Store')\n        .map(file => new UploadedFile(file));\n      resolve(uploads);\n      input.remove();\n    };\n\n    document.body.appendChild(input);\n    input.click();\n  });\n}\n"],"names":["createUploadInput","config","old","input","buildUploadInputAccept","extensions","types","accept","e","openUploadWindow","resolve","fileList","uploads","f","file","UploadedFile"],"mappings":"gDAEO,SAASA,EACdC,EAA0B,GACR,CAClB,MAAMC,EAAM,SAAS,cAAc,2BAA2B,EAC1DA,KAAS,OAAA,EAEb,MAAMC,EAAQ,SAAS,cAAc,OAAO,EAC5C,OAAAA,EAAM,KAAO,OACbA,EAAM,SAAWF,EAAO,UAAY,GACpCE,EAAM,UAAU,IAAI,QAAQ,EAC5BA,EAAM,MAAM,QAAU,OACtBA,EAAM,MAAM,WAAa,SACzBA,EAAM,GAAK,2BAEXA,EAAM,OAASC,EAAuBH,CAAM,EAExCA,EAAO,YACTE,EAAM,gBAAkB,IAG1B,SAAS,KAAK,YAAYA,CAAK,EAExBA,CACT,CAMO,SAASC,EAAuB,CACrC,WAAAC,EAAa,CAAA,EACb,MAAAC,EAAQ,CAAA,CACV,EAA8B,CAC5B,MAAMC,EAAS,CAAA,EACf,OAAIF,GAAA,MAAAA,EAAY,SACdA,EAAaA,EAAW,IAAIG,GACnBA,EAAE,WAAW,GAAG,EAAIA,EAAI,IAAIA,CAAC,EACrC,EACDD,EAAO,KAAKF,EAAW,KAAK,GAAG,CAAC,GAG9BC,GAAA,MAAAA,EAAO,QACTC,EAAO,KAAKD,EAAM,KAAK,GAAG,CAAC,EAGtBC,EAAO,KAAK,GAAG,CACxB,CCxCO,SAASE,EACdR,EAA0B,GACD,CACzB,OAAO,IAAI,QAAQS,GAAW,CAC5B,MAAMP,EAAQH,EAAkBC,CAAM,EAEtCE,EAAM,SAAWK,GAAK,CACpB,MAAMG,EAAYH,EAAE,OAA4B,MAChD,GAAI,CAACG,EACH,OAAOD,EAAQ,CAAA,CAAE,EAGnB,MAAME,EAAU,MAAM,KAAKD,CAAQ,EAChC,OAAOE,GAAKA,EAAE,OAAS,WAAW,EAClC,IAAIC,GAAQ,IAAIC,EAAaD,CAAI,CAAC,EACrCJ,EAAQE,CAAO,EACfT,EAAM,OAAA,CACR,EAEA,SAAS,KAAK,YAAYA,CAAK,EAC/BA,EAAM,MAAA,CACR,CAAC,CACH"}