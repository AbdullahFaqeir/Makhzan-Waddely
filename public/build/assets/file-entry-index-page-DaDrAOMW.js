import{r as d,cc as p,j as e,T as s,cE as h,D as c,B as f,au as j,ax as y,ak as b,J as w,a7 as D,an as v,ao as S,k as C,av as E,aH as k,x as F}from"./main-TIUJvpaR.js";import{a as N}from"./admin-config-DnlTcyOh.js";import{D as P}from"./settings-links-DfKKjWK1.js";import{u as T,a as I,G as _,D as L,b as B,c as H}from"./use-datatable-query-GunfT5m0.js";import{D as z}from"./datatable-filters-BjM39JGH.js";import{a as A,D as R,b as q,c as M}from"./datatable-page-with-header-layout-Bbr3vl7W.js";import{T as Q}from"./table-Bwvbdqc8.js";import{a as U}from"./file-preview-dialog-nG29u1qb.js";import{F as V}from"./formatted-bytes-Z5HHbbV8.js";import{F as W}from"./formatted-date-CsxGDhkC.js";import{V as G}from"./Visibility-DZtPDbrq.js";import{C as K}from"./confirmation-dialog-Ds1Wl8FN.js";import{N as J}from"./name-with-avatar-B4cJ-k97.js";import{a as m}from"./file-entry-index-filters-ALDBKQPu.js";import"./external-link-DvqU4uvd.js";import"./FilterAlt-TOiEFGZR.js";import"./select-filter-panel-Bmcw5umN.js";import"./use-normalized-models-DEvVtvvO.js";import"./form-chip-field-ebQy8_UE.js";import"./input-C85ULg8F.js";import"./ArrowRightAlt-CPRMvsTm.js";import"./DateRange-LhM59-62.js";import"./use-base-date-picker-state-DYQU3Rut.js";import"./use-date-formatter-hhGEq_P-.js";import"./KeyboardArrowRight-C0U0wgwT.js";import"./use-date-range-picker-state-Df5vuAtM.js";import"./list-DlNGU0yW.js";import"./switch-Bj7wwiPq.js";import"./dialog-footer-yCpPZGPO.js";import"./use-current-date-time-BdzpdEnL.js";import"./select-T49HzTXy.js";import"./Edit-_sVfUVPu.js";import"./skeleton-uSF3jNnm.js";import"./accordion-CabB8onw.js";import"./checkbox-kZVscZNC.js";import"./CheckBoxOutlineBlank-p6gxL9Ym.js";import"./timestamp-filters-WRgK6N5J.js";import"./formatted-number-rmEdx96M.js";import"./dashboard-layout-context-DA6Q35rI.js";import"./use-toggle-dashboard-left-sidebar-BuzWlDo2.js";import"./ArrowDownward-B1kd_Dtq.js";import"./useEffectEvent-Bgk8rSJ3.js";import"./use-pointer-events-B6G-2ez3.js";import"./useGlobalListeners-_BzTaAbJ.js";import"./ChevronLeft-BuvOaHR7.js";import"./ChevronRight-BaJkMP9s.js";import"./FileDownload-pojohXY8.js";import"./download-file-from-url-BVaKcxRP.js";import"./pretty-bytes-bO14ePu9.js";import"./user-D6GCMJ6c.js";const X=""+new URL("upload-DtVE1GoK.svg",import.meta.url).href,Y=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Name"}),body:t=>e.jsxs(d.Fragment,{children:[e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis",children:t.name}),e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis text-xs text-muted",children:t.file_name})]})},{key:"owner_id",allowsSorting:!0,width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Uploader"}),body:t=>{var i,o;const a=((i=t.users)==null?void 0:i.find(r=>r.owns_entry))??((o=t.users)==null?void 0:o[0]);return a?e.jsx(J,{image:a.image,label:a.name,description:a.email}):null}},{key:"type",width:"w-100 flex-shrink-0",allowsSorting:!0,header:()=>e.jsx(s,{message:"Type"}),body:t=>e.jsxs("div",{className:"flex items-center gap-12",children:[e.jsx(j,{type:t.type,className:"h-24 w-24 overflow-hidden"}),e.jsx("div",{className:"capitalize",children:t.type})]})},{key:"public",allowsSorting:!0,width:"w-60 flex-shrink-0",header:()=>e.jsx(s,{message:"Public"}),body:t=>t.public?e.jsx(y,{className:"text-positive icon-md"}):e.jsx(b,{className:"text-danger icon-md"})},{key:"file_size",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(s,{message:"File size"}),body:t=>e.jsx(V,{bytes:t.file_size})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(s,{message:"Last updated"}),body:t=>e.jsx(W,{date:t.updated_at})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:t=>e.jsxs(c,{type:"modal",children:[e.jsx(w,{size:"md",className:"text-muted",children:e.jsx(G,{})}),e.jsx(U,{entries:[t]})]})}];function Je(){const[t,a]=d.useState([]),{searchParams:i,sortDescriptor:o,mergeIntoSearchParams:r,setSearchQuery:x,isFiltering:g}=T(h),l=I(p.fileEntries.index(i)),u=e.jsxs(c,{type:"modal",children:[e.jsx(f,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx($,{selectedIds:t,onDelete:()=>a([])})]});return e.jsxs(A,{children:[e.jsx(_,{query:l}),e.jsx(R,{title:e.jsx(s,{message:"Uploaded files and folders"}),showSidebarToggleButton:!0,rightContent:e.jsx(P,{variant:"button",link:N.pages.files,size:"xs"})}),e.jsxs(q,{children:[e.jsx(L,{searchValue:i.query,onSearchChange:x,selectedItems:t,selectedActions:u,filters:m}),e.jsx(z,{filters:m}),e.jsxs(M,{children:[e.jsx(Q,{columns:Y,data:l.items,sortDescriptor:o,onSortChange:r,enableSelection:!0,selectedRows:t,onSelectionChange:a}),l.isEmpty&&e.jsx(B,{isFiltering:g,image:X,title:e.jsx(s,{message:"Nothing has been uploaded yet"}),filteringTitle:e.jsx(s,{message:"No matching files or folders"})}),e.jsx(H,{query:l,onPageChange:n=>r({page:n}),onPerPageChange:n=>r({perPage:n})})]})]})]})}function $({selectedIds:t,onDelete:a}){const{close:i}=D(),o=v({mutationFn:()=>C.delete(`file-entries/${t.join(",")}`),onSuccess:async()=>{await E.invalidateQueries({queryKey:p.fileEntries.invalidateKey}),k(F("File entries deleted")),a(),i()},onError:r=>S(r)});return e.jsx(K,{isDanger:!0,isLoading:o.isPending,title:e.jsx(s,{message:"Delete file entries"}),body:e.jsx(s,{message:"Are you sure you want to delete selected file entries?",values:{count:t.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>o.mutate()})}export{Je as Component};
