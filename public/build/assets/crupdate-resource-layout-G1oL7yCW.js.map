{"version":3,"file":"crupdate-resource-layout-G1oL7yCW.js","sources":["../../../common/foundation/resources/client/admin/crupdate-resource-layout.tsx"],"sourcesContent":["import {DatatablePageHeaderBar} from '@common/datatable/page/datatable-page-with-header-layout';\nimport {Button} from '@ui/buttons/button';\nimport {Form} from '@ui/forms/form';\nimport {Trans} from '@ui/i18n/trans';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {Fragment, ReactElement, ReactNode} from 'react';\nimport {\n  FieldValues,\n  SubmitHandler,\n  useFormContext,\n  UseFormReturn,\n} from 'react-hook-form';\n\ninterface Props<T extends FieldValues> {\n  onSubmit: SubmitHandler<T>;\n  form: UseFormReturn<T>;\n  title: ReactElement;\n  tabs?: ReactNode;\n  isLoading: boolean;\n  children: ReactNode;\n  actions?: ReactNode;\n  disableSaveWhenNotDirty?: boolean;\n  wrapInContainer?: boolean;\n  submitButtonText?: ReactNode;\n  className?: string;\n  containerClassName?: string;\n  navbar?: ReactNode;\n}\nexport function CrupdateResourceLayout<T extends FieldValues>({\n  onSubmit,\n  form,\n  title,\n  tabs,\n  children,\n  actions,\n  isLoading = false,\n  disableSaveWhenNotDirty = false,\n  wrapInContainer = true,\n  submitButtonText,\n  className,\n  containerClassName,\n  navbar,\n}: Props<T>) {\n  const isDirty = !disableSaveWhenNotDirty\n    ? true\n    : Object.keys(form.formState.dirtyFields).length;\n\n  const saveButton = (\n    <Button\n      variant=\"flat\"\n      color=\"primary\"\n      type=\"submit\"\n      disabled={isLoading || !isDirty}\n    >\n      {submitButtonText ?? <Trans message=\"Save\" />}\n    </Button>\n  );\n\n  return (\n    <Form\n      onSubmit={onSubmit}\n      onBeforeSubmit={() => form.clearErrors()}\n      form={form}\n      className={clsx('flex h-full flex-col', className)}\n    >\n      {navbar}\n      <CrupdateResourceHeader\n        endActions={\n          <Fragment>\n            {actions}\n            {saveButton}\n          </Fragment>\n        }\n        border={tabs ? 'border-none' : undefined}\n      >\n        {title}\n      </CrupdateResourceHeader>\n      {tabs && <div className=\"flex-shrink-0\">{tabs}</div>}\n      <div className=\"overflow-y-auto\">\n        <div\n          className={clsx(\n            wrapInContainer ? 'container mx-auto px-24 py-56' : undefined,\n            containerClassName,\n          )}\n        >\n          {children}\n        </div>\n      </div>\n    </Form>\n  );\n}\n\ninterface CrupdateResourceHeaderProps {\n  children: ReactElement;\n  endActions?: ReactNode;\n  border?: string;\n}\nexport function CrupdateResourceHeader({\n  children,\n  endActions,\n  border,\n}: CrupdateResourceHeaderProps) {\n  return (\n    <DatatablePageHeaderBar\n      showSidebarToggleButton\n      title={children}\n      rightContent={endActions}\n      border={border}\n    />\n  );\n}\n\ninterface CrupdateResourceSectionProps {\n  label: ReactElement;\n  labelMargin?: string;\n  children: ReactNode;\n  margin?: string;\n}\n\nexport function CrupdateResourceSection({\n  label,\n  children,\n  margin = 'mb-48',\n  labelMargin = 'mb-16',\n}: CrupdateResourceSectionProps) {\n  return (\n    <section className={clsx(margin)}>\n      <div className={clsx(labelMargin, 'text-lg font-semibold')}>{label}</div>\n      {children}\n    </section>\n  );\n}\n\ninterface DirtyFormSaveDrawerProps {\n  saveButton?: ReactElement;\n  isLoading?: boolean;\n}\nexport function DirtyFormSaveDrawer({\n  saveButton,\n  isLoading,\n}: DirtyFormSaveDrawerProps) {\n  const {formState, reset} = useFormContext();\n  return (\n    <AnimatePresence>\n      {formState.isDirty && (\n        <Fragment>\n          <div className=\"invisible h-92\" />\n          <m.div\n            key=\"dirty-panel\"\n            initial={{y: 100, opacity: 0}}\n            animate={{y: 0, opacity: 1}}\n            exit={{y: 100, opacity: 0}}\n            transition={{duration: 0.2}}\n            className=\"fixed bottom-0 left-0 right-0 z-20 flex items-center justify-center gap-16 border-t bg px-12 py-28 shadow-[rgba(0,0,0,0.2)_0px_0px_10px]\"\n          >\n            <Button variant=\"outline\" onClick={() => reset()}>\n              <Trans message=\"Cancel\" />\n            </Button>\n            {saveButton ?? (\n              <Button\n                variant=\"flat\"\n                color=\"primary\"\n                type=\"submit\"\n                disabled={isLoading}\n              >\n                <Trans message=\"Save changes\" />\n              </Button>\n            )}\n          </m.div>\n        </Fragment>\n      )}\n    </AnimatePresence>\n  );\n}\n"],"names":["CrupdateResourceLayout","onSubmit","form","title","tabs","children","actions","isLoading","disableSaveWhenNotDirty","wrapInContainer","submitButtonText","className","containerClassName","navbar","isDirty","saveButton","jsx","Button","Trans","jsxs","Form","clsx","CrupdateResourceHeader","Fragment","endActions","border","DatatablePageHeaderBar","CrupdateResourceSection","label","margin","labelMargin","DirtyFormSaveDrawer","formState","reset","useFormContext","AnimatePresence","m"],"mappings":"qKA6BO,SAASA,EAA8C,CAC5D,SAAAC,EACA,KAAAC,EACA,MAAAC,EACA,KAAAC,EACA,SAAAC,EACA,QAAAC,EACA,UAAAC,EAAY,GACZ,wBAAAC,EAA0B,GAC1B,gBAAAC,EAAkB,GAClB,iBAAAC,EACA,UAAAC,EACA,mBAAAC,EACA,OAAAC,CACF,EAAa,CACX,MAAMC,EAAWN,EAEb,OAAO,KAAKN,EAAK,UAAU,WAAW,EAAE,OADxC,GAGEa,EACJC,EAAAA,IAACC,EAAA,CACC,QAAQ,OACR,MAAM,UACN,KAAK,SACL,SAAUV,GAAa,CAACO,EAEvB,SAAAJ,GAAoBM,EAAAA,IAACE,EAAA,CAAM,QAAQ,MAAA,CAAO,CAAA,CAAA,EAI/C,OACEC,EAAAA,KAACC,EAAA,CACC,SAAAnB,EACA,eAAgB,IAAMC,EAAK,YAAA,EAC3B,KAAAA,EACA,UAAWmB,EAAK,uBAAwBV,CAAS,EAEhD,SAAA,CAAAE,EACDG,EAAAA,IAACM,EAAA,CACC,kBACGC,WAAA,CACE,SAAA,CAAAjB,EACAS,CAAA,EACH,EAEF,OAAQX,EAAO,cAAgB,OAE9B,SAAAD,CAAA,CAAA,EAEFC,GAAQY,EAAAA,IAAC,MAAA,CAAI,UAAU,gBAAiB,SAAAZ,EAAK,EAC9CY,EAAAA,IAAC,MAAA,CAAI,UAAU,kBACb,SAAAA,EAAAA,IAAC,MAAA,CACC,UAAWK,EACTZ,EAAkB,gCAAkC,OACpDG,CAAA,EAGD,SAAAP,CAAA,CAAA,CACH,CACF,CAAA,CAAA,CAAA,CAGN,CAOO,SAASiB,EAAuB,CACrC,SAAAjB,EACA,WAAAmB,EACA,OAAAC,CACF,EAAgC,CAC9B,OACET,EAAAA,IAACU,EAAA,CACC,wBAAuB,GACvB,MAAOrB,EACP,aAAcmB,EACd,OAAAC,CAAA,CAAA,CAGN,CASO,SAASE,EAAwB,CACtC,MAAAC,EACA,SAAAvB,EACA,OAAAwB,EAAS,QACT,YAAAC,EAAc,OAChB,EAAiC,CAC/B,OACEX,EAAAA,KAAC,UAAA,CAAQ,UAAWE,EAAKQ,CAAM,EAC7B,SAAA,CAAAb,MAAC,OAAI,UAAWK,EAAKS,EAAa,uBAAuB,EAAI,SAAAF,EAAM,EAClEvB,CAAA,EACH,CAEJ,CAMO,SAAS0B,EAAoB,CAClC,WAAAhB,EACA,UAAAR,CACF,EAA6B,CAC3B,KAAM,CAAC,UAAAyB,EAAW,MAAAC,CAAA,EAASC,EAAA,EAC3B,OACElB,EAAAA,IAACmB,EAAA,CACE,SAAAH,EAAU,gBACRT,WAAA,CACC,SAAA,CAAAP,EAAAA,IAAC,MAAA,CAAI,UAAU,gBAAA,CAAiB,EAChCG,EAAAA,KAACiB,EAAE,IAAF,CAEC,QAAS,CAAC,EAAG,IAAK,QAAS,CAAA,EAC3B,QAAS,CAAC,EAAG,EAAG,QAAS,CAAA,EACzB,KAAM,CAAC,EAAG,IAAK,QAAS,CAAA,EACxB,WAAY,CAAC,SAAU,EAAA,EACvB,UAAU,2IAEV,SAAA,CAAApB,EAAAA,IAACC,EAAA,CAAO,QAAQ,UAAU,QAAS,IAAMgB,EAAA,EACvC,SAAAjB,EAAAA,IAACE,EAAA,CAAM,QAAQ,QAAA,CAAS,CAAA,CAC1B,EACCH,GACCC,EAAAA,IAACC,EAAA,CACC,QAAQ,OACR,MAAM,UACN,KAAK,SACL,SAAUV,EAEV,SAAAS,EAAAA,IAACE,EAAA,CAAM,QAAQ,cAAA,CAAe,CAAA,CAAA,CAChC,CAAA,EAlBE,aAAA,CAoBN,CAAA,CACF,CAAA,CAEJ,CAEJ"}