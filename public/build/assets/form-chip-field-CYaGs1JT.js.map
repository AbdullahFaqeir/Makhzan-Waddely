{"version":3,"file":"form-chip-field-CYaGs1JT.js","sources":["../../../common/foundation/resources/client/ui/library/forms/input-field/chip-field/chip-list.tsx","../../../common/foundation/resources/client/ui/library/forms/input-field/chip-field/string-to-chip-value.ts","../../../common/foundation/resources/client/ui/library/forms/input-field/chip-field/chip-field.tsx","../../../common/foundation/resources/client/ui/library/forms/input-field/chip-field/form-chip-field.tsx"],"sourcesContent":["import React, {\n  Children,\n  cloneElement,\n  isValidElement,\n  ReactElement,\n  ReactNode,\n} from 'react';\nimport clsx from 'clsx';\nimport type {ChipProps} from './chip';\n\nexport interface ChipListProps {\n  className?: string;\n  children?: ReactElement | ReactElement[];\n  size?: ChipProps['size'];\n  radius?: ChipProps['radius'];\n  color?: ChipProps['color'];\n  selectable?: ChipProps['selectable'];\n  wrap?: boolean;\n  startButton?: ReactNode;\n}\nexport function ChipList({\n  className,\n  children,\n  size,\n  color,\n  radius,\n  selectable,\n  wrap = true,\n  startButton,\n}: ChipListProps) {\n  return (\n    <div\n      className={clsx(\n        'flex items-center gap-8',\n        wrap && 'flex-wrap',\n        className,\n      )}\n    >\n      {startButton}\n      {Children.map(children, chip => {\n        if (isValidElement<ChipProps>(chip)) {\n          return cloneElement<ChipProps>(chip, {\n            size,\n            color,\n            selectable,\n            radius,\n          });\n        }\n      })}\n    </div>\n  );\n}\n","import {ChipValue} from './chip-field';\n\nexport function stringToChipValue(value: string | number): ChipValue {\n  // add both name and description so \"validateWith\" works properly in chip field, if it depends on description\n  return {id: value, name: `${value}`, description: `${value}`};\n}\n","import {useFocusManager} from '@react-aria/focus';\nimport {mergeProps, useLayoutEffect, useObjectRef} from '@react-aria/utils';\nimport {useControlledState} from '@react-stately/utils';\nimport {Avatar} from '@ui/avatar/avatar';\nimport {KeyboardArrowDownIcon} from '@ui/icons/material/KeyboardArrowDown';\nimport {Popover} from '@ui/overlays/popover';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport {NormalizedModel} from '@ui/types/normalized-model';\nimport {createEventHandler} from '@ui/utils/dom/create-event-handler';\nimport clsx from 'clsx';\nimport {\n  HTMLAttributes,\n  Key,\n  ReactNode,\n  Ref,\n  RefObject,\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport {Listbox} from '../../listbox/listbox';\nimport {ListBoxChildren, ListboxProps} from '../../listbox/types';\nimport {useListbox} from '../../listbox/use-listbox';\nimport {useListboxKeyboardNavigation} from '../../listbox/use-listbox-keyboard-navigation';\nimport {BaseFieldPropsWithDom} from '../base-field-props';\nimport {Field, FieldProps} from '../field';\nimport {getInputFieldClassNames} from '../get-input-field-class-names';\nimport {Input} from '../input';\nimport {useField} from '../use-field';\nimport {Chip, ChipProps} from './chip';\nimport {ChipList} from './chip-list';\nimport {stringToChipValue} from './string-to-chip-value';\n\nexport interface ChipValue extends Omit<NormalizedModel, 'model_type'> {\n  invalid?: boolean;\n  errorMessage?: string;\n}\n\nexport type ChipFieldProps<T, P extends ChipValue = ChipValue> = Omit<\n  ListboxProps,\n  'selectionMode' | 'displayWith'\n> &\n  Omit<\n    BaseFieldPropsWithDom<HTMLInputElement>,\n    'value' | 'onChange' | 'defaultValue'\n  > & {\n    value?: (ChipValue | string)[];\n    defaultValue?: (ChipValue | string)[];\n    displayWith?: (value: ChipValue) => ReactNode;\n    validateWith?: (value: ChipValue) => ChipValue;\n    getItemForPresentation?: (value: ChipValue) => P | undefined;\n    maxItems?: number;\n    allowCustomValue?: boolean;\n    showDropdownArrow?: boolean;\n    onChange?: (value: ChipValue[]) => void;\n    suggestions?: T[];\n    children?: ListBoxChildren<T>['children'];\n    placeholder?: string;\n    chipSize?: ChipProps['size'];\n    openMenuOnFocus?: boolean;\n    valueKey?: 'id' | 'name';\n    onChipClick?: (value: ChipValue) => void;\n    alwaysShowAvatar?: boolean;\n    readOnly?: boolean;\n    ref?: Ref<HTMLInputElement>;\n  };\n\nexport function ChipField<T>({ref, ...props}: ChipFieldProps<T>) {\n  const fieldRef = useRef<HTMLDivElement>(null);\n  const inputRef = useObjectRef(ref);\n  const {\n    displayWith = v => v.name,\n    validateWith,\n    getItemForPresentation,\n    children,\n    suggestions,\n    isLoading,\n    inputValue,\n    onInputValueChange,\n    onItemSelected,\n    placeholder,\n    onOpenChange,\n    chipSize = 'sm',\n    openMenuOnFocus = true,\n    showEmptyMessage,\n    value: propsValue,\n    defaultValue,\n    onChange: propsOnChange,\n    valueKey,\n    isAsync,\n    allowCustomValue = true,\n    showDropdownArrow,\n    onChipClick,\n    alwaysShowAvatar = false,\n    readOnly,\n    maxItems,\n    ...inputFieldProps\n  } = props;\n  const fieldClassNames = getInputFieldClassNames({\n    ...props,\n    flexibleHeight: true,\n  });\n\n  const [value, onChange] = useChipFieldValueState(props);\n\n  const [listboxIsOpen, setListboxIsOpen] = useState(false);\n\n  const loadingIndicator = (\n    <ProgressCircle isIndeterminate size=\"w-24 h-24\" aria-label=\"loading...\" />\n  );\n\n  const dropdownArrow = showDropdownArrow ? <KeyboardArrowDownIcon /> : null;\n\n  const {fieldProps, inputProps} = useField({\n    ...inputFieldProps,\n    focusRef: inputRef,\n    endAdornment: isLoading && listboxIsOpen ? loadingIndicator : dropdownArrow,\n  });\n\n  return (\n    <Field fieldClassNames={fieldClassNames} {...fieldProps}>\n      <Input\n        ref={fieldRef}\n        className={clsx('flex flex-wrap items-center', fieldClassNames.input)}\n        onClick={() => {\n          // refocus input when clicking outside it, but while still inside chip field\n          inputRef.current?.focus();\n        }}\n      >\n        <ListWrapper\n          displayChipUsing={displayWith}\n          onChipClick={onChipClick}\n          items={value}\n          setItems={onChange}\n          chipSize={chipSize}\n          alwaysShowAvatar={alwaysShowAvatar}\n          readOnly={readOnly}\n          getItemForPresentation={getItemForPresentation}\n        />\n        <ChipInput\n          size={props.size}\n          showEmptyMessage={showEmptyMessage}\n          inputProps={inputProps}\n          inputValue={inputValue}\n          onInputValueChange={onInputValueChange}\n          fieldRef={fieldRef}\n          inputRef={inputRef}\n          chips={value}\n          setChips={onChange}\n          validateWith={validateWith}\n          isLoading={isLoading}\n          suggestions={suggestions}\n          placeholder={placeholder}\n          openMenuOnFocus={openMenuOnFocus}\n          listboxIsOpen={listboxIsOpen}\n          setListboxIsOpen={setListboxIsOpen}\n          allowCustomValue={allowCustomValue}\n          readOnly={readOnly}\n        >\n          {children}\n        </ChipInput>\n      </Input>\n    </Field>\n  );\n}\n\ninterface ListWrapperProps<P extends ChipValue = ChipValue> {\n  items: ChipValue[];\n  setItems: (items: ChipValue[]) => void;\n  displayChipUsing: (value: ChipValue) => ReactNode;\n  chipSize?: ChipProps['size'];\n  onChipClick?: (value: ChipValue) => void;\n  alwaysShowAvatar?: boolean;\n  readOnly?: boolean;\n  getItemForPresentation?: (value: ChipValue) => P | undefined;\n}\nfunction ListWrapper<P extends ChipValue = ChipValue>({\n  items,\n  setItems,\n  displayChipUsing,\n  chipSize,\n  onChipClick,\n  alwaysShowAvatar,\n  readOnly,\n  getItemForPresentation,\n}: ListWrapperProps<P>) {\n  const manager = useFocusManager();\n  const removeItem = useCallback(\n    (key: Key) => {\n      const i = items.findIndex(cr => cr.id === key);\n      const newItems = [...items];\n      if (i > -1) {\n        newItems.splice(i, 1);\n        setItems(newItems);\n      }\n      return newItems;\n    },\n    [items, setItems],\n  );\n\n  return (\n    <ChipList\n      className={clsx(\n        'max-w-full flex-shrink-0 flex-wrap',\n        chipSize === 'xs' ? 'my-6' : 'my-8',\n      )}\n      size={chipSize}\n      selectable\n    >\n      {items.map(item => {\n        item = getItemForPresentation?.(item) ?? item;\n        return (\n          <Chip\n            key={item.id}\n            errorMessage={item.errorMessage}\n            adornment={\n              item.image || alwaysShowAvatar ? (\n                <Avatar\n                  circle\n                  src={item.image}\n                  fallback=\"initials\"\n                  label={item.name}\n                />\n              ) : null\n            }\n            onClick={() => onChipClick?.(item)}\n            onRemove={\n              readOnly\n                ? undefined\n                : () => {\n                    const newItems = removeItem(item.id);\n                    if (newItems.length) {\n                      // focus previous chip\n                      manager?.focusPrevious({tabbable: true});\n                    } else {\n                      // focus input\n                      manager?.focusLast();\n                    }\n                  }\n            }\n          >\n            {displayChipUsing(item)}\n          </Chip>\n        );\n      })}\n    </ChipList>\n  );\n}\n\ninterface ChipInputProps<T> {\n  showEmptyMessage?: boolean;\n  inputProps: ReturnType<typeof useField>['inputProps'];\n  inputValue?: string;\n  onInputValueChange?: (value: string) => void;\n  fieldRef: RefObject<HTMLDivElement | null>;\n  inputRef: RefObject<HTMLInputElement | null>;\n  chips: ChipValue[];\n  setChips: (items: ChipValue[]) => void;\n  validateWith?: (value: ChipValue) => ChipValue;\n  isLoading?: boolean;\n  suggestions?: T[];\n  placeholder?: string;\n  openMenuOnFocus?: boolean;\n  listboxIsOpen: boolean;\n  setListboxIsOpen: (value: boolean) => void;\n  allowCustomValue: boolean;\n  children: ListBoxChildren<T>['children'];\n  size: FieldProps['size'];\n  readOnly?: boolean;\n}\nfunction ChipInput<T>(props: ChipInputProps<T>) {\n  const {\n    inputRef,\n    fieldRef,\n    validateWith,\n    setChips,\n    chips,\n    suggestions,\n    inputProps,\n    placeholder,\n    openMenuOnFocus,\n    listboxIsOpen,\n    setListboxIsOpen,\n    allowCustomValue,\n    isLoading,\n    size,\n    readOnly,\n  } = props;\n  const manager = useFocusManager();\n\n  const addItems = useCallback(\n    (items?: ChipValue[]) => {\n      items = (items || []).filter(item => {\n        const invalid = !item || !item.id || !item.name;\n        const alreadyExists = chips.findIndex(cr => cr.id === item?.id) > -1;\n        return !alreadyExists && !invalid;\n      });\n      if (!items.length) return;\n\n      if (validateWith) {\n        items = items.map(item => validateWith(item));\n      }\n      setChips([...chips, ...items]);\n    },\n    [chips, setChips, validateWith],\n  );\n\n  const listbox = useListbox<T>({\n    ...props,\n    clearInputOnItemSelection: true,\n    isOpen: listboxIsOpen,\n    onOpenChange: setListboxIsOpen,\n    items: suggestions,\n    selectionMode: 'none',\n    role: 'listbox',\n    virtualFocus: true,\n    onItemSelected: value => {\n      handleItemSelection(value as string);\n    },\n  });\n\n  const {\n    state: {\n      activeIndex,\n      setActiveIndex,\n      isOpen,\n      setIsOpen,\n      inputValue,\n      setInputValue,\n    },\n    refs,\n    listboxId,\n    collection,\n    onInputChange,\n  } = listbox;\n\n  const handleItemSelection = (textValue: string) => {\n    const option =\n      collection.size && activeIndex != null\n        ? [...collection.values()][activeIndex]\n        : null;\n    if (option?.item) {\n      addItems([option.item]);\n    } else if (allowCustomValue) {\n      addItems([stringToChipValue(option ? option.value : textValue)]);\n    }\n\n    setInputValue('');\n    setActiveIndex(null);\n    setIsOpen(false);\n  };\n\n  // position dropdown relative to whole chip field, not the input\n  useLayoutEffect(() => {\n    if (fieldRef.current && refs.reference.current !== fieldRef.current) {\n      listbox.reference(fieldRef.current);\n    }\n  }, [fieldRef, listbox, refs]);\n\n  const {handleTriggerKeyDown, handleListboxKeyboardNavigation} =\n    useListboxKeyboardNavigation(listbox);\n\n  const handleFocusAndClick = createEventHandler(() => {\n    if (openMenuOnFocus && !isOpen) {\n      setIsOpen(true);\n    }\n  });\n\n  return (\n    <Listbox\n      listbox={listbox}\n      mobileOverlay={Popover}\n      isLoading={isLoading}\n      onPointerDown={e => {\n        // prevent focus from leaving input when scrolling listbox via mouse\n        e.preventDefault();\n      }}\n    >\n      <input\n        readOnly={readOnly}\n        type=\"text\"\n        className={clsx(\n          'mx-8 my-4 min-w-30 flex-[1_1_60px] bg-transparent text-sm outline-none',\n          size === 'xs' ? 'h-20' : 'h-30',\n        )}\n        placeholder={placeholder}\n        {...mergeProps(inputProps, {\n          required: false,\n          ref: inputRef,\n          value: inputValue,\n          onChange: onInputChange,\n          onPaste: e => {\n            const paste = e.clipboardData.getData('text');\n            const emails = paste.match(\n              /([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi,\n            );\n            if (emails) {\n              e.preventDefault();\n              const selection = window.getSelection();\n              if (selection?.rangeCount) {\n                selection.deleteFromDocument();\n                addItems(emails.map(email => stringToChipValue(email)));\n              }\n            }\n          },\n          'aria-autocomplete': 'list',\n          'aria-controls': isOpen ? listboxId : undefined,\n          autoComplete: 'off',\n          autoCorrect: 'off',\n          spellCheck: 'false',\n          onKeyDown: e => {\n            if (readOnly) return;\n\n            const input = e.target as HTMLInputElement;\n\n            if (e.key === 'Enter') {\n              // prevent form submitting\n              e.preventDefault();\n              // add chip from selected listbox option or current input text value\n              handleItemSelection(input.value);\n              return;\n            }\n\n            // on escape, clear input and close dropdown\n            if (e.key === 'Escape' && isOpen) {\n              setIsOpen(false);\n              setInputValue('');\n            }\n\n            // move focus to input when focus is on first item and prevent arrow up from cycling listbox\n            if (\n              e.key === 'ArrowUp' &&\n              isOpen &&\n              (activeIndex === 0 || activeIndex == null)\n            ) {\n              setActiveIndex(null);\n              return;\n            }\n\n            // block left and right arrows from navigating in input, if focus is on listbox\n            if (\n              activeIndex != null &&\n              (e.key === 'ArrowLeft' || e.key === 'ArrowRight')\n            ) {\n              e.preventDefault();\n              return;\n            }\n\n            // move focus on the last chip, if focus is at the  start of input\n            if (\n              (e.key === 'ArrowLeft' ||\n                e.key === 'Backspace' ||\n                e.key === 'Delete') &&\n              input.selectionStart === 0 &&\n              activeIndex == null &&\n              chips.length\n            ) {\n              manager?.focusPrevious({tabbable: true});\n              return;\n            }\n\n            // fallthrough to listbox navigation handlers for arrow keys\n            const handled = handleTriggerKeyDown(e);\n            if (!handled) {\n              handleListboxKeyboardNavigation(e);\n            }\n          },\n          onFocus: readOnly ? undefined : handleFocusAndClick,\n          onClick: readOnly ? undefined : handleFocusAndClick,\n        } as HTMLAttributes<HTMLInputElement>)}\n      />\n    </Listbox>\n  );\n}\n\nfunction useChipFieldValueState({\n  onChange,\n  value,\n  defaultValue,\n  valueKey,\n  maxItems,\n}: ChipFieldProps<any>) {\n  // convert value from string[] to ChipValue[], if needed\n  const propsValue = useMemo(() => {\n    return mixedValueToChipValue(value);\n  }, [value]);\n\n  // convert defaultValue from string[] to ChipValue[], if needed\n  const propsDefaultValue = useMemo(() => {\n    return mixedValueToChipValue(defaultValue);\n  }, [defaultValue]);\n\n  // emit string[] or ChipValue[] on change, based on \"valueKey\" prop\n  const handleChange = useCallback(\n    (value: ChipValue[]) => {\n      let newValue = valueKey ? value.map(v => v[valueKey]) : value;\n      if (maxItems) {\n        newValue = newValue.slice(0, maxItems);\n      }\n      onChange?.(newValue as any);\n    },\n    [onChange, valueKey],\n  );\n\n  return useControlledState<ChipValue[]>(\n    !propsValue ? undefined : propsValue,\n    propsDefaultValue || [],\n    handleChange,\n  );\n}\n\nfunction mixedValueToChipValue(\n  value?: (string | number | ChipValue)[] | null,\n): ChipValue[] | undefined {\n  if (!value) {\n    return undefined;\n  }\n\n  if (!Array.isArray(value)) {\n    return [stringToChipValue(value)];\n  }\n\n  return value.map(v => {\n    return typeof v !== 'object' ? stringToChipValue(v as string) : v;\n  });\n}\n","import {mergeProps} from '@react-aria/utils';\nimport {useDefaultValidationRules} from '@ui/forms/use-default-validation-rules';\nimport {useController} from 'react-hook-form';\nimport {ChipField, ChipFieldProps} from './chip-field';\n\nexport type FormChipFieldProps<T> = ChipFieldProps<T> & {\n  name: string;\n};\n\nexport function FormChipField<T>({children, ...props}: FormChipFieldProps<T>) {\n  const rules = useDefaultValidationRules({...props, multiSelect: true});\n  const {\n    field: {onChange, onBlur, value = [], ref},\n    fieldState: {invalid, error},\n  } = useController({\n    name: props.name,\n    rules,\n  });\n\n  const formProps: Partial<ChipFieldProps<T>> = {\n    onChange,\n    onBlur,\n    value,\n    invalid,\n    errorMessage: error?.message,\n  };\n\n  return (\n    <ChipField ref={ref} {...mergeProps(formProps, props)}>\n      {children}\n    </ChipField>\n  );\n}\n"],"names":["ChipList","className","children","size","color","radius","selectable","wrap","startButton","jsxs","clsx","Children","chip","isValidElement","cloneElement","stringToChipValue","value","ChipField","ref","props","fieldRef","useRef","inputRef","useObjectRef","displayWith","v","validateWith","getItemForPresentation","suggestions","isLoading","inputValue","onInputValueChange","onItemSelected","placeholder","onOpenChange","chipSize","openMenuOnFocus","showEmptyMessage","propsValue","defaultValue","propsOnChange","valueKey","isAsync","allowCustomValue","showDropdownArrow","onChipClick","alwaysShowAvatar","readOnly","maxItems","inputFieldProps","fieldClassNames","getInputFieldClassNames","onChange","useChipFieldValueState","listboxIsOpen","setListboxIsOpen","useState","loadingIndicator","ProgressCircle","dropdownArrow","jsx","KeyboardArrowDownIcon","fieldProps","inputProps","useField","Field","Input","_a","ListWrapper","ChipInput","items","setItems","displayChipUsing","manager","useFocusManager","removeItem","useCallback","key","i","cr","newItems","item","Chip","Avatar","setChips","chips","addItems","invalid","listbox","useListbox","handleItemSelection","activeIndex","setActiveIndex","isOpen","setIsOpen","setInputValue","refs","listboxId","collection","onInputChange","textValue","option","useLayoutEffect","handleTriggerKeyDown","handleListboxKeyboardNavigation","useListboxKeyboardNavigation","handleFocusAndClick","createEventHandler","Listbox","Popover","mergeProps","emails","selection","email","input","useMemo","mixedValueToChipValue","propsDefaultValue","handleChange","newValue","useControlledState","FormChipField","rules","useDefaultValidationRules","onBlur","error","useController","formProps"],"mappings":"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"}