{"version":3,"file":"crupdate-role-settings-panel-BlXKphOB.js","sources":["../../../common/foundation/resources/client/admin/roles/crupdate-role-page/crupdate-role-settings-panel.tsx"],"sourcesContent":["import {Role} from '@common/auth/role';\nimport {FormPermissionSelector} from '@common/auth/ui/permission-selector';\nimport {SiteConfigContext} from '@common/core/settings/site-config-context';\nimport {SectionHelper} from '@common/ui/other/section-helper';\nimport {Button} from '@ui/buttons/button';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Item} from '@ui/forms/listbox/item';\nimport {FormSelect} from '@ui/forms/select/select';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {useContext} from 'react';\nimport {useFormContext} from 'react-hook-form';\nimport {useSearchParams} from 'react-router';\n\nexport function Component() {\n  const {trans} = useTrans();\n  const [searchParams] = useSearchParams();\n  const {watch, setValue} = useFormContext<Role>();\n  const watchedType = watch('type');\n  const isDefault = watch('default');\n  const isInternal = watch('internal');\n  const isGuests = watch('guests');\n\n  const siteConfig = useContext(SiteConfigContext);\n  const roleTypes = siteConfig.roles?.types ?? [];\n  const typeConfig = roleTypes.find(type => type.type === watchedType);\n  const permissionType = typeConfig?.permission_type ?? 'users';\n\n  return (\n    <>\n      <FormTextField\n        label={<Trans message=\"Name\" />}\n        name=\"name\"\n        className=\"mb-20\"\n        required\n      />\n      <FormTextField\n        label={<Trans message=\"Description\" />}\n        name=\"description\"\n        inputElementType=\"textarea\"\n        placeholder={trans(message('Role description...'))}\n        rows={4}\n        className=\"mb-20\"\n      />\n      {roleTypes.length && !searchParams.get('type') ? (\n        <FormSelect\n          label={<Trans message=\"Type\" />}\n          name=\"type\"\n          selectionMode=\"single\"\n          className=\"mb-20\"\n          description={\n            <Trans message=\"Whether this role will be assigned to users globally on the site or only within workspaces.\" />\n          }\n        >\n          {roleTypes.map(type => (\n            <Item key={type.type} value={type.type}>\n              <Trans {...type.label} />\n            </Item>\n          ))}\n        </FormSelect>\n      ) : null}\n      {isInternal && isDefault && (\n        <SectionHelper\n          title={<Trans message=\"Default role\" />}\n          description={\n            <Trans message=\"This role will be assigned to new users, if they have no other roles.\" />\n          }\n        />\n      )}\n      {isInternal && isGuests && (\n        <SectionHelper\n          title={<Trans message=\"Guests role\" />}\n          description={\n            <Trans message=\"Non logged in users will be assigned this role.\" />\n          }\n        />\n      )}\n      <div className=\"mb-14 mt-30 flex items-end justify-between gap-12\">\n        <h2 className=\"text-lg font-medium\">\n          <Trans message=\"Permissions\" />\n        </h2>\n        <Button\n          variant=\"outline\"\n          size=\"xs\"\n          onClick={() => setValue('permissions', [])}\n        >\n          <Trans message=\"Remove all\" />\n        </Button>\n      </div>\n      <FormPermissionSelector name=\"permissions\" type={permissionType} />\n    </>\n  );\n}\n"],"names":["Component","trans","useTrans","searchParams","useSearchParams","watch","setValue","useFormContext","watchedType","isDefault","isInternal","isGuests","roleTypes","_a","useContext","SiteConfigContext","typeConfig","type","permissionType","jsxs","Fragment","jsx","FormTextField","Trans","message","FormSelect","Item","SectionHelper","Button","FormPermissionSelector"],"mappings":"yXAeO,SAASA,GAAY,OAC1B,KAAM,CAAC,MAAAC,CAAA,EAASC,EAAA,EACV,CAACC,CAAY,EAAIC,EAAA,EACjB,CAAC,MAAAC,EAAO,SAAAC,CAAA,EAAYC,EAAA,EACpBC,EAAcH,EAAM,MAAM,EAC1BI,EAAYJ,EAAM,SAAS,EAC3BK,EAAaL,EAAM,UAAU,EAC7BM,EAAWN,EAAM,QAAQ,EAGzBO,IAAYC,EADCC,EAAAA,WAAWC,CAAiB,EAClB,QAAX,YAAAF,EAAkB,QAAS,CAAA,EACvCG,EAAaJ,EAAU,KAAKK,GAAQA,EAAK,OAAST,CAAW,EAC7DU,GAAiBF,GAAA,YAAAA,EAAY,kBAAmB,QAEtD,OACEG,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAC,EAAAA,IAACC,EAAA,CACC,MAAOD,EAAAA,IAACE,EAAA,CAAM,QAAQ,MAAA,CAAO,EAC7B,KAAK,OACL,UAAU,QACV,SAAQ,EAAA,CAAA,EAEVF,EAAAA,IAACC,EAAA,CACC,MAAOD,EAAAA,IAACE,EAAA,CAAM,QAAQ,aAAA,CAAc,EACpC,KAAK,cACL,iBAAiB,WACjB,YAAatB,EAAMuB,EAAQ,qBAAqB,CAAC,EACjD,KAAM,EACN,UAAU,OAAA,CAAA,EAEXZ,EAAU,QAAU,CAACT,EAAa,IAAI,MAAM,EAC3CkB,EAAAA,IAACI,EAAA,CACC,MAAOJ,EAAAA,IAACE,EAAA,CAAM,QAAQ,MAAA,CAAO,EAC7B,KAAK,OACL,cAAc,SACd,UAAU,QACV,YACEF,EAAAA,IAACE,EAAA,CAAM,QAAQ,6FAAA,CAA8F,EAG9G,WAAU,IAAIN,GACbI,EAAAA,IAACK,EAAA,CAAqB,MAAOT,EAAK,KAChC,SAAAI,EAAAA,IAACE,EAAA,CAAO,GAAGN,EAAK,MAAO,CAAA,EADdA,EAAK,IAEhB,CACD,CAAA,CAAA,EAED,KACHP,GAAcD,GACbY,EAAAA,IAACM,EAAA,CACC,MAAON,EAAAA,IAACE,EAAA,CAAM,QAAQ,cAAA,CAAe,EACrC,YACEF,EAAAA,IAACE,EAAA,CAAM,QAAQ,uEAAA,CAAwE,CAAA,CAAA,EAI5Fb,GAAcC,GACbU,EAAAA,IAACM,EAAA,CACC,MAAON,EAAAA,IAACE,EAAA,CAAM,QAAQ,aAAA,CAAc,EACpC,YACEF,EAAAA,IAACE,EAAA,CAAM,QAAQ,iDAAA,CAAkD,CAAA,CAAA,EAIvEJ,EAAAA,KAAC,MAAA,CAAI,UAAU,oDACb,SAAA,CAAAE,EAAAA,IAAC,MAAG,UAAU,sBACZ,eAACE,EAAA,CAAM,QAAQ,cAAc,CAAA,CAC/B,EACAF,EAAAA,IAACO,EAAA,CACC,QAAQ,UACR,KAAK,KACL,QAAS,IAAMtB,EAAS,cAAe,EAAE,EAEzC,SAAAe,EAAAA,IAACE,EAAA,CAAM,QAAQ,YAAA,CAAa,CAAA,CAAA,CAC9B,EACF,EACAF,EAAAA,IAACQ,EAAA,CAAuB,KAAK,cAAc,KAAMX,CAAA,CAAgB,CAAA,EACnE,CAEJ"}