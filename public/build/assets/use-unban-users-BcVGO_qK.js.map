{"version":3,"file":"use-unban-users-BcVGO_qK.js","sources":["../../../common/foundation/resources/client/admin/users/requests/use-ban-users.ts","../../../common/foundation/resources/client/admin/users/ban-users-dialog.tsx","../../../common/foundation/resources/client/admin/users/requests/use-unban-users.ts"],"sourcesContent":["import {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\nimport {UseFormReturn} from 'react-hook-form';\n\nexport interface CreateBanPayload {\n  ban_until?: string;\n  permanent?: boolean;\n  comment?: string;\n}\n\nexport function useBanUsers(\n  form: UseFormReturn<CreateBanPayload>,\n  userIds: number[],\n) {\n  return useMutation({\n    mutationFn: (payload: CreateBanPayload) =>\n      apiClient\n        .post(`users/ban/${userIds.join(',')}`, payload)\n        .then(r => r.data),\n    onSuccess: async () => {\n      toast(\n        message('[one User|other :count Users] suspended', {\n          values: {count: userIds.length},\n        }),\n      );\n      await queryClient.invalidateQueries({queryKey: ['users']});\n    },\n    onError: r => onFormQueryError(r, form),\n  });\n}\n","import {\n  CreateBanPayload,\n  useBanUsers,\n} from '@common/admin/users/requests/use-ban-users';\nimport {Button} from '@ui/buttons/button';\nimport {Form} from '@ui/forms/form';\nimport {FormDatePicker} from '@ui/forms/input-field/date/date-picker/date-picker';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {FormSwitch} from '@ui/forms/toggle/switch';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {DialogFooter} from '@ui/overlays/dialog/dialog-footer';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {ReactNode} from 'react';\nimport {useForm} from 'react-hook-form';\n\ninterface Props {\n  userIds: number[];\n  description?: ReactNode;\n  onSuccess?: () => void;\n}\nexport function BanUsersDialog({userIds, description, onSuccess}: Props) {\n  const {trans} = useTrans();\n  const {close, formId} = useDialogContext();\n  const form = useForm<CreateBanPayload>({\n    defaultValues: {\n      permanent: true,\n    },\n  });\n  const isPermanent = form.watch('permanent');\n  const banUser = useBanUsers(form, userIds);\n  return (\n    <Dialog>\n      <DialogHeader>\n        <Trans message=\"Suspend users\" />\n      </DialogHeader>\n      <DialogBody>\n        <Form\n          id={formId}\n          form={form}\n          onSubmit={values =>\n            banUser.mutate(values, {\n              onSuccess: () => {\n                close(true);\n                onSuccess?.();\n              },\n            })\n          }\n        >\n          <FormDatePicker\n            name=\"ban_until\"\n            label={<Trans message=\"Suspend until\" />}\n            disabled={isPermanent}\n          />\n          <FormSwitch name=\"permanent\" className=\"mt-12\">\n            <Trans message=\"Permanent\" />\n          </FormSwitch>\n          <FormTextField\n            className=\"mt-24\"\n            name=\"comment\"\n            inputElementType=\"textarea\"\n            maxLength={250}\n            label={<Trans message=\"Reason\" />}\n            placeholder={trans(message('Optional'))}\n          />\n        </Form>\n        {description && <div className=\"mt-16\">{description}</div>}\n      </DialogBody>\n      <DialogFooter>\n        <Button onClick={() => close()}>\n          <Trans message=\"Cancel\" />\n        </Button>\n        <Button\n          form={formId}\n          variant=\"flat\"\n          color=\"primary\"\n          type=\"submit\"\n          disabled={banUser.isPending}\n        >\n          <Trans message=\"Suspend\" />\n        </Button>\n      </DialogFooter>\n    </Dialog>\n  );\n}\n","import {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\n\nexport function useUnbanUsers(userIds: number[]) {\n  return useMutation({\n    mutationFn: () =>\n      apiClient.delete(`users/unban/${userIds.join(',')}`).then(r => r.data),\n    onSuccess: () => {\n      toast(\n        message('[one User|other :count Users] unsuspended', {\n          values: {count: userIds.length},\n        }),\n      );\n      queryClient.invalidateQueries({queryKey: ['users']});\n    },\n    onError: r => showHttpErrorToast(r),\n  });\n}\n"],"names":["useBanUsers","form","userIds","useMutation","payload","apiClient","toast","message","queryClient","r","onFormQueryError","BanUsersDialog","description","onSuccess","trans","useTrans","close","formId","useDialogContext","useForm","isPermanent","banUser","Dialog","jsx","DialogHeader","Trans","DialogBody","jsxs","Form","values","FormDatePicker","FormSwitch","FormTextField","DialogFooter","Button","useUnbanUsers","showHttpErrorToast"],"mappings":"8SAaO,SAASA,EACdC,EACAC,EACA,CACA,OAAOC,EAAY,CACjB,WAAaC,GACXC,EACG,KAAK,aAAaH,EAAQ,KAAK,GAAG,CAAC,GAAIE,CAAO,EAC9C,KAAK,GAAK,EAAE,IAAI,EACrB,UAAW,SAAY,CACrBE,EACEC,EAAQ,0CAA2C,CACjD,OAAQ,CAAC,MAAOL,EAAQ,MAAA,CAAM,CAC/B,CAAA,EAEH,MAAMM,EAAY,kBAAkB,CAAC,SAAU,CAAC,OAAO,EAAE,CAC3D,EACA,QAASC,GAAKC,EAAiBD,EAAGR,CAAI,CAAA,CACvC,CACH,CCPO,SAASU,EAAe,CAAC,QAAAT,EAAS,YAAAU,EAAa,UAAAC,GAAmB,CACvE,KAAM,CAAC,MAAAC,CAAA,EAASC,EAAA,EACV,CAAC,MAAAC,EAAO,OAAAC,CAAA,EAAUC,EAAA,EAClBjB,EAAOkB,EAA0B,CACrC,cAAe,CACb,UAAW,EAAA,CACb,CACD,EACKC,EAAcnB,EAAK,MAAM,WAAW,EACpCoB,EAAUrB,EAAYC,EAAMC,CAAO,EACzC,cACGoB,EAAA,CACC,SAAA,CAAAC,MAACC,EAAA,CACC,SAAAD,EAAAA,IAACE,EAAA,CAAM,QAAQ,gBAAgB,EACjC,SACCC,EAAA,CACC,SAAA,CAAAC,EAAAA,KAACC,EAAA,CACC,GAAIX,EACJ,KAAAhB,EACA,SAAU4B,GACRR,EAAQ,OAAOQ,EAAQ,CACrB,UAAW,IAAM,CACfb,EAAM,EAAI,EACVH,GAAA,MAAAA,GACF,CAAA,CACD,EAGH,SAAA,CAAAU,EAAAA,IAACO,EAAA,CACC,KAAK,YACL,MAAOP,EAAAA,IAACE,EAAA,CAAM,QAAQ,eAAA,CAAgB,EACtC,SAAUL,CAAA,CAAA,EAEZG,EAAAA,IAACQ,EAAA,CAAW,KAAK,YAAY,UAAU,QACrC,SAAAR,EAAAA,IAACE,EAAA,CAAM,QAAQ,WAAA,CAAY,CAAA,CAC7B,EACAF,EAAAA,IAACS,EAAA,CACC,UAAU,QACV,KAAK,UACL,iBAAiB,WACjB,UAAW,IACX,MAAOT,EAAAA,IAACE,EAAA,CAAM,QAAQ,QAAA,CAAS,EAC/B,YAAaX,EAAMP,EAAQ,UAAU,CAAC,CAAA,CAAA,CACxC,CAAA,CAAA,EAEDK,GAAeW,EAAAA,IAAC,MAAA,CAAI,UAAU,QAAS,SAAAX,CAAA,CAAY,CAAA,EACtD,SACCqB,EAAA,CACC,SAAA,CAAAV,EAAAA,IAACW,EAAA,CAAO,QAAS,IAAMlB,EAAA,EACrB,SAAAO,EAAAA,IAACE,EAAA,CAAM,QAAQ,QAAA,CAAS,CAAA,CAC1B,EACAF,EAAAA,IAACW,EAAA,CACC,KAAMjB,EACN,QAAQ,OACR,MAAM,UACN,KAAK,SACL,SAAUI,EAAQ,UAElB,SAAAE,EAAAA,IAACE,EAAA,CAAM,QAAQ,SAAA,CAAU,CAAA,CAAA,CAC3B,CAAA,CACF,CAAA,EACF,CAEJ,CClFO,SAASU,EAAcjC,EAAmB,CAC/C,OAAOC,EAAY,CACjB,WAAY,IACVE,EAAU,OAAO,eAAeH,EAAQ,KAAK,GAAG,CAAC,EAAE,EAAE,KAAKO,GAAKA,EAAE,IAAI,EACvE,UAAW,IAAM,CACfH,EACEC,EAAQ,4CAA6C,CACnD,OAAQ,CAAC,MAAOL,EAAQ,MAAA,CAAM,CAC/B,CAAA,EAEHM,EAAY,kBAAkB,CAAC,SAAU,CAAC,OAAO,EAAE,CACrD,EACA,QAASC,GAAK2B,EAAmB3B,CAAC,CAAA,CACnC,CACH"}