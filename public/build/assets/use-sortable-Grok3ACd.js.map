{"version":3,"file":"use-sortable-Grok3ACd.js","sources":["../../../common/foundation/resources/client/ui/library/interactions/dnd/sortable/sortable-line-strategy.ts","../../../common/foundation/resources/client/ui/library/utils/array/move-item-in-array.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/sortable/sortable-move-node-strategy.ts","../../../common/foundation/resources/client/ui/library/utils/array/move-item-in-new-array.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/sortable/sortable-transform-strategy.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/sortable/use-sortable.ts"],"sourcesContent":["import {\n  DropPosition,\n  SortSession,\n} from '@ui/interactions/dnd/sortable/use-sortable';\nimport {SortableStrategy} from '@ui/interactions/dnd/sortable/sortable-strategy';\nimport {droppables} from '@ui/interactions/dnd/drag-state';\n\nexport const sortableLineStrategy: SortableStrategy = {\n  onDragStart: () => {},\n  onDragEnter: () => {},\n  onDragOver: ({e, ref, item, sortSession, onDropPositionChange}) => {\n    const previousPosition = sortSession.dropPosition;\n    let newPosition: DropPosition = null;\n\n    const rect = droppables.get(item)?.rect;\n    if (rect) {\n      const midY = rect.top + rect.height / 2;\n      if (e.clientY <= midY) {\n        newPosition = 'before';\n      } else if (e.clientY >= midY) {\n        newPosition = 'after';\n      }\n    }\n\n    if (newPosition !== previousPosition) {\n      const overIndex = sortSession.sortables.indexOf(item);\n      sortSession.dropPosition = newPosition;\n      onDropPositionChange?.(sortSession.dropPosition);\n\n      clearLinePreview(sortSession);\n      if (ref.current) {\n        if (sortSession.dropPosition === 'after') {\n          addLinePreview(ref.current, 'bottom', sortSession);\n        } else {\n          // if it's the first row, add preview to the top border, as there's no previous element\n          if (overIndex === 0) {\n            addLinePreview(ref.current, 'top', sortSession);\n            // otherwise add preview to the bottom border of the previous row\n          } else {\n            const droppableId = sortSession.sortables[overIndex - 1];\n            const droppable = droppables.get(droppableId);\n            if (droppable?.ref.current) {\n              addLinePreview(droppable.ref.current, 'bottom', sortSession);\n            }\n          }\n        }\n      }\n\n      const itemIndex = sortSession.sortables.indexOf(item);\n\n      // don't move item at all if hovering over itself\n      if (sortSession.activeIndex === itemIndex) {\n        sortSession.finalIndex = sortSession.activeIndex;\n        return;\n      }\n\n      // adjust final drop index based on whether we're dropping drag target after or before it's original index\n      // this is needed, so we get the same index if target is dropped after current item or before next item\n      const dragDirection =\n        overIndex > sortSession.activeIndex ? 'after' : 'before';\n      if (dragDirection === 'after') {\n        sortSession.finalIndex =\n          sortSession.dropPosition === 'before' ? itemIndex - 1 : itemIndex;\n      } else {\n        sortSession.finalIndex =\n          sortSession.dropPosition === 'after' ? itemIndex + 1 : itemIndex;\n      }\n    }\n  },\n  onDragEnd: sortSession => {\n    clearLinePreview(sortSession);\n  },\n};\n\nfunction clearLinePreview(sortSession: SortSession) {\n  if (sortSession?.linePreviewEl) {\n    sortSession.linePreviewEl.style.borderBottomColor = '';\n    sortSession.linePreviewEl.style.borderTopColor = '';\n    sortSession.linePreviewEl = undefined;\n  }\n}\n\nfunction addLinePreview(\n  el: HTMLElement,\n  side: 'top' | 'bottom',\n  sortSession: SortSession,\n) {\n  const color = 'rgb(var(--be-primary))';\n  if (side === 'top') {\n    el.style.borderTopColor = color;\n  } else {\n    el.style.borderBottomColor = color;\n  }\n  if (sortSession) {\n    sortSession.linePreviewEl = el;\n  }\n}\n","import {clamp} from '@ui/utils/number/clamp';\n\nexport function moveItemInArray<T = any>(\n  array: T[],\n  fromIndex: number,\n  toIndex: number,\n): T[] {\n  const from = clamp(fromIndex, 0, array.length - 1);\n  const to = clamp(toIndex, 0, array.length - 1);\n\n  if (from === to) {\n    return array;\n  }\n\n  const target = array[from];\n  const delta = to < from ? -1 : 1;\n\n  for (let i = from; i !== to; i += delta) {\n    array[i] = array[i + delta];\n  }\n\n  array[to] = target;\n\n  return array;\n}\n","import {moveItemInArray} from '@ui/utils/array/move-item-in-array';\nimport {droppables} from '@ui/interactions/dnd/drag-state';\nimport {SortableStrategy} from '@ui/interactions/dnd/sortable/sortable-strategy';\n\nexport const sortableMoveNodeStrategy: SortableStrategy = {\n  onDragStart: () => {},\n  onDragOver: () => {},\n  onDragEnter: (sortSession, overIndex: number, currentIndex: number) => {\n    const node = droppables.get(sortSession.sortables[currentIndex])?.ref\n      .current;\n    if (node) {\n      moveNode(node, currentIndex, overIndex);\n      moveItemInArray(sortSession.sortables, currentIndex, overIndex);\n      sortSession.finalIndex = overIndex;\n    }\n  },\n  onDragEnd: () => {},\n};\n\nfunction moveNode(el: HTMLElement, currentIndex: number, newIndex: number) {\n  const parentEl = el.parentElement!;\n  if (newIndex < 0) {\n    parentEl.prepend(el);\n  } else {\n    // if parent already contains this node, and we're changing\n    // node's index within parent, need to adjust index by one\n    if (currentIndex > -1 && currentIndex <= newIndex) {\n      newIndex++;\n    }\n    const ref = parentEl.children.item(newIndex);\n    if (ref) {\n      ref.before(el);\n    } else {\n      parentEl.append(el);\n    }\n  }\n}\n","export function moveItemInNewArray<T>(\n  array: T[],\n  from: number,\n  to: number\n): T[] {\n  const newArray = array.slice();\n  newArray.splice(\n    to < 0 ? newArray.length + to : to,\n    0,\n    newArray.splice(from, 1)[0]\n  );\n\n  return newArray;\n}\n","import {droppables} from '@ui/interactions/dnd/drag-state';\nimport type {SortableStrategy} from '@ui/interactions/dnd/sortable/sortable-strategy';\nimport type {SortSession} from '@ui/interactions/dnd/sortable/use-sortable';\nimport {moveItemInArray} from '@ui/utils/array/move-item-in-array';\nimport {moveItemInNewArray} from '@ui/utils/array/move-item-in-new-array';\n\nconst transition = 'transform 0.2s cubic-bezier(0.2, 0, 0, 1)';\n\nexport const sortableTransformStrategy: SortableStrategy = {\n  onDragStart: sortSession => {\n    sortSession.sortables.forEach((sortable, index) => {\n      const droppable = droppables.get(sortable);\n      if (!droppable?.ref.current) return;\n\n      droppable.ref.current.style.transition = transition;\n\n      if (sortSession?.activeIndex === index) {\n        droppable.ref.current.style.opacity = '0.4';\n      }\n    });\n  },\n  onDragEnter: (\n    sortSession: SortSession,\n    overIndex: number,\n    currentIndex: number,\n  ) => {\n    moveItemInArray(sortSession.sortables, currentIndex, overIndex);\n    const rects = sortSession.sortables.map(s => droppables.get(s)?.rect);\n\n    sortSession.sortables.forEach((sortable, index) => {\n      if (!sortSession) return;\n\n      const newRects = moveItemInNewArray(\n        rects,\n        overIndex,\n        sortSession.activeIndex,\n      );\n      const oldRect = rects[index];\n      const newRect = newRects[index];\n      const sortableTarget = droppables.get(sortable);\n\n      if (sortableTarget?.ref.current && newRect && oldRect) {\n        const x = newRect.left - oldRect.left;\n        const y = newRect.top - oldRect.top;\n        sortableTarget.ref.current.style.transform = `translate3d(${x}px, ${y}px, 0)`;\n      }\n    });\n\n    sortSession.finalIndex = overIndex;\n  },\n  onDragOver: () => {},\n  onDragEnd: sortSession => {\n    // clear any styles and transforms applied to sortables during sorting\n    sortSession.sortables.forEach(sortable => {\n      const droppable = droppables.get(sortable);\n      if (droppable?.ref.current) {\n        droppable.ref.current.style.transform = '';\n        droppable.ref.current.style.transition = '';\n        droppable.ref.current.style.opacity = '';\n        droppable.ref.current.style.zIndex = '';\n      }\n    });\n  },\n};\n","import {getScrollParent, mergeProps} from '@react-aria/utils';\nimport {sortableLineStrategy} from '@ui/interactions/dnd/sortable/sortable-line-strategy';\nimport {sortableMoveNodeStrategy} from '@ui/interactions/dnd/sortable/sortable-move-node-strategy';\nimport {SortableStrategy} from '@ui/interactions/dnd/sortable/sortable-strategy';\nimport {sortableTransformStrategy} from '@ui/interactions/dnd/sortable/sortable-transform-strategy';\nimport {updateRects} from '@ui/interactions/dnd/update-rects';\nimport {RefObject, useEffect} from 'react';\nimport {droppables} from '../drag-state';\nimport {DraggableId, DragPreviewRenderer, useDraggable} from '../use-draggable';\nimport {useDroppable} from '../use-droppable';\n\nexport interface SortSession {\n  // items in this list will be moved when user is sorting\n  sortables: DraggableId[];\n\n  // sortable user started dragging to start this session\n  activeSortable: DraggableId;\n  activeIndex: number;\n\n  // final index sortable was dropped in and should be moved to\n  finalIndex: number;\n\n  // drop position for displaying line preview\n  dropPosition: DropPosition;\n  // element that currently has a line preview at the top or bottom\n  linePreviewEl?: HTMLElement;\n  scrollParent?: Element;\n  scrollListener: () => void;\n  ref: RefObject<HTMLElement | null>;\n  type: string;\n}\n\nlet sortSession: null | SortSession = null;\n\nexport type DropPosition = 'before' | 'after' | null;\n\ntype StrategyName = 'line' | 'liveSort' | 'moveNode';\n\nconst strategies: Record<StrategyName, SortableStrategy> = {\n  line: sortableLineStrategy,\n  liveSort: sortableTransformStrategy,\n  moveNode: sortableMoveNodeStrategy,\n};\n\nexport interface UseSortableProps {\n  item: DraggableId;\n  items: DraggableId[];\n  onSortStart?: () => void;\n  onSortEnd?: (oldIndex: number, newIndex: number) => void;\n  onDragEnd?: () => void;\n  onDropPositionChange?: (dropPosition: DropPosition) => void;\n  ref: RefObject<HTMLElement | null>;\n  type: string;\n  preview?: RefObject<DragPreviewRenderer | null>;\n  strategy?: StrategyName;\n  disabled?: boolean;\n}\nexport function useSortable({\n  item,\n  items,\n  type,\n  ref,\n  onSortEnd,\n  onSortStart,\n  onDragEnd,\n  preview,\n  disabled,\n  onDropPositionChange,\n  strategy = 'liveSort',\n}: UseSortableProps) {\n  // todo: issue with sorting after scrolling menu editor item list\n\n  // update sortables and active index, in case we lazy load more items while sorting\n  useEffect(() => {\n    if (\n      !disabled &&\n      sortSession?.type === type &&\n      sortSession.sortables.length !== items.length\n    ) {\n      sortSession.sortables = [...items];\n      sortSession.activeIndex = items.indexOf(item);\n    }\n  }, [items, item]);\n\n  const {draggableProps, dragHandleRef} = useDraggable({\n    id: item,\n    ref,\n    type,\n    preview,\n    disabled,\n    onDragStart: () => {\n      sortSession = {\n        type,\n        sortables: [...items],\n        activeSortable: item,\n        activeIndex: items.indexOf(item),\n        finalIndex: items.indexOf(item),\n        dropPosition: null,\n        ref,\n        scrollParent: ref.current ? getScrollParent(ref.current) : undefined,\n        scrollListener: () => {\n          updateRects(droppables);\n        },\n      };\n      strategies[strategy].onDragStart(sortSession);\n\n      onSortStart?.();\n      sortSession.scrollParent?.addEventListener(\n        'scroll',\n        sortSession.scrollListener,\n      );\n    },\n    onDragEnd: e => {\n      if (!sortSession) return;\n\n      sortSession.dropPosition = null;\n      onDropPositionChange?.(sortSession.dropPosition);\n      if (sortSession.activeIndex !== sortSession.finalIndex) {\n        onSortEnd?.(sortSession.activeIndex, sortSession.finalIndex);\n      }\n      sortSession.scrollParent?.removeEventListener(\n        'scroll',\n        sortSession.scrollListener,\n      );\n      strategies[strategy].onDragEnd(sortSession);\n      // call \"onDragEnd\" after \"onSortEnd\", so listener has a chance to use sort session data\n      onDragEnd?.();\n      sortSession = null;\n    },\n    getData: () => {},\n  });\n\n  const {droppableProps} = useDroppable({\n    id: item,\n    ref,\n    types: [type],\n    disabled,\n    allowDragEventsFromItself: true,\n    onDragOver: (target, e) => {\n      if (!sortSession) return;\n      strategies[strategy].onDragOver({\n        e,\n        ref,\n        item,\n        sortSession,\n        onDropPositionChange,\n      });\n    },\n    onDragEnter: () => {\n      if (!sortSession) return;\n      const overIndex = sortSession.sortables.indexOf(item);\n      const oldIndex = sortSession.sortables.indexOf(\n        sortSession.activeSortable,\n      );\n      strategies[strategy].onDragEnter(sortSession, overIndex, oldIndex);\n    },\n    onDragLeave: () => {\n      if (!sortSession) return;\n      sortSession.dropPosition = null;\n      onDropPositionChange?.(sortSession.dropPosition);\n    },\n  });\n\n  return {\n    sortableProps: {...mergeProps(draggableProps, droppableProps)},\n    dragHandleRef,\n  };\n}\n"],"names":["sortableLineStrategy","ref","item","sortSession","onDropPositionChange","previousPosition","newPosition","rect","_a","droppables","midY","overIndex","clearLinePreview","addLinePreview","droppableId","droppable","itemIndex","el","side","color","moveItemInArray","array","fromIndex","toIndex","from","clamp","to","target","delta","i","sortableMoveNodeStrategy","currentIndex","node","moveNode","newIndex","parentEl","moveItemInNewArray","newArray","transition","sortableTransformStrategy","sortable","index","rects","s","newRects","oldRect","newRect","sortableTarget","x","y","strategies","useSortable","items","type","onSortEnd","onSortStart","onDragEnd","preview","disabled","strategy","useEffect","draggableProps","dragHandleRef","useDraggable","getScrollParent","updateRects","e","droppableProps","useDroppable","oldIndex","mergeProps"],"mappings":"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"}