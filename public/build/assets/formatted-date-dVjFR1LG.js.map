{"version":3,"file":"formatted-date-dVjFR1LG.js","sources":["../../../common/foundation/resources/client/ui/library/i18n/formatted-date.tsx"],"sourcesContent":["import {DateValue, parseAbsolute} from '@internationalized/date';\nimport {Fragment, memo} from 'react';\nimport {useDateFormatter} from '@ui/i18n/use-date-formatter';\nimport {shallowEqual} from '@ui/utils/shallow-equal';\nimport {useSettings} from '@ui/settings/use-settings';\nimport {useUserTimezone} from '@ui/i18n/use-user-timezone';\n\nexport const DateFormatPresets: Record<\n  'numeric' | 'short' | 'long' | 'timestamp' | 'time',\n  Intl.DateTimeFormatOptions\n> = {\n  numeric: {year: 'numeric', month: '2-digit', day: '2-digit'},\n  short: {year: 'numeric', month: 'short', day: '2-digit'},\n  long: {month: 'long', day: '2-digit', year: 'numeric'},\n  timestamp: {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit',\n  },\n  time: {\n    hour: '2-digit',\n    minute: '2-digit',\n  },\n};\n\ninterface FormattedDateProps {\n  date?: string | DateValue | Date;\n  options?: Intl.DateTimeFormatOptions;\n  preset?: keyof typeof DateFormatPresets;\n  timezone?: string;\n}\n\nexport const FormattedDate = memo(\n  ({date, options, preset, timezone: propsTimezone}: FormattedDateProps) => {\n    const {dates} = useSettings();\n    const userTimezone = useUserTimezone();\n    const timezone = propsTimezone || options?.timeZone || userTimezone;\n\n    const formatterOptions: Intl.DateTimeFormatOptions =\n      options ||\n      (DateFormatPresets as Record<string, Intl.DateTimeFormatOptions>)[\n        preset || dates?.format || 'short'\n      ] ||\n      {};\n\n    if (!formatterOptions.timeZone) {\n      formatterOptions.timeZone = timezone;\n    }\n\n    const formatter = useDateFormatter(formatterOptions);\n\n    if (!date) {\n      return null;\n    }\n\n    // make sure date with invalid format does not blow up the app\n    try {\n      if (typeof date === 'string') {\n        date = parseAbsolute(date, timezone).toDate();\n      } else if ('toDate' in date) {\n        date = date.toDate(timezone);\n      }\n    } catch (e) {\n      return null;\n    }\n\n    return <Fragment>{formatter.format(date as Date)}</Fragment>;\n  },\n  shallowEqual,\n);\n"],"names":["DateFormatPresets","FormattedDate","memo","date","options","preset","propsTimezone","dates","useSettings","userTimezone","useUserTimezone","timezone","formatterOptions","formatter","useDateFormatter","parseAbsolute","jsx","Fragment","shallowEqual"],"mappings":"iIAOO,MAAMA,EAGT,CACF,QAAS,CAAC,KAAM,UAAW,MAAO,UAAW,IAAK,SAAA,EAClD,MAAO,CAAC,KAAM,UAAW,MAAO,QAAS,IAAK,SAAA,EAC9C,KAAM,CAAC,MAAO,OAAQ,IAAK,UAAW,KAAM,SAAA,EAC5C,UAAW,CACT,KAAM,UACN,MAAO,UACP,IAAK,UACL,KAAM,UACN,OAAQ,UACR,OAAQ,SAAA,EAEV,KAAM,CACJ,KAAM,UACN,OAAQ,SAAA,CAEZ,EASaC,EAAgBC,EAAAA,KAC3B,CAAC,CAAC,KAAAC,EAAM,QAAAC,EAAS,OAAAC,EAAQ,SAAUC,KAAuC,CACxE,KAAM,CAAC,MAAAC,CAAA,EAASC,EAAA,EACVC,EAAeC,EAAA,EACfC,EAAWL,IAAiBF,GAAA,YAAAA,EAAS,WAAYK,EAEjDG,EACJR,GACCJ,EACCK,IAAUE,GAAA,YAAAA,EAAO,SAAU,OAC7B,GACA,CAAA,EAEGK,EAAiB,WACpBA,EAAiB,SAAWD,GAG9B,MAAME,EAAYC,EAAiBF,CAAgB,EAEnD,GAAI,CAACT,EACH,OAAO,KAIT,GAAI,CACE,OAAOA,GAAS,SAClBA,EAAOY,EAAcZ,EAAMQ,CAAQ,EAAE,OAAA,EAC5B,WAAYR,IACrBA,EAAOA,EAAK,OAAOQ,CAAQ,EAE/B,MAAY,CACV,OAAO,IACT,CAEA,OAAOK,EAAAA,IAACC,EAAAA,SAAA,CAAU,SAAAJ,EAAU,OAAOV,CAAY,EAAE,CACnD,EACAe,CACF"}