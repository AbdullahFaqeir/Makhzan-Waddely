{"version":3,"file":"shareable-link-page-xc4wZgbN.js","sources":["../../../resources/client/drive/shareable-link/shareable-link-page/link-page-store.ts","../../../resources/client/drive/shareable-link/queries/use-shareable-link-page.ts","../../../resources/client/drive/shareable-link/shareable-link-page/folder-preview/folder-preview-file-grid.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/folder-preview/folder-preview-file-table.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/folder-preview/use-navigate-to-subfolder.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/folder-preview/folder-preview-file-view.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/queries/import-into-own-drive.ts","../../../resources/client/drive/shareable-link/shareable-link-page/shareable-link-page-action-buttons.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/folder-preview/folder-preview-breadcrumb.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/folder-preview/folder-preview-header.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/folder-preview/folder-preview.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/queries/check-link-password.ts","../../../resources/client/drive/shareable-link/shareable-link-page/shareable-link-navbar.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/password-page.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/shareable-link-page-file-preview.tsx","../../../resources/client/drive/shareable-link/shareable-link-page/shareable-link-page.tsx"],"sourcesContent":["import {DriveSortDescriptor} from '@app/drive/drive-store';\nimport {\n  getFromLocalStorage,\n  setInLocalStorage,\n} from '@ui/utils/hooks/local-storage';\nimport {create} from 'zustand';\nimport {immer} from 'zustand/middleware/immer';\n\ninterface LinkPageState {\n  password: string | null;\n  setPassword: (value: string) => void;\n  isPasswordProtected: boolean;\n  setIsPasswordProtected: (value: boolean) => void;\n  activeSort: DriveSortDescriptor;\n  setActiveSort: (value: DriveSortDescriptor) => void;\n  viewMode: 'grid' | 'list';\n  setViewMode: (mode: 'grid' | 'list') => void;\n}\n\nexport const useLinkPageStore = create<LinkPageState>()(\n  immer(set => ({\n    password: null,\n    viewMode: getFromLocalStorage<'list' | 'grid'>('drive.viewMode') || 'grid',\n    activeSort: {\n      orderBy: 'updated_at',\n      orderDir: 'desc',\n    },\n    setPassword: value => {\n      set(state => {\n        state.password = value;\n      });\n    },\n    isPasswordProtected: false,\n    setIsPasswordProtected: value => {\n      set(state => {\n        state.isPasswordProtected = value;\n      });\n    },\n    setViewMode: mode => {\n      set(state => {\n        state.viewMode = mode;\n        setInLocalStorage('drive.viewMode', mode);\n      });\n    },\n    setActiveSort: value => {\n      set(state => {\n        state.activeSort = value;\n      });\n    },\n  })),\n);\n\nexport function linkPageState() {\n  return useLinkPageStore.getState();\n}\n","import {appQueries} from '@app/app-queries';\nimport type {DriveEntry} from '@app/drive/files/drive-entry';\nimport {\n  linkPageState,\n  useLinkPageStore,\n} from '@app/drive/shareable-link/shareable-link-page/link-page-store';\nimport {LengthAwarePaginationResponse} from '@common/http/backend-response/pagination-response';\nimport {apiClient} from '@common/http/query-client';\nimport {SortDescriptor} from '@common/ui/tables/types/sort-descriptor';\nimport {\n  keepPreviousData,\n  partialMatchKey,\n  useInfiniteQuery,\n} from '@tanstack/react-query';\nimport {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\nimport {useParams} from 'react-router';\nimport type {FetchShareableLinkResponse} from './use-entry-shareable-link';\n\nexport interface FetchShareableLinkPageResponse\n  extends FetchShareableLinkResponse {\n  folderChildren: LengthAwarePaginationResponse<DriveEntry>;\n  passwordInvalid: boolean;\n}\n\nexport function useShareableLinkPage() {\n  const {hash} = useParams();\n  const sortDescriptor = useLinkPageStore(s => s.activeSort);\n  //const order = `${orderBy}:${orderDir}`;\n  const isPasswordProtected = useLinkPageStore(s => s.isPasswordProtected);\n  const password = useLinkPageStore(s => s.password);\n\n  const queryKey = buildQueryKey(hash!, sortDescriptor, password);\n\n  const query = useInfiniteQuery({\n    queryKey,\n    queryFn: async ({pageParam = 1}) => {\n      const response = await apiClient\n        .get<FetchShareableLinkPageResponse>(`shareable-link-page/${hash}`, {\n          params: {\n            loader: 'shareableLinkPage',\n            page: pageParam,\n            password,\n            ...sortDescriptor,\n          },\n        })\n        .then(response => response.data);\n\n      if (response.passwordInvalid) {\n        linkPageState().setIsPasswordProtected(true);\n      }\n      return response;\n    },\n    initialData: () => {\n      const data = getBootstrapData().loaders?.shareableLinkPage;\n      if (!data?.link) return undefined;\n\n      const queryKeyMatches = partialMatchKey(\n        queryKey,\n        buildQueryKey(\n          data.link.hash,\n          {\n            orderBy: 'updated_at',\n            orderDir: 'desc',\n          },\n          password,\n        ),\n      );\n\n      if (queryKeyMatches) {\n        if (data.passwordInvalid) {\n          linkPageState().setIsPasswordProtected(true);\n        }\n        return {\n          pageParams: [undefined, 1],\n          pages: [data],\n        };\n      }\n    },\n    initialPageParam: 1,\n    getNextPageParam: lastResponse => {\n      if (!lastResponse.folderChildren) return undefined;\n      const currentPage = lastResponse.folderChildren.current_page;\n      const lastPage = lastResponse.folderChildren.last_page;\n      if (currentPage >= lastPage) {\n        return undefined;\n      }\n      return currentPage + 1;\n    },\n    // disable query if link is password protected and correct\n    // password was not entered yet, to prevent unnecessary requests\n    enabled: (!!hash && !isPasswordProtected) || password != null,\n    placeholderData: keepPreviousData,\n  });\n\n  return {\n    ...query,\n    link: query.data?.pages[0].link,\n    entries: query.data?.pages.flatMap(p => p.folderChildren?.data),\n  };\n}\n\nconst buildQueryKey = (\n  hash: string,\n  order: SortDescriptor,\n  password: string | null,\n) => [\n  appQueries.shareableLinks.invalidateKey,\n  'page',\n  hash,\n  `${order.orderBy}:${order.orderDir}`,\n  password,\n];\n","import {BaseFileGridItem} from '@app/drive/file-view/file-grid/base-file-grid-item';\nimport React from 'react';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\n\nexport interface FolderPreviewGridProps {\n  entries: DriveEntry[];\n  onEntrySelected: (entry: DriveEntry, index: number) => void;\n}\nexport function FolderPreviewFileGrid({\n  entries,\n  onEntrySelected,\n}: FolderPreviewGridProps) {\n  return (\n    <div className=\"file-grid\">\n      {entries.map((entry, index) => (\n        <BaseFileGridItem\n          tabIndex={-1}\n          className=\"hover:shadow-md cursor-pointer bg\"\n          entry={entry}\n          key={entry.id}\n          onContextMenu={e => {\n            e.preventDefault();\n          }}\n          onKeyDown={e => {\n            if (e.key === 'Enter' || e.key === ' ') {\n              onEntrySelected(entry, index);\n            }\n          }}\n          onClick={() => {\n            onEntrySelected(entry, index);\n          }}\n        />\n      ))}\n    </div>\n  );\n}\n","import {DriveSortDescriptor} from '@app/drive/drive-store';\nimport React from 'react';\nimport {Table} from '@common/ui/tables/table';\nimport {\n  linkPageState,\n  useLinkPageStore,\n} from '@app/drive/shareable-link/shareable-link-page/link-page-store';\nimport type {FolderPreviewGridProps} from '@app/drive/shareable-link/shareable-link-page/folder-preview/folder-preview-file-grid';\nimport {fileTableColumns} from '@app/drive/file-view/file-table/file-table-columns';\nimport {useIsMobileMediaQuery} from '@ui/utils/hooks/is-mobile-media-query';\n\nconst mobileColumns = fileTableColumns.filter(\n  config => config.key !== 'updated_at',\n);\n\nexport function FolderPreviewFileTable({\n  entries,\n  onEntrySelected,\n}: FolderPreviewGridProps) {\n  const sortDescriptor = useLinkPageStore(s => s.activeSort);\n  const isMobile = useIsMobileMediaQuery();\n\n  return (\n    <Table\n      columns={isMobile ? mobileColumns : fileTableColumns}\n      data={entries}\n      sortDescriptor={sortDescriptor}\n      onSortChange={value => {\n        linkPageState().setActiveSort(value as DriveSortDescriptor);\n      }}\n      onAction={(item, index) => {\n        onEntrySelected(item, index);\n      }}\n      enableSelection={false}\n    />\n  );\n}\n","import {useShareableLinkPage} from '@app/drive/shareable-link/queries/use-shareable-link-page';\nimport {useNavigate} from 'react-router';\nimport {ShareableLink} from '@app/drive/shareable-link/shareable-link';\n\nfunction buildFolderHash(link: ShareableLink, folderHash?: string) {\n  let hash = link.hash;\n  if (folderHash && link.entry?.hash !== folderHash) {\n    hash = `${hash}:${folderHash}`;\n  }\n  return hash;\n}\n\nexport function useNavigateToSubfolder() {\n  const {link} = useShareableLinkPage();\n  const navigate = useNavigate();\n  return (hash: string) => {\n    if (!link) return;\n    navigate(`/drive/s/${buildFolderHash(link, hash)}`);\n  };\n}\n","import {AnimatePresence, m} from 'framer-motion';\nimport React, {useEffect, useRef, useState} from 'react';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport {useShareableLinkPage} from '@app/drive/shareable-link/queries/use-shareable-link-page';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport clsx from 'clsx';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {FolderPreviewFileGrid} from './folder-preview-file-grid';\nimport {useLinkPageStore} from '@app/drive/shareable-link/shareable-link-page/link-page-store';\nimport {FolderPreviewFileTable} from './folder-preview-file-table';\nimport {useNavigateToSubfolder} from './use-navigate-to-subfolder';\nimport {useLocation} from 'react-router';\nimport {AdHost} from '@common/admin/ads/ad-host';\nimport {opacityAnimation} from '@ui/animation/opacity-animation';\nimport {FilePreviewDialog} from '@common/uploads/components/file-preview/file-preview-dialog';\n\ninterface FolderPreviewChildrenProps {\n  className?: string;\n}\nexport function FolderPreviewFileView({className}: FolderPreviewChildrenProps) {\n  const {pathname} = useLocation();\n  const navigateToSubfolder = useNavigateToSubfolder();\n  const [activePreviewIndex, setActivePreviewIndex] = useState<number>();\n  const viewMode = useLinkPageStore(s => s.viewMode);\n  const sentinelRef = useRef<HTMLDivElement>(null);\n  const {\n    link,\n    entries,\n    isFetchingNextPage,\n    hasNextPage,\n    fetchNextPage,\n    isPlaceholderData,\n  } = useShareableLinkPage();\n\n  // close preview modal on back/forward navigation\n  useEffect(() => {\n    setActivePreviewIndex(undefined);\n  }, [pathname]);\n\n  useEffect(() => {\n    const sentinelEl = sentinelRef.current;\n    if (!sentinelEl) return;\n    const observer = new IntersectionObserver(([entry]) => {\n      if (entry.isIntersecting && hasNextPage) {\n        fetchNextPage();\n      }\n    });\n    observer.observe(sentinelEl);\n    return () => {\n      observer.unobserve(sentinelEl);\n    };\n  }, [hasNextPage, fetchNextPage]);\n\n  if (!link || isPlaceholderData) {\n    return (\n      <div className={clsx('flex justify-center', className)}>\n        <ProgressCircle isIndeterminate />\n      </div>\n    );\n  }\n\n  const handlePreview = (entry: DriveEntry, index: number) => {\n    if (entry.type === 'folder') {\n      navigateToSubfolder(entry.hash);\n    } else {\n      setActivePreviewIndex(index);\n    }\n  };\n\n  const folderEntries = entries || [];\n\n  return (\n    <>\n      <div\n        className={clsx(\n          'file-grid-container flex-auto overflow-auto px-14 pb-14 md:px-24 md:pb-24',\n          className,\n        )}\n      >\n        <AdHost slot=\"file-preview\" className=\"mb-40\" />\n        {viewMode === 'grid' ? (\n          <FolderPreviewFileGrid\n            entries={folderEntries}\n            onEntrySelected={handlePreview}\n          />\n        ) : (\n          <FolderPreviewFileTable\n            entries={folderEntries}\n            onEntrySelected={handlePreview}\n          />\n        )}\n        <span ref={sentinelRef} aria-hidden />\n        <AnimatePresence>\n          {isFetchingNextPage && (\n            <m.div\n              className=\"mt-24 flex w-full justify-center\"\n              {...opacityAnimation}\n            >\n              <ProgressCircle isIndeterminate aria-label=\"loading\" />\n            </m.div>\n          )}\n        </AnimatePresence>\n      </div>\n      <DialogTrigger\n        type=\"modal\"\n        isOpen={activePreviewIndex != undefined}\n        onClose={() => setActivePreviewIndex(undefined)}\n      >\n        <FilePreviewDialog\n          entries={folderEntries}\n          defaultActiveIndex={activePreviewIndex}\n          allowDownload={link.allow_download}\n        />\n      </DialogTrigger>\n    </>\n  );\n}\n","import {appQueries} from '@app/app-queries';\nimport {DriveEntryUser} from '@app/drive/files/drive-entry';\nimport {useLinkPageStore} from '@app/drive/shareable-link/shareable-link-page/link-page-store';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\n\ninterface Response extends BackendResponse {\n  users: DriveEntryUser[];\n}\n\ninterface Props {\n  password: string | null;\n  linkId: number;\n}\n\nfunction importIntoOwnDrive({linkId, password}: Props): Promise<Response> {\n  return apiClient\n    .post(`shareable-links/${linkId}/import`, {password})\n    .then(r => r.data);\n}\n\nexport function useImportIntoOwnDrive() {\n  const password = useLinkPageStore(s => s.password);\n  return useMutation({\n    mutationFn: (props: Omit<Props, 'password'>) =>\n      importIntoOwnDrive({...props, password}),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({\n        queryKey: appQueries.shareableLinks.invalidateKey,\n      });\n      toast(message('Item imported into your drive'));\n    },\n    onError: err => showHttpErrorToast(err, message('Could not create link')),\n  });\n}\n","import {useShareableLinkPage} from '@app/drive/shareable-link/queries/use-shareable-link-page';\nimport {useAuth} from '@common/auth/use-auth';\nimport {useFileEntryUrls} from '@common/uploads/file-entry-urls';\nimport {useImportIntoOwnDrive} from './queries/import-into-own-drive';\nimport {Button} from '@ui/buttons/button';\nimport {FileDownloadIcon} from '@ui/icons/material/FileDownload';\nimport {Trans} from '@ui/i18n/trans';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {KeyboardArrowDownIcon} from '@ui/icons/material/KeyboardArrowDown';\nimport {ImportExportIcon} from '@ui/icons/material/ImportExport';\nimport React, {Fragment} from 'react';\nimport {Tooltip} from '@ui/tooltip/tooltip';\nimport {Menu, MenuItem, MenuTrigger} from '@ui/menu/menu-trigger';\nimport {downloadFileFromUrl} from '@ui/utils/files/download-file-from-url';\n\nexport function ShareableLinkPageActionButtons() {\n  const {link} = useShareableLinkPage();\n  const {user, isLoggedIn} = useAuth();\n  const {downloadUrl} = useFileEntryUrls(link?.entry);\n  const importIntoOwnDrive = useImportIntoOwnDrive();\n  const alreadyImported = link?.entry?.users!.find(u => u.id === user?.id);\n\n  if (!link?.entry) return null;\n\n  return (\n    <div>\n      {link.allow_download && <DownloadButton downloadUrl={downloadUrl} />}\n      {!alreadyImported && isLoggedIn && link.allow_edit && (\n        <MenuTrigger\n          onItemSelected={key => {\n            if (key === 'import') {\n              importIntoOwnDrive.mutate({linkId: link.id});\n            } else if (key === 'download') {\n              if (downloadUrl) {\n                downloadFileFromUrl(downloadUrl);\n              }\n            }\n          }}\n        >\n          <IconButton className=\"ml-6\" disabled={importIntoOwnDrive.isPending}>\n            <KeyboardArrowDownIcon />\n          </IconButton>\n          <Menu>\n            <MenuItem value=\"download\" startIcon={<FileDownloadIcon />}>\n              <Trans message=\"Download\" />\n            </MenuItem>\n            <MenuItem value=\"import\" startIcon={<ImportExportIcon />}>\n              <Trans message=\"Save a copy to your own drive\" />\n            </MenuItem>\n          </Menu>\n        </MenuTrigger>\n      )}\n    </div>\n  );\n}\n\ninterface DownloadButtonProps {\n  downloadUrl: string | undefined;\n}\nfunction DownloadButton({downloadUrl}: DownloadButtonProps) {\n  return (\n    <Fragment>\n      <Tooltip label={<Trans message=\"Download\" />}>\n        <IconButton\n          className=\"md:hidden\"\n          onClick={() => {\n            if (downloadUrl) {\n              downloadFileFromUrl(downloadUrl);\n            }\n          }}\n        >\n          <FileDownloadIcon />\n        </IconButton>\n      </Tooltip>\n      <Button\n        className=\"max-md:hidden\"\n        size=\"sm\"\n        variant=\"flat\"\n        color=\"chip\"\n        startIcon={<FileDownloadIcon />}\n        onClick={() => {\n          if (downloadUrl) {\n            downloadFileFromUrl(downloadUrl);\n          }\n        }}\n      >\n        <Trans message=\"Download\" />\n      </Button>\n    </Fragment>\n  );\n}\n","import {DriveFolder} from '@app/drive/files/drive-entry';\nimport {useFolderPath} from '@app/drive/files/queries/use-folder-path';\nimport {ShareableLink} from '@app/drive/shareable-link/shareable-link';\nimport {useLinkPageStore} from '@app/drive/shareable-link/shareable-link-page/link-page-store';\nimport {Breadcrumb} from '@ui/breadcrumbs/breadcrumb';\nimport {BreadcrumbItem} from '@ui/breadcrumbs/breadcrumb-item';\nimport clsx from 'clsx';\nimport {ReactElement, ReactNode} from 'react';\nimport {useNavigateToSubfolder} from './use-navigate-to-subfolder';\n\ninterface Props {\n  className?: string;\n  folder?: DriveFolder;\n  link: ShareableLink;\n}\nexport function FolderPreviewBreadcrumb({className, folder, link}: Props) {\n  const navigateToSubfolder = useNavigateToSubfolder();\n  const password = useLinkPageStore(s => s.password);\n  const query = useFolderPath({\n    hash: folder?.hash,\n    params: {\n      shareable_link: link.id,\n      password,\n    },\n  });\n\n  let content: ReactNode;\n\n  if (query.isLoading) {\n    content = null;\n  } else {\n    const items: {folder: DriveFolder; label: ReactElement}[] = [];\n    if (query.data) {\n      query.data.path.forEach(parent => {\n        items.push({\n          folder: parent,\n          label: <>{parent.name}</>,\n        });\n      });\n    }\n\n    content = (\n      <Breadcrumb size=\"lg\" isNavigation>\n        {items.map(item => {\n          return (\n            <BreadcrumbItem\n              onSelected={() => {\n                navigateToSubfolder(item.folder.hash);\n              }}\n              key={item.folder.hash}\n            >\n              {item.label}\n            </BreadcrumbItem>\n          );\n        })}\n      </Breadcrumb>\n    );\n  }\n\n  return <div className={clsx('h-36 flex-shrink-0', className)}>{content}</div>;\n}\n","import {DriveFolder} from '@app/drive/files/drive-entry';\nimport {EntriesSortButton} from '@app/drive/layout/sorting/entries-sort-button';\nimport {useShareableLinkPage} from '@app/drive/shareable-link/queries/use-shareable-link-page';\nimport {\n  linkPageState,\n  useLinkPageStore,\n} from '@app/drive/shareable-link/shareable-link-page/link-page-store';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {GridViewIcon} from '@ui/icons/material/GridView';\nimport {FolderPreviewBreadcrumb} from './folder-preview-breadcrumb';\n\nexport function FolderPreviewHeader() {\n  const activeSort = useLinkPageStore(s => s.activeSort);\n  const {link, isFetching} = useShareableLinkPage();\n  const hasEntry = link && link.entry;\n\n  return (\n    <div className=\"flex flex-col justify-between gap-14 p-14 md:h-90 md:flex-row md:items-center md:p-24\">\n      {hasEntry && (\n        <FolderPreviewBreadcrumb\n          link={link}\n          folder={link.entry as DriveFolder}\n          className=\"flex-auto\"\n        />\n      )}\n      {hasEntry && (\n        <div className=\"flex items-center justify-between text-muted md:justify-start\">\n          <EntriesSortButton\n            isDisabled={isFetching}\n            descriptor={activeSort}\n            onChange={value => {\n              linkPageState().setActiveSort(value);\n            }}\n          />\n          <div className=\"ml-10 md:border-l md:pl-10\">\n            <IconButton\n              onClick={() => {\n                linkPageState().setViewMode(\n                  linkPageState().viewMode === 'grid' ? 'list' : 'grid',\n                );\n              }}\n            >\n              <GridViewIcon />\n            </IconButton>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport {useShareableLinkPage} from '@app/drive/shareable-link/queries/use-shareable-link-page';\nimport {FolderPreviewFileView} from './folder-preview-file-view';\nimport {Trans} from '@ui/i18n/trans';\nimport {FileUploadProvider} from '@common/uploads/uploader/file-upload-provider';\nimport {ShareableLinkPageActionButtons} from '@app/drive/shareable-link/shareable-link-page/shareable-link-page-action-buttons';\nimport {FolderPreviewHeader} from './folder-preview-header';\nimport shareSvg from './share.svg';\nimport clsx from 'clsx';\nimport {DashboardLayout} from '@common/ui/dashboard-layout/dashboard-layout';\nimport {DashboardNavbar} from '@common/ui/dashboard-layout/dashboard-navbar';\nimport {DashboardContentHeader} from '@common/ui/dashboard-layout/dashboard-content-header';\nimport {DashboardContent} from '@common/ui/dashboard-layout/dashboard-content';\nimport {IllustratedMessage} from '@ui/images/illustrated-message';\nimport {SvgImage} from '@ui/images/svg-image';\n\nexport function FolderPreview() {\n  const {entries, isFetched} = useShareableLinkPage();\n  const showEmptyMessage = isFetched && !entries?.length;\n\n  return (\n    <DashboardLayout name=\"folder-preview\">\n      <DashboardNavbar\n        hideToggleButton\n        rightChildren={<ShareableLinkPageActionButtons />}\n        color=\"bg\"\n      />\n      <DashboardContentHeader>\n        <FolderPreviewHeader />\n      </DashboardContentHeader>\n      <FileUploadProvider>\n        <DashboardContent>\n          {showEmptyMessage ? <EmptyMessage /> : <FolderPreviewFileView />}\n        </DashboardContent>\n      </FileUploadProvider>\n    </DashboardLayout>\n  );\n}\n\ninterface EmptyMessageProps {\n  className?: string;\n}\nfunction EmptyMessage({className}: EmptyMessageProps) {\n  return (\n    <IllustratedMessage\n      className={clsx(className, 'mt-80')}\n      image={<SvgImage src={shareSvg} />}\n      title={<Trans message=\"Folder is empty\" />}\n      description={\n        <Trans message=\"No files have been uploaded to this folder yet\" />\n      }\n    />\n  );\n}\n","import {linkPageState} from '@app/drive/shareable-link/shareable-link-page/link-page-store';\nimport {apiClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\n\ninterface Props {\n  password: string;\n  linkHash: string;\n}\n\nexport function useCheckLinkPassword() {\n  return useMutation({\n    mutationFn: ({password, linkHash}: Props) =>\n      apiClient\n        .post<{matches: boolean}>(\n          `shareable-link-page/${linkHash}/check-password`,\n          {\n            password,\n          },\n        )\n        .then(r => r.data),\n    onSuccess: (response, props) => {\n      if (response.matches) {\n        linkPageState().setPassword(props.password);\n      }\n    },\n    onError: err => showHttpErrorToast(err, message('Could not create link')),\n  });\n}\n","import React from 'react';\nimport {Navbar} from '@common/ui/navigation/navbar/navbar';\nimport {useShareableLinkPage} from '@app/drive/shareable-link/queries/use-shareable-link-page';\nimport {ShareableLinkPageActionButtons} from './shareable-link-page-action-buttons';\nimport {useIsMobileMediaQuery} from '@ui/utils/hooks/is-mobile-media-query';\nimport {FileTypeIcon} from '@common/uploads/components/file-type-icon/file-type-icon';\n\nexport function ShareableLinkNavbar() {\n  const {link} = useShareableLinkPage();\n  const isMobile = useIsMobileMediaQuery();\n  return (\n    <Navbar\n      size=\"md\"\n      color=\"bg\"\n      className=\"flex-shrink-0\"\n      rightChildren={link?.entry && <ShareableLinkPageActionButtons />}\n      menuPosition=\"shareable-link-page\"\n      hideLogo={isMobile}\n    >\n      {link?.entry && link.entry.type !== 'folder' && (\n        <div className=\"fex-auto flex min-w-0 items-center gap-10\">\n          <FileTypeIcon className=\"flex-shrink-0\" type={link.entry.type} />\n          <div className=\"flex-auto overflow-hidden overflow-ellipsis whitespace-nowrap font-medium\">\n            {link.entry.name}\n          </div>\n        </div>\n      )}\n    </Navbar>\n  );\n}\n","import {useState} from 'react';\nimport {TextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Button} from '@ui/buttons/button';\nimport {useCheckLinkPassword} from './queries/check-link-password';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {ShareableLinkNavbar} from './shareable-link-navbar';\nimport {useParams} from 'react-router';\nimport secureFilesSvg from '@common/auth/ui/account-settings/access-token-panel/secure-files.svg';\nimport {SvgImage} from '@ui/images/svg-image';\n\nexport function PasswordPage() {\n  const {trans} = useTrans();\n  const {hash} = useParams();\n  const fieldLabel = trans({message: 'Password'});\n  const [password, setPassword] = useState<string>('');\n  const checkPassword = useCheckLinkPassword();\n  const linkHash = hash ? hash.split(':')[0] : null;\n\n  const passwordIsInvalid = checkPassword.data && !checkPassword.data.matches;\n\n  return (\n    <div className=\"flex h-screen flex-col bg-alt\">\n      <ShareableLinkNavbar />\n      <div className=\"mx-auto my-80 px-10 md:px-20\">\n        <div className=\"flex max-w-[560px] flex-col items-center gap-40 rounded border bg p-24 md:flex-row md:gap-14\">\n          <div className=\"h-132 w-[165px]\">\n            <SvgImage src={secureFilesSvg} />\n          </div>\n          <form\n            onSubmit={e => {\n              e.preventDefault();\n              checkPassword.mutate({\n                linkHash: linkHash!,\n                password,\n              });\n            }}\n          >\n            <span className=\"text-sm\">\n              <Trans message=\"The link you are trying to access is password protected.\" />\n            </span>\n            <TextField\n              autoFocus\n              placeholder={fieldLabel}\n              aria-label={fieldLabel}\n              className=\"mb-20 mt-10\"\n              type=\"password\"\n              value={password}\n              required\n              errorMessage={\n                passwordIsInvalid && <Trans message=\"Password is not valid\" />\n              }\n              onChange={e => {\n                setPassword(e.target.value);\n              }}\n            />\n            <div className=\"text-right\">\n              <Button\n                variant=\"flat\"\n                color=\"primary\"\n                type=\"submit\"\n                className=\"w-full md:w-auto\"\n                disabled={checkPassword.isPending}\n              >\n                <Trans message=\"Enter\" />\n              </Button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport {useShareableLinkPage} from '@app/drive/shareable-link/queries/use-shareable-link-page';\nimport {ShareableLinkNavbar} from './shareable-link-navbar';\nimport {AdHost} from '@common/admin/ads/ad-host';\nimport {FilePreviewContainer} from '@common/uploads/components/file-preview/file-preview-container';\n\nexport function ShareableLinkPageFilePreview() {\n  const {link} = useShareableLinkPage();\n\n  if (!link?.entry) return null;\n\n  return (\n    <div className=\"flex h-screen flex-col bg-alt\">\n      <ShareableLinkNavbar />\n      <AdHost slot=\"file-preview\" className=\"mx-auto mt-24\" />\n      <FilePreviewContainer\n        entries={[link.entry]}\n        showHeader={false}\n        allowDownload={link.allow_download}\n      />\n    </div>\n  );\n}\n","import {useShareableLinkPage} from '@app/drive/shareable-link/queries/use-shareable-link-page';\nimport {FolderPreview} from '@app/drive/shareable-link/shareable-link-page/folder-preview/folder-preview';\nimport {useLinkPageStore} from '@app/drive/shareable-link/shareable-link-page/link-page-store';\nimport {PasswordPage} from '@app/drive/shareable-link/shareable-link-page/password-page';\nimport {NotFoundPage} from '@common/ui/not-found-page/not-found-page';\nimport {FileEntryUrlsContext} from '@common/uploads/file-entry-urls';\nimport {ActiveWorkspaceProvider} from '@common/workspace/active-workspace-id-context';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport {ReactElement} from 'react';\nimport {ShareableLinkPageFilePreview} from './shareable-link-page-file-preview';\n\nexport function Component() {\n  const {status, link} = useShareableLinkPage();\n  const {trans} = useTrans();\n  const isPasswordProtected = useLinkPageStore(s => s.isPasswordProtected);\n  const password = useLinkPageStore(s => s.password);\n\n  let content: ReactElement;\n\n  if (status === 'pending') {\n    content = (\n      <div className=\"flex h-screen flex-auto items-center justify-center\">\n        <ProgressCircle\n          aria-label={trans({message: 'Loading link'})}\n          isIndeterminate\n        />\n      </div>\n    );\n  } else if (!link && !isPasswordProtected) {\n    return <NotFoundPage />;\n  } else if (isPasswordProtected && !password) {\n    content = <PasswordPage />;\n  } else if (link?.entry?.type === 'folder') {\n    content = <FolderPreview />;\n  } else {\n    content = <ShareableLinkPageFilePreview />;\n  }\n\n  return (\n    <ActiveWorkspaceProvider>\n      <FileEntryUrlsContext.Provider\n        value={{shareable_link: link?.id, password}}\n      >\n        {content}\n      </FileEntryUrlsContext.Provider>\n    </ActiveWorkspaceProvider>\n  );\n}\n"],"names":["useLinkPageStore","create","immer","set","getFromLocalStorage","value","state","mode","setInLocalStorage","linkPageState","useShareableLinkPage","hash","useParams","sortDescriptor","s","isPasswordProtected","password","queryKey","buildQueryKey","query","useInfiniteQuery","pageParam","response","apiClient","data","_a","getBootstrapData","partialMatchKey","lastResponse","currentPage","lastPage","keepPreviousData","_b","p","order","appQueries","FolderPreviewFileGrid","entries","onEntrySelected","jsx","entry","index","BaseFileGridItem","e","mobileColumns","fileTableColumns","config","FolderPreviewFileTable","isMobile","useIsMobileMediaQuery","Table","item","buildFolderHash","link","folderHash","useNavigateToSubfolder","navigate","useNavigate","FolderPreviewFileView","className","pathname","useLocation","navigateToSubfolder","activePreviewIndex","setActivePreviewIndex","useState","viewMode","sentinelRef","useRef","isFetchingNextPage","hasNextPage","fetchNextPage","isPlaceholderData","useEffect","sentinelEl","observer","clsx","ProgressCircle","handlePreview","folderEntries","jsxs","Fragment","AdHost","AnimatePresence","m","opacityAnimation","DialogTrigger","FilePreviewDialog","importIntoOwnDrive","linkId","useImportIntoOwnDrive","useMutation","props","queryClient","toast","message","err","showHttpErrorToast","ShareableLinkPageActionButtons","user","isLoggedIn","useAuth","downloadUrl","useFileEntryUrls","alreadyImported","u","DownloadButton","MenuTrigger","key","downloadFileFromUrl","IconButton","KeyboardArrowDownIcon","Menu","MenuItem","FileDownloadIcon","Trans","ImportExportIcon","Tooltip","Button","FolderPreviewBreadcrumb","folder","useFolderPath","content","items","parent","Breadcrumb","BreadcrumbItem","FolderPreviewHeader","activeSort","isFetching","hasEntry","EntriesSortButton","GridViewIcon","FolderPreview","isFetched","showEmptyMessage","DashboardLayout","DashboardNavbar","DashboardContentHeader","FileUploadProvider","DashboardContent","EmptyMessage","IllustratedMessage","SvgImage","shareSvg","useCheckLinkPassword","linkHash","ShareableLinkNavbar","Navbar","FileTypeIcon","PasswordPage","trans","useTrans","fieldLabel","setPassword","checkPassword","passwordIsInvalid","secureFilesSvg","TextField","ShareableLinkPageFilePreview","FilePreviewContainer","Component","status","NotFoundPage","ActiveWorkspaceProvider","FileEntryUrlsContext"],"mappings":"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"}