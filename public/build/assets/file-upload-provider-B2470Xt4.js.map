{"version":3,"file":"file-upload-provider-B2470Xt4.js","sources":["../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.js","../../../node_modules/use-sync-external-store/shim/index.js","../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js","../../../node_modules/use-sync-external-store/shim/with-selector.js","../../../common/foundation/resources/client/uploads/uploader/create-file-upload.ts","../../../common/foundation/resources/client/core/settings/base-backend-settings.ts","../../../node_modules/wildcard/index.js","../../../node_modules/mime-match/index.js","../../../common/foundation/resources/client/ui/library/utils/files/validate-file.ts","../../../common/foundation/resources/client/uploads/uploader/progress-timeout.ts","../../../common/foundation/resources/client/uploads/uploader/strategy/axios-upload.ts","../../../node_modules/is-retry-allowed/index.js","../../../node_modules/axios-retry/dist/esm/index.js","../../../common/foundation/resources/client/uploads/uploader/strategy/s3-multipart-upload.ts","../../../common/foundation/resources/client/uploads/uploader/strategy/s3-upload.ts","../../../node_modules/react-use-cookie/dist/index.js","../../../node_modules/tus-js-client/lib.esm/error.js","../../../node_modules/tus-js-client/lib.esm/noopUrlStorage.js","../../../node_modules/js-base64/base64.mjs","../../../node_modules/requires-port/index.js","../../../node_modules/querystringify/index.js","../../../node_modules/url-parse/index.js","../../../node_modules/tus-js-client/lib.esm/uuid.js","../../../node_modules/tus-js-client/lib.esm/upload.js","../../../node_modules/tus-js-client/lib.esm/browser/isReactNative.js","../../../node_modules/tus-js-client/lib.esm/browser/uriToBlob.js","../../../node_modules/tus-js-client/lib.esm/browser/sources/isCordova.js","../../../node_modules/tus-js-client/lib.esm/browser/sources/readAsByteArray.js","../../../node_modules/tus-js-client/lib.esm/browser/sources/FileSource.js","../../../node_modules/tus-js-client/lib.esm/browser/sources/StreamSource.js","../../../node_modules/tus-js-client/lib.esm/browser/fileReader.js","../../../node_modules/tus-js-client/lib.esm/browser/fileSignature.js","../../../node_modules/tus-js-client/lib.esm/browser/httpStack.js","../../../node_modules/tus-js-client/lib.esm/browser/urlStorage.js","../../../node_modules/tus-js-client/lib.esm/browser/index.js","../../../common/foundation/resources/client/uploads/uploader/strategy/tus-upload.ts","../../../common/foundation/resources/client/uploads/uploader/start-uploading.tsx","../../../common/foundation/resources/client/uploads/uploader/file-upload-store.ts","../../../node_modules/zustand/esm/traditional.mjs","../../../common/foundation/resources/client/uploads/uploader/file-upload-provider.tsx"],"sourcesContent":["/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useState = React.useState,\n  useEffect = React.useEffect,\n  useLayoutEffect = React.useLayoutEffect,\n  useDebugValue = React.useDebugValue;\nfunction useSyncExternalStore$2(subscribe, getSnapshot) {\n  var value = getSnapshot(),\n    _useState = useState({ inst: { value: value, getSnapshot: getSnapshot } }),\n    inst = _useState[0].inst,\n    forceUpdate = _useState[1];\n  useLayoutEffect(\n    function () {\n      inst.value = value;\n      inst.getSnapshot = getSnapshot;\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n    },\n    [subscribe, value, getSnapshot]\n  );\n  useEffect(\n    function () {\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      return subscribe(function () {\n        checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      });\n    },\n    [subscribe]\n  );\n  useDebugValue(value);\n  return value;\n}\nfunction checkIfSnapshotChanged(inst) {\n  var latestGetSnapshot = inst.getSnapshot;\n  inst = inst.value;\n  try {\n    var nextValue = latestGetSnapshot();\n    return !objectIs(inst, nextValue);\n  } catch (error) {\n    return !0;\n  }\n}\nfunction useSyncExternalStore$1(subscribe, getSnapshot) {\n  return getSnapshot();\n}\nvar shim =\n  \"undefined\" === typeof window ||\n  \"undefined\" === typeof window.document ||\n  \"undefined\" === typeof window.document.createElement\n    ? useSyncExternalStore$1\n    : useSyncExternalStore$2;\nexports.useSyncExternalStore =\n  void 0 !== React.useSyncExternalStore ? React.useSyncExternalStore : shim;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\"),\n  shim = require(\"use-sync-external-store/shim\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useSyncExternalStore = shim.useSyncExternalStore,\n  useRef = React.useRef,\n  useEffect = React.useEffect,\n  useMemo = React.useMemo,\n  useDebugValue = React.useDebugValue;\nexports.useSyncExternalStoreWithSelector = function (\n  subscribe,\n  getSnapshot,\n  getServerSnapshot,\n  selector,\n  isEqual\n) {\n  var instRef = useRef(null);\n  if (null === instRef.current) {\n    var inst = { hasValue: !1, value: null };\n    instRef.current = inst;\n  } else inst = instRef.current;\n  instRef = useMemo(\n    function () {\n      function memoizedSelector(nextSnapshot) {\n        if (!hasMemo) {\n          hasMemo = !0;\n          memoizedSnapshot = nextSnapshot;\n          nextSnapshot = selector(nextSnapshot);\n          if (void 0 !== isEqual && inst.hasValue) {\n            var currentSelection = inst.value;\n            if (isEqual(currentSelection, nextSnapshot))\n              return (memoizedSelection = currentSelection);\n          }\n          return (memoizedSelection = nextSnapshot);\n        }\n        currentSelection = memoizedSelection;\n        if (objectIs(memoizedSnapshot, nextSnapshot)) return currentSelection;\n        var nextSelection = selector(nextSnapshot);\n        if (void 0 !== isEqual && isEqual(currentSelection, nextSelection))\n          return (memoizedSnapshot = nextSnapshot), currentSelection;\n        memoizedSnapshot = nextSnapshot;\n        return (memoizedSelection = nextSelection);\n      }\n      var hasMemo = !1,\n        memoizedSnapshot,\n        memoizedSelection,\n        maybeGetServerSnapshot =\n          void 0 === getServerSnapshot ? null : getServerSnapshot;\n      return [\n        function () {\n          return memoizedSelector(getSnapshot());\n        },\n        null === maybeGetServerSnapshot\n          ? void 0\n          : function () {\n              return memoizedSelector(maybeGetServerSnapshot());\n            }\n      ];\n    },\n    [getSnapshot, getServerSnapshot, selector, isEqual]\n  );\n  var value = useSyncExternalStore(subscribe, instRef[0], instRef[1]);\n  useEffect(\n    function () {\n      inst.hasValue = !0;\n      inst.value = value;\n    },\n    [value]\n  );\n  useDebugValue(value);\n  return value;\n};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","import {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\nimport {Restrictions} from '@ui/utils/files/validate-file';\nimport {FileUpload, FileUploadStoreOptions} from './file-upload-store';\nimport {UploadStrategyConfig} from './strategy/upload-strategy';\n\nexport function createUpload(\n  file: UploadedFile | File,\n  strategyConfig: UploadStrategyConfig,\n  storeOptions: FileUploadStoreOptions | undefined,\n): FileUpload {\n  let uploadedFile =\n    file instanceof UploadedFile ? file : new UploadedFile(file);\n  if (storeOptions?.modifyUploadedFile) {\n    uploadedFile = storeOptions.modifyUploadedFile(uploadedFile);\n  }\n  return {\n    file: uploadedFile,\n    percentage: 0,\n    bytesUploaded: 0,\n    status: 'pending',\n    options: {\n      ...strategyConfig,\n      restrictions: restrictionsFromConfig(strategyConfig),\n    },\n  };\n}\n\nexport function restrictionsFromConfig(\n  config: UploadStrategyConfig,\n): Restrictions | null {\n  if (config.restrictions) {\n    return config.restrictions;\n  }\n\n  const uploadType = getBootstrapData().uploading_types[config.uploadType];\n  if (uploadType.max_file_size || uploadType.accept) {\n    return {\n      maxFileSize: uploadType.max_file_size\n        ? parseInt(`${uploadType.max_file_size}`)\n        : undefined,\n      allowedFileTypes: uploadType.accept?.map(function (type) {\n        switch (type) {\n          case 'image':\n            return 'image/*';\n          case 'video':\n            return 'video/*';\n          case 'audio':\n            return 'audio/*';\n          default:\n            return type;\n        }\n      }),\n    };\n  }\n\n  return null;\n}\n","import {ImapConnectionCredentials} from '@common/admin/settings/pages/email-settings/incoming-email/imap-connection-credentials';\nimport {MenuConfig, MenuItemConfig} from '@common/menus/menu-config';\nimport {SectionConfig} from '@common/ui/landing-page/landing-page-config';\nimport {Settings} from '@ui/settings/settings';\n\nexport const DEFAULT_CHUNK_SIZE = 2097152; // 2MB\n\nexport type CaptchaAction = keyof NonNullable<\n  Required<Settings>['captcha']['enable']\n>;\n\nexport type UploadingBackendSettings = {\n  id: string;\n  name: string;\n  root?: string;\n  domain?: string;\n  type: string;\n  config?: Record<string, string | number>;\n};\n\nexport type UploadingTypeSettings = {\n  backends: string[];\n  root?: string;\n  max_file_size?: number;\n  accept?: string[];\n};\n\nexport interface BaseBackendSettings {\n  version: string;\n  branding: {\n    logo_light: string;\n    logo_dark: string;\n    logo_light_mobile: string;\n    logo_dark_mobile: string;\n    site_name: string;\n    site_description: string;\n    favicon: string;\n  };\n  landingPage?: {\n    sections?: SectionConfig[];\n  };\n  menus: MenuConfig[];\n  html_base_uri: string;\n  cookie_notice?: {\n    enable: boolean;\n    position: 'top' | 'bottom';\n    button?: MenuItemConfig;\n  };\n  logging: {\n    sentry_public?: string;\n  };\n  themes?: {\n    default_id?: number | string | null;\n    user_change: boolean;\n  };\n  custom_domains?: {\n    default_host?: string;\n    allow_select?: boolean;\n    allow_all_option?: boolean;\n  };\n  i18n: {\n    enable: boolean;\n    default_localization: string;\n  };\n  api?: {\n    integrated: boolean;\n  };\n  websockets?: {\n    integrated: boolean;\n  };\n  incoming_email?: {\n    integrated?: boolean;\n    imap?: {\n      connections?: ImapConnectionCredentials[];\n    };\n    mailgun?: {\n      enabled?: boolean;\n      verify?: boolean;\n    };\n    gmail?: {\n      enabled?: boolean;\n      topicName?: string;\n    };\n    pipe?: {\n      enabled?: boolean;\n    };\n    api?: {\n      enabled?: boolean;\n    };\n  };\n  billing: {\n    integrated: boolean;\n    enable: boolean;\n    paypal_test_mode: boolean;\n    stripe_public_key?: string;\n    invoice: {\n      address?: string;\n      notes?: string;\n    };\n    paypal: {\n      public_key: string;\n      enable: boolean;\n    };\n    stripe: {\n      enable: boolean;\n    };\n  };\n  notifications: {\n    integrated: boolean;\n  };\n  notif: {\n    subs: {\n      integrated: boolean;\n    };\n  };\n  site: {\n    hide_docs_button: boolean;\n    has_mobile_app: boolean;\n    demo: boolean;\n  };\n  registration?: {\n    disable?: boolean;\n    policies?: MenuItemConfig[];\n  };\n  social?: {\n    envato?: {\n      enable: boolean;\n    };\n    google?: {\n      enable: boolean;\n    };\n    twitter?: {\n      enable: boolean;\n    };\n    facebook?: {\n      enable: boolean;\n    };\n    compact_buttons: boolean;\n    requireAccount?: boolean;\n  };\n  auth?: {\n    domain_blacklist?: string;\n  };\n  workspaces: {\n    integrated: boolean;\n  };\n  uploading?: {\n    chunk_size?: number;\n    backends?: UploadingBackendSettings[];\n    types?: Record<string, UploadingTypeSettings>;\n  };\n  require_email_confirmation: boolean;\n  single_device_login: boolean;\n  mail?: {\n    contact_page_address?: string;\n    handler?: string;\n  };\n  captcha?: {\n    enable?: Record<'contact' | 'register', boolean>;\n    provider?: 'recaptcha' | 'turnstile';\n    g_site_key?: string;\n    g_secret_key?: string;\n    t_site_key?: string;\n    t_secret_key?: string;\n  };\n  broadcasting?: {\n    driver?: 'pusher' | 'reverb' | 'ably' | 'null' | 'log';\n    key?: string;\n    cluster?: string;\n    host?: string;\n    port?: number;\n    scheme?: string;\n  };\n  analytics?: {\n    tracking_code?: string;\n    gchart_api_key?: string;\n  };\n}\n","/* jshint node: true */\n'use strict';\n\n/**\n  # wildcard\n\n  Very simple wildcard matching, which is designed to provide the same\n  functionality that is found in the\n  [eve](https://github.com/adobe-webplatform/eve) eventing library.\n\n  ## Usage\n\n  It works with strings:\n\n  <<< examples/strings.js\n\n  Arrays:\n\n  <<< examples/arrays.js\n\n  Objects (matching against keys):\n\n  <<< examples/objects.js\n\n  While the library works in Node, if you are are looking for file-based\n  wildcard matching then you should have a look at:\n\n  <https://github.com/isaacs/node-glob>\n**/\n\nfunction WildcardMatcher(text, separator) {\n  this.text = text = text || '';\n  this.hasWild = ~text.indexOf('*');\n  this.separator = separator;\n  this.parts = text.split(separator);\n}\n\nWildcardMatcher.prototype.match = function(input) {\n  var matches = true;\n  var parts = this.parts;\n  var ii;\n  var partsCount = parts.length;\n  var testParts;\n\n  if (typeof input == 'string' || input instanceof String) {\n    if (!this.hasWild && this.text != input) {\n      matches = false;\n    } else {\n      testParts = (input || '').split(this.separator);\n      for (ii = 0; matches && ii < partsCount; ii++) {\n        if (parts[ii] === '*')  {\n          continue;\n        } else if (ii < testParts.length) {\n          matches = parts[ii] === testParts[ii];\n        } else {\n          matches = false;\n        }\n      }\n\n      // If matches, then return the component parts\n      matches = matches && testParts;\n    }\n  }\n  else if (typeof input.splice == 'function') {\n    matches = [];\n\n    for (ii = input.length; ii--; ) {\n      if (this.match(input[ii])) {\n        matches[matches.length] = input[ii];\n      }\n    }\n  }\n  else if (typeof input == 'object') {\n    matches = {};\n\n    for (var key in input) {\n      if (this.match(key)) {\n        matches[key] = input[key];\n      }\n    }\n  }\n\n  return matches;\n};\n\nmodule.exports = function(text, test, separator) {\n  var matcher = new WildcardMatcher(text, separator || /[\\/\\.]/);\n  if (typeof test != 'undefined') {\n    return matcher.match(test);\n  }\n\n  return matcher;\n};\n","var wildcard = require('wildcard');\nvar reMimePartSplit = /[\\/\\+\\.]/;\n\n/**\n  # mime-match\n\n  A simple function to checker whether a target mime type matches a mime-type\n  pattern (e.g. image/jpeg matches image/jpeg OR image/*).\n\n  ## Example Usage\n\n  <<< example.js\n\n**/\nmodule.exports = function(target, pattern) {\n  function test(pattern) {\n    var result = wildcard(pattern, target, reMimePartSplit);\n\n    // ensure that we have a valid mime type (should have two parts)\n    return result && result.length >= 2;\n  }\n\n  return pattern ? test(pattern.split(';')[0]) : test;\n};\n","import {message} from '@ui/i18n/message';\nimport {MessageDescriptor} from '@ui/i18n/message-descriptor';\nimport {prettyBytes} from '@ui/utils/files/pretty-bytes';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\nimport match from 'mime-match';\n\nexport interface Restrictions {\n  maxFileSize?: number;\n  allowedFileTypes?: string[];\n}\n\nexport function validateFile(\n  file: UploadedFile,\n  restrictions?: Restrictions | null,\n): MessageDescriptor | void {\n  if (!restrictions) return;\n\n  const {maxFileSize, allowedFileTypes} = restrictions;\n\n  if (maxFileSize && file.size != null && file.size > maxFileSize) {\n    return message('`:file` exceeds maximum allowed size of :size', {\n      values: {file: file.name, size: prettyBytes(maxFileSize)},\n    });\n  }\n\n  if (allowedFileTypes?.length) {\n    if (!fileMatchesTypes(file, allowedFileTypes)) {\n      return message('This file type is not allowed');\n    }\n  }\n}\n\nfunction fileMatchesTypes(file: UploadedFile, types: string[]): boolean {\n  return (\n    types\n      // support multiple file types in a string (video/mp4,audio/mp3,image/png)\n      .map(type => type.split(','))\n      .flat()\n      .some(type => {\n        // check if this is a mime-type\n        if (type.includes('/')) {\n          if (!file.mime) return false;\n          return match(file.mime.replace(/;.*?$/, ''), type);\n        }\n\n        // otherwise this is likely an extension\n        const extension = type.replace('.', '').toLowerCase();\n        if (extension && file.extension) {\n          return file.extension.toLowerCase() === extension;\n        }\n        return false;\n      })\n  );\n}\n","export class ProgressTimeout {\n  public aliveTimer: any;\n  public isDone = false;\n  public timeout = 30000;\n  public timeoutHandler: (() => void) | null = null;\n\n  progress() {\n    // Some browsers fire another progress event when the upload is\n    // cancelled, so we have to ignore progress after the timer was\n    // told to stop.\n    if (this.isDone || !this.timeoutHandler) return;\n\n    if (this.timeout > 0) {\n      clearTimeout(this.aliveTimer);\n      this.aliveTimer = setTimeout(this.timeoutHandler, this.timeout);\n    }\n  }\n\n  done() {\n    if (!this.isDone) {\n      clearTimeout(this.aliveTimer);\n      this.aliveTimer = null;\n      this.isDone = true;\n    }\n  }\n}\n","import {getAxiosErrorMessage} from '@common/http/get-axios-error-message';\nimport {apiClient} from '@common/http/query-client';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\nimport {AxiosProgressEvent} from 'axios';\nimport {\n  UploadStrategy,\n  UploadStrategyConfigWithBackend,\n} from './upload-strategy';\n\nexport class AxiosUpload implements UploadStrategy {\n  private abortController: AbortController;\n  constructor(\n    private file: UploadedFile,\n    private config: UploadStrategyConfigWithBackend,\n  ) {\n    this.abortController = new AbortController();\n  }\n\n  async start() {\n    const formData = new FormData();\n    const {onSuccess, onError, onProgress, metadata} = this.config;\n\n    formData.set('file', this.file.native);\n    formData.set('clientMime', this.file.mime);\n    formData.set('clientExtension', this.file.extension);\n    formData.set('uploadType', this.config.uploadType);\n    formData.set('backendId', this.config.backendId);\n\n    if (metadata) {\n      Object.entries(metadata).forEach(([key, value]) => {\n        formData.set(key, `${value}`);\n      });\n    }\n\n    const response = await apiClient\n      .post('file-entries', formData, {\n        onUploadProgress: (e: AxiosProgressEvent) => {\n          if (e.event.lengthComputable) {\n            onProgress?.({\n              bytesUploaded: e.loaded,\n              bytesTotal: e.total || 0,\n            });\n          }\n        },\n        signal: this.abortController.signal,\n        headers: {\n          'Content-Type': 'multipart/form-data',\n        },\n      })\n      .catch(err => {\n        if (err.code !== 'ERR_CANCELED') {\n          onError?.(getAxiosErrorMessage(err), this.file);\n        }\n      });\n\n    // if upload was aborted, it will be handled and set\n    // as \"aborted\" already, no need to set it as \"failed\"\n    if (this.abortController.signal.aborted) {\n      return;\n    }\n\n    if (response && response.data.fileEntry) {\n      onSuccess?.(response.data.fileEntry, this.file);\n    }\n  }\n\n  abort() {\n    this.abortController.abort();\n    return Promise.resolve();\n  }\n\n  static async create(\n    file: UploadedFile,\n    config: UploadStrategyConfigWithBackend,\n  ): Promise<AxiosUpload> {\n    return new AxiosUpload(file, config);\n  }\n}\n","'use strict';\n\nconst denyList = new Set([\n\t'ENOTFOUND',\n\t'ENETUNREACH',\n\n\t// SSL errors from https://github.com/nodejs/node/blob/fc8e3e2cdc521978351de257030db0076d79e0ab/src/crypto/crypto_common.cc#L301-L328\n\t'UNABLE_TO_GET_ISSUER_CERT',\n\t'UNABLE_TO_GET_CRL',\n\t'UNABLE_TO_DECRYPT_CERT_SIGNATURE',\n\t'UNABLE_TO_DECRYPT_CRL_SIGNATURE',\n\t'UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY',\n\t'CERT_SIGNATURE_FAILURE',\n\t'CRL_SIGNATURE_FAILURE',\n\t'CERT_NOT_YET_VALID',\n\t'CERT_HAS_EXPIRED',\n\t'CRL_NOT_YET_VALID',\n\t'CRL_HAS_EXPIRED',\n\t'ERROR_IN_CERT_NOT_BEFORE_FIELD',\n\t'ERROR_IN_CERT_NOT_AFTER_FIELD',\n\t'ERROR_IN_CRL_LAST_UPDATE_FIELD',\n\t'ERROR_IN_CRL_NEXT_UPDATE_FIELD',\n\t'OUT_OF_MEM',\n\t'DEPTH_ZERO_SELF_SIGNED_CERT',\n\t'SELF_SIGNED_CERT_IN_CHAIN',\n\t'UNABLE_TO_GET_ISSUER_CERT_LOCALLY',\n\t'UNABLE_TO_VERIFY_LEAF_SIGNATURE',\n\t'CERT_CHAIN_TOO_LONG',\n\t'CERT_REVOKED',\n\t'INVALID_CA',\n\t'PATH_LENGTH_EXCEEDED',\n\t'INVALID_PURPOSE',\n\t'CERT_UNTRUSTED',\n\t'CERT_REJECTED',\n\t'HOSTNAME_MISMATCH'\n]);\n\n// TODO: Use `error?.code` when targeting Node.js 14\nmodule.exports = error => !denyList.has(error && error.code);\n","import isRetryAllowed from 'is-retry-allowed';\nexport const namespace = 'axios-retry';\nexport function isNetworkError(error) {\n    const CODE_EXCLUDE_LIST = ['ERR_CANCELED', 'ECONNABORTED'];\n    if (error.response) {\n        return false;\n    }\n    if (!error.code) {\n        return false;\n    }\n    // Prevents retrying timed out & cancelled requests\n    if (CODE_EXCLUDE_LIST.includes(error.code)) {\n        return false;\n    }\n    // Prevents retrying unsafe errors\n    return isRetryAllowed(error);\n}\nconst SAFE_HTTP_METHODS = ['get', 'head', 'options'];\nconst IDEMPOTENT_HTTP_METHODS = SAFE_HTTP_METHODS.concat(['put', 'delete']);\nexport function isRetryableError(error) {\n    return (error.code !== 'ECONNABORTED' &&\n        (!error.response ||\n            error.response.status === 429 ||\n            (error.response.status >= 500 && error.response.status <= 599)));\n}\nexport function isSafeRequestError(error) {\n    if (!error.config?.method) {\n        // Cannot determine if the request can be retried\n        return false;\n    }\n    return isRetryableError(error) && SAFE_HTTP_METHODS.indexOf(error.config.method) !== -1;\n}\nexport function isIdempotentRequestError(error) {\n    if (!error.config?.method) {\n        // Cannot determine if the request can be retried\n        return false;\n    }\n    return isRetryableError(error) && IDEMPOTENT_HTTP_METHODS.indexOf(error.config.method) !== -1;\n}\nexport function isNetworkOrIdempotentRequestError(error) {\n    return isNetworkError(error) || isIdempotentRequestError(error);\n}\nexport function retryAfter(error = undefined) {\n    const retryAfterHeader = error?.response?.headers['retry-after'];\n    if (!retryAfterHeader) {\n        return 0;\n    }\n    // if the retry after header is a number, convert it to milliseconds\n    let retryAfterMs = (Number(retryAfterHeader) || 0) * 1000;\n    // If the retry after header is a date, get the number of milliseconds until that date\n    if (retryAfterMs === 0) {\n        retryAfterMs = (new Date(retryAfterHeader).valueOf() || 0) - Date.now();\n    }\n    return Math.max(0, retryAfterMs);\n}\nfunction noDelay(_retryNumber = 0, error = undefined) {\n    return Math.max(0, retryAfter(error));\n}\nexport function exponentialDelay(retryNumber = 0, error = undefined, delayFactor = 100) {\n    const calculatedDelay = 2 ** retryNumber * delayFactor;\n    const delay = Math.max(calculatedDelay, retryAfter(error));\n    const randomSum = delay * 0.2 * Math.random(); // 0-20% of the delay\n    return delay + randomSum;\n}\n/**\n * Linear delay\n * @param {number | undefined} delayFactor - delay factor in milliseconds (default: 100)\n * @returns {function} (retryNumber: number, error: AxiosError | undefined) => number\n */\nexport function linearDelay(delayFactor = 100) {\n    return (retryNumber = 0, error = undefined) => {\n        const delay = retryNumber * delayFactor;\n        return Math.max(delay, retryAfter(error));\n    };\n}\nexport const DEFAULT_OPTIONS = {\n    retries: 3,\n    retryCondition: isNetworkOrIdempotentRequestError,\n    retryDelay: noDelay,\n    shouldResetTimeout: false,\n    onRetry: () => { },\n    onMaxRetryTimesExceeded: () => { },\n    validateResponse: null\n};\nfunction getRequestOptions(config, defaultOptions) {\n    return { ...DEFAULT_OPTIONS, ...defaultOptions, ...config[namespace] };\n}\nfunction setCurrentState(config, defaultOptions, resetLastRequestTime = false) {\n    const currentState = getRequestOptions(config, defaultOptions || {});\n    currentState.retryCount = currentState.retryCount || 0;\n    if (!currentState.lastRequestTime || resetLastRequestTime) {\n        currentState.lastRequestTime = Date.now();\n    }\n    config[namespace] = currentState;\n    return currentState;\n}\nfunction fixConfig(axiosInstance, config) {\n    // @ts-ignore\n    if (axiosInstance.defaults.agent === config.agent) {\n        // @ts-ignore\n        delete config.agent;\n    }\n    if (axiosInstance.defaults.httpAgent === config.httpAgent) {\n        delete config.httpAgent;\n    }\n    if (axiosInstance.defaults.httpsAgent === config.httpsAgent) {\n        delete config.httpsAgent;\n    }\n}\nasync function shouldRetry(currentState, error) {\n    const { retries, retryCondition } = currentState;\n    const shouldRetryOrPromise = (currentState.retryCount || 0) < retries && retryCondition(error);\n    // This could be a promise\n    if (typeof shouldRetryOrPromise === 'object') {\n        try {\n            const shouldRetryPromiseResult = await shouldRetryOrPromise;\n            // keep return true unless shouldRetryPromiseResult return false for compatibility\n            return shouldRetryPromiseResult !== false;\n        }\n        catch (_err) {\n            return false;\n        }\n    }\n    return shouldRetryOrPromise;\n}\nasync function handleRetry(axiosInstance, currentState, error, config) {\n    currentState.retryCount += 1;\n    const { retryDelay, shouldResetTimeout, onRetry } = currentState;\n    const delay = retryDelay(currentState.retryCount, error);\n    // Axios fails merging this configuration to the default configuration because it has an issue\n    // with circular structures: https://github.com/mzabriskie/axios/issues/370\n    fixConfig(axiosInstance, config);\n    if (!shouldResetTimeout && config.timeout && currentState.lastRequestTime) {\n        const lastRequestDuration = Date.now() - currentState.lastRequestTime;\n        const timeout = config.timeout - lastRequestDuration - delay;\n        if (timeout <= 0) {\n            return Promise.reject(error);\n        }\n        config.timeout = timeout;\n    }\n    config.transformRequest = [(data) => data];\n    await onRetry(currentState.retryCount, error, config);\n    if (config.signal?.aborted) {\n        return Promise.resolve(axiosInstance(config));\n    }\n    return new Promise((resolve) => {\n        const abortListener = () => {\n            clearTimeout(timeout);\n            resolve(axiosInstance(config));\n        };\n        const timeout = setTimeout(() => {\n            resolve(axiosInstance(config));\n            if (config.signal?.removeEventListener) {\n                config.signal.removeEventListener('abort', abortListener);\n            }\n        }, delay);\n        if (config.signal?.addEventListener) {\n            config.signal.addEventListener('abort', abortListener, { once: true });\n        }\n    });\n}\nasync function handleMaxRetryTimesExceeded(currentState, error) {\n    if (currentState.retryCount >= currentState.retries)\n        await currentState.onMaxRetryTimesExceeded(error, currentState.retryCount);\n}\nconst axiosRetry = (axiosInstance, defaultOptions) => {\n    const requestInterceptorId = axiosInstance.interceptors.request.use((config) => {\n        setCurrentState(config, defaultOptions, true);\n        if (config[namespace]?.validateResponse) {\n            // by setting this, all HTTP responses will be go through the error interceptor first\n            config.validateStatus = () => false;\n        }\n        return config;\n    });\n    const responseInterceptorId = axiosInstance.interceptors.response.use(null, async (error) => {\n        const { config } = error;\n        // If we have no information to retry the request\n        if (!config) {\n            return Promise.reject(error);\n        }\n        const currentState = setCurrentState(config, defaultOptions);\n        if (error.response && currentState.validateResponse?.(error.response)) {\n            // no issue with response\n            return error.response;\n        }\n        if (await shouldRetry(currentState, error)) {\n            return handleRetry(axiosInstance, currentState, error, config);\n        }\n        await handleMaxRetryTimesExceeded(currentState, error);\n        return Promise.reject(error);\n    });\n    return { requestInterceptorId, responseInterceptorId };\n};\n// Compatibility with CommonJS\naxiosRetry.isNetworkError = isNetworkError;\naxiosRetry.isSafeRequestError = isSafeRequestError;\naxiosRetry.isIdempotentRequestError = isIdempotentRequestError;\naxiosRetry.isNetworkOrIdempotentRequestError = isNetworkOrIdempotentRequestError;\naxiosRetry.exponentialDelay = exponentialDelay;\naxiosRetry.linearDelay = linearDelay;\naxiosRetry.isRetryableError = isRetryableError;\nexport default axiosRetry;\n","import {getAxiosErrorMessage} from '@common/http/get-axios-error-message';\nimport {apiClient} from '@common/http/query-client';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\nimport {\n  getFromLocalStorage,\n  removeFromLocalStorage,\n  setInLocalStorage,\n} from '@ui/utils/hooks/local-storage';\nimport axios, {AxiosInstance, AxiosProgressEvent} from 'axios';\nimport axiosRetry from 'axios-retry';\nimport {FileEntry} from '../../file-entry';\nimport {\n  UploadStrategy,\n  UploadStrategyConfigWithBackend,\n} from './upload-strategy';\n\nconst oneMB = 1024 * 1024;\n// chunk size that will be uploaded to s3 per request\nconst desiredChunkSize = 20 * oneMB;\n// how many urls should be pre-signed per call to backend\nconst batchSize = 10;\n// number of concurrent requests to s3 api\nconst concurrency = 5;\n\ninterface ChunkState {\n  blob: Blob | File;\n  done: boolean;\n  etag?: string;\n  partNumber: number;\n  bytesUploaded: number;\n}\n\ninterface SignedUrl {\n  url: string;\n  partNumber: number;\n}\n\ninterface StoredUrl {\n  createdAt: string;\n  uploadId: string;\n  fileKey: string;\n}\n\ninterface UploadedPart {\n  PartNumber: number;\n  ETag: string;\n  Size: string;\n  LastModified: string;\n}\n\nexport class S3MultipartUpload implements UploadStrategy {\n  private abortController: AbortController;\n  private chunks: ChunkState[] = [];\n  private uploadId?: string;\n  private fileKey?: string;\n  private readonly chunkAxios: AxiosInstance;\n  private abortedByUser = false;\n  private uploadedParts?: UploadedPart[];\n\n  get storageKey(): string {\n    return `s3-multipart::${this.file.fingerprint}`;\n  }\n\n  constructor(\n    private file: UploadedFile,\n    private config: UploadStrategyConfigWithBackend,\n  ) {\n    this.abortController = new AbortController();\n    this.chunkAxios = axios.create();\n    axiosRetry(this.chunkAxios, {retries: 3});\n  }\n\n  async start() {\n    const storedUrl = getFromLocalStorage<StoredUrl>(this.storageKey);\n    if (storedUrl) {\n      await this.getUploadedParts(storedUrl);\n    }\n\n    if (!this.uploadedParts?.length) {\n      await this.createMultipartUpload();\n      if (!this.uploadId) return;\n    }\n\n    this.prepareChunks();\n\n    const result = await this.uploadParts();\n    if (result === 'done') {\n      const isCompleted = await this.completeMultipartUpload();\n      if (!isCompleted) return;\n\n      // catch any errors so below \"onError\" handler gets executed\n      try {\n        const response = await this.createFileEntry();\n        if (response?.fileEntry) {\n          this.config.onSuccess?.(response?.fileEntry, this.file);\n          removeFromLocalStorage(this.storageKey);\n          return;\n        }\n      } catch {}\n    }\n\n    // upload failed\n    if (!this.abortController.signal.aborted) {\n      this.abortController.abort();\n    }\n    if (!this.abortedByUser) {\n      this.config.onError?.(null, this.file);\n    }\n  }\n\n  async abort() {\n    this.abortedByUser = true;\n    this.abortController.abort();\n    await this.abortUploadOnS3();\n  }\n\n  private async uploadParts(): Promise<any> {\n    const pendingChunks = this.chunks.filter(c => !c.done);\n    if (!pendingChunks.length) {\n      return Promise.resolve('done');\n    }\n\n    const signedUrls = await this.batchSignUrls(\n      pendingChunks.slice(0, batchSize),\n    );\n    if (!signedUrls) return;\n\n    while (signedUrls.length) {\n      const batch = signedUrls.splice(0, concurrency);\n      const pendingUploads = batch.map(item => {\n        return this.uploadPartToS3(item);\n      });\n      const result = await Promise.all(pendingUploads);\n      // if not all uploads in batch completed, bail\n      if (!result.every(r => r)) return;\n    }\n\n    return await this.uploadParts();\n  }\n\n  private async batchSignUrls(\n    batch: ChunkState[],\n  ): Promise<SignedUrl[] | undefined> {\n    const response = await this.chunkAxios\n      .post(\n        'api/v1/s3/multipart/batch-sign-part-urls',\n        {\n          backendId: this.config.backendId,\n          uploadType: this.config.uploadType,\n          partNumbers: batch.map(i => i.partNumber),\n          uploadId: this.uploadId,\n          key: this.fileKey,\n        },\n        {signal: this.abortController.signal},\n      )\n      .then(r => r.data as {urls: SignedUrl[]})\n      .catch(err => {\n        if (!this.abortController.signal.aborted) {\n          this.abortController.abort();\n        }\n      });\n\n    return response?.urls;\n  }\n\n  private async uploadPartToS3({\n    url,\n    partNumber,\n  }: SignedUrl): Promise<boolean | void> {\n    const chunk = this.chunks.find(c => c.partNumber === partNumber);\n    if (!chunk) return;\n    return this.chunkAxios\n      .put(url, chunk.blob, {\n        withCredentials: false,\n        signal: this.abortController.signal,\n        onUploadProgress: (e: AxiosProgressEvent) => {\n          if (!e.event.lengthComputable) return;\n\n          chunk.bytesUploaded = e.loaded;\n          const totalUploaded = this.chunks.reduce(\n            (n, c) => n + c.bytesUploaded,\n            0,\n          );\n\n          this.config.onProgress?.({\n            bytesUploaded: totalUploaded,\n            bytesTotal: this.file.size,\n          });\n        },\n      })\n      .then(r => {\n        const etag = r.headers.etag;\n        if (etag) {\n          chunk.done = true;\n          chunk.etag = etag;\n          return true;\n        }\n      })\n      .catch(err => {\n        if (!this.abortController.signal.aborted && err !== undefined) {\n          this.abortController.abort();\n        }\n      });\n  }\n\n  private async createMultipartUpload(): Promise<void> {\n    const response = await apiClient\n      .post('s3/multipart/create', {\n        clientName: this.file.name,\n        clientMime: this.file.mime,\n        clientSize: this.file.size,\n        clientExtension: this.file.extension,\n        uploadType: this.config.uploadType,\n        backendId: this.config.backendId,\n        ...this.config.metadata,\n      })\n      .then(r => r.data as {uploadId: string; key: string})\n      .catch(err => {\n        if (err.code !== 'ERR_CANCELED') {\n          this.config.onError?.(getAxiosErrorMessage(err), this.file);\n        }\n      });\n\n    if (response) {\n      this.uploadId = response.uploadId;\n      this.fileKey = response.key;\n      setInLocalStorage(this.storageKey, {\n        createdAt: new Date().toISOString(),\n        fileKey: this.fileKey,\n        uploadId: this.uploadId,\n      } as StoredUrl);\n    }\n  }\n\n  private async getUploadedParts({fileKey, uploadId}: StoredUrl) {\n    const response = await apiClient\n      .post('s3/multipart/get-uploaded-parts', {\n        backendId: this.config.backendId,\n        uploadType: this.config.uploadType,\n        key: fileKey,\n        uploadId,\n      })\n      .then(r => r.data as {parts: UploadedPart[]})\n      .catch(() => {\n        removeFromLocalStorage(this.storageKey);\n        return null;\n      });\n    if (response?.parts?.length) {\n      this.uploadedParts = response.parts;\n      this.uploadId = uploadId;\n      this.fileKey = fileKey;\n    }\n  }\n\n  private async completeMultipartUpload(): Promise<{location: string} | null> {\n    return apiClient\n      .post('s3/multipart/complete', {\n        backendId: this.config.backendId,\n        uploadType: this.config.uploadType,\n        key: this.fileKey,\n        uploadId: this.uploadId,\n        parts: this.chunks.map(c => {\n          return {\n            ETag: c.etag,\n            PartNumber: c.partNumber,\n          };\n        }),\n      })\n      .then(r => r.data)\n      .catch(() => {\n        this.config.onError?.(null, this.file);\n        this.abortUploadOnS3();\n      })\n      .finally(() => {\n        removeFromLocalStorage(this.storageKey);\n      });\n  }\n\n  private async createFileEntry(): Promise<{fileEntry: FileEntry}> {\n    return await apiClient\n      .post('s3/entries', {\n        ...this.config.metadata,\n        clientMime: this.file.mime,\n        clientName: this.file.name,\n        clientSize: this.file.size,\n        clientExtension: this.file.extension,\n        filename: this.fileKey!.split('/').pop(),\n        uploadType: this.config.uploadType,\n        backendId: this.config.backendId,\n      })\n      .then(r => r.data)\n      .catch();\n  }\n\n  private prepareChunks() {\n    this.chunks = [];\n    // at least 5MB per request, at most 10k requests\n    const minChunkSize = Math.max(5 * oneMB, Math.ceil(this.file.size / 10000));\n    const chunkSize = Math.max(desiredChunkSize, minChunkSize);\n\n    // Upload zero-sized files in one zero-sized chunk\n    if (this.file.size === 0) {\n      this.chunks.push({\n        blob: this.file.native,\n        done: false,\n        partNumber: 1,\n        bytesUploaded: 0,\n      });\n    } else {\n      let partNumber = 1;\n      for (let i = 0; i < this.file.size; i += chunkSize) {\n        const end = Math.min(this.file.size, i + chunkSize);\n        // check if this part was already uploaded previously\n        const previouslyUploaded = this.uploadedParts?.find(\n          p => p.PartNumber === partNumber,\n        );\n        this.chunks.push({\n          blob: this.file.native.slice(i, end),\n          done: !!previouslyUploaded,\n          partNumber,\n          etag: previouslyUploaded ? previouslyUploaded.ETag : undefined,\n          bytesUploaded: previouslyUploaded?.Size\n            ? parseInt(previouslyUploaded?.Size)\n            : 0,\n        });\n        partNumber++;\n      }\n    }\n  }\n\n  private abortUploadOnS3() {\n    return apiClient.post('s3/multipart/abort', {\n      key: this.fileKey,\n      uploadId: this.uploadId,\n    });\n  }\n\n  static async create(\n    file: UploadedFile,\n    config: UploadStrategyConfigWithBackend,\n  ): Promise<S3MultipartUpload> {\n    return new S3MultipartUpload(file, config);\n  }\n}\n","import {getAxiosErrorMessage} from '@common/http/get-axios-error-message';\nimport {apiClient} from '@common/http/query-client';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\nimport axios, {AxiosProgressEvent} from 'axios';\nimport {FileEntry} from '../../file-entry';\nimport {\n  UploadStrategy,\n  UploadStrategyConfigWithBackend,\n} from './upload-strategy';\n\ninterface PresignedRequest {\n  url: string;\n  key: string;\n  acl: string;\n}\n\nexport class S3Upload implements UploadStrategy {\n  private abortController: AbortController;\n  private presignedRequest?: PresignedRequest;\n\n  constructor(\n    private file: UploadedFile,\n    private config: UploadStrategyConfigWithBackend,\n  ) {\n    this.abortController = new AbortController();\n  }\n\n  async start() {\n    this.presignedRequest = await this.presignPostUrl();\n    if (!this.presignedRequest) return;\n\n    const result = await this.uploadFileToS3();\n    if (result !== 'uploaded') return;\n\n    const response = await this.createFileEntry();\n    if (response?.fileEntry) {\n      this.config.onSuccess?.(response.fileEntry, this.file);\n    } else if (!this.abortController.signal) {\n      this.config.onError?.(null, this.file);\n    }\n  }\n\n  abort() {\n    this.abortController.abort();\n    return Promise.resolve();\n  }\n\n  private presignPostUrl(): Promise<PresignedRequest> {\n    return apiClient\n      .post(\n        's3/simple/presign',\n        {\n          clientName: this.file.name,\n          clientMime: this.file.mime,\n          clientSize: this.file.size,\n          clientExtension: this.file.extension,\n          uploadType: this.config.uploadType,\n          backendId: this.config.backendId,\n          ...this.config.metadata,\n        },\n        {signal: this.abortController.signal},\n      )\n      .then(r => r.data)\n      .catch(err => {\n        if (err.code !== 'ERR_CANCELED') {\n          this.config.onError?.(getAxiosErrorMessage(err), this.file);\n        }\n      });\n  }\n\n  private uploadFileToS3() {\n    const {url, acl} = this.presignedRequest!;\n    return axios\n      .put(url, this.file.native, {\n        signal: this.abortController.signal,\n        withCredentials: false,\n        headers: {\n          'Content-Type': this.file.mime,\n          'x-amz-acl': acl,\n        },\n        onUploadProgress: (e: AxiosProgressEvent) => {\n          if (e.event.lengthComputable) {\n            this.config.onProgress?.({\n              bytesUploaded: e.loaded,\n              bytesTotal: e.total || 0,\n            });\n          }\n        },\n      })\n      .then(() => 'uploaded')\n      .catch(err => {\n        if (err.code !== 'ERR_CANCELED') {\n          this.config.onError?.(getAxiosErrorMessage(err), this.file);\n        }\n      });\n  }\n\n  private async createFileEntry() {\n    return await apiClient\n      .post('s3/entries', {\n        ...this.config.metadata,\n        clientMime: this.file.mime,\n        clientName: this.file.name,\n        clientSize: this.file.size,\n        clientExtension: this.file.extension,\n        filename: this.presignedRequest!.key.split('/').pop(),\n        uploadType: this.config.uploadType,\n        backendId: this.config.backendId,\n      })\n      .then(r => {\n        return r.data as {fileEntry: FileEntry};\n      })\n      .catch(err => {\n        if (err.code !== 'ERR_CANCELED') {\n          this.config.onError?.(getAxiosErrorMessage(err), this.file);\n        }\n      });\n  }\n\n  static async create(\n    file: UploadedFile,\n    config: UploadStrategyConfigWithBackend,\n  ): Promise<S3Upload> {\n    return new S3Upload(file, config);\n  }\n}\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = _default;\nexports.setCookie = exports.removeCookie = exports.getCookie = void 0;\nexports.stringifyOptions = stringifyOptions;\nvar _react = require(\"react\");\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nvar isBrowser = typeof window !== 'undefined';\nfunction stringifyOptions(options) {\n  return Object.keys(options).reduce(function (acc, key) {\n    if (key === 'days') {\n      return acc;\n    } else {\n      if (options[key] === false) {\n        return acc;\n      } else if (options[key] === true) {\n        return \"\".concat(acc, \"; \").concat(key);\n      } else {\n        return \"\".concat(acc, \"; \").concat(key, \"=\").concat(options[key]);\n      }\n    }\n  }, '');\n}\nvar setCookie = function setCookie(name, value, options) {\n  if (!isBrowser) return;\n  var optionsWithDefaults = _objectSpread({\n    days: 7,\n    path: '/'\n  }, options);\n  var expires = new Date(Date.now() + optionsWithDefaults.days * 864e5).toUTCString();\n  document.cookie = name + '=' + encodeURIComponent(value) + '; expires=' + expires + stringifyOptions(optionsWithDefaults);\n};\nexports.setCookie = setCookie;\nvar getCookie = function getCookie(name) {\n  var initialValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  return isBrowser && document.cookie.split('; ').reduce(function (r, v) {\n    var parts = v.split('=');\n    return parts[0] === name ? decodeURIComponent(parts[1]) : r;\n  }, '') || initialValue;\n};\nexports.getCookie = getCookie;\nvar removeCookie = function removeCookie(name) {\n  document.cookie = \"\".concat(name, \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\");\n};\nexports.removeCookie = removeCookie;\nfunction _default(key, initialValue) {\n  var _useState = (0, _react.useState)(function () {\n      return getCookie(key, initialValue);\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    item = _useState2[0],\n    setItem = _useState2[1];\n  var removeItem = (0, _react.useCallback)(function () {\n    setItem(undefined);\n    removeCookie(key);\n  }, [key]);\n  var updateItem = (0, _react.useCallback)(function (value, options) {\n    setItem(value);\n    setCookie(key, value, options);\n  }, [key]);\n  return [item, updateItem, removeItem];\n}","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === \"function\" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== \"function\") { throw new TypeError(\"Super expression must either be null or a function\"); } if (typeof _cache !== \"undefined\") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\nfunction _construct(t, e, r) { if (_isNativeReflectConstruct()) return Reflect.construct.apply(null, arguments); var o = [null]; o.push.apply(o, e); var p = new (t.bind.apply(t, o))(); return r && _setPrototypeOf(p, r.prototype), p; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _isNativeFunction(fn) { try { return Function.toString.call(fn).indexOf(\"[native code]\") !== -1; } catch (e) { return typeof fn === \"function\"; } }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nvar DetailedError = /*#__PURE__*/function (_Error) {\n  function DetailedError(message) {\n    var _this;\n    var causingErr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var req = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var res = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    _classCallCheck(this, DetailedError);\n    _this = _callSuper(this, DetailedError, [message]);\n    _this.originalRequest = req;\n    _this.originalResponse = res;\n    _this.causingError = causingErr;\n    if (causingErr != null) {\n      message += \", caused by \".concat(causingErr.toString());\n    }\n    if (req != null) {\n      var requestId = req.getHeader('X-Request-ID') || 'n/a';\n      var method = req.getMethod();\n      var url = req.getURL();\n      var status = res ? res.getStatus() : 'n/a';\n      var body = res ? res.getBody() || '' : 'n/a';\n      message += \", originated from request (method: \".concat(method, \", url: \").concat(url, \", response code: \").concat(status, \", response text: \").concat(body, \", request id: \").concat(requestId, \")\");\n    }\n    _this.message = message;\n    return _this;\n  }\n  _inherits(DetailedError, _Error);\n  return _createClass(DetailedError);\n}( /*#__PURE__*/_wrapNativeSuper(Error));\nexport default DetailedError;","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar NoopUrlStorage = /*#__PURE__*/function () {\n  function NoopUrlStorage() {\n    _classCallCheck(this, NoopUrlStorage);\n  }\n  return _createClass(NoopUrlStorage, [{\n    key: \"listAllUploads\",\n    value: function listAllUploads() {\n      return Promise.resolve([]);\n    }\n  }, {\n    key: \"findUploadsByFingerprint\",\n    value: function findUploadsByFingerprint(_fingerprint) {\n      return Promise.resolve([]);\n    }\n  }, {\n    key: \"removeUpload\",\n    value: function removeUpload(_urlStorageKey) {\n      return Promise.resolve();\n    }\n  }, {\n    key: \"addUpload\",\n    value: function addUpload(_fingerprint, _upload) {\n      return Promise.resolve(null);\n    }\n  }]);\n}();\nexport { NoopUrlStorage as default };","/**\n *  base64.ts\n *\n *  Licensed under the BSD 3-Clause License.\n *    http://opensource.org/licenses/BSD-3-Clause\n *\n *  References:\n *    http://en.wikipedia.org/wiki/Base64\n *\n * @author Dan Kogai (https://github.com/dankogai)\n */\nconst version = '3.7.8';\n/**\n * @deprecated use lowercase `version`.\n */\nconst VERSION = version;\nconst _hasBuffer = typeof Buffer === 'function';\nconst _TD = typeof TextDecoder === 'function' ? new TextDecoder() : undefined;\nconst _TE = typeof TextEncoder === 'function' ? new TextEncoder() : undefined;\nconst b64ch = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nconst b64chs = Array.prototype.slice.call(b64ch);\nconst b64tab = ((a) => {\n    let tab = {};\n    a.forEach((c, i) => tab[c] = i);\n    return tab;\n})(b64chs);\nconst b64re = /^(?:[A-Za-z\\d+\\/]{4})*?(?:[A-Za-z\\d+\\/]{2}(?:==)?|[A-Za-z\\d+\\/]{3}=?)?$/;\nconst _fromCC = String.fromCharCode.bind(String);\nconst _U8Afrom = typeof Uint8Array.from === 'function'\n    ? Uint8Array.from.bind(Uint8Array)\n    : (it) => new Uint8Array(Array.prototype.slice.call(it, 0));\nconst _mkUriSafe = (src) => src\n    .replace(/=/g, '').replace(/[+\\/]/g, (m0) => m0 == '+' ? '-' : '_');\nconst _tidyB64 = (s) => s.replace(/[^A-Za-z0-9\\+\\/]/g, '');\n/**\n * polyfill version of `btoa`\n */\nconst btoaPolyfill = (bin) => {\n    // console.log('polyfilled');\n    let u32, c0, c1, c2, asc = '';\n    const pad = bin.length % 3;\n    for (let i = 0; i < bin.length;) {\n        if ((c0 = bin.charCodeAt(i++)) > 255 ||\n            (c1 = bin.charCodeAt(i++)) > 255 ||\n            (c2 = bin.charCodeAt(i++)) > 255)\n            throw new TypeError('invalid character found');\n        u32 = (c0 << 16) | (c1 << 8) | c2;\n        asc += b64chs[u32 >> 18 & 63]\n            + b64chs[u32 >> 12 & 63]\n            + b64chs[u32 >> 6 & 63]\n            + b64chs[u32 & 63];\n    }\n    return pad ? asc.slice(0, pad - 3) + \"===\".substring(pad) : asc;\n};\n/**\n * does what `window.btoa` of web browsers do.\n * @param {String} bin binary string\n * @returns {string} Base64-encoded string\n */\nconst _btoa = typeof btoa === 'function' ? (bin) => btoa(bin)\n    : _hasBuffer ? (bin) => Buffer.from(bin, 'binary').toString('base64')\n        : btoaPolyfill;\nconst _fromUint8Array = _hasBuffer\n    ? (u8a) => Buffer.from(u8a).toString('base64')\n    : (u8a) => {\n        // cf. https://stackoverflow.com/questions/12710001/how-to-convert-uint8-array-to-base64-encoded-string/12713326#12713326\n        const maxargs = 0x1000;\n        let strs = [];\n        for (let i = 0, l = u8a.length; i < l; i += maxargs) {\n            strs.push(_fromCC.apply(null, u8a.subarray(i, i + maxargs)));\n        }\n        return _btoa(strs.join(''));\n    };\n/**\n * converts a Uint8Array to a Base64 string.\n * @param {boolean} [urlsafe] URL-and-filename-safe a la RFC4648 5\n * @returns {string} Base64 string\n */\nconst fromUint8Array = (u8a, urlsafe = false) => urlsafe ? _mkUriSafe(_fromUint8Array(u8a)) : _fromUint8Array(u8a);\n// This trick is found broken https://github.com/dankogai/js-base64/issues/130\n// const utob = (src: string) => unescape(encodeURIComponent(src));\n// reverting good old fationed regexp\nconst cb_utob = (c) => {\n    if (c.length < 2) {\n        var cc = c.charCodeAt(0);\n        return cc < 0x80 ? c\n            : cc < 0x800 ? (_fromCC(0xc0 | (cc >>> 6))\n                + _fromCC(0x80 | (cc & 0x3f)))\n                : (_fromCC(0xe0 | ((cc >>> 12) & 0x0f))\n                    + _fromCC(0x80 | ((cc >>> 6) & 0x3f))\n                    + _fromCC(0x80 | (cc & 0x3f)));\n    }\n    else {\n        var cc = 0x10000\n            + (c.charCodeAt(0) - 0xD800) * 0x400\n            + (c.charCodeAt(1) - 0xDC00);\n        return (_fromCC(0xf0 | ((cc >>> 18) & 0x07))\n            + _fromCC(0x80 | ((cc >>> 12) & 0x3f))\n            + _fromCC(0x80 | ((cc >>> 6) & 0x3f))\n            + _fromCC(0x80 | (cc & 0x3f)));\n    }\n};\nconst re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n/**\n * @deprecated should have been internal use only.\n * @param {string} src UTF-8 string\n * @returns {string} UTF-16 string\n */\nconst utob = (u) => u.replace(re_utob, cb_utob);\n//\nconst _encode = _hasBuffer\n    ? (s) => Buffer.from(s, 'utf8').toString('base64')\n    : _TE\n        ? (s) => _fromUint8Array(_TE.encode(s))\n        : (s) => _btoa(utob(s));\n/**\n * converts a UTF-8-encoded string to a Base64 string.\n * @param {boolean} [urlsafe] if `true` make the result URL-safe\n * @returns {string} Base64 string\n */\nconst encode = (src, urlsafe = false) => urlsafe\n    ? _mkUriSafe(_encode(src))\n    : _encode(src);\n/**\n * converts a UTF-8-encoded string to URL-safe Base64 RFC4648 5.\n * @returns {string} Base64 string\n */\nconst encodeURI = (src) => encode(src, true);\n// This trick is found broken https://github.com/dankogai/js-base64/issues/130\n// const btou = (src: string) => decodeURIComponent(escape(src));\n// reverting good old fationed regexp\nconst re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\nconst cb_btou = (cccc) => {\n    switch (cccc.length) {\n        case 4:\n            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)\n                | ((0x3f & cccc.charCodeAt(1)) << 12)\n                | ((0x3f & cccc.charCodeAt(2)) << 6)\n                | (0x3f & cccc.charCodeAt(3)), offset = cp - 0x10000;\n            return (_fromCC((offset >>> 10) + 0xD800)\n                + _fromCC((offset & 0x3FF) + 0xDC00));\n        case 3:\n            return _fromCC(((0x0f & cccc.charCodeAt(0)) << 12)\n                | ((0x3f & cccc.charCodeAt(1)) << 6)\n                | (0x3f & cccc.charCodeAt(2)));\n        default:\n            return _fromCC(((0x1f & cccc.charCodeAt(0)) << 6)\n                | (0x3f & cccc.charCodeAt(1)));\n    }\n};\n/**\n * @deprecated should have been internal use only.\n * @param {string} src UTF-16 string\n * @returns {string} UTF-8 string\n */\nconst btou = (b) => b.replace(re_btou, cb_btou);\n/**\n * polyfill version of `atob`\n */\nconst atobPolyfill = (asc) => {\n    // console.log('polyfilled');\n    asc = asc.replace(/\\s+/g, '');\n    if (!b64re.test(asc))\n        throw new TypeError('malformed base64.');\n    asc += '=='.slice(2 - (asc.length & 3));\n    let u24, r1, r2;\n    let binArray = []; // use array to avoid minor gc in loop\n    for (let i = 0; i < asc.length;) {\n        u24 = b64tab[asc.charAt(i++)] << 18\n            | b64tab[asc.charAt(i++)] << 12\n            | (r1 = b64tab[asc.charAt(i++)]) << 6\n            | (r2 = b64tab[asc.charAt(i++)]);\n        if (r1 === 64) {\n            binArray.push(_fromCC(u24 >> 16 & 255));\n        }\n        else if (r2 === 64) {\n            binArray.push(_fromCC(u24 >> 16 & 255, u24 >> 8 & 255));\n        }\n        else {\n            binArray.push(_fromCC(u24 >> 16 & 255, u24 >> 8 & 255, u24 & 255));\n        }\n    }\n    return binArray.join('');\n};\n/**\n * does what `window.atob` of web browsers do.\n * @param {String} asc Base64-encoded string\n * @returns {string} binary string\n */\nconst _atob = typeof atob === 'function' ? (asc) => atob(_tidyB64(asc))\n    : _hasBuffer ? (asc) => Buffer.from(asc, 'base64').toString('binary')\n        : atobPolyfill;\n//\nconst _toUint8Array = _hasBuffer\n    ? (a) => _U8Afrom(Buffer.from(a, 'base64'))\n    : (a) => _U8Afrom(_atob(a).split('').map(c => c.charCodeAt(0)));\n/**\n * converts a Base64 string to a Uint8Array.\n */\nconst toUint8Array = (a) => _toUint8Array(_unURI(a));\n//\nconst _decode = _hasBuffer\n    ? (a) => Buffer.from(a, 'base64').toString('utf8')\n    : _TD\n        ? (a) => _TD.decode(_toUint8Array(a))\n        : (a) => btou(_atob(a));\nconst _unURI = (a) => _tidyB64(a.replace(/[-_]/g, (m0) => m0 == '-' ? '+' : '/'));\n/**\n * converts a Base64 string to a UTF-8 string.\n * @param {String} src Base64 string.  Both normal and URL-safe are supported\n * @returns {string} UTF-8 string\n */\nconst decode = (src) => _decode(_unURI(src));\n/**\n * check if a value is a valid Base64 string\n * @param {String} src a value to check\n  */\nconst isValid = (src) => {\n    if (typeof src !== 'string')\n        return false;\n    const s = src.replace(/\\s+/g, '').replace(/={0,2}$/, '');\n    return !/[^\\s0-9a-zA-Z\\+/]/.test(s) || !/[^\\s0-9a-zA-Z\\-_]/.test(s);\n};\n//\nconst _noEnum = (v) => {\n    return {\n        value: v, enumerable: false, writable: true, configurable: true\n    };\n};\n/**\n * extend String.prototype with relevant methods\n */\nconst extendString = function () {\n    const _add = (name, body) => Object.defineProperty(String.prototype, name, _noEnum(body));\n    _add('fromBase64', function () { return decode(this); });\n    _add('toBase64', function (urlsafe) { return encode(this, urlsafe); });\n    _add('toBase64URI', function () { return encode(this, true); });\n    _add('toBase64URL', function () { return encode(this, true); });\n    _add('toUint8Array', function () { return toUint8Array(this); });\n};\n/**\n * extend Uint8Array.prototype with relevant methods\n */\nconst extendUint8Array = function () {\n    const _add = (name, body) => Object.defineProperty(Uint8Array.prototype, name, _noEnum(body));\n    _add('toBase64', function (urlsafe) { return fromUint8Array(this, urlsafe); });\n    _add('toBase64URI', function () { return fromUint8Array(this, true); });\n    _add('toBase64URL', function () { return fromUint8Array(this, true); });\n};\n/**\n * extend Builtin prototypes with relevant methods\n */\nconst extendBuiltins = () => {\n    extendString();\n    extendUint8Array();\n};\nconst gBase64 = {\n    version: version,\n    VERSION: VERSION,\n    atob: _atob,\n    atobPolyfill: atobPolyfill,\n    btoa: _btoa,\n    btoaPolyfill: btoaPolyfill,\n    fromBase64: decode,\n    toBase64: encode,\n    encode: encode,\n    encodeURI: encodeURI,\n    encodeURL: encodeURI,\n    utob: utob,\n    btou: btou,\n    decode: decode,\n    isValid: isValid,\n    fromUint8Array: fromUint8Array,\n    toUint8Array: toUint8Array,\n    extendString: extendString,\n    extendUint8Array: extendUint8Array,\n    extendBuiltins: extendBuiltins\n};\n// makecjs:CUT //\nexport { version };\nexport { VERSION };\nexport { _atob as atob };\nexport { atobPolyfill };\nexport { _btoa as btoa };\nexport { btoaPolyfill };\nexport { decode as fromBase64 };\nexport { encode as toBase64 };\nexport { utob };\nexport { encode };\nexport { encodeURI };\nexport { encodeURI as encodeURL };\nexport { btou };\nexport { decode };\nexport { isValid };\nexport { fromUint8Array };\nexport { toUint8Array };\nexport { extendString };\nexport { extendUint8Array };\nexport { extendBuiltins };\n// and finally,\nexport { gBase64 as Base64 };\n","'use strict';\n\n/**\n * Check if we're required to add a port number.\n *\n * @see https://url.spec.whatwg.org/#default-port\n * @param {Number|String} port Port number we need to check\n * @param {String} protocol Protocol we need to check against.\n * @returns {Boolean} Is it a default port for the given protocol\n * @api private\n */\nmodule.exports = function required(port, protocol) {\n  protocol = protocol.split(':')[0];\n  port = +port;\n\n  if (!port) return false;\n\n  switch (protocol) {\n    case 'http':\n    case 'ws':\n    return port !== 80;\n\n    case 'https':\n    case 'wss':\n    return port !== 443;\n\n    case 'ftp':\n    return port !== 21;\n\n    case 'gopher':\n    return port !== 70;\n\n    case 'file':\n    return false;\n  }\n\n  return port !== 0;\n};\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , undef;\n\n/**\n * Decode a URI encoded string.\n *\n * @param {String} input The URI encoded string.\n * @returns {String|Null} The decoded string.\n * @api private\n */\nfunction decode(input) {\n  try {\n    return decodeURIComponent(input.replace(/\\+/g, ' '));\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Attempts to encode a given input.\n *\n * @param {String} input The string that needs to be encoded.\n * @returns {String|Null} The encoded string.\n * @api private\n */\nfunction encode(input) {\n  try {\n    return encodeURIComponent(input);\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Simple query string parser.\n *\n * @param {String} query The query string that needs to be parsed.\n * @returns {Object}\n * @api public\n */\nfunction querystring(query) {\n  var parser = /([^=?#&]+)=?([^&]*)/g\n    , result = {}\n    , part;\n\n  while (part = parser.exec(query)) {\n    var key = decode(part[1])\n      , value = decode(part[2]);\n\n    //\n    // Prevent overriding of existing properties. This ensures that build-in\n    // methods like `toString` or __proto__ are not overriden by malicious\n    // querystrings.\n    //\n    // In the case if failed decoding, we want to omit the key/value pairs\n    // from the result.\n    //\n    if (key === null || value === null || key in result) continue;\n    result[key] = value;\n  }\n\n  return result;\n}\n\n/**\n * Transform a query string to an object.\n *\n * @param {Object} obj Object that should be transformed.\n * @param {String} prefix Optional prefix.\n * @returns {String}\n * @api public\n */\nfunction querystringify(obj, prefix) {\n  prefix = prefix || '';\n\n  var pairs = []\n    , value\n    , key;\n\n  //\n  // Optionally prefix with a '?' if needed\n  //\n  if ('string' !== typeof prefix) prefix = '?';\n\n  for (key in obj) {\n    if (has.call(obj, key)) {\n      value = obj[key];\n\n      //\n      // Edge cases where we actually want to encode the value to an empty\n      // string instead of the stringified value.\n      //\n      if (!value && (value === null || value === undef || isNaN(value))) {\n        value = '';\n      }\n\n      key = encode(key);\n      value = encode(value);\n\n      //\n      // If we failed to encode the strings, we should bail out as we don't\n      // want to add invalid strings to the query.\n      //\n      if (key === null || value === null) continue;\n      pairs.push(key +'='+ value);\n    }\n  }\n\n  return pairs.length ? prefix + pairs.join('&') : '';\n}\n\n//\n// Expose the module.\n//\nexports.stringify = querystringify;\nexports.parse = querystring;\n","'use strict';\n\nvar required = require('requires-port')\n  , qs = require('querystringify')\n  , controlOrWhitespace = /^[\\x00-\\x20\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff]+/\n  , CRHTLF = /[\\n\\r\\t]/g\n  , slashes = /^[A-Za-z][A-Za-z0-9+-.]*:\\/\\//\n  , port = /:\\d+$/\n  , protocolre = /^([a-z][a-z0-9.+-]*:)?(\\/\\/)?([\\\\/]+)?([\\S\\s]*)/i\n  , windowsDriveLetter = /^[a-zA-Z]:/;\n\n/**\n * Remove control characters and whitespace from the beginning of a string.\n *\n * @param {Object|String} str String to trim.\n * @returns {String} A new string representing `str` stripped of control\n *     characters and whitespace from its beginning.\n * @public\n */\nfunction trimLeft(str) {\n  return (str ? str : '').toString().replace(controlOrWhitespace, '');\n}\n\n/**\n * These are the parse rules for the URL parser, it informs the parser\n * about:\n *\n * 0. The char it Needs to parse, if it's a string it should be done using\n *    indexOf, RegExp using exec and NaN means set as current value.\n * 1. The property we should set when parsing this value.\n * 2. Indication if it's backwards or forward parsing, when set as number it's\n *    the value of extra chars that should be split off.\n * 3. Inherit from location if non existing in the parser.\n * 4. `toLowerCase` the resulting value.\n */\nvar rules = [\n  ['#', 'hash'],                        // Extract from the back.\n  ['?', 'query'],                       // Extract from the back.\n  function sanitize(address, url) {     // Sanitize what is left of the address\n    return isSpecial(url.protocol) ? address.replace(/\\\\/g, '/') : address;\n  },\n  ['/', 'pathname'],                    // Extract from the back.\n  ['@', 'auth', 1],                     // Extract from the front.\n  [NaN, 'host', undefined, 1, 1],       // Set left over value.\n  [/:(\\d*)$/, 'port', undefined, 1],    // RegExp the back.\n  [NaN, 'hostname', undefined, 1, 1]    // Set left over.\n];\n\n/**\n * These properties should not be copied or inherited from. This is only needed\n * for all non blob URL's as a blob URL does not include a hash, only the\n * origin.\n *\n * @type {Object}\n * @private\n */\nvar ignore = { hash: 1, query: 1 };\n\n/**\n * The location object differs when your code is loaded through a normal page,\n * Worker or through a worker using a blob. And with the blobble begins the\n * trouble as the location object will contain the URL of the blob, not the\n * location of the page where our code is loaded in. The actual origin is\n * encoded in the `pathname` so we can thankfully generate a good \"default\"\n * location from it so we can generate proper relative URL's again.\n *\n * @param {Object|String} loc Optional default location object.\n * @returns {Object} lolcation object.\n * @public\n */\nfunction lolcation(loc) {\n  var globalVar;\n\n  if (typeof window !== 'undefined') globalVar = window;\n  else if (typeof global !== 'undefined') globalVar = global;\n  else if (typeof self !== 'undefined') globalVar = self;\n  else globalVar = {};\n\n  var location = globalVar.location || {};\n  loc = loc || location;\n\n  var finaldestination = {}\n    , type = typeof loc\n    , key;\n\n  if ('blob:' === loc.protocol) {\n    finaldestination = new Url(unescape(loc.pathname), {});\n  } else if ('string' === type) {\n    finaldestination = new Url(loc, {});\n    for (key in ignore) delete finaldestination[key];\n  } else if ('object' === type) {\n    for (key in loc) {\n      if (key in ignore) continue;\n      finaldestination[key] = loc[key];\n    }\n\n    if (finaldestination.slashes === undefined) {\n      finaldestination.slashes = slashes.test(loc.href);\n    }\n  }\n\n  return finaldestination;\n}\n\n/**\n * Check whether a protocol scheme is special.\n *\n * @param {String} The protocol scheme of the URL\n * @return {Boolean} `true` if the protocol scheme is special, else `false`\n * @private\n */\nfunction isSpecial(scheme) {\n  return (\n    scheme === 'file:' ||\n    scheme === 'ftp:' ||\n    scheme === 'http:' ||\n    scheme === 'https:' ||\n    scheme === 'ws:' ||\n    scheme === 'wss:'\n  );\n}\n\n/**\n * @typedef ProtocolExtract\n * @type Object\n * @property {String} protocol Protocol matched in the URL, in lowercase.\n * @property {Boolean} slashes `true` if protocol is followed by \"//\", else `false`.\n * @property {String} rest Rest of the URL that is not part of the protocol.\n */\n\n/**\n * Extract protocol information from a URL with/without double slash (\"//\").\n *\n * @param {String} address URL we want to extract from.\n * @param {Object} location\n * @return {ProtocolExtract} Extracted information.\n * @private\n */\nfunction extractProtocol(address, location) {\n  address = trimLeft(address);\n  address = address.replace(CRHTLF, '');\n  location = location || {};\n\n  var match = protocolre.exec(address);\n  var protocol = match[1] ? match[1].toLowerCase() : '';\n  var forwardSlashes = !!match[2];\n  var otherSlashes = !!match[3];\n  var slashesCount = 0;\n  var rest;\n\n  if (forwardSlashes) {\n    if (otherSlashes) {\n      rest = match[2] + match[3] + match[4];\n      slashesCount = match[2].length + match[3].length;\n    } else {\n      rest = match[2] + match[4];\n      slashesCount = match[2].length;\n    }\n  } else {\n    if (otherSlashes) {\n      rest = match[3] + match[4];\n      slashesCount = match[3].length;\n    } else {\n      rest = match[4]\n    }\n  }\n\n  if (protocol === 'file:') {\n    if (slashesCount >= 2) {\n      rest = rest.slice(2);\n    }\n  } else if (isSpecial(protocol)) {\n    rest = match[4];\n  } else if (protocol) {\n    if (forwardSlashes) {\n      rest = rest.slice(2);\n    }\n  } else if (slashesCount >= 2 && isSpecial(location.protocol)) {\n    rest = match[4];\n  }\n\n  return {\n    protocol: protocol,\n    slashes: forwardSlashes || isSpecial(protocol),\n    slashesCount: slashesCount,\n    rest: rest\n  };\n}\n\n/**\n * Resolve a relative URL pathname against a base URL pathname.\n *\n * @param {String} relative Pathname of the relative URL.\n * @param {String} base Pathname of the base URL.\n * @return {String} Resolved pathname.\n * @private\n */\nfunction resolve(relative, base) {\n  if (relative === '') return base;\n\n  var path = (base || '/').split('/').slice(0, -1).concat(relative.split('/'))\n    , i = path.length\n    , last = path[i - 1]\n    , unshift = false\n    , up = 0;\n\n  while (i--) {\n    if (path[i] === '.') {\n      path.splice(i, 1);\n    } else if (path[i] === '..') {\n      path.splice(i, 1);\n      up++;\n    } else if (up) {\n      if (i === 0) unshift = true;\n      path.splice(i, 1);\n      up--;\n    }\n  }\n\n  if (unshift) path.unshift('');\n  if (last === '.' || last === '..') path.push('');\n\n  return path.join('/');\n}\n\n/**\n * The actual URL instance. Instead of returning an object we've opted-in to\n * create an actual constructor as it's much more memory efficient and\n * faster and it pleases my OCD.\n *\n * It is worth noting that we should not use `URL` as class name to prevent\n * clashes with the global URL instance that got introduced in browsers.\n *\n * @constructor\n * @param {String} address URL we want to parse.\n * @param {Object|String} [location] Location defaults for relative paths.\n * @param {Boolean|Function} [parser] Parser for the query string.\n * @private\n */\nfunction Url(address, location, parser) {\n  address = trimLeft(address);\n  address = address.replace(CRHTLF, '');\n\n  if (!(this instanceof Url)) {\n    return new Url(address, location, parser);\n  }\n\n  var relative, extracted, parse, instruction, index, key\n    , instructions = rules.slice()\n    , type = typeof location\n    , url = this\n    , i = 0;\n\n  //\n  // The following if statements allows this module two have compatibility with\n  // 2 different API:\n  //\n  // 1. Node.js's `url.parse` api which accepts a URL, boolean as arguments\n  //    where the boolean indicates that the query string should also be parsed.\n  //\n  // 2. The `URL` interface of the browser which accepts a URL, object as\n  //    arguments. The supplied object will be used as default values / fall-back\n  //    for relative paths.\n  //\n  if ('object' !== type && 'string' !== type) {\n    parser = location;\n    location = null;\n  }\n\n  if (parser && 'function' !== typeof parser) parser = qs.parse;\n\n  location = lolcation(location);\n\n  //\n  // Extract protocol information before running the instructions.\n  //\n  extracted = extractProtocol(address || '', location);\n  relative = !extracted.protocol && !extracted.slashes;\n  url.slashes = extracted.slashes || relative && location.slashes;\n  url.protocol = extracted.protocol || location.protocol || '';\n  address = extracted.rest;\n\n  //\n  // When the authority component is absent the URL starts with a path\n  // component.\n  //\n  if (\n    extracted.protocol === 'file:' && (\n      extracted.slashesCount !== 2 || windowsDriveLetter.test(address)) ||\n    (!extracted.slashes &&\n      (extracted.protocol ||\n        extracted.slashesCount < 2 ||\n        !isSpecial(url.protocol)))\n  ) {\n    instructions[3] = [/(.*)/, 'pathname'];\n  }\n\n  for (; i < instructions.length; i++) {\n    instruction = instructions[i];\n\n    if (typeof instruction === 'function') {\n      address = instruction(address, url);\n      continue;\n    }\n\n    parse = instruction[0];\n    key = instruction[1];\n\n    if (parse !== parse) {\n      url[key] = address;\n    } else if ('string' === typeof parse) {\n      index = parse === '@'\n        ? address.lastIndexOf(parse)\n        : address.indexOf(parse);\n\n      if (~index) {\n        if ('number' === typeof instruction[2]) {\n          url[key] = address.slice(0, index);\n          address = address.slice(index + instruction[2]);\n        } else {\n          url[key] = address.slice(index);\n          address = address.slice(0, index);\n        }\n      }\n    } else if ((index = parse.exec(address))) {\n      url[key] = index[1];\n      address = address.slice(0, index.index);\n    }\n\n    url[key] = url[key] || (\n      relative && instruction[3] ? location[key] || '' : ''\n    );\n\n    //\n    // Hostname, host and protocol should be lowercased so they can be used to\n    // create a proper `origin`.\n    //\n    if (instruction[4]) url[key] = url[key].toLowerCase();\n  }\n\n  //\n  // Also parse the supplied query string in to an object. If we're supplied\n  // with a custom parser as function use that instead of the default build-in\n  // parser.\n  //\n  if (parser) url.query = parser(url.query);\n\n  //\n  // If the URL is relative, resolve the pathname against the base URL.\n  //\n  if (\n      relative\n    && location.slashes\n    && url.pathname.charAt(0) !== '/'\n    && (url.pathname !== '' || location.pathname !== '')\n  ) {\n    url.pathname = resolve(url.pathname, location.pathname);\n  }\n\n  //\n  // Default to a / for pathname if none exists. This normalizes the URL\n  // to always have a /\n  //\n  if (url.pathname.charAt(0) !== '/' && isSpecial(url.protocol)) {\n    url.pathname = '/' + url.pathname;\n  }\n\n  //\n  // We should not add port numbers if they are already the default port number\n  // for a given protocol. As the host also contains the port number we're going\n  // override it with the hostname which contains no port number.\n  //\n  if (!required(url.port, url.protocol)) {\n    url.host = url.hostname;\n    url.port = '';\n  }\n\n  //\n  // Parse down the `auth` for the username and password.\n  //\n  url.username = url.password = '';\n\n  if (url.auth) {\n    index = url.auth.indexOf(':');\n\n    if (~index) {\n      url.username = url.auth.slice(0, index);\n      url.username = encodeURIComponent(decodeURIComponent(url.username));\n\n      url.password = url.auth.slice(index + 1);\n      url.password = encodeURIComponent(decodeURIComponent(url.password))\n    } else {\n      url.username = encodeURIComponent(decodeURIComponent(url.auth));\n    }\n\n    url.auth = url.password ? url.username +':'+ url.password : url.username;\n  }\n\n  url.origin = url.protocol !== 'file:' && isSpecial(url.protocol) && url.host\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  //\n  // The href is just the compiled result.\n  //\n  url.href = url.toString();\n}\n\n/**\n * This is convenience method for changing properties in the URL instance to\n * insure that they all propagate correctly.\n *\n * @param {String} part          Property we need to adjust.\n * @param {Mixed} value          The newly assigned value.\n * @param {Boolean|Function} fn  When setting the query, it will be the function\n *                               used to parse the query.\n *                               When setting the protocol, double slash will be\n *                               removed from the final url if it is true.\n * @returns {URL} URL instance for chaining.\n * @public\n */\nfunction set(part, value, fn) {\n  var url = this;\n\n  switch (part) {\n    case 'query':\n      if ('string' === typeof value && value.length) {\n        value = (fn || qs.parse)(value);\n      }\n\n      url[part] = value;\n      break;\n\n    case 'port':\n      url[part] = value;\n\n      if (!required(value, url.protocol)) {\n        url.host = url.hostname;\n        url[part] = '';\n      } else if (value) {\n        url.host = url.hostname +':'+ value;\n      }\n\n      break;\n\n    case 'hostname':\n      url[part] = value;\n\n      if (url.port) value += ':'+ url.port;\n      url.host = value;\n      break;\n\n    case 'host':\n      url[part] = value;\n\n      if (port.test(value)) {\n        value = value.split(':');\n        url.port = value.pop();\n        url.hostname = value.join(':');\n      } else {\n        url.hostname = value;\n        url.port = '';\n      }\n\n      break;\n\n    case 'protocol':\n      url.protocol = value.toLowerCase();\n      url.slashes = !fn;\n      break;\n\n    case 'pathname':\n    case 'hash':\n      if (value) {\n        var char = part === 'pathname' ? '/' : '#';\n        url[part] = value.charAt(0) !== char ? char + value : value;\n      } else {\n        url[part] = value;\n      }\n      break;\n\n    case 'username':\n    case 'password':\n      url[part] = encodeURIComponent(value);\n      break;\n\n    case 'auth':\n      var index = value.indexOf(':');\n\n      if (~index) {\n        url.username = value.slice(0, index);\n        url.username = encodeURIComponent(decodeURIComponent(url.username));\n\n        url.password = value.slice(index + 1);\n        url.password = encodeURIComponent(decodeURIComponent(url.password));\n      } else {\n        url.username = encodeURIComponent(decodeURIComponent(value));\n      }\n  }\n\n  for (var i = 0; i < rules.length; i++) {\n    var ins = rules[i];\n\n    if (ins[4]) url[ins[1]] = url[ins[1]].toLowerCase();\n  }\n\n  url.auth = url.password ? url.username +':'+ url.password : url.username;\n\n  url.origin = url.protocol !== 'file:' && isSpecial(url.protocol) && url.host\n    ? url.protocol +'//'+ url.host\n    : 'null';\n\n  url.href = url.toString();\n\n  return url;\n}\n\n/**\n * Transform the properties back in to a valid and full URL string.\n *\n * @param {Function} stringify Optional query stringify function.\n * @returns {String} Compiled version of the URL.\n * @public\n */\nfunction toString(stringify) {\n  if (!stringify || 'function' !== typeof stringify) stringify = qs.stringify;\n\n  var query\n    , url = this\n    , host = url.host\n    , protocol = url.protocol;\n\n  if (protocol && protocol.charAt(protocol.length - 1) !== ':') protocol += ':';\n\n  var result =\n    protocol +\n    ((url.protocol && url.slashes) || isSpecial(url.protocol) ? '//' : '');\n\n  if (url.username) {\n    result += url.username;\n    if (url.password) result += ':'+ url.password;\n    result += '@';\n  } else if (url.password) {\n    result += ':'+ url.password;\n    result += '@';\n  } else if (\n    url.protocol !== 'file:' &&\n    isSpecial(url.protocol) &&\n    !host &&\n    url.pathname !== '/'\n  ) {\n    //\n    // Add back the empty userinfo, otherwise the original invalid URL\n    // might be transformed into a valid one with `url.pathname` as host.\n    //\n    result += '@';\n  }\n\n  //\n  // Trailing colon is removed from `url.host` when it is parsed. If it still\n  // ends with a colon, then add back the trailing colon that was removed. This\n  // prevents an invalid URL from being transformed into a valid one.\n  //\n  if (host[host.length - 1] === ':' || (port.test(url.hostname) && !url.port)) {\n    host += ':';\n  }\n\n  result += host + url.pathname;\n\n  query = 'object' === typeof url.query ? stringify(url.query) : url.query;\n  if (query) result += '?' !== query.charAt(0) ? '?'+ query : query;\n\n  if (url.hash) result += url.hash;\n\n  return result;\n}\n\nUrl.prototype = { set: set, toString: toString };\n\n//\n// Expose the URL parser and some additional properties that might be useful for\n// others or testing.\n//\nUrl.extractProtocol = extractProtocol;\nUrl.location = lolcation;\nUrl.trimLeft = trimLeft;\nUrl.qs = qs;\n\nmodule.exports = Url;\n","/**\n * Generate a UUID v4 based on random numbers. We intentioanlly use the less\n * secure Math.random function here since the more secure crypto.getRandomNumbers\n * is not available on all platforms.\n * This is not a problem for us since we use the UUID only for generating a\n * request ID, so we can correlate server logs to client errors.\n *\n * This function is taken from following site:\n * https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n *\n * @return {string} The generate UUID\n */\nexport default function uuid() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}","function _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { Base64 } from 'js-base64';\nimport URL from 'url-parse';\nimport DetailedError from './error.js';\nimport { log } from './logger.js';\nimport uuid from './uuid.js';\nvar PROTOCOL_TUS_V1 = 'tus-v1';\nvar PROTOCOL_IETF_DRAFT_03 = 'ietf-draft-03';\nvar PROTOCOL_IETF_DRAFT_05 = 'ietf-draft-05';\nvar defaultOptions = {\n  endpoint: null,\n  uploadUrl: null,\n  metadata: {},\n  metadataForPartialUploads: {},\n  fingerprint: null,\n  uploadSize: null,\n  onProgress: null,\n  onChunkComplete: null,\n  onSuccess: null,\n  onError: null,\n  onUploadUrlAvailable: null,\n  overridePatchMethod: false,\n  headers: {},\n  addRequestId: false,\n  onBeforeRequest: null,\n  onAfterResponse: null,\n  onShouldRetry: defaultOnShouldRetry,\n  chunkSize: Number.POSITIVE_INFINITY,\n  retryDelays: [0, 1000, 3000, 5000],\n  parallelUploads: 1,\n  parallelUploadBoundaries: null,\n  storeFingerprintForResuming: true,\n  removeFingerprintOnSuccess: false,\n  uploadLengthDeferred: false,\n  uploadDataDuringCreation: false,\n  urlStorage: null,\n  fileReader: null,\n  httpStack: null,\n  protocol: PROTOCOL_TUS_V1\n};\nvar BaseUpload = /*#__PURE__*/function () {\n  function BaseUpload(file, options) {\n    _classCallCheck(this, BaseUpload);\n    // Warn about removed options from previous versions\n    if ('resume' in options) {\n      console.log('tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead.');\n    }\n\n    // The default options will already be added from the wrapper classes.\n    this.options = options;\n\n    // Cast chunkSize to integer\n    this.options.chunkSize = Number(this.options.chunkSize);\n\n    // The storage module used to store URLs\n    this._urlStorage = this.options.urlStorage;\n\n    // The underlying File/Blob object\n    this.file = file;\n\n    // The URL against which the file will be uploaded\n    this.url = null;\n\n    // The underlying request object for the current PATCH request\n    this._req = null;\n\n    // The fingerpinrt for the current file (set after start())\n    this._fingerprint = null;\n\n    // The key that the URL storage returned when saving an URL with a fingerprint,\n    this._urlStorageKey = null;\n\n    // The offset used in the current PATCH request\n    this._offset = null;\n\n    // True if the current PATCH request has been aborted\n    this._aborted = false;\n\n    // The file's size in bytes\n    this._size = null;\n\n    // The Source object which will wrap around the given file and provides us\n    // with a unified interface for getting its size and slice chunks from its\n    // content allowing us to easily handle Files, Blobs, Buffers and Streams.\n    this._source = null;\n\n    // The current count of attempts which have been made. Zero indicates none.\n    this._retryAttempt = 0;\n\n    // The timeout's ID which is used to delay the next retry\n    this._retryTimeout = null;\n\n    // The offset of the remote upload before the latest attempt was started.\n    this._offsetBeforeRetry = 0;\n\n    // An array of BaseUpload instances which are used for uploading the different\n    // parts, if the parallelUploads option is used.\n    this._parallelUploads = null;\n\n    // An array of upload URLs which are used for uploading the different\n    // parts, if the parallelUploads option is used.\n    this._parallelUploadUrls = null;\n  }\n\n  /**\n   * Use the Termination extension to delete an upload from the server by sending a DELETE\n   * request to the specified upload URL. This is only possible if the server supports the\n   * Termination extension. If the `options.retryDelays` property is set, the method will\n   * also retry if an error ocurrs.\n   *\n   * @param {String} url The upload's URL which will be terminated.\n   * @param {object} options Optional options for influencing HTTP requests.\n   * @return {Promise} The Promise will be resolved/rejected when the requests finish.\n   */\n  return _createClass(BaseUpload, [{\n    key: \"findPreviousUploads\",\n    value: function findPreviousUploads() {\n      var _this = this;\n      return this.options.fingerprint(this.file, this.options).then(function (fingerprint) {\n        return _this._urlStorage.findUploadsByFingerprint(fingerprint);\n      });\n    }\n  }, {\n    key: \"resumeFromPreviousUpload\",\n    value: function resumeFromPreviousUpload(previousUpload) {\n      this.url = previousUpload.uploadUrl || null;\n      this._parallelUploadUrls = previousUpload.parallelUploadUrls || null;\n      this._urlStorageKey = previousUpload.urlStorageKey;\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      var _this2 = this;\n      var file = this.file;\n      if (!file) {\n        this._emitError(new Error('tus: no file or stream to upload provided'));\n        return;\n      }\n      if (![PROTOCOL_TUS_V1, PROTOCOL_IETF_DRAFT_03, PROTOCOL_IETF_DRAFT_05].includes(this.options.protocol)) {\n        this._emitError(new Error(\"tus: unsupported protocol \".concat(this.options.protocol)));\n        return;\n      }\n      if (!this.options.endpoint && !this.options.uploadUrl && !this.url) {\n        this._emitError(new Error('tus: neither an endpoint or an upload URL is provided'));\n        return;\n      }\n      var retryDelays = this.options.retryDelays;\n      if (retryDelays != null && Object.prototype.toString.call(retryDelays) !== '[object Array]') {\n        this._emitError(new Error('tus: the `retryDelays` option must either be an array or null'));\n        return;\n      }\n      if (this.options.parallelUploads > 1) {\n        // Test which options are incompatible with parallel uploads.\n        for (var _i = 0, _arr = ['uploadUrl', 'uploadSize', 'uploadLengthDeferred']; _i < _arr.length; _i++) {\n          var optionName = _arr[_i];\n          if (this.options[optionName]) {\n            this._emitError(new Error(\"tus: cannot use the \".concat(optionName, \" option when parallelUploads is enabled\")));\n            return;\n          }\n        }\n      }\n      if (this.options.parallelUploadBoundaries) {\n        if (this.options.parallelUploads <= 1) {\n          this._emitError(new Error('tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled'));\n          return;\n        }\n        if (this.options.parallelUploads !== this.options.parallelUploadBoundaries.length) {\n          this._emitError(new Error('tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`'));\n          return;\n        }\n      }\n      this.options.fingerprint(file, this.options).then(function (fingerprint) {\n        if (fingerprint == null) {\n          log('No fingerprint was calculated meaning that the upload cannot be stored in the URL storage.');\n        } else {\n          log(\"Calculated fingerprint: \".concat(fingerprint));\n        }\n        _this2._fingerprint = fingerprint;\n        if (_this2._source) {\n          return _this2._source;\n        }\n        return _this2.options.fileReader.openFile(file, _this2.options.chunkSize);\n      }).then(function (source) {\n        _this2._source = source;\n\n        // First, we look at the uploadLengthDeferred option.\n        // Next, we check if the caller has supplied a manual upload size.\n        // Finally, we try to use the calculated size from the source object.\n        if (_this2.options.uploadLengthDeferred) {\n          _this2._size = null;\n        } else if (_this2.options.uploadSize != null) {\n          _this2._size = Number(_this2.options.uploadSize);\n          if (Number.isNaN(_this2._size)) {\n            _this2._emitError(new Error('tus: cannot convert `uploadSize` option into a number'));\n            return;\n          }\n        } else {\n          _this2._size = _this2._source.size;\n          if (_this2._size == null) {\n            _this2._emitError(new Error(\"tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option\"));\n            return;\n          }\n        }\n\n        // If the upload was configured to use multiple requests or if we resume from\n        // an upload which used multiple requests, we start a parallel upload.\n        if (_this2.options.parallelUploads > 1 || _this2._parallelUploadUrls != null) {\n          _this2._startParallelUpload();\n        } else {\n          _this2._startSingleUpload();\n        }\n      })[\"catch\"](function (err) {\n        _this2._emitError(err);\n      });\n    }\n\n    /**\n     * Initiate the uploading procedure for a parallelized upload, where one file is split into\n     * multiple request which are run in parallel.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_startParallelUpload\",\n    value: function _startParallelUpload() {\n      var _this$options$paralle,\n        _this3 = this;\n      var totalSize = this._size;\n      var totalProgress = 0;\n      this._parallelUploads = [];\n      var partCount = this._parallelUploadUrls != null ? this._parallelUploadUrls.length : this.options.parallelUploads;\n\n      // The input file will be split into multiple slices which are uploaded in separate\n      // requests. Here we get the start and end position for the slices.\n      var parts = (_this$options$paralle = this.options.parallelUploadBoundaries) !== null && _this$options$paralle !== void 0 ? _this$options$paralle : splitSizeIntoParts(this._source.size, partCount);\n\n      // Attach URLs from previous uploads, if available.\n      if (this._parallelUploadUrls) {\n        parts.forEach(function (part, index) {\n          part.uploadUrl = _this3._parallelUploadUrls[index] || null;\n        });\n      }\n\n      // Create an empty list for storing the upload URLs\n      this._parallelUploadUrls = new Array(parts.length);\n\n      // Generate a promise for each slice that will be resolve if the respective\n      // upload is completed.\n      var uploads = parts.map(function (part, index) {\n        var lastPartProgress = 0;\n        return _this3._source.slice(part.start, part.end).then(function (_ref) {\n          var value = _ref.value;\n          return new Promise(function (resolve, reject) {\n            // Merge with the user supplied options but overwrite some values.\n            var options = _objectSpread(_objectSpread({}, _this3.options), {}, {\n              // If available, the partial upload should be resumed from a previous URL.\n              uploadUrl: part.uploadUrl || null,\n              // We take manually care of resuming for partial uploads, so they should\n              // not be stored in the URL storage.\n              storeFingerprintForResuming: false,\n              removeFingerprintOnSuccess: false,\n              // Reset the parallelUploads option to not cause recursion.\n              parallelUploads: 1,\n              // Reset this option as we are not doing a parallel upload.\n              parallelUploadBoundaries: null,\n              metadata: _this3.options.metadataForPartialUploads,\n              // Add the header to indicate the this is a partial upload.\n              headers: _objectSpread(_objectSpread({}, _this3.options.headers), {}, {\n                'Upload-Concat': 'partial'\n              }),\n              // Reject or resolve the promise if the upload errors or completes.\n              onSuccess: resolve,\n              onError: reject,\n              // Based in the progress for this partial upload, calculate the progress\n              // for the entire final upload.\n              onProgress: function onProgress(newPartProgress) {\n                totalProgress = totalProgress - lastPartProgress + newPartProgress;\n                lastPartProgress = newPartProgress;\n                _this3._emitProgress(totalProgress, totalSize);\n              },\n              // Wait until every partial upload has an upload URL, so we can add\n              // them to the URL storage.\n              onUploadUrlAvailable: function onUploadUrlAvailable() {\n                _this3._parallelUploadUrls[index] = upload.url;\n                // Test if all uploads have received an URL\n                if (_this3._parallelUploadUrls.filter(function (u) {\n                  return Boolean(u);\n                }).length === parts.length) {\n                  _this3._saveUploadInUrlStorage();\n                }\n              }\n            });\n            var upload = new BaseUpload(value, options);\n            upload.start();\n\n            // Store the upload in an array, so we can later abort them if necessary.\n            _this3._parallelUploads.push(upload);\n          });\n        });\n      });\n      var req;\n      // Wait until all partial uploads are finished and we can send the POST request for\n      // creating the final upload.\n      Promise.all(uploads).then(function () {\n        req = _this3._openRequest('POST', _this3.options.endpoint);\n        req.setHeader('Upload-Concat', \"final;\".concat(_this3._parallelUploadUrls.join(' ')));\n\n        // Add metadata if values have been added\n        var metadata = encodeMetadata(_this3.options.metadata);\n        if (metadata !== '') {\n          req.setHeader('Upload-Metadata', metadata);\n        }\n        return _this3._sendRequest(req, null);\n      }).then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this3._emitHttpError(req, res, 'tus: unexpected response while creating upload');\n          return;\n        }\n        var location = res.getHeader('Location');\n        if (location == null) {\n          _this3._emitHttpError(req, res, 'tus: invalid or missing Location header');\n          return;\n        }\n        _this3.url = resolveUrl(_this3.options.endpoint, location);\n        log(\"Created upload at \".concat(_this3.url));\n        _this3._emitSuccess(res);\n      })[\"catch\"](function (err) {\n        _this3._emitError(err);\n      });\n    }\n\n    /**\n     * Initiate the uploading procedure for a non-parallel upload. Here the entire file is\n     * uploaded in a sequential matter.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_startSingleUpload\",\n    value: function _startSingleUpload() {\n      // Reset the aborted flag when the upload is started or else the\n      // _performUpload will stop before sending a request if the upload has been\n      // aborted previously.\n      this._aborted = false;\n\n      // The upload had been started previously and we should reuse this URL.\n      if (this.url != null) {\n        log(\"Resuming upload from previous URL: \".concat(this.url));\n        this._resumeUpload();\n        return;\n      }\n\n      // A URL has manually been specified, so we try to resume\n      if (this.options.uploadUrl != null) {\n        log(\"Resuming upload from provided URL: \".concat(this.options.uploadUrl));\n        this.url = this.options.uploadUrl;\n        this._resumeUpload();\n        return;\n      }\n\n      // An upload has not started for the file yet, so we start a new one\n      log('Creating a new upload');\n      this._createUpload();\n    }\n\n    /**\n     * Abort any running request and stop the current upload. After abort is called, no event\n     * handler will be invoked anymore. You can use the `start` method to resume the upload\n     * again.\n     * If `shouldTerminate` is true, the `terminate` function will be called to remove the\n     * current upload from the server.\n     *\n     * @param {boolean} shouldTerminate True if the upload should be deleted from the server.\n     * @return {Promise} The Promise will be resolved/rejected when the requests finish.\n     */\n  }, {\n    key: \"abort\",\n    value: function abort(shouldTerminate) {\n      var _this4 = this;\n      // Stop any parallel partial uploads, that have been started in _startParallelUploads.\n      if (this._parallelUploads != null) {\n        var _iterator = _createForOfIteratorHelper(this._parallelUploads),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var upload = _step.value;\n            upload.abort(shouldTerminate);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n\n      // Stop any current running request.\n      if (this._req !== null) {\n        this._req.abort();\n        // Note: We do not close the file source here, so the user can resume in the future.\n      }\n      this._aborted = true;\n\n      // Stop any timeout used for initiating a retry.\n      if (this._retryTimeout != null) {\n        clearTimeout(this._retryTimeout);\n        this._retryTimeout = null;\n      }\n      if (!shouldTerminate || this.url == null) {\n        return Promise.resolve();\n      }\n      return BaseUpload.terminate(this.url, this.options)\n      // Remove entry from the URL storage since the upload URL is no longer valid.\n      .then(function () {\n        return _this4._removeFromUrlStorage();\n      });\n    }\n  }, {\n    key: \"_emitHttpError\",\n    value: function _emitHttpError(req, res, message, causingErr) {\n      this._emitError(new DetailedError(message, causingErr, req, res));\n    }\n  }, {\n    key: \"_emitError\",\n    value: function _emitError(err) {\n      var _this5 = this;\n      // Do not emit errors, e.g. from aborted HTTP requests, if the upload has been stopped.\n      if (this._aborted) return;\n\n      // Check if we should retry, when enabled, before sending the error to the user.\n      if (this.options.retryDelays != null) {\n        // We will reset the attempt counter if\n        // - we were already able to connect to the server (offset != null) and\n        // - we were able to upload a small chunk of data to the server\n        var shouldResetDelays = this._offset != null && this._offset > this._offsetBeforeRetry;\n        if (shouldResetDelays) {\n          this._retryAttempt = 0;\n        }\n        if (shouldRetry(err, this._retryAttempt, this.options)) {\n          var delay = this.options.retryDelays[this._retryAttempt++];\n          this._offsetBeforeRetry = this._offset;\n          this._retryTimeout = setTimeout(function () {\n            _this5.start();\n          }, delay);\n          return;\n        }\n      }\n      if (typeof this.options.onError === 'function') {\n        this.options.onError(err);\n      } else {\n        throw err;\n      }\n    }\n\n    /**\n     * Publishes notification if the upload has been successfully completed.\n     *\n     * @param {object} lastResponse Last HTTP response.\n     * @api private\n     */\n  }, {\n    key: \"_emitSuccess\",\n    value: function _emitSuccess(lastResponse) {\n      if (this.options.removeFingerprintOnSuccess) {\n        // Remove stored fingerprint and corresponding endpoint. This causes\n        // new uploads of the same file to be treated as a different file.\n        this._removeFromUrlStorage();\n      }\n      if (typeof this.options.onSuccess === 'function') {\n        this.options.onSuccess({\n          lastResponse: lastResponse\n        });\n      }\n    }\n\n    /**\n     * Publishes notification when data has been sent to the server. This\n     * data may not have been accepted by the server yet.\n     *\n     * @param {number} bytesSent  Number of bytes sent to the server.\n     * @param {number} bytesTotal Total number of bytes to be sent to the server.\n     * @api private\n     */\n  }, {\n    key: \"_emitProgress\",\n    value: function _emitProgress(bytesSent, bytesTotal) {\n      if (typeof this.options.onProgress === 'function') {\n        this.options.onProgress(bytesSent, bytesTotal);\n      }\n    }\n\n    /**\n     * Publishes notification when a chunk of data has been sent to the server\n     * and accepted by the server.\n     * @param {number} chunkSize  Size of the chunk that was accepted by the server.\n     * @param {number} bytesAccepted Total number of bytes that have been\n     *                                accepted by the server.\n     * @param {number} bytesTotal Total number of bytes to be sent to the server.\n     * @api private\n     */\n  }, {\n    key: \"_emitChunkComplete\",\n    value: function _emitChunkComplete(chunkSize, bytesAccepted, bytesTotal) {\n      if (typeof this.options.onChunkComplete === 'function') {\n        this.options.onChunkComplete(chunkSize, bytesAccepted, bytesTotal);\n      }\n    }\n\n    /**\n     * Create a new upload using the creation extension by sending a POST\n     * request to the endpoint. After successful creation the file will be\n     * uploaded\n     *\n     * @api private\n     */\n  }, {\n    key: \"_createUpload\",\n    value: function _createUpload() {\n      var _this6 = this;\n      if (!this.options.endpoint) {\n        this._emitError(new Error('tus: unable to create upload because no endpoint is provided'));\n        return;\n      }\n      var req = this._openRequest('POST', this.options.endpoint);\n      if (this.options.uploadLengthDeferred) {\n        req.setHeader('Upload-Defer-Length', '1');\n      } else {\n        req.setHeader('Upload-Length', \"\".concat(this._size));\n      }\n\n      // Add metadata if values have been added\n      var metadata = encodeMetadata(this.options.metadata);\n      if (metadata !== '') {\n        req.setHeader('Upload-Metadata', metadata);\n      }\n      var promise;\n      if (this.options.uploadDataDuringCreation && !this.options.uploadLengthDeferred) {\n        this._offset = 0;\n        promise = this._addChunkToRequest(req);\n      } else {\n        if (this.options.protocol === PROTOCOL_IETF_DRAFT_03 || this.options.protocol === PROTOCOL_IETF_DRAFT_05) {\n          req.setHeader('Upload-Complete', '?0');\n        }\n        promise = this._sendRequest(req, null);\n      }\n      promise.then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this6._emitHttpError(req, res, 'tus: unexpected response while creating upload');\n          return;\n        }\n        var location = res.getHeader('Location');\n        if (location == null) {\n          _this6._emitHttpError(req, res, 'tus: invalid or missing Location header');\n          return;\n        }\n        _this6.url = resolveUrl(_this6.options.endpoint, location);\n        log(\"Created upload at \".concat(_this6.url));\n        if (typeof _this6.options.onUploadUrlAvailable === 'function') {\n          _this6.options.onUploadUrlAvailable();\n        }\n        if (_this6._size === 0) {\n          // Nothing to upload and file was successfully created\n          _this6._emitSuccess(res);\n          _this6._source.close();\n          return;\n        }\n        _this6._saveUploadInUrlStorage().then(function () {\n          if (_this6.options.uploadDataDuringCreation) {\n            _this6._handleUploadResponse(req, res);\n          } else {\n            _this6._offset = 0;\n            _this6._performUpload();\n          }\n        });\n      })[\"catch\"](function (err) {\n        _this6._emitHttpError(req, null, 'tus: failed to create upload', err);\n      });\n    }\n\n    /*\n     * Try to resume an existing upload. First a HEAD request will be sent\n     * to retrieve the offset. If the request fails a new upload will be\n     * created. In the case of a successful response the file will be uploaded.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_resumeUpload\",\n    value: function _resumeUpload() {\n      var _this7 = this;\n      var req = this._openRequest('HEAD', this.url);\n      var promise = this._sendRequest(req, null);\n      promise.then(function (res) {\n        var status = res.getStatus();\n        if (!inStatusCategory(status, 200)) {\n          // If the upload is locked (indicated by the 423 Locked status code), we\n          // emit an error instead of directly starting a new upload. This way the\n          // retry logic can catch the error and will retry the upload. An upload\n          // is usually locked for a short period of time and will be available\n          // afterwards.\n          if (status === 423) {\n            _this7._emitHttpError(req, res, 'tus: upload is currently locked; retry later');\n            return;\n          }\n          if (inStatusCategory(status, 400)) {\n            // Remove stored fingerprint and corresponding endpoint,\n            // on client errors since the file can not be found\n            _this7._removeFromUrlStorage();\n          }\n          if (!_this7.options.endpoint) {\n            // Don't attempt to create a new upload if no endpoint is provided.\n            _this7._emitHttpError(req, res, 'tus: unable to resume upload (new upload cannot be created without an endpoint)');\n            return;\n          }\n\n          // Try to create a new upload\n          _this7.url = null;\n          _this7._createUpload();\n          return;\n        }\n        var offset = Number.parseInt(res.getHeader('Upload-Offset'), 10);\n        if (Number.isNaN(offset)) {\n          _this7._emitHttpError(req, res, 'tus: invalid or missing offset value');\n          return;\n        }\n        var length = Number.parseInt(res.getHeader('Upload-Length'), 10);\n        if (Number.isNaN(length) && !_this7.options.uploadLengthDeferred && _this7.options.protocol === PROTOCOL_TUS_V1) {\n          _this7._emitHttpError(req, res, 'tus: invalid or missing length value');\n          return;\n        }\n        if (typeof _this7.options.onUploadUrlAvailable === 'function') {\n          _this7.options.onUploadUrlAvailable();\n        }\n        _this7._saveUploadInUrlStorage().then(function () {\n          // Upload has already been completed and we do not need to send additional\n          // data to the server\n          if (offset === length) {\n            _this7._emitProgress(length, length);\n            _this7._emitSuccess(res);\n            return;\n          }\n          _this7._offset = offset;\n          _this7._performUpload();\n        });\n      })[\"catch\"](function (err) {\n        _this7._emitHttpError(req, null, 'tus: failed to resume upload', err);\n      });\n    }\n\n    /**\n     * Start uploading the file using PATCH requests. The file will be divided\n     * into chunks as specified in the chunkSize option. During the upload\n     * the onProgress event handler may be invoked multiple times.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_performUpload\",\n    value: function _performUpload() {\n      var _this8 = this;\n      // If the upload has been aborted, we will not send the next PATCH request.\n      // This is important if the abort method was called during a callback, such\n      // as onChunkComplete or onProgress.\n      if (this._aborted) {\n        return;\n      }\n      var req;\n\n      // Some browser and servers may not support the PATCH method. For those\n      // cases, you can tell tus-js-client to use a POST request with the\n      // X-HTTP-Method-Override header for simulating a PATCH request.\n      if (this.options.overridePatchMethod) {\n        req = this._openRequest('POST', this.url);\n        req.setHeader('X-HTTP-Method-Override', 'PATCH');\n      } else {\n        req = this._openRequest('PATCH', this.url);\n      }\n      req.setHeader('Upload-Offset', \"\".concat(this._offset));\n      var promise = this._addChunkToRequest(req);\n      promise.then(function (res) {\n        if (!inStatusCategory(res.getStatus(), 200)) {\n          _this8._emitHttpError(req, res, 'tus: unexpected response while uploading chunk');\n          return;\n        }\n        _this8._handleUploadResponse(req, res);\n      })[\"catch\"](function (err) {\n        // Don't emit an error if the upload was aborted manually\n        if (_this8._aborted) {\n          return;\n        }\n        _this8._emitHttpError(req, null, \"tus: failed to upload chunk at offset \".concat(_this8._offset), err);\n      });\n    }\n\n    /**\n     * _addChunktoRequest reads a chunk from the source and sends it using the\n     * supplied request object. It will not handle the response.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_addChunkToRequest\",\n    value: function _addChunkToRequest(req) {\n      var _this9 = this;\n      var start = this._offset;\n      var end = this._offset + this.options.chunkSize;\n      req.setProgressHandler(function (bytesSent) {\n        _this9._emitProgress(start + bytesSent, _this9._size);\n      });\n      if (this.options.protocol === PROTOCOL_TUS_V1) {\n        req.setHeader('Content-Type', 'application/offset+octet-stream');\n      } else if (this.options.protocol === PROTOCOL_IETF_DRAFT_05) {\n        req.setHeader('Content-Type', 'application/partial-upload');\n      }\n\n      // The specified chunkSize may be Infinity or the calcluated end position\n      // may exceed the file's size. In both cases, we limit the end position to\n      // the input's total size for simpler calculations and correctness.\n      if ((end === Number.POSITIVE_INFINITY || end > this._size) && !this.options.uploadLengthDeferred) {\n        end = this._size;\n      }\n      return this._source.slice(start, end).then(function (_ref2) {\n        var value = _ref2.value,\n          done = _ref2.done;\n        var valueSize = value !== null && value !== void 0 && value.size ? value.size : 0;\n\n        // If the upload length is deferred, the upload size was not specified during\n        // upload creation. So, if the file reader is done reading, we know the total\n        // upload size and can tell the tus server.\n        if (_this9.options.uploadLengthDeferred && done) {\n          _this9._size = _this9._offset + valueSize;\n          req.setHeader('Upload-Length', \"\".concat(_this9._size));\n        }\n\n        // The specified uploadSize might not match the actual amount of data that a source\n        // provides. In these cases, we cannot successfully complete the upload, so we\n        // rather error out and let the user know. If not, tus-js-client will be stuck\n        // in a loop of repeating empty PATCH requests.\n        // See https://community.transloadit.com/t/how-to-abort-hanging-companion-uploads/16488/13\n        var newSize = _this9._offset + valueSize;\n        if (!_this9.options.uploadLengthDeferred && done && newSize !== _this9._size) {\n          return Promise.reject(new Error(\"upload was configured with a size of \".concat(_this9._size, \" bytes, but the source is done after \").concat(newSize, \" bytes\")));\n        }\n        if (value === null) {\n          return _this9._sendRequest(req);\n        }\n        if (_this9.options.protocol === PROTOCOL_IETF_DRAFT_03 || _this9.options.protocol === PROTOCOL_IETF_DRAFT_05) {\n          req.setHeader('Upload-Complete', done ? '?1' : '?0');\n        }\n        _this9._emitProgress(_this9._offset, _this9._size);\n        return _this9._sendRequest(req, value);\n      });\n    }\n\n    /**\n     * _handleUploadResponse is used by requests that haven been sent using _addChunkToRequest\n     * and already have received a response.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_handleUploadResponse\",\n    value: function _handleUploadResponse(req, res) {\n      var offset = Number.parseInt(res.getHeader('Upload-Offset'), 10);\n      if (Number.isNaN(offset)) {\n        this._emitHttpError(req, res, 'tus: invalid or missing offset value');\n        return;\n      }\n      this._emitProgress(offset, this._size);\n      this._emitChunkComplete(offset - this._offset, offset, this._size);\n      this._offset = offset;\n      if (offset === this._size) {\n        // Yay, finally done :)\n        this._emitSuccess(res);\n        this._source.close();\n        return;\n      }\n      this._performUpload();\n    }\n\n    /**\n     * Create a new HTTP request object with the given method and URL.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_openRequest\",\n    value: function _openRequest(method, url) {\n      var req = openRequest(method, url, this.options);\n      this._req = req;\n      return req;\n    }\n\n    /**\n     * Remove the entry in the URL storage, if it has been saved before.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_removeFromUrlStorage\",\n    value: function _removeFromUrlStorage() {\n      var _this10 = this;\n      if (!this._urlStorageKey) return;\n      this._urlStorage.removeUpload(this._urlStorageKey)[\"catch\"](function (err) {\n        _this10._emitError(err);\n      });\n      this._urlStorageKey = null;\n    }\n\n    /**\n     * Add the upload URL to the URL storage, if possible.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_saveUploadInUrlStorage\",\n    value: function _saveUploadInUrlStorage() {\n      var _this11 = this;\n      // We do not store the upload URL\n      // - if it was disabled in the option, or\n      // - if no fingerprint was calculated for the input (i.e. a stream), or\n      // - if the URL is already stored (i.e. key is set alread).\n      if (!this.options.storeFingerprintForResuming || !this._fingerprint || this._urlStorageKey !== null) {\n        return Promise.resolve();\n      }\n      var storedUpload = {\n        size: this._size,\n        metadata: this.options.metadata,\n        creationTime: new Date().toString()\n      };\n      if (this._parallelUploads) {\n        // Save multiple URLs if the parallelUploads option is used ...\n        storedUpload.parallelUploadUrls = this._parallelUploadUrls;\n      } else {\n        // ... otherwise we just save the one available URL.\n        storedUpload.uploadUrl = this.url;\n      }\n      return this._urlStorage.addUpload(this._fingerprint, storedUpload).then(function (urlStorageKey) {\n        _this11._urlStorageKey = urlStorageKey;\n      });\n    }\n\n    /**\n     * Send a request with the provided body.\n     *\n     * @api private\n     */\n  }, {\n    key: \"_sendRequest\",\n    value: function _sendRequest(req) {\n      var body = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      return sendRequest(req, body, this.options);\n    }\n  }], [{\n    key: \"terminate\",\n    value: function terminate(url) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var req = openRequest('DELETE', url, options);\n      return sendRequest(req, null, options).then(function (res) {\n        // A 204 response indicates a successfull request\n        if (res.getStatus() === 204) {\n          return;\n        }\n        throw new DetailedError('tus: unexpected response while terminating upload', null, req, res);\n      })[\"catch\"](function (err) {\n        if (!(err instanceof DetailedError)) {\n          err = new DetailedError('tus: failed to terminate upload', err, req, null);\n        }\n        if (!shouldRetry(err, 0, options)) {\n          throw err;\n        }\n\n        // Instead of keeping track of the retry attempts, we remove the first element from the delays\n        // array. If the array is empty, all retry attempts are used up and we will bubble up the error.\n        // We recursively call the terminate function will removing elements from the retryDelays array.\n        var delay = options.retryDelays[0];\n        var remainingDelays = options.retryDelays.slice(1);\n        var newOptions = _objectSpread(_objectSpread({}, options), {}, {\n          retryDelays: remainingDelays\n        });\n        return new Promise(function (resolve) {\n          return setTimeout(resolve, delay);\n        }).then(function () {\n          return BaseUpload.terminate(url, newOptions);\n        });\n      });\n    }\n  }]);\n}();\nfunction encodeMetadata(metadata) {\n  return Object.entries(metadata).map(function (_ref3) {\n    var _ref4 = _slicedToArray(_ref3, 2),\n      key = _ref4[0],\n      value = _ref4[1];\n    return \"\".concat(key, \" \").concat(Base64.encode(String(value)));\n  }).join(',');\n}\n\n/**\n * Checks whether a given status is in the range of the expected category.\n * For example, only a status between 200 and 299 will satisfy the category 200.\n *\n * @api private\n */\nfunction inStatusCategory(status, category) {\n  return status >= category && status < category + 100;\n}\n\n/**\n * Create a new HTTP request with the specified method and URL.\n * The necessary headers that are included in every request\n * will be added, including the request ID.\n *\n * @api private\n */\nfunction openRequest(method, url, options) {\n  var req = options.httpStack.createRequest(method, url);\n  if (options.protocol === PROTOCOL_IETF_DRAFT_03) {\n    req.setHeader('Upload-Draft-Interop-Version', '5');\n  } else if (options.protocol === PROTOCOL_IETF_DRAFT_05) {\n    req.setHeader('Upload-Draft-Interop-Version', '6');\n  } else {\n    req.setHeader('Tus-Resumable', '1.0.0');\n  }\n  var headers = options.headers || {};\n  for (var _i2 = 0, _Object$entries = Object.entries(headers); _i2 < _Object$entries.length; _i2++) {\n    var _Object$entries$_i = _slicedToArray(_Object$entries[_i2], 2),\n      name = _Object$entries$_i[0],\n      value = _Object$entries$_i[1];\n    req.setHeader(name, value);\n  }\n  if (options.addRequestId) {\n    var requestId = uuid();\n    req.setHeader('X-Request-ID', requestId);\n  }\n  return req;\n}\n\n/**\n * Send a request with the provided body while invoking the onBeforeRequest\n * and onAfterResponse callbacks.\n *\n * @api private\n */\nfunction sendRequest(_x, _x2, _x3) {\n  return _sendRequest2.apply(this, arguments);\n}\n/**\n * Checks whether the browser running this code has internet access.\n * This function will always return true in the node.js environment\n *\n * @api private\n */\nfunction _sendRequest2() {\n  _sendRequest2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(req, body, options) {\n    var res;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          if (!(typeof options.onBeforeRequest === 'function')) {\n            _context.next = 3;\n            break;\n          }\n          _context.next = 3;\n          return options.onBeforeRequest(req);\n        case 3:\n          _context.next = 5;\n          return req.send(body);\n        case 5:\n          res = _context.sent;\n          if (!(typeof options.onAfterResponse === 'function')) {\n            _context.next = 9;\n            break;\n          }\n          _context.next = 9;\n          return options.onAfterResponse(req, res);\n        case 9:\n          return _context.abrupt(\"return\", res);\n        case 10:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _sendRequest2.apply(this, arguments);\n}\nfunction isOnline() {\n  var online = true;\n  // Note: We don't reference `window` here because the navigator object also exists\n  // in a Web Worker's context.\n  if (typeof navigator !== 'undefined' && navigator.onLine === false) {\n    online = false;\n  }\n  return online;\n}\n\n/**\n * Checks whether or not it is ok to retry a request.\n * @param {Error|DetailedError} err the error returned from the last request\n * @param {number} retryAttempt the number of times the request has already been retried\n * @param {object} options tus Upload options\n *\n * @api private\n */\nfunction shouldRetry(err, retryAttempt, options) {\n  // We only attempt a retry if\n  // - retryDelays option is set\n  // - we didn't exceed the maxium number of retries, yet, and\n  // - this error was caused by a request or it's response and\n  // - the error is server error (i.e. not a status 4xx except a 409 or 423) or\n  // a onShouldRetry is specified and returns true\n  // - the browser does not indicate that we are offline\n  if (options.retryDelays == null || retryAttempt >= options.retryDelays.length || err.originalRequest == null) {\n    return false;\n  }\n  if (options && typeof options.onShouldRetry === 'function') {\n    return options.onShouldRetry(err, retryAttempt, options);\n  }\n  return defaultOnShouldRetry(err);\n}\n\n/**\n * determines if the request should be retried. Will only retry if not a status 4xx except a 409 or 423\n * @param {DetailedError} err\n * @returns {boolean}\n */\nfunction defaultOnShouldRetry(err) {\n  var status = err.originalResponse ? err.originalResponse.getStatus() : 0;\n  return (!inStatusCategory(status, 400) || status === 409 || status === 423) && isOnline();\n}\n\n/**\n * Resolve a relative link given the origin as source. For example,\n * if a HTTP request to http://example.com/files/ returns a Location\n * header with the value /upload/abc, the resolved URL will be:\n * http://example.com/upload/abc\n */\nfunction resolveUrl(origin, link) {\n  return new URL(link, origin).toString();\n}\n\n/**\n * Calculate the start and end positions for the parts if an upload\n * is split into multiple parallel requests.\n *\n * @param {number} totalSize The byte size of the upload, which will be split.\n * @param {number} partCount The number in how many parts the upload will be split.\n * @return {object[]}\n * @api private\n */\nfunction splitSizeIntoParts(totalSize, partCount) {\n  var partSize = Math.floor(totalSize / partCount);\n  var parts = [];\n  for (var i = 0; i < partCount; i++) {\n    parts.push({\n      start: partSize * i,\n      end: partSize * (i + 1)\n    });\n  }\n  parts[partCount - 1].end = totalSize;\n  return parts;\n}\nBaseUpload.defaultOptions = defaultOptions;\nexport default BaseUpload;","var isReactNative = function isReactNative() {\n  return typeof navigator !== 'undefined' && typeof navigator.product === 'string' && navigator.product.toLowerCase() === 'reactnative';\n};\nexport default isReactNative;","/**\n * uriToBlob resolves a URI to a Blob object. This is used for\n * React Native to retrieve a file (identified by a file://\n * URI) as a blob.\n */\nexport default function uriToBlob(uri) {\n  return new Promise(function (resolve, reject) {\n    var xhr = new XMLHttpRequest();\n    xhr.responseType = 'blob';\n    xhr.onload = function () {\n      var blob = xhr.response;\n      resolve(blob);\n    };\n    xhr.onerror = function (err) {\n      reject(err);\n    };\n    xhr.open('GET', uri);\n    xhr.send();\n  });\n}","var isCordova = function isCordova() {\n  return typeof window !== 'undefined' && (typeof window.PhoneGap !== 'undefined' || typeof window.Cordova !== 'undefined' || typeof window.cordova !== 'undefined');\n};\nexport default isCordova;","/**\n * readAsByteArray converts a File object to a Uint8Array.\n * This function is only used on the Apache Cordova platform.\n * See https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-file/index.html#read-a-file\n */\nexport default function readAsByteArray(chunk) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n    reader.onload = function () {\n      var value = new Uint8Array(reader.result);\n      resolve({\n        value: value\n      });\n    };\n    reader.onerror = function (err) {\n      reject(err);\n    };\n    reader.readAsArrayBuffer(chunk);\n  });\n}","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport isCordova from './isCordova.js';\nimport readAsByteArray from './readAsByteArray.js';\nvar FileSource = /*#__PURE__*/function () {\n  // Make this.size a method\n  function FileSource(file) {\n    _classCallCheck(this, FileSource);\n    this._file = file;\n    this.size = file.size;\n  }\n  return _createClass(FileSource, [{\n    key: \"slice\",\n    value: function slice(start, end) {\n      // In Apache Cordova applications, a File must be resolved using\n      // FileReader instances, see\n      // https://cordova.apache.org/docs/en/8.x/reference/cordova-plugin-file/index.html#read-a-file\n      if (isCordova()) {\n        return readAsByteArray(this._file.slice(start, end));\n      }\n      var value = this._file.slice(start, end);\n      var done = end >= this.size;\n      return Promise.resolve({\n        value: value,\n        done: done\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      // Nothing to do here since we don't need to release any resources.\n    }\n  }]);\n}();\nexport { FileSource as default };","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction len(blobOrArray) {\n  if (blobOrArray === undefined) return 0;\n  if (blobOrArray.size !== undefined) return blobOrArray.size;\n  return blobOrArray.length;\n}\n\n/*\n  Typed arrays and blobs don't have a concat method.\n  This function helps StreamSource accumulate data to reach chunkSize.\n*/\nfunction concat(a, b) {\n  if (a.concat) {\n    // Is `a` an Array?\n    return a.concat(b);\n  }\n  if (a instanceof Blob) {\n    return new Blob([a, b], {\n      type: a.type\n    });\n  }\n  if (a.set) {\n    // Is `a` a typed array?\n    var c = new a.constructor(a.length + b.length);\n    c.set(a);\n    c.set(b, a.length);\n    return c;\n  }\n  throw new Error('Unknown data type');\n}\nvar StreamSource = /*#__PURE__*/function () {\n  function StreamSource(reader) {\n    _classCallCheck(this, StreamSource);\n    this._buffer = undefined;\n    this._bufferOffset = 0;\n    this._reader = reader;\n    this._done = false;\n  }\n  return _createClass(StreamSource, [{\n    key: \"slice\",\n    value: function slice(start, end) {\n      if (start < this._bufferOffset) {\n        return Promise.reject(new Error(\"Requested data is before the reader's current offset\"));\n      }\n      return this._readUntilEnoughDataOrDone(start, end);\n    }\n  }, {\n    key: \"_readUntilEnoughDataOrDone\",\n    value: function _readUntilEnoughDataOrDone(start, end) {\n      var _this = this;\n      var hasEnoughData = end <= this._bufferOffset + len(this._buffer);\n      if (this._done || hasEnoughData) {\n        var value = this._getDataFromBuffer(start, end);\n        var done = value == null ? this._done : false;\n        return Promise.resolve({\n          value: value,\n          done: done\n        });\n      }\n      return this._reader.read().then(function (_ref) {\n        var value = _ref.value,\n          done = _ref.done;\n        if (done) {\n          _this._done = true;\n        } else if (_this._buffer === undefined) {\n          _this._buffer = value;\n        } else {\n          _this._buffer = concat(_this._buffer, value);\n        }\n        return _this._readUntilEnoughDataOrDone(start, end);\n      });\n    }\n  }, {\n    key: \"_getDataFromBuffer\",\n    value: function _getDataFromBuffer(start, end) {\n      // Remove data from buffer before `start`.\n      // Data might be reread from the buffer if an upload fails, so we can only\n      // safely delete data when it comes *before* what is currently being read.\n      if (start > this._bufferOffset) {\n        this._buffer = this._buffer.slice(start - this._bufferOffset);\n        this._bufferOffset = start;\n      }\n      // If the buffer is empty after removing old data, all data has been read.\n      var hasAllDataBeenRead = len(this._buffer) === 0;\n      if (this._done && hasAllDataBeenRead) {\n        return null;\n      }\n      // We already removed data before `start`, so we just return the first\n      // chunk from the buffer.\n      return this._buffer.slice(0, end - start);\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      if (this._reader.cancel) {\n        this._reader.cancel();\n      }\n    }\n  }]);\n}();\nexport { StreamSource as default };","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport isReactNative from './isReactNative.js';\nimport uriToBlob from './uriToBlob.js';\nimport FileSource from './sources/FileSource.js';\nimport StreamSource from './sources/StreamSource.js';\nvar FileReader = /*#__PURE__*/function () {\n  function FileReader() {\n    _classCallCheck(this, FileReader);\n  }\n  return _createClass(FileReader, [{\n    key: \"openFile\",\n    value: function () {\n      var _openFile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(input, chunkSize) {\n        var blob;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (!(isReactNative() && input && typeof input.uri !== 'undefined')) {\n                _context.next = 11;\n                break;\n              }\n              _context.prev = 1;\n              _context.next = 4;\n              return uriToBlob(input.uri);\n            case 4:\n              blob = _context.sent;\n              return _context.abrupt(\"return\", new FileSource(blob));\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](1);\n              throw new Error(\"tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. \".concat(_context.t0));\n            case 11:\n              if (!(typeof input.slice === 'function' && typeof input.size !== 'undefined')) {\n                _context.next = 13;\n                break;\n              }\n              return _context.abrupt(\"return\", Promise.resolve(new FileSource(input)));\n            case 13:\n              if (!(typeof input.read === 'function')) {\n                _context.next = 18;\n                break;\n              }\n              chunkSize = Number(chunkSize);\n              if (Number.isFinite(chunkSize)) {\n                _context.next = 17;\n                break;\n              }\n              return _context.abrupt(\"return\", Promise.reject(new Error('cannot create source for stream without a finite value for the `chunkSize` option')));\n            case 17:\n              return _context.abrupt(\"return\", Promise.resolve(new StreamSource(input, chunkSize)));\n            case 18:\n              return _context.abrupt(\"return\", Promise.reject(new Error('source object may only be an instance of File, Blob, or Reader in this environment')));\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[1, 8]]);\n      }));\n      function openFile(_x, _x2) {\n        return _openFile.apply(this, arguments);\n      }\n      return openFile;\n    }()\n  }]);\n}();\nexport { FileReader as default };","import isReactNative from './isReactNative.js';\n\n// TODO: Differenciate between input types\n\n/**\n * Generate a fingerprint for a file which will be used the store the endpoint\n *\n * @param {File} file\n * @param {Object} options\n * @param {Function} callback\n */\nexport default function fingerprint(file, options) {\n  if (isReactNative()) {\n    return Promise.resolve(reactNativeFingerprint(file, options));\n  }\n  return Promise.resolve(['tus-br', file.name, file.type, file.size, file.lastModified, options.endpoint].join('-'));\n}\nfunction reactNativeFingerprint(file, options) {\n  var exifHash = file.exif ? hashCode(JSON.stringify(file.exif)) : 'noexif';\n  return ['tus-rn', file.name || 'noname', file.size || 'nosize', exifHash, options.endpoint].join('/');\n}\nfunction hashCode(str) {\n  // from https://stackoverflow.com/a/8831937/151666\n  var hash = 0;\n  if (str.length === 0) {\n    return hash;\n  }\n  for (var i = 0; i < str.length; i++) {\n    var _char = str.charCodeAt(i);\n    hash = (hash << 5) - hash + _char;\n    hash &= hash; // Convert to 32bit integer\n  }\n  return hash;\n}","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar XHRHttpStack = /*#__PURE__*/function () {\n  function XHRHttpStack() {\n    _classCallCheck(this, XHRHttpStack);\n  }\n  return _createClass(XHRHttpStack, [{\n    key: \"createRequest\",\n    value: function createRequest(method, url) {\n      return new Request(method, url);\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return 'XHRHttpStack';\n    }\n  }]);\n}();\nexport { XHRHttpStack as default };\nvar Request = /*#__PURE__*/function () {\n  function Request(method, url) {\n    _classCallCheck(this, Request);\n    this._xhr = new XMLHttpRequest();\n    this._xhr.open(method, url, true);\n    this._method = method;\n    this._url = url;\n    this._headers = {};\n  }\n  return _createClass(Request, [{\n    key: \"getMethod\",\n    value: function getMethod() {\n      return this._method;\n    }\n  }, {\n    key: \"getURL\",\n    value: function getURL() {\n      return this._url;\n    }\n  }, {\n    key: \"setHeader\",\n    value: function setHeader(header, value) {\n      this._xhr.setRequestHeader(header, value);\n      this._headers[header] = value;\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(header) {\n      return this._headers[header];\n    }\n  }, {\n    key: \"setProgressHandler\",\n    value: function setProgressHandler(progressHandler) {\n      // Test support for progress events before attaching an event listener\n      if (!('upload' in this._xhr)) {\n        return;\n      }\n      this._xhr.upload.onprogress = function (e) {\n        if (!e.lengthComputable) {\n          return;\n        }\n        progressHandler(e.loaded);\n      };\n    }\n  }, {\n    key: \"send\",\n    value: function send() {\n      var _this = this;\n      var body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      return new Promise(function (resolve, reject) {\n        _this._xhr.onload = function () {\n          resolve(new Response(_this._xhr));\n        };\n        _this._xhr.onerror = function (err) {\n          reject(err);\n        };\n        _this._xhr.send(body);\n      });\n    }\n  }, {\n    key: \"abort\",\n    value: function abort() {\n      this._xhr.abort();\n      return Promise.resolve();\n    }\n  }, {\n    key: \"getUnderlyingObject\",\n    value: function getUnderlyingObject() {\n      return this._xhr;\n    }\n  }]);\n}();\nvar Response = /*#__PURE__*/function () {\n  function Response(xhr) {\n    _classCallCheck(this, Response);\n    this._xhr = xhr;\n  }\n  return _createClass(Response, [{\n    key: \"getStatus\",\n    value: function getStatus() {\n      return this._xhr.status;\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(header) {\n      return this._xhr.getResponseHeader(header);\n    }\n  }, {\n    key: \"getBody\",\n    value: function getBody() {\n      return this._xhr.responseText;\n    }\n  }, {\n    key: \"getUnderlyingObject\",\n    value: function getUnderlyingObject() {\n      return this._xhr;\n    }\n  }]);\n}();","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar hasStorage = false;\ntry {\n  // Note: localStorage does not exist in the Web Worker's context, so we must use window here.\n  hasStorage = 'localStorage' in window;\n\n  // Attempt to store and read entries from the local storage to detect Private\n  // Mode on Safari on iOS (see #49)\n  // If the key was not used before, we remove it from local storage again to\n  // not cause confusion where the entry came from.\n  var key = 'tusSupport';\n  var originalValue = localStorage.getItem(key);\n  localStorage.setItem(key, originalValue);\n  if (originalValue === null) localStorage.removeItem(key);\n} catch (e) {\n  // If we try to access localStorage inside a sandboxed iframe, a SecurityError\n  // is thrown. When in private mode on iOS Safari, a QuotaExceededError is\n  // thrown (see #49)\n  if (e.code === e.SECURITY_ERR || e.code === e.QUOTA_EXCEEDED_ERR) {\n    hasStorage = false;\n  } else {\n    throw e;\n  }\n}\nexport var canStoreURLs = hasStorage;\nexport var WebStorageUrlStorage = /*#__PURE__*/function () {\n  function WebStorageUrlStorage() {\n    _classCallCheck(this, WebStorageUrlStorage);\n  }\n  return _createClass(WebStorageUrlStorage, [{\n    key: \"findAllUploads\",\n    value: function findAllUploads() {\n      var results = this._findEntries('tus::');\n      return Promise.resolve(results);\n    }\n  }, {\n    key: \"findUploadsByFingerprint\",\n    value: function findUploadsByFingerprint(fingerprint) {\n      var results = this._findEntries(\"tus::\".concat(fingerprint, \"::\"));\n      return Promise.resolve(results);\n    }\n  }, {\n    key: \"removeUpload\",\n    value: function removeUpload(urlStorageKey) {\n      localStorage.removeItem(urlStorageKey);\n      return Promise.resolve();\n    }\n  }, {\n    key: \"addUpload\",\n    value: function addUpload(fingerprint, upload) {\n      var id = Math.round(Math.random() * 1e12);\n      var key = \"tus::\".concat(fingerprint, \"::\").concat(id);\n      localStorage.setItem(key, JSON.stringify(upload));\n      return Promise.resolve(key);\n    }\n  }, {\n    key: \"_findEntries\",\n    value: function _findEntries(prefix) {\n      var results = [];\n      for (var i = 0; i < localStorage.length; i++) {\n        var _key = localStorage.key(i);\n        if (_key.indexOf(prefix) !== 0) continue;\n        try {\n          var upload = JSON.parse(localStorage.getItem(_key));\n          upload.urlStorageKey = _key;\n          results.push(upload);\n        } catch (_e) {\n          // The JSON parse error is intentionally ignored here, so a malformed\n          // entry in the storage cannot prevent an upload.\n        }\n      }\n      return results;\n    }\n  }]);\n}();","function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport DetailedError from '../error.js';\nimport { enableDebugLog } from '../logger.js';\nimport NoopUrlStorage from '../noopUrlStorage.js';\nimport BaseUpload from '../upload.js';\nimport FileReader from './fileReader.js';\nimport fingerprint from './fileSignature.js';\nimport DefaultHttpStack from './httpStack.js';\nimport { WebStorageUrlStorage, canStoreURLs } from './urlStorage.js';\nvar defaultOptions = _objectSpread(_objectSpread({}, BaseUpload.defaultOptions), {}, {\n  httpStack: new DefaultHttpStack(),\n  fileReader: new FileReader(),\n  urlStorage: canStoreURLs ? new WebStorageUrlStorage() : new NoopUrlStorage(),\n  fingerprint: fingerprint\n});\nvar Upload = /*#__PURE__*/function (_BaseUpload) {\n  function Upload() {\n    var file = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    _classCallCheck(this, Upload);\n    options = _objectSpread(_objectSpread({}, defaultOptions), options);\n    return _callSuper(this, Upload, [file, options]);\n  }\n  _inherits(Upload, _BaseUpload);\n  return _createClass(Upload, null, [{\n    key: \"terminate\",\n    value: function terminate(url) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      options = _objectSpread(_objectSpread({}, defaultOptions), options);\n      return BaseUpload.terminate(url, options);\n    }\n  }]);\n}(BaseUpload); // Note: We don't reference `window` here because these classes also exist in a Web Worker's context.\nvar isSupported = typeof XMLHttpRequest === 'function' && typeof Blob === 'function' && typeof Blob.prototype.slice === 'function';\nexport { Upload, canStoreURLs, defaultOptions, isSupported, enableDebugLog, DefaultHttpStack, DetailedError };","import {getAxiosErrorMessage} from '@common/http/get-axios-error-message';\nimport {apiClient} from '@common/http/query-client';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\nimport {getCookie} from 'react-use-cookie';\nimport {Upload} from 'tus-js-client';\nimport {FileEntry} from '../../file-entry';\nimport {\n  UploadStrategy,\n  UploadStrategyConfigWithBackend,\n} from './upload-strategy';\n\nexport class TusUpload implements UploadStrategy {\n  constructor(private upload: Upload) {}\n\n  start() {\n    this.upload.start();\n  }\n\n  abort() {\n    return this.upload.abort(true);\n  }\n\n  static async create(\n    file: UploadedFile,\n    {\n      onProgress,\n      onSuccess,\n      onError,\n      uploadType,\n      backendId,\n      metadata,\n      chunkSize,\n      baseUrl,\n    }: UploadStrategyConfigWithBackend,\n  ): Promise<TusUpload> {\n    const tusFingerprint = ['tus', file.fingerprint, 'drive'].join('-');\n    const upload = new Upload(file.native, {\n      fingerprint: () => Promise.resolve(tusFingerprint),\n      removeFingerprintOnSuccess: true,\n      endpoint: `${baseUrl}/api/v1/tus/upload`,\n      chunkSize,\n      retryDelays: [0, 3000, 5000, 10000, 20000],\n      overridePatchMethod: true,\n      metadata: {\n        name: window.btoa(file.id),\n        clientName: file.name,\n        clientExtension: file.extension,\n        clientMime: file.mime || '',\n        clientSize: `${file.size}`,\n        uploadType: uploadType,\n        backendId: backendId,\n        ...(metadata as Record<string, string>),\n      },\n      headers: {\n        'X-XSRF-TOKEN': getCookie('XSRF-TOKEN'),\n      },\n      onError: err => {\n        if ('originalResponse' in err && err.originalResponse) {\n          try {\n            const message = JSON.parse(err.originalResponse.getBody())?.message;\n            onError?.(message, file);\n          } catch (e) {\n            onError?.(null, file);\n          }\n        } else {\n          onError?.(null, file);\n        }\n      },\n      onProgress(bytesUploaded, bytesTotal) {\n        onProgress?.({bytesUploaded, bytesTotal});\n      },\n      onSuccess: async () => {\n        const uploadKey = upload.url?.split('/').pop();\n        try {\n          if (uploadKey) {\n            const response = await createFileEntry(uploadKey);\n            onSuccess?.(response.fileEntry, file);\n          }\n        } catch (err) {\n          localStorage.removeItem(tusFingerprint);\n          onError?.(getAxiosErrorMessage(err), file);\n        }\n      },\n    });\n\n    const previousUploads = await upload.findPreviousUploads();\n    if (previousUploads.length) {\n      upload.resumeFromPreviousUpload(previousUploads[0]);\n    }\n\n    return new TusUpload(upload);\n  }\n}\n\nfunction createFileEntry(uploadKey: string): Promise<{fileEntry: FileEntry}> {\n  return apiClient.post('tus/entries', {uploadKey}).then(r => r.data);\n}\n","import {UploadType} from '@app/site-config';\nimport {PartialUploadType} from '@common/core/base-backend-bootstrap-data';\nimport {DEFAULT_CHUNK_SIZE} from '@common/core/settings/base-backend-settings';\nimport {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\nimport {validateFile} from '@ui/utils/files/validate-file';\nimport {FileUpload, FileUploadState} from './file-upload-store';\nimport {ProgressTimeout} from './progress-timeout';\nimport {AxiosUpload} from './strategy/axios-upload';\nimport {S3MultipartUpload} from './strategy/s3-multipart-upload';\nimport {S3Upload} from './strategy/s3-upload';\nimport {TusUpload} from './strategy/tus-upload';\nimport {\n  UploadStrategy,\n  UploadStrategyConfigWithBackend,\n} from './strategy/upload-strategy';\n\nexport async function startUploading(\n  upload: FileUpload,\n  state: FileUploadState,\n): Promise<UploadStrategy | null> {\n  const settings = getBootstrapData().settings;\n  const options = upload.options;\n  const file = upload.file as UploadedFile;\n\n  // validate file, if validation fails, error the upload and bail\n  if (options?.restrictions) {\n    const errorMessage = validateFile(file, options.restrictions);\n    if (errorMessage) {\n      state.updateFileUpload(file.id, {\n        errorMessage,\n        status: 'failed',\n        request: undefined,\n        timer: undefined,\n      });\n\n      if (options.showToastOnRestrictionFail) {\n        toast.danger(errorMessage);\n      }\n\n      state.runQueue();\n      return null;\n    }\n  }\n\n  const backend = chooseBackend(options.uploadType);\n\n  if (!backend) {\n    throw new Error('No backend found for upload type ' + options.uploadType);\n  }\n\n  // prepare config for file upload strategy\n  const timer = new ProgressTimeout();\n  const config: UploadStrategyConfigWithBackend = {\n    uploadType: options?.uploadType,\n    backendId: backend.id,\n    metadata: {\n      ...options?.metadata,\n      relativePath: file.relativePath,\n      parentId: options?.metadata?.parentId || '',\n    },\n    chunkSize: settings.uploading?.chunk_size ?? DEFAULT_CHUNK_SIZE,\n    baseUrl: settings.base_url,\n    onError: errorMessage => {\n      state.updateFileUpload(file.id, {\n        errorMessage,\n        status: 'failed',\n      });\n      state.runQueue();\n      timer.done();\n      options?.onError?.(errorMessage, file);\n      if (options.showToastOnBackendError && errorMessage) {\n        toast.danger(errorMessage);\n      }\n    },\n    onSuccess: entry => {\n      state.updateFileUpload(file.id, {\n        status: 'completed',\n        entry,\n      });\n      state.runQueue();\n      timer.done();\n      options?.onSuccess?.(entry, file);\n    },\n    onProgress: ({bytesUploaded, bytesTotal}) => {\n      const percentage = (bytesUploaded / bytesTotal) * 100;\n      state.updateFileUpload(file.id, {\n        percentage,\n        bytesUploaded,\n      });\n      timer.progress();\n      options?.onProgress?.({bytesUploaded, bytesTotal});\n    },\n  };\n\n  // choose and create upload strategy, based on file size and settings\n  const strategy = chooseUploadStrategy(file, backend);\n  const request = await strategy.create(file, config);\n\n  // add handler for when upload times out (no progress for 30+ seconds)\n  timer.timeoutHandler = () => {\n    request.abort();\n    state.updateFileUpload(file.id, {\n      status: 'failed',\n      errorMessage: message('Upload timed out'),\n    });\n    state.runQueue();\n  };\n\n  state.updateFileUpload(file.id, {\n    status: 'inProgress',\n    request,\n  });\n  request.start();\n\n  return request;\n}\n\nconst OneMB = 1024 * 1024;\nconst FourMB = 4 * OneMB;\nconst HundredMB = 100 * OneMB;\n\nconst chooseUploadStrategy = (\n  file: UploadedFile,\n  backend: PartialUploadType['backends'][number],\n) => {\n  if (backend.driver === 's3' && backend.direct_upload) {\n    return file.size >= HundredMB ? S3MultipartUpload : S3Upload;\n  } else {\n    // 4MB = Axios, otherwise Tus\n    return file.size >= FourMB ? TusUpload : AxiosUpload;\n  }\n};\n\nfunction chooseBackend(uploadType: keyof typeof UploadType) {\n  const uploadingTypes = getBootstrapData().uploading_types;\n  if (uploadingTypes && uploadType) {\n    const uploadTypeConfig = uploadingTypes[uploadType];\n    // pick random backend\n    return uploadTypeConfig.backends[\n      Math.floor(Math.random() * uploadTypeConfig.backends.length)\n    ];\n  }\n  return null;\n}\n","import {UploadType} from '@app/site-config';\nimport {DEFAULT_CHUNK_SIZE} from '@common/core/settings/base-backend-settings';\nimport {MessageDescriptor} from '@ui/i18n/message-descriptor';\nimport {Settings} from '@ui/settings/settings';\nimport {\n  UploadedFile,\n  UploadedFileFromEntry,\n} from '@ui/utils/files/uploaded-file';\nimport {Draft, enableMapSet} from 'immer';\nimport {create} from 'zustand';\nimport {immer} from 'zustand/middleware/immer';\nimport {FileEntry} from '../file-entry';\nimport {createUpload} from './create-file-upload';\nimport {ProgressTimeout} from './progress-timeout';\nimport {startUploading} from './start-uploading';\nimport {S3MultipartUpload} from './strategy/s3-multipart-upload';\nimport {TusUpload} from './strategy/tus-upload';\nimport {UploadStrategy, UploadStrategyConfig} from './strategy/upload-strategy';\n\nenableMapSet();\n\nexport interface FileUpload {\n  file: UploadedFile | UploadedFileFromEntry;\n  percentage: number;\n  bytesUploaded: number;\n  status: 'pending' | 'inProgress' | 'aborted' | 'failed' | 'completed';\n  errorMessage?: string | MessageDescriptor | null;\n  entry?: FileEntry;\n  request?: UploadStrategy;\n  timer?: ProgressTimeout;\n  options: UploadStrategyConfig;\n  meta?: unknown;\n}\n\ninterface FileUploadStoreState {\n  // If false, then we are showing file selection list UI where user can manage selected files.\n  uploadStarted: boolean;\n  concurrency: number;\n  fileUploads: Map<string, FileUpload>;\n  // uploads with pending and inProgress status\n  activeUploadsCount: number;\n  // uploads with inProgress status\n  inProgressUploadsCount: number;\n  pendingUploadsCount: number;\n  completedUploadsCount: number;\n}\n\nconst initialState: FileUploadStoreState = {\n  uploadStarted: false,\n  concurrency: 3,\n  fileUploads: new Map(),\n  activeUploadsCount: 0,\n  inProgressUploadsCount: 0,\n  pendingUploadsCount: 0,\n  completedUploadsCount: 0,\n};\n\nexport interface FileUploadStoreActions {\n  uploadMultiple: (\n    files: (File | UploadedFile)[] | FileList,\n    strategyConfig: Omit<\n      UploadStrategyConfig,\n      // progress would be called for each upload simultaneously\n      'onProgress'\n    >,\n    options?: {\n      startUpload?: boolean;\n    },\n  ) => string[];\n  uploadSingle: (\n    file: File | UploadedFile,\n    options: UploadStrategyConfig,\n  ) => string;\n  startUpload: () => void;\n  removeUpload: (id: string) => void;\n  clearInactive: () => void;\n  abortUpload: (id: string) => void;\n  updateFileUpload: (id: string, state: Partial<FileUpload>) => void;\n  addCompletedFileUpload: (\n    entry: FileEntry,\n    uploadType: keyof typeof UploadType,\n  ) => void;\n  getUpload: (id: string) => FileUpload | undefined;\n  getCompletedFileEntries: () => FileEntry[];\n  runQueue: () => Promise<void>;\n  reset: () => void;\n}\n\nexport type FileUploadState = FileUploadStoreState & FileUploadStoreActions;\n\nexport interface FileUploadStoreOptions {\n  modifyUploadedFile?: (file: UploadedFile) => UploadedFile;\n}\n\ninterface StoreProps {\n  settings: Settings;\n  options?: FileUploadStoreOptions;\n}\nexport const createFileUploadStore = ({settings, options}: StoreProps) =>\n  create<FileUploadState>()(\n    immer((set, get) => {\n      return {\n        ...initialState,\n        reset: () => {\n          set(initialState);\n        },\n\n        getUpload: uploadId => {\n          return get().fileUploads.get(uploadId);\n        },\n\n        getCompletedFileEntries: () => {\n          return [...get().fileUploads.values()]\n            .filter(u => !!u.entry)\n            .map(u => u.entry) as FileEntry[];\n        },\n\n        clearInactive: () => {\n          set(state => {\n            state.fileUploads.forEach((upload, key) => {\n              if (upload.status !== 'inProgress') {\n                state.fileUploads.delete(key);\n              }\n            });\n            updateTotals(state);\n          });\n          get().runQueue();\n        },\n\n        abortUpload: id => {\n          const upload = get().fileUploads.get(id);\n          if (upload) {\n            upload.request?.abort();\n            if (!get().uploadStarted) {\n              get().removeUpload(id);\n            } else {\n              get().updateFileUpload(id, {status: 'aborted', percentage: 0});\n              get().runQueue();\n            }\n          }\n        },\n\n        updateFileUpload: (id, newUploadState) => {\n          set(state => {\n            const fileUpload = state.fileUploads.get(id);\n            if (fileUpload) {\n              state.fileUploads.set(id, {\n                ...fileUpload,\n                ...newUploadState,\n              });\n\n              // only need to update inProgress count if status of the uploads in queue change\n              if ('status' in newUploadState) {\n                updateTotals(state);\n              }\n            }\n          });\n        },\n\n        addCompletedFileUpload: (entry, uploadType) => {\n          set(state => {\n            state.fileUploads.set(`${entry.id}`, {\n              file: new UploadedFileFromEntry(entry),\n              status: 'completed',\n              entry,\n              percentage: 100,\n              bytesUploaded: entry.file_size || 0,\n              options: {\n                uploadType,\n              },\n            });\n            updateTotals(state);\n          });\n        },\n\n        uploadSingle: (file, userOptions) => {\n          const upload = createUpload(file, userOptions, options);\n          const fileUploads = new Map(get().fileUploads);\n          fileUploads.set(upload.file.id, upload);\n\n          set(state => {\n            updateTotals(state);\n            state.fileUploads = fileUploads;\n            state.uploadStarted = true;\n          });\n\n          get().runQueue();\n\n          return upload.file.id;\n        },\n\n        removeUpload: (id: string) => {\n          set(state => {\n            state.fileUploads.delete(id);\n            updateTotals(state);\n          });\n        },\n\n        uploadMultiple: (files, strategyConfig, {startUpload = true} = {}) => {\n          // create file upload items from specified files\n          const uploads = new Map<string, FileUpload>(get().fileUploads);\n          [...files].forEach(file => {\n            const upload = createUpload(file, strategyConfig, options);\n            uploads.set(upload.file.id, upload);\n          });\n\n          // set state only once, there might be thousands of files, don't want to trigger a rerender for each one\n          set(state => {\n            state.uploadStarted = startUpload;\n            state.fileUploads = uploads;\n            updateTotals(state);\n          });\n\n          if (startUpload) {\n            get().runQueue();\n          }\n\n          return [...uploads.keys()];\n        },\n\n        startUpload: () => {\n          set(state => {\n            state.uploadStarted = true;\n          });\n          get().runQueue();\n        },\n\n        runQueue: async () => {\n          if (get().uploadStarted === false) return;\n          const uploads = [...get().fileUploads.values()];\n          const activeUploads = uploads.filter(u => u.status === 'inProgress');\n\n          let concurrency = get().concurrency;\n          if (\n            activeUploads.filter(\n              activeUpload =>\n                // only upload one file from folder at a time to avoid creating duplicate folders\n                activeUpload.file.relativePath ||\n                // only allow one s3 multipart upload at a time, it will already upload multiple parts in parallel\n                activeUpload.request instanceof S3MultipartUpload ||\n                // only allow one tus upload if file is larger than chunk size, tus will have parallel uploads already in that case\n                (activeUpload.request instanceof TusUpload &&\n                  activeUpload.file.size >\n                    (settings.uploading?.chunk_size ?? DEFAULT_CHUNK_SIZE)),\n            ).length\n          ) {\n            concurrency = 1;\n          }\n\n          if (activeUploads.length < concurrency) {\n            //const pendingUploads = uploads.filter(u => u.status === 'pending');\n            //const next = pendingUploads.find(a => !!a.request);\n            const next = uploads.find(u => u.status === 'pending');\n            if (next) {\n              await startUploading(next, get());\n            } else {\n              set(state => {\n                state.uploadStarted = false;\n              });\n            }\n          }\n        },\n      };\n    }),\n  );\n\nconst updateTotals = (state: Draft<FileUploadState>) => {\n  const uploads = [...state.fileUploads.values()];\n  state.completedUploadsCount = uploads.filter(\n    u => u.status === 'completed',\n  ).length;\n  state.inProgressUploadsCount = uploads.filter(\n    u => u.status === 'inProgress',\n  ).length;\n  state.pendingUploadsCount = uploads.filter(\n    u => u.status === 'pending',\n  ).length;\n  state.activeUploadsCount = uploads.filter(\n    u => u.status === 'inProgress' || u.status === 'pending',\n  ).length;\n};\n","import React from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\nimport { createStore } from 'zustand/vanilla';\n\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nconst identity = (arg) => arg;\nfunction useStoreWithEqualityFn(api, selector = identity, equalityFn) {\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getInitialState,\n    selector,\n    equalityFn\n  );\n  React.useDebugValue(slice);\n  return slice;\n}\nconst createWithEqualityFnImpl = (createState, defaultEqualityFn) => {\n  const api = createStore(createState);\n  const useBoundStoreWithEqualityFn = (selector, equalityFn = defaultEqualityFn) => useStoreWithEqualityFn(api, selector, equalityFn);\n  Object.assign(useBoundStoreWithEqualityFn, api);\n  return useBoundStoreWithEqualityFn;\n};\nconst createWithEqualityFn = ((createState, defaultEqualityFn) => createState ? createWithEqualityFnImpl(createState, defaultEqualityFn) : createWithEqualityFnImpl);\n\nexport { createWithEqualityFn, useStoreWithEqualityFn };\n","import {\n  createFileUploadStore,\n  FileUploadState,\n  FileUploadStoreOptions,\n} from '@common/uploads/uploader/file-upload-store';\nimport {useSettings} from '@ui/settings/use-settings';\nimport {createContext, ReactNode, useContext, useState} from 'react';\nimport {useStoreWithEqualityFn} from 'zustand/traditional';\n\ntype FileUploadStore = ReturnType<typeof createFileUploadStore>;\nexport const FileUploadContext = createContext<FileUploadStore>(null!);\n\nexport function useFileUploadStore<T>(\n  selector: (s: FileUploadState) => T,\n  equalityFn?: (left: T, right: T) => boolean,\n): T {\n  const store = useContext(FileUploadContext);\n  return useStoreWithEqualityFn(store, selector, equalityFn);\n}\n\nexport interface FileUploadProviderProps {\n  children: ReactNode;\n  options?: FileUploadStoreOptions;\n}\nexport function FileUploadProvider({\n  children,\n  options,\n}: FileUploadProviderProps) {\n  const settings = useSettings();\n\n  //lazily create store object only once\n  const [store] = useState(() => {\n    return createFileUploadStore({settings, options});\n  });\n\n  return (\n    <FileUploadContext.Provider value={store}>\n      {children}\n    </FileUploadContext.Provider>\n  );\n}\n"],"names":["React","require$$0","is","x","y","objectIs","useState","useEffect","useLayoutEffect","useDebugValue","useSyncExternalStore$2","subscribe","getSnapshot","value","_useState","inst","forceUpdate","checkIfSnapshotChanged","latestGetSnapshot","nextValue","useSyncExternalStore$1","shim","useSyncExternalStoreShim_production","shimModule","require$$1","useSyncExternalStore","useRef","useMemo","withSelector_production","getServerSnapshot","selector","isEqual","instRef","memoizedSelector","nextSnapshot","hasMemo","memoizedSnapshot","currentSelection","memoizedSelection","nextSelection","maybeGetServerSnapshot","withSelectorModule","createUpload","file","strategyConfig","storeOptions","uploadedFile","UploadedFile","restrictionsFromConfig","config","uploadType","getBootstrapData","_a","type","DEFAULT_CHUNK_SIZE","WildcardMatcher","text","separator","input","matches","parts","ii","partsCount","testParts","key","wildcard","test","matcher","reMimePartSplit","mimeMatch","target","pattern","result","validateFile","restrictions","maxFileSize","allowedFileTypes","message","prettyBytes","fileMatchesTypes","types","match","extension","ProgressTimeout","__publicField","AxiosUpload","formData","onSuccess","onError","onProgress","metadata","response","apiClient","e","err","getAxiosErrorMessage","denyList","isRetryAllowed","error","namespace","isNetworkError","CODE_EXCLUDE_LIST","SAFE_HTTP_METHODS","IDEMPOTENT_HTTP_METHODS","isRetryableError","isSafeRequestError","isIdempotentRequestError","isNetworkOrIdempotentRequestError","retryAfter","retryAfterHeader","retryAfterMs","noDelay","_retryNumber","exponentialDelay","retryNumber","delayFactor","calculatedDelay","delay","randomSum","linearDelay","DEFAULT_OPTIONS","getRequestOptions","defaultOptions","setCurrentState","resetLastRequestTime","currentState","fixConfig","axiosInstance","shouldRetry","retries","retryCondition","shouldRetryOrPromise","handleRetry","retryDelay","shouldResetTimeout","onRetry","lastRequestDuration","timeout","data","resolve","abortListener","handleMaxRetryTimesExceeded","axiosRetry","requestInterceptorId","responseInterceptorId","oneMB","desiredChunkSize","batchSize","concurrency","S3MultipartUpload","axios","storedUrl","getFromLocalStorage","_c","_b","removeFromLocalStorage","_e","_d","pendingChunks","c","signedUrls","pendingUploads","item","r","batch","i","url","partNumber","chunk","totalUploaded","n","etag","setInLocalStorage","fileKey","uploadId","minChunkSize","chunkSize","end","previouslyUploaded","S3Upload","acl","exports","_default","stringifyOptions","_react","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","o","minLen","_arrayLikeToArray","len","arr2","_i","_arr","_n","_s","ownKeys","object","enumerableOnly","keys","symbols","sym","_objectSpread","source","_defineProperty","obj","isBrowser","options","acc","setCookie","name","optionsWithDefaults","expires","getCookie","initialValue","v","removeCookie","_useState2","setItem","removeItem","updateItem","_typeof","_createClass","Constructor","protoProps","staticProps","_classCallCheck","instance","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","self","call","_assertThisInitialized","_inherits","subClass","superClass","_setPrototypeOf","_wrapNativeSuper","Class","_cache","_isNativeFunction","Wrapper","_construct","p","fn","DetailedError","_Error","_this","causingErr","req","res","requestId","method","status","body","_defineProperties","props","descriptor","_toPropertyKey","_toPrimitive","NoopUrlStorage","_fingerprint","_urlStorageKey","_upload","version","VERSION","_hasBuffer","_TD","_TE","b64ch","b64chs","b64tab","a","tab","b64re","_fromCC","_U8Afrom","it","_mkUriSafe","src","m0","_tidyB64","s","btoaPolyfill","bin","u32","c0","c1","c2","asc","pad","_btoa","_fromUint8Array","u8a","strs","l","fromUint8Array","urlsafe","cb_utob","cc","re_utob","utob","u","_encode","encode","encodeURI","re_btou","cb_btou","cccc","cp","offset","btou","b","atobPolyfill","u24","r1","r2","binArray","_atob","_toUint8Array","toUint8Array","_unURI","_decode","decode","isValid","_noEnum","extendString","_add","extendUint8Array","extendBuiltins","gBase64","requiresPort","port","protocol","has","undef","querystring","query","parser","part","querystringify","prefix","pairs","querystringify_1","required","qs","controlOrWhitespace","CRHTLF","slashes","protocolre","windowsDriveLetter","trimLeft","str","rules","address","isSpecial","ignore","lolcation","loc","globalVar","global","location","finaldestination","Url","scheme","extractProtocol","forwardSlashes","otherSlashes","slashesCount","rest","relative","base","path","last","unshift","up","extracted","parse","instruction","index","instructions","set","char","ins","toString","stringify","host","urlParse","uuid","_regeneratorRuntime","t","define","wrap","Generator","Context","makeInvokeMethod","tryCatch","h","f","GeneratorFunction","GeneratorFunctionPrototype","d","values","g","defineIteratorMethods","AsyncIterator","invoke","callInvokeWithMethodAndArg","maybeInvokeDelegate","pushTryEntry","resetTryEntry","next","handle","asyncGeneratorStep","gen","reject","_next","_throw","arg","info","_asyncToGenerator","args","_createForOfIteratorHelper","allowArrayLike","F","normalCompletion","didErr","step","_e2","PROTOCOL_TUS_V1","PROTOCOL_IETF_DRAFT_03","PROTOCOL_IETF_DRAFT_05","defaultOnShouldRetry","BaseUpload","fingerprint","previousUpload","_this2","retryDelays","optionName","_this$options$paralle","_this3","totalSize","totalProgress","partCount","splitSizeIntoParts","uploads","lastPartProgress","_ref","newPartProgress","upload","encodeMetadata","inStatusCategory","resolveUrl","shouldTerminate","_this4","_iterator","_step","_this5","shouldResetDelays","lastResponse","bytesSent","bytesTotal","bytesAccepted","_this6","promise","_this7","length","_this8","_this9","start","_ref2","done","valueSize","newSize","openRequest","_this10","_this11","storedUpload","urlStorageKey","sendRequest","remainingDelays","newOptions","_ref3","_ref4","Base64","category","headers","_i2","_Object$entries","_Object$entries$_i","_x","_x2","_x3","_sendRequest2","_callee","_context","isOnline","online","retryAttempt","origin","link","URL","partSize","isReactNative","uriToBlob","uri","xhr","blob","isCordova","readAsByteArray","reader","FileSource","blobOrArray","concat","StreamSource","hasEnoughData","hasAllDataBeenRead","FileReader","_openFile","openFile","reactNativeFingerprint","exifHash","hashCode","hash","_char","XHRHttpStack","Request","header","progressHandler","Response","hasStorage","originalValue","canStoreURLs","WebStorageUrlStorage","results","id","_key","DefaultHttpStack","Upload","_BaseUpload","TusUpload","backendId","baseUrl","tusFingerprint","bytesUploaded","uploadKey","createFileEntry","previousUploads","startUploading","state","settings","errorMessage","toast","backend","chooseBackend","timer","entry","percentage","request","chooseUploadStrategy","OneMB","FourMB","HundredMB","uploadingTypes","uploadTypeConfig","enableMapSet","initialState","createFileUploadStore","create","immer","get","updateTotals","newUploadState","fileUpload","UploadedFileFromEntry","userOptions","fileUploads","files","startUpload","activeUploads","activeUpload","useSyncExternalStoreWithSelector","useSyncExternalStoreExports","identity","useStoreWithEqualityFn","api","equalityFn","slice","FileUploadContext","createContext","useFileUploadStore","store","useContext","FileUploadProvider","children","useSettings"],"mappings":"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","x_google_ignoreList":[0,1,2,3,6,7,11,12,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,38]}