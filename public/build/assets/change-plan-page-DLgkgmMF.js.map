{"version":3,"file":"change-plan-page-DLgkgmMF.js","sources":["../../../common/foundation/resources/client/billing/billing-page/change-plan-page.tsx"],"sourcesContent":["import {billingQueries} from '@common/billing/billing-queries';\nimport {useQuery} from '@tanstack/react-query';\nimport {opacityAnimation} from '@ui/animation/opacity-animation';\nimport {Breadcrumb} from '@ui/breadcrumbs/breadcrumb';\nimport {BreadcrumbItem} from '@ui/breadcrumbs/breadcrumb-item';\nimport {Button} from '@ui/buttons/button';\nimport {Trans} from '@ui/i18n/trans';\nimport {CheckIcon} from '@ui/icons/material/Check';\nimport {Skeleton} from '@ui/skeleton/skeleton';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {Fragment, useState} from 'react';\nimport {Link} from 'react-router';\nimport {useNavigate} from '../../ui/navigation/use-navigate';\nimport {FormattedPrice} from '../formatted-price';\nimport {Price} from '../price';\nimport {BillingCycleRadio} from '../pricing-table/billing-cycle-radio';\nimport {\n  findBestPrice,\n  UpsellBillingCycle,\n} from '../pricing-table/find-best-price';\nimport {Product} from '../product';\nimport {BillingPlanPanel} from './billing-plan-panel';\nimport {useBillingUser} from './use-billing-user';\n\nexport function Component() {\n  const navigate = useNavigate();\n  return (\n    <Fragment>\n      <Breadcrumb>\n        <BreadcrumbItem isLink onSelected={() => navigate('/billing')}>\n          <Trans message=\"Billing\" />\n        </BreadcrumbItem>\n        <BreadcrumbItem>\n          <Trans message=\"Plans\" />\n        </BreadcrumbItem>\n      </Breadcrumb>\n      <h1 className=\"my-32 text-3xl font-bold md:my-64\">\n        <Trans message=\"Change your plan\" />\n      </h1>\n      <BillingPlanPanel title={<Trans message=\"Available plans\" />}>\n        <AnimatePresence initial={false} mode=\"wait\">\n          <PlanList />\n        </AnimatePresence>\n      </BillingPlanPanel>\n    </Fragment>\n  );\n}\n\nfunction PlanList() {\n  const query = useQuery(billingQueries.products.index());\n  const [selectedCycle, setSelectedCycle] =\n    useState<UpsellBillingCycle>('monthly');\n\n  if (query.isLoading) {\n    return <PlanSkeleton key=\"plan-skeleton\" />;\n  }\n\n  return (\n    <Fragment key=\"plan-list\">\n      <BillingCycleRadio\n        products={query.data?.products}\n        selectedCycle={selectedCycle}\n        onChange={setSelectedCycle}\n        className=\"mb-20\"\n        size=\"md\"\n      />\n      {query.data?.products.map(plan => {\n        const price = findBestPrice(selectedCycle, plan.prices);\n        if (!price || plan.hidden) return null;\n        return (\n          <m.div\n            {...opacityAnimation}\n            key={plan.id}\n            className=\"justify-between gap-40 border-b py-32 md:flex\"\n          >\n            <div className=\"mb-40 md:mb-0\">\n              <div className=\"text-xl font-bold\">{plan.name}</div>\n              <FormattedPrice price={price} className=\"text-lg\" />\n              <div className=\"mt-12 text-base\">{plan.description}</div>\n              <FeatureList plan={plan} />\n            </div>\n            <ContinueButton product={plan} price={price} />\n          </m.div>\n        );\n      })}\n    </Fragment>\n  );\n}\n\ninterface FeatureListProps {\n  plan: Product;\n}\nfunction FeatureList({plan}: FeatureListProps) {\n  if (!plan.feature_list.length) return null;\n  return (\n    <div className=\"mt-32\">\n      <div className=\"mb-10 text-sm font-semibold\">\n        <Trans message=\"What's included\" />\n      </div>\n      {plan.feature_list.map(feature => (\n        <div key={feature} className=\"flex items-center gap-10 text-sm\">\n          <CheckIcon className=\"text-positive\" size=\"sm\" />\n          <Trans message={feature} />\n        </div>\n      ))}\n    </div>\n  );\n}\n\ninterface ContinueButtonProps {\n  product: Product;\n  price: Price;\n}\nfunction ContinueButton({product, price}: ContinueButtonProps) {\n  const {subscription} = useBillingUser();\n  if (!subscription?.price || !subscription?.product) return null;\n\n  if (\n    subscription.product_id === product.id &&\n    subscription.price_id === price.id\n  ) {\n    return (\n      <div className=\"flex w-[168px] items-center justify-center gap-10 text-muted\">\n        <CheckIcon size=\"md\" />\n        <Trans message=\"Current plan\" />\n      </div>\n    );\n  }\n\n  return (\n    <Button\n      variant=\"flat\"\n      color=\"primary\"\n      className=\"w-[168px]\"\n      size=\"md\"\n      elementType={Link}\n      to={`/billing/change-plan/${product.id}/${price.id}/confirm`}\n    >\n      <Trans message=\"Continue\" />\n    </Button>\n  );\n}\n\nfunction PlanSkeleton() {\n  return (\n    <m.div\n      key=\"plan-skeleton\"\n      {...opacityAnimation}\n      className=\"border-b py-32 text-2xl\"\n    >\n      <Skeleton className=\"mb-8\" />\n      <Skeleton className=\"mb-14\" />\n      <Skeleton className=\"mb-24\" />\n      <Skeleton className=\"mb-12\" />\n    </m.div>\n  );\n}\n"],"names":["Component","navigate","useNavigate","Fragment","jsxs","Breadcrumb","jsx","BreadcrumbItem","Trans","BillingPlanPanel","AnimatePresence","PlanList","query","useQuery","billingQueries","selectedCycle","setSelectedCycle","useState","PlanSkeleton","BillingCycleRadio","_a","_b","plan","price","findBestPrice","createElement","m","opacityAnimation","FormattedPrice","FeatureList","ContinueButton","CheckIcon","feature","product","subscription","useBillingUser","Button","Link","Skeleton"],"mappings":"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"}