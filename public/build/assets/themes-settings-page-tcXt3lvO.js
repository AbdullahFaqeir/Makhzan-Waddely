import{r as p,a9 as S,j as e,ak as G,J as C,al as J,a6 as y,T as o,D as N,aJ as Y,x as j,a3 as A,a8 as $,M as L,Q as R,R as E,ao as q,B as D,a4 as Q,cv as X,W as Z,w as ee,ay as se,S as te,aY as ae,cS as ie,K as ne,A as re,aG as oe,aH as le,y as H,z as O,aO as U,c as V,an as ce,Y as me,a5 as de,V as ue}from"./main-BdzhGpqn.js";import{a as he}from"./admin-config-DGty5VaU.js";import{u as v}from"./settings-layout-BMn_Y_PI.js";import{S as fe,a as k}from"./settings-section-button-D9ZdQo7M.js";import{u as _}from"./use-admin-settings-BNntRzaQ.js";import{F as w}from"./switch-DFT-JawA.js";import{D as xe}from"./Delete-Bd6wbCuT.js";import{M as ge}from"./MoreVert-BJhX_Lfk.js";import{T as je,R as pe}from"./Tune-C2Yqx2ly.js";import{C as ye}from"./confirmation-dialog-DtIJ4lxn.js";import{D as W}from"./dialog-footer-DL2JkwrZ.js";import{A as be}from"./Add-iOynMxF0.js";import{S as z,F as Se}from"./select-l28gQBMg.js";import{C as ve}from"./color-icon-BuDBXWKb.js";import{C as ke}from"./color-picker-dialog-PoRfERyQ.js";import{u as we}from"./use-filter-nRzvrFAx.js";import{K as Ce}from"./KeyboardArrowRight-DFizyHtY.js";import{S as M}from"./skeleton-CTimao-U.js";import{A as Ne,a as B}from"./accordion-DxYXjiZR.js";import"./settings-links-CqCp-cYt.js";import"./external-link-BX7ebgFF.js";import"./use-admin-settings-page-nav-config-C7ZI9Uzh.js";import"./datatable-page-with-header-layout-T5QYry_g.js";import"./dashboard-layout-context-DDiFtkN0.js";import"./use-toggle-dashboard-left-sidebar-Dzdho4R0.js";import"./file-upload-provider-Cq9bpz4o.js";import"./uploaded-file-BYIHeonQ.js";import"./pretty-bytes-bO14ePu9.js";import"./OpenInFull-C9JCoLeX.js";import"./useSuspenseQuery-DRZs9XPp.js";function De({selectedThemeId:s,initialThemeId:a,onSelectedThemeChange:t}){const n=v(u=>u.preview),[l,m]=p.useState(!1),[i,h]=p.useState(!1),{setValue:c,getValues:d}=S(),{data:{defaults:f}}=_(),r=()=>{if(d("themes").length<=1){Y.danger(j("At least one theme is required"));return}if(s){c("themes",d("themes").filter(g=>g.id!==s),{shouldDirty:!0});const u=d("themes").find(g=>g.id===a);a===s?window.location.reload():t(u?a:d("themes")[0].id)}},x=()=>{const g=`themes.${d("themes").findIndex(T=>T.id===s)}`,b=d(`${g}.is_dark`)?f.themes.dark:f.themes.light;Object.entries(b).forEach(([T,P])=>{n.setThemeValue(T,P)}),n.setThemeFont(null),c(`${g}.values`,b,{shouldDirty:!0}),c(`${g}.font`,void 0,{shouldDirty:!0})};return e.jsxs(p.Fragment,{children:[e.jsxs(G,{children:[e.jsx(C,{variant:"outline",size:"sm",children:e.jsx(ge,{})}),e.jsxs(J,{children:[e.jsx(y,{value:"settings",startIcon:e.jsx(je,{}),onSelected:()=>h(!0),children:e.jsx(o,{message:"Settings"})}),e.jsx(y,{value:"reset",startIcon:e.jsx(pe,{}),onSelected:()=>x(),children:e.jsx(o,{message:"Reset to default"})}),e.jsx(y,{value:"delete",startIcon:e.jsx(xe,{}),onSelected:()=>m(!0),children:e.jsx(o,{message:"Delete"})})]})]}),e.jsx(N,{type:"modal",isOpen:l,onClose:u=>{u&&r(),m(!1)},children:e.jsx(ye,{isDanger:!0,title:e.jsx(o,{message:"Delete theme"}),body:e.jsx(o,{message:"Are you sure you want to delete this theme?"}),confirm:e.jsx(o,{message:"Delete"})})}),e.jsx(N,{type:"modal",isOpen:i,onClose:()=>h(!1),children:e.jsx(Te,{theme:d("themes").find(u=>u.id===s)})})]})}function Te({theme:s}){const a=S(),t=A({defaultValues:s}),{close:n,formId:l}=$();p.useEffect(()=>{const i=t.watch((h,{name:c})=>{c==="default_light"&&h.default_light&&t.setValue("default_dark",!1),c==="default_dark"&&h.default_dark&&t.setValue("default_light",!1)});return()=>i.unsubscribe()},[t]);const m=i=>{a.getValues("themes").forEach((h,c)=>{if(h.id===i.id){a.setValue(`themes.${c}`,i,{shouldDirty:!0});return}if(i.default_light){a.setValue(`themes.${c}`,{...h,default_light:!1},{shouldDirty:!0});return}if(i.default_dark){a.setValue(`themes.${c}`,{...h,default_dark:!1},{shouldDirty:!0});return}})};return e.jsxs(L,{children:[e.jsx(R,{children:e.jsx(o,{message:"Update settings"})}),e.jsx(E,{children:e.jsx(q,{form:t,id:l,onSubmit:i=>{m(i),n()},children:e.jsx(K,{})})}),e.jsxs(W,{children:[e.jsx(D,{onClick:()=>{n()},children:e.jsx(o,{message:"Cancel"})}),e.jsx(D,{variant:"flat",color:"primary",type:"submit",form:l,disabled:!t.formState.isDirty,children:e.jsx(o,{message:"Save"})})]})]})}function K(){return e.jsxs(p.Fragment,{children:[e.jsx(Q,{name:"name",label:e.jsx(o,{message:"Name"}),className:"mb-24",autoFocus:!0,required:!0}),e.jsx(w,{name:"is_dark",className:"mb-20 border-b pb-20",description:e.jsx(o,{message:"Whether this theme has light text on dark background."}),children:e.jsx(o,{message:"Dark theme"})}),e.jsx(w,{name:"default_light",className:"mb-24",description:e.jsx(o,{message:"When light mode is selected, this theme will be used."}),children:e.jsx(o,{message:"Default for light mode"})}),e.jsx(w,{name:"default_dark",description:e.jsx(o,{message:"When dark mode is selected, this theme will be used."}),children:e.jsx(o,{message:"Default for dark mode"})})]})}function Fe(s=1,a=1e4){const t=new Uint32Array(1);window.crypto.getRandomValues(t);const n=t[0]/4294967296;return s=Math.ceil(s),a=Math.floor(a),Math.floor(n*(a-s+1))+s}function Ie({type:s="site",onCreated:a}){return e.jsxs(N,{type:"modal",onClose:t=>{t!=null&&(a==null||a(t))},children:[e.jsx(C,{variant:"outline",shadow:"shadow",size:"sm",className:"ml-auto",children:e.jsx(be,{})}),e.jsx(Ve,{type:s})]})}function Ve({type:s}){const{formId:a,close:t}=$(),{data:{defaults:n}}=_(),l=S(),m=A({defaultValues:{default_dark:!1,default_light:!1,is_dark:!1}}),i=h=>{const c=h.is_dark?n.themes.dark:n.themes.light,d=l.getValues("themes"),f=Fe(100,1e3);l.setValue("themes",[...d,{...h,id:f,type:s,values:c}],{shouldDirty:!0}),t(f)};return e.jsxs(L,{children:[e.jsx(R,{children:e.jsx(o,{message:"New theme"})}),e.jsx(E,{children:e.jsx(q,{id:a,form:m,onSubmit:i,children:e.jsx(K,{})})}),e.jsxs(W,{children:[e.jsx(D,{onClick:()=>t(),children:e.jsx(o,{message:"Cancel"})}),e.jsx(D,{variant:"flat",color:"primary",type:"submit",form:a,disabled:!m.formState.isDirty,children:e.jsx(o,{message:"Save"})})]})]})}function Ae({selectedThemeId:s,onSelectionChange:a,allThemes:t}){return e.jsx(z,{size:"sm",selectionMode:"single",selectedValue:s,onSelectionChange:n=>a(n),appearance:"dropdown",children:t.map(n=>e.jsx(y,{value:n.id,children:n.name},n.id))})}function F(s){return X(s).toString("rgb").replace("rgb(","").replace(")","").replace(/, ?/g," ")}function _e({label:s,colorName:a,initialThemeValue:t,themeId:n,size:l="lg"}){const m=v(r=>r.preview),{setValue:i,getValues:h}=S(),[c,d]=p.useState(t),f=r=>{d(r),m.setThemeValue(a,r)};return p.useEffect(()=>{d(t)},[t]),e.jsxs(N,{value:Z(c),type:"popover",placement:"right",offset:10,onValueChange:r=>{f(F(r))},onClose:(r,{valueChanged:x,initialValue:u})=>{if(r&&x){const g=h("themes").findIndex(b=>b.id===n);i(`themes.${g}.values.${a}`,F(r),{shouldDirty:!0})}else f(u?F(u):"")},children:[e.jsx(fe,{size:l,radius:"rounded-panel",startIcon:e.jsx(ve,{viewBox:"0 0 48 48",className:"icon-lg",style:{fill:c.startsWith("#")?c:`rgb(${c})`}}),children:s}),e.jsx(ke,{})]})}const Me=[{label:j("Background"),key:"--be-background"},{label:j("Background alt"),key:"--be-bg-alt"},{label:j("Background elevated"),key:"--be-bg-elevated"},{label:j("Foreground"),key:"--be-fg-base"},{label:j("Accent light"),key:"--be-primary-light"},{label:j("Accent"),key:"--be-primary"},{label:j("Accent dark"),key:"--be-primary-dark"},{label:j("Text on accent"),key:"--be-on-primary"},{label:j("Chip"),key:"--be-bg-chip"}],Be={"rounded-none":{label:j("Square"),value:"0px"},rounded:{label:j("Small"),value:"0.25rem"},"rounded-md":{label:j("Medium"),value:"0.375rem"},"rounded-lg":{label:j("Large"),value:"0.5rem"},"rounded-xl":{label:j("Larger"),value:"0.75rem"},"rounded-full":{label:j("Pill"),value:"9999px"}},$e=""+new URL("font-bxNTk0j0.svg",import.meta.url).href;function Le({state:{filters:s,setFilters:a}}){const{trans:t}=ee();return e.jsxs("div",{className:"mb-24 items-center gap-24 @xs:flex",children:[e.jsx(se,{className:"mb-12 flex-auto @xs:mb-0",value:s.query,onChange:n=>{a({...s,query:n.target.value})},startAdornment:e.jsx(te,{}),placeholder:t(j("Search fonts"))}),e.jsxs(z,{className:"flex-auto",selectionMode:"single",selectedValue:s.category,onSelectionChange:n=>{a({...s,category:n})},children:[e.jsx(y,{value:"",children:e.jsx(o,{message:"All categories"})}),e.jsx(y,{value:"serif",children:e.jsx(o,{message:"Serif"})}),e.jsx(y,{value:"sans-serif",children:e.jsx(o,{message:"Sans serif"})}),e.jsx(y,{value:"display",children:e.jsx(o,{message:"Display"})}),e.jsx(y,{value:"handwriting",children:e.jsx(o,{message:"Handwriting"})}),e.jsx(y,{value:"monospace",children:e.jsx(o,{message:"Monospace"})})]})]})}const Re=[{label:j("System"),family:'ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',category:"sans-serif"},{family:"Impact, Charcoal, sans-serif",category:"sans-serif"},{family:"Arial, Helvetica Neue, Helvetica, sans-serif",category:"serif"},{family:'"Comic Sans MS", cursive, sans-serif',category:"Handwriting"},{family:"Century Gothic, sans-serif",category:"sans-serif"},{family:'"Courier New", Courier, monospace',category:"monospace"},{family:'"Lucida Sans Unicode", "Lucida Grande", sans-serif',category:"sans-serif"},{family:'"Times New Roman", Times, serif',category:"serif"},{family:'"Lucida Console", Monaco, monospace',category:"monospace"},{family:'"Andele Mono", monospace, sans-serif',category:"sans-serif"},{family:"Verdana, Geneva, sans-serif",category:"sans-serif"},{family:'"Helvetica Neue", Helvetica, Arial, sans-serif',category:"sans-serif"}];function Ee(s,a){return s.reduce((t,n,l)=>{const m=Math.floor(l/a);return t[m]||(t[m]=[]),t[m].push(n),t},[])}function qe({value:s,onChange:a}){const{data:t,isLoading:n}=ae(["googleFonts"]),[l,m]=p.useState(0),[i,h]=p.useState({query:"",category:(s==null?void 0:s.category)??""}),{contains:c}=we({sensitivity:"base"}),d=p.useMemo(()=>Re.concat((t==null?void 0:t.googleFonts)??[]),[t==null?void 0:t.googleFonts]),f=p.useMemo(()=>d.filter(g=>{var b;return c(g.family,i.query)&&(!i.category||((b=g.category)==null?void 0:b.toLowerCase())===i.category.toLowerCase())}),[d,i,c]),r=p.useMemo(()=>Ee(f,20),[f]),x=r[l];p.useEffect(()=>{if(t&&(s!=null&&s.family)){const g=f.findIndex(b=>b.family===s.family);g>=0&&m(Math.floor(g/20))}},[t,f,s==null?void 0:s.family]),p.useEffect(()=>{x!=null&&x.length&&ie(x,{id:"font-selector"})},[x,l]);const u=p.useCallback(g=>{h(g),m(0)},[]);return{fonts:x||[],currentPage:l,filteredFonts:f||[],setCurrentPage:m,isLoading:n,filters:i,setFilters:u,value:s,onChange:a,pages:r}}function He({state:{currentPage:s=0,setCurrentPage:a,filteredFonts:t,pages:n}}){const l=(t==null?void 0:t.length)||0;return e.jsxs("div",{className:"mt-30 flex items-center justify-end gap-24 border-t pt-14 text-sm",children:[l>0&&e.jsx("div",{children:e.jsx(o,{message:":from - :to of :total",values:{from:s*20+1,to:Math.min((s+1)*20,l),total:l}})}),e.jsxs("div",{className:"text-muted",children:[e.jsx(C,{disabled:s<1,onClick:()=>{a(Math.max(0,s-1))},children:e.jsx(ne,{})}),e.jsx(C,{disabled:s>=n.length-1,onClick:()=>{a(s+1)},children:e.jsx(Ce,{})})]})]})}function Oe(s){const a=qe(s);return e.jsxs("div",{className:s.className,children:[e.jsx(Le,{state:a}),e.jsx(re,{initial:!1,mode:"wait",children:e.jsx(Ue,{state:a})}),e.jsx(He,{state:a})]})}function Ue({state:s}){const{isLoading:a,fonts:t}=s,n="grid gap-24 grid-cols-[repeat(auto-fill,minmax(90px,1fr))] items-start";return a?e.jsx(ze,{className:n}):t!=null&&t.length?e.jsx(H.div,{...O,className:n,children:t==null?void 0:t.map(l=>e.jsx(We,{font:l,state:s},l.family))},"font-list"):e.jsx(oe,{className:"mt-60",size:"sm",image:e.jsx(le,{src:$e}),title:e.jsx(o,{message:"No matching fonts"}),description:e.jsx(o,{message:"Try another search query or different category"})})}function We({font:s,state:{value:a,onChange:t}}){const n=(a==null?void 0:a.family)===s.family,l=s.family.split(",")[0].replace(/"/g,"");return e.jsxs(U,{display:"block",onClick:()=>{t(s)},children:[e.jsx("span",{className:V("flex aspect-square items-center justify-center rounded-panel border text-4xl transition-bg-color hover:bg-hover md:text-5xl",n&&"ring-2 ring-primary ring-offset-2"),children:e.jsx("span",{style:{fontFamily:s.family},children:"Aa"})}),e.jsx("span",{className:V("mt-6 block overflow-hidden overflow-ellipsis whitespace-nowrap text-sm",n&&"text-primary"),children:s.label?e.jsx(o,{...s.label}):l})]},s.family)}function ze({className:s}){const a=Array.from(Array(20).keys());return e.jsx(H.div,{...O,className:s,children:a.map(t=>e.jsxs("div",{children:[e.jsx("div",{className:"aspect-square",children:e.jsx(M,{display:"block",variant:"rect"})}),e.jsx(M,{className:"mt-6 text-sm"})]},t))},"font-list-skeleton")}function ws(){var l,m;const{data:s}=_(),{auth:a}=p.use(ce),t=s.themes.filter(i=>i.type==="site"),n=A({defaultValues:{themes:t,client:{themes:{default_id:(l=s.client.themes)!=null&&l.default_id?parseInt(s.client.themes.default_id):0,user_change:((m=s.client.themes)==null?void 0:m.user_change)??!1}}}});return e.jsxs(k,{title:e.jsx(o,{message:"Themes"}),defaultRoute:me().auth_redirect_uri??"/",docsLink:he.settings.themes,children:[e.jsx(k.Content,{children:e.jsxs(k.Form,{form:n,children:[e.jsxs("div",{className:"mb-20 border-b pb-20",children:[e.jsxs(Se,{className:"mb-20",size:"sm",name:"client.themes.default_id",selectionMode:"single",label:e.jsx(o,{message:"Default site theme"}),children:[e.jsx(y,{value:0,children:e.jsx(o,{message:"System"})}),t.map(i=>e.jsx(y,{value:i.id,children:i.name},i.id))]}),e.jsx(w,{name:"client.themes.user_change",children:e.jsx(o,{message:"Allow users to switch theme"})})]}),e.jsx(Ke,{})]})}),e.jsx(k.Preview,{})]})}function Ke({size:s="lg",type:a="site"}){var f;const t=v(r=>r.preview),n=S(),l=de({name:"themes"}).filter(r=>r.type===a),{selectedTheme:m}=ue(),[i,h]=p.useState(()=>{var x;const r=l.find(u=>u.id===m.id);return r?r.id:(x=l[0])==null?void 0:x.id}),c=n.watch("themes").find(r=>r.id===i),d=r=>{if(r===i)return;h(r);const x=n.getValues("themes").find(u=>u.id===r);x&&t.setActiveTheme(x.id)};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-24 flex items-center gap-8",children:[e.jsx(Ae,{selectedThemeId:i,onSelectionChange:d,allThemes:l}),e.jsx(De,{selectedThemeId:i,initialThemeId:m.id,onSelectedThemeChange:d}),e.jsx(Ie,{type:a,onCreated:d})]}),e.jsxs(Ne,{variant:"outline",size:s,className:"mb-10",children:[e.jsx(B,{fontClassName:"text-sm",label:e.jsx(o,{message:"Font"}),descriptionClassName:"overflow-hidden text-ellipsis whitespace-nowrap text-xs text-muted",description:(f=c==null?void 0:c.font)!=null&&f.family?c.font.family:e.jsx(o,{message:"System"}),children:e.jsx(Pe,{themeId:i})}),e.jsxs(B,{label:e.jsx(o,{message:"Rounding"}),fontClassName:"text-sm",children:[e.jsx(I,{label:e.jsx(o,{message:"Button rounding"}),name:"button-radius",themeId:i,className:"mb-24"}),e.jsx(I,{label:e.jsx(o,{message:"Input rounding"}),name:"input-radius",themeId:i,className:"mb-24"}),e.jsx(I,{label:e.jsx(o,{message:"Panel rounding"}),name:"panel-radius",hidePill:!0,themeId:i})]})]}),Me.map(r=>e.jsx(_e,{colorName:r.key,size:s,label:e.jsx(o,{...r.label}),initialThemeValue:(c==null?void 0:c.values[r.key])??"",themeId:i},r.key))]})}function Pe({themeId:s}){const a=v(i=>i.preview),{setValue:t,watch:n}=S(),m=`themes.${n("themes").findIndex(i=>i.id===s)}.font`;return e.jsx(Oe,{value:n(m),onChange:i=>{t(m,i,{shouldDirty:!0}),a.setThemeFont(i)}})}function I({label:s,name:a,hidePill:t,themeId:n,className:l}){const m=v(r=>r.preview),{watch:i,setValue:h}=S(),d=`themes.${i("themes").findIndex(r=>r.id===n)}.values.--be-${a}`,f=i(d);return e.jsxs("div",{className:l,children:[e.jsx("div",{className:"mb-10 text-sm font-semibold",children:s}),e.jsx("div",{className:"grid grid-cols-3 gap-10 text-sm",children:Object.entries(Be).filter(([r])=>!t||!r.includes("full")).map(([r,{label:x,value:u}])=>e.jsx(U,{display:"block",className:V("h-36 border-2 hover:bg-hover",r,u===f&&"border-primary"),onClick:()=>{h(d,u,{shouldDirty:!0}),m.setThemeValue(`--be-${a}`,u)},children:e.jsx(o,{...x})},r))})]})}export{ws as Component,Ke as ThemeEditor};
