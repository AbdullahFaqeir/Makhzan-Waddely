import{aD as C,l as k,b3 as w,an as F,ap as P,bm as S,k as R,g as j,b2 as _,aA as E,a2 as A,j as e,bn as L,T as s,a1 as I,am as T,a3 as u,B as q,aH as B,x as M,L as D,b1 as U}from"./main-TIUJvpaR.js";import{G,A as O}from"./auth-layout-DWQg2Sxo.js";import{u as z,C as H}from"./use-captcha-fHl8O9vq.js";import{L as b}from"./external-link-DvqU4uvd.js";import{F as Q}from"./checkbox-kZVscZNC.js";import{S as V}from"./social-auth-section-jZCqz3zw.js";import"./CheckBoxOutlineBlank-p6gxL9Ym.js";import"./use-social-login-w6iLlymj.js";import"./use-all-social-logins-disabled-BoQ09ZS1.js";import"./envato-zsG_WUKe.js";import"./google-Dkq6mbpd.js";import"./dialog-footer-yCpPZGPO.js";function J(a){const t=C(),{getRedirectUri:i}=k(),{inviteId:n}=w();return F({mutationFn:r=>K({invite_id:n,...r}),onSuccess:r=>{S(r.bootstrapData),r.status==="needs_email_verification"?t("/"):t(i(),{replace:!0})},onError:r=>P(r,a)})}function K(a){return R.post("auth/register",a).then(t=>t.data)}function me({inviteType:a,fields:t}){const{branding:i,registration:n,social:r}=j(),{captchaToken:l,captchaEnabled:g,resetCaptcha:f}=z("register"),{pathname:v}=_(),[d]=E(),o=v.includes("workspace")||!!a,N=d.get("redirectFrom")==="pricing",p=d.get("email")||void 0,x=A({defaultValues:{email:p}}),h=J(x);if(n!=null&&n.disable&&!o)return e.jsx(L,{to:"/login",replace:!0});let m=e.jsx(s,{message:"Create a new account"});o?m=e.jsx(s,{values:{siteName:i==null?void 0:i.site_name},message:"To join your team on :siteName, create an account"}):N&&(m=e.jsx(s,{message:"First, let's create your account"}));const y=e.jsx(s,{values:{a:c=>e.jsx(D,{className:b,to:"/login",children:c})},message:"Already have an account? <a>Sign in.</a>"});return e.jsx(G,{children:e.jsxs(O,{heading:m,message:y,children:[e.jsx(I,{children:e.jsx(s,{message:"Register"})}),e.jsxs(T,{form:x,onSubmit:async c=>{if(g&&!l){B.danger(M("Please solve the captcha challenge."));return}h.mutate({...c,captcha_token:l,invite_type:a},{onError:()=>f()})},children:[e.jsx(u,{className:"mb-32",name:"email",type:"email",disabled:!!p,label:e.jsx(s,{message:"Email"}),required:!0}),e.jsx(u,{className:"mb-32",name:"password",type:"password",label:e.jsx(s,{message:"Password"}),required:!0}),e.jsx(u,{className:"mb-32",name:"password_confirmation",type:"password",label:e.jsx(s,{message:"Confirm password"}),required:!0}),t,g&&e.jsx(H,{className:"mb-32"}),e.jsx(W,{}),e.jsx(q,{className:"block w-full",type:"submit",variant:"flat",color:"primary",size:"md",disabled:h.isPending,children:e.jsx(s,{message:"Create account"})}),e.jsx(V,{isUsingInvite:o,dividerMessage:r!=null&&r.compact_buttons?e.jsx(s,{message:"Or sign up with"}):e.jsx(s,{message:"OR"})})]})]})})}function W(){const{registration:a}=j();return a!=null&&a.policies?e.jsx("div",{className:"mb-32",children:a.policies.map(t=>e.jsx(Q,{name:t.id,className:"mb-4 block",required:!0,children:e.jsx(s,{message:"I accept the :name",values:{name:e.jsx(U,{unstyled:!0,className:()=>b,item:t})}})},t.id))}):null}export{me as RegisterPage};
