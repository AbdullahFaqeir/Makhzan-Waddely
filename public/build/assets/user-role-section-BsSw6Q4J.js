import{aF as u,ap as l,ar as m,aq as c,aJ as d,x as p,ax as h,k as x,cY as j,j as t,ao as U,r as F,l as f,a6 as v,aE as S,T as i}from"./main-BdzhGpqn.js";import{D as y,b as E}from"./crupdate-resource-layout-wC4RWJ3G.js";import{u as b}from"./use-normalized-models-yOhv1j4Y.js";import{F as C}from"./form-chip-field-Bj0OQHU9.js";function g(r,e){const a=u();return l({mutationFn:s=>w(r,s),onSuccess:()=>{d(p("User updated")),h.invalidateQueries({queryKey:["users"]}),a("../..",{relative:"path"})},onError:s=>e?m(s,e):c(s)})}function w(r,e){return e.roles&&(e.roles=e.roles.map(a=>a.id)),x.put(`users/${r}`,e).then(a=>a.data)}function I({form:r,children:e}){const a=j(),s=g(a.id,r);return t.jsxs(U,{onSubmit:n=>{s.mutate(n)},onBeforeSubmit:()=>r.clearErrors(),form:r,children:[e,t.jsx(y,{isLoading:s.isPending})]})}function N({endpoint:r}){const[e,a]=F.useState(""),{data:s}=b(r??"normalized-models/role",{query:e}),{hasPermission:n}=f();return t.jsx(E,{label:t.jsx(i,{message:"Roles"}),children:t.jsx(C,{className:"mb-30",name:"roles",suggestions:s==null?void 0:s.results,inputValue:e,onInputValueChange:a,alwaysShowAvatar:!0,readOnly:!n("users.update"),description:t.jsx(i,{message:"User will inherit all permissions from the roles they are assigned."}),children:o=>t.jsx(v,{value:o.id,startIcon:t.jsx(S,{label:o.name}),children:o.name},o.id)})})}export{I as U,N as a};
