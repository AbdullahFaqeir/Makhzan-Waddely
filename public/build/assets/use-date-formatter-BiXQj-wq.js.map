{"version":3,"file":"use-date-formatter-BiXQj-wq.js","sources":["../../../node_modules/@internationalized/date/dist/DateFormatter.mjs","../../../common/foundation/resources/client/ui/library/i18n/use-date-formatter.ts"],"sourcesContent":["/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */ let $fb18d541ea1ad717$var$formatterCache = new Map();\nclass $fb18d541ea1ad717$export$ad991b66133851cf {\n    /** Formats a date as a string according to the locale and format options passed to the constructor. */ format(value) {\n        return this.formatter.format(value);\n    }\n    /** Formats a date to an array of parts such as separators, numbers, punctuation, and more. */ formatToParts(value) {\n        return this.formatter.formatToParts(value);\n    }\n    /** Formats a date range as a string. */ formatRange(start, end) {\n        // @ts-ignore\n        if (typeof this.formatter.formatRange === 'function') // @ts-ignore\n        return this.formatter.formatRange(start, end);\n        if (end < start) throw new RangeError('End date must be >= start date');\n        // Very basic fallback for old browsers.\n        return `${this.formatter.format(start)} \\u{2013} ${this.formatter.format(end)}`;\n    }\n    /** Formats a date range as an array of parts. */ formatRangeToParts(start, end) {\n        // @ts-ignore\n        if (typeof this.formatter.formatRangeToParts === 'function') // @ts-ignore\n        return this.formatter.formatRangeToParts(start, end);\n        if (end < start) throw new RangeError('End date must be >= start date');\n        let startParts = this.formatter.formatToParts(start);\n        let endParts = this.formatter.formatToParts(end);\n        return [\n            ...startParts.map((p)=>({\n                    ...p,\n                    source: 'startRange'\n                })),\n            {\n                type: 'literal',\n                value: \" \\u2013 \",\n                source: 'shared'\n            },\n            ...endParts.map((p)=>({\n                    ...p,\n                    source: 'endRange'\n                }))\n        ];\n    }\n    /** Returns the resolved formatting options based on the values passed to the constructor. */ resolvedOptions() {\n        let resolvedOptions = this.formatter.resolvedOptions();\n        if ($fb18d541ea1ad717$var$hasBuggyResolvedHourCycle()) {\n            if (!this.resolvedHourCycle) this.resolvedHourCycle = $fb18d541ea1ad717$var$getResolvedHourCycle(resolvedOptions.locale, this.options);\n            resolvedOptions.hourCycle = this.resolvedHourCycle;\n            resolvedOptions.hour12 = this.resolvedHourCycle === 'h11' || this.resolvedHourCycle === 'h12';\n        }\n        // Safari uses a different name for the Ethiopic (Amete Alem) calendar.\n        // https://bugs.webkit.org/show_bug.cgi?id=241564\n        if (resolvedOptions.calendar === 'ethiopic-amete-alem') resolvedOptions.calendar = 'ethioaa';\n        return resolvedOptions;\n    }\n    constructor(locale, options = {}){\n        this.formatter = $fb18d541ea1ad717$var$getCachedDateFormatter(locale, options);\n        this.options = options;\n    }\n}\n// There are multiple bugs involving the hour12 and hourCycle options in various browser engines.\n//   - Chrome [1] (and the ECMA 402 spec [2]) resolve hour12: false in English and other locales to h24 (24:00 - 23:59)\n//     rather than h23 (00:00 - 23:59). Same can happen with hour12: true in French, which Chrome resolves to h11 (00:00 - 11:59)\n//     rather than h12 (12:00 - 11:59).\n//   - WebKit returns an incorrect hourCycle resolved option in the French locale due to incorrect parsing of 'h' literal\n//     in the resolved pattern. It also formats incorrectly when specifying the hourCycle option for the same reason. [3]\n// [1] https://bugs.chromium.org/p/chromium/issues/detail?id=1045791\n// [2] https://github.com/tc39/ecma402/issues/402\n// [3] https://bugs.webkit.org/show_bug.cgi?id=229313\n// https://github.com/unicode-org/cldr/blob/018b55eff7ceb389c7e3fc44e2f657eae3b10b38/common/supplemental/supplementalData.xml#L4774-L4802\nconst $fb18d541ea1ad717$var$hour12Preferences = {\n    true: {\n        // Only Japanese uses the h11 style for 12 hour time. All others use h12.\n        ja: 'h11'\n    },\n    false: {\n    }\n};\nfunction $fb18d541ea1ad717$var$getCachedDateFormatter(locale, options = {}) {\n    // Work around buggy hour12 behavior in Chrome / ECMA 402 spec by using hourCycle instead.\n    // Only apply the workaround if the issue is detected, because the hourCycle option is buggy in Safari.\n    if (typeof options.hour12 === 'boolean' && $fb18d541ea1ad717$var$hasBuggyHour12Behavior()) {\n        options = {\n            ...options\n        };\n        let pref = $fb18d541ea1ad717$var$hour12Preferences[String(options.hour12)][locale.split('-')[0]];\n        let defaultHourCycle = options.hour12 ? 'h12' : 'h23';\n        options.hourCycle = pref !== null && pref !== void 0 ? pref : defaultHourCycle;\n        delete options.hour12;\n    }\n    let cacheKey = locale + (options ? Object.entries(options).sort((a, b)=>a[0] < b[0] ? -1 : 1).join() : '');\n    if ($fb18d541ea1ad717$var$formatterCache.has(cacheKey)) return $fb18d541ea1ad717$var$formatterCache.get(cacheKey);\n    let numberFormatter = new Intl.DateTimeFormat(locale, options);\n    $fb18d541ea1ad717$var$formatterCache.set(cacheKey, numberFormatter);\n    return numberFormatter;\n}\nlet $fb18d541ea1ad717$var$_hasBuggyHour12Behavior = null;\nfunction $fb18d541ea1ad717$var$hasBuggyHour12Behavior() {\n    if ($fb18d541ea1ad717$var$_hasBuggyHour12Behavior == null) $fb18d541ea1ad717$var$_hasBuggyHour12Behavior = new Intl.DateTimeFormat('en-US', {\n        hour: 'numeric',\n        hour12: false\n    }).format(new Date(2020, 2, 3, 0)) === '24';\n    return $fb18d541ea1ad717$var$_hasBuggyHour12Behavior;\n}\nlet $fb18d541ea1ad717$var$_hasBuggyResolvedHourCycle = null;\nfunction $fb18d541ea1ad717$var$hasBuggyResolvedHourCycle() {\n    if ($fb18d541ea1ad717$var$_hasBuggyResolvedHourCycle == null) $fb18d541ea1ad717$var$_hasBuggyResolvedHourCycle = new Intl.DateTimeFormat('fr', {\n        hour: 'numeric',\n        hour12: false\n    }).resolvedOptions().hourCycle === 'h12';\n    return $fb18d541ea1ad717$var$_hasBuggyResolvedHourCycle;\n}\nfunction $fb18d541ea1ad717$var$getResolvedHourCycle(locale, options) {\n    if (!options.timeStyle && !options.hour) return undefined;\n    // Work around buggy results in resolved hourCycle and hour12 options in WebKit.\n    // Format the minimum possible hour and maximum possible hour in a day and parse the results.\n    locale = locale.replace(/(-u-)?-nu-[a-zA-Z0-9]+/, '');\n    locale += (locale.includes('-u-') ? '' : '-u') + '-nu-latn';\n    let formatter = $fb18d541ea1ad717$var$getCachedDateFormatter(locale, {\n        ...options,\n        timeZone: undefined // use local timezone\n    });\n    let min = parseInt(formatter.formatToParts(new Date(2020, 2, 3, 0)).find((p)=>p.type === 'hour').value, 10);\n    let max = parseInt(formatter.formatToParts(new Date(2020, 2, 3, 23)).find((p)=>p.type === 'hour').value, 10);\n    if (min === 0 && max === 23) return 'h23';\n    if (min === 24 && max === 23) return 'h24';\n    if (min === 0 && max === 11) return 'h11';\n    if (min === 12 && max === 11) return 'h12';\n    throw new Error('Unexpected hour cycle result');\n}\n\n\nexport {$fb18d541ea1ad717$export$ad991b66133851cf as DateFormatter};\n//# sourceMappingURL=DateFormatter.module.js.map\n","import {DateFormatter} from '@internationalized/date';\nimport {useSelectedLocale} from '@ui/i18n/selected-locale';\nimport {shallowEqual} from '@ui/utils/shallow-equal';\nimport {useMemo, useRef} from 'react';\n\nexport function useDateFormatter(\n  options?: Intl.DateTimeFormatOptions,\n): DateFormatter {\n  // Reuse last options object if it is shallowly equal, which allows the useMemo result to also be reused.\n  const lastOptions = useRef<Intl.DateTimeFormatOptions | undefined | null>(\n    null,\n  );\n  if (\n    options &&\n    lastOptions.current &&\n    shallowEqual(options as any, lastOptions.current)\n  ) {\n    options = lastOptions.current;\n  }\n\n  lastOptions.current = options;\n\n  const {localeCode} = useSelectedLocale();\n  return useMemo(\n    () => new DateFormatter(localeCode, options),\n    [localeCode, options],\n  );\n}\n"],"names":["$fb18d541ea1ad717$var$formatterCache","$fb18d541ea1ad717$export$ad991b66133851cf","value","start","end","startParts","endParts","p","resolvedOptions","$fb18d541ea1ad717$var$hasBuggyResolvedHourCycle","$fb18d541ea1ad717$var$getResolvedHourCycle","locale","options","$fb18d541ea1ad717$var$getCachedDateFormatter","$fb18d541ea1ad717$var$hour12Preferences","$fb18d541ea1ad717$var$hasBuggyHour12Behavior","pref","defaultHourCycle","cacheKey","b","numberFormatter","$fb18d541ea1ad717$var$_hasBuggyHour12Behavior","$fb18d541ea1ad717$var$_hasBuggyResolvedHourCycle","formatter","min","max","useDateFormatter","lastOptions","useRef","shallowEqual","localeCode","useSelectedLocale","useMemo","DateFormatter"],"mappings":"qDAUI,IAAIA,EAAuC,IAAI,IACnD,MAAMC,CAA0C,CAC4D,OAAOC,EAAO,CAClH,OAAO,KAAK,UAAU,OAAOA,CAAK,CACtC,CAC+F,cAAcA,EAAO,CAChH,OAAO,KAAK,UAAU,cAAcA,CAAK,CAC7C,CACyC,YAAYC,EAAOC,EAAK,CAE7D,GAAI,OAAO,KAAK,UAAU,aAAgB,WAC1C,OAAO,KAAK,UAAU,YAAYD,EAAOC,CAAG,EAC5C,GAAIA,EAAMD,EAAO,MAAM,IAAI,WAAW,gCAAgC,EAEtE,MAAO,GAAG,KAAK,UAAU,OAAOA,CAAK,CAAC,MAAa,KAAK,UAAU,OAAOC,CAAG,CAAC,EACjF,CACkD,mBAAmBD,EAAOC,EAAK,CAE7E,GAAI,OAAO,KAAK,UAAU,oBAAuB,WACjD,OAAO,KAAK,UAAU,mBAAmBD,EAAOC,CAAG,EACnD,GAAIA,EAAMD,EAAO,MAAM,IAAI,WAAW,gCAAgC,EACtE,IAAIE,EAAa,KAAK,UAAU,cAAcF,CAAK,EAC/CG,EAAW,KAAK,UAAU,cAAcF,CAAG,EAC/C,MAAO,CACH,GAAGC,EAAW,IAAKE,IAAK,CAChB,GAAGA,EACH,OAAQ,YAC5B,EAAkB,EACN,CACI,KAAM,UACN,MAAO,MACP,OAAQ,QACxB,EACY,GAAGD,EAAS,IAAKC,IAAK,CACd,GAAGA,EACH,OAAQ,UAC5B,EAAkB,CAClB,CACI,CAC8F,iBAAkB,CAC5G,IAAIC,EAAkB,KAAK,UAAU,gBAAe,EACpD,OAAIC,EAA+C,IAC1C,KAAK,oBAAmB,KAAK,kBAAoBC,EAA2CF,EAAgB,OAAQ,KAAK,OAAO,GACrIA,EAAgB,UAAY,KAAK,kBACjCA,EAAgB,OAAS,KAAK,oBAAsB,OAAS,KAAK,oBAAsB,OAIxFA,EAAgB,WAAa,wBAAuBA,EAAgB,SAAW,WAC5EA,CACX,CACA,YAAYG,EAAQC,EAAU,GAAG,CAC7B,KAAK,UAAYC,EAA6CF,EAAQC,CAAO,EAC7E,KAAK,QAAUA,CACnB,CACJ,CAWA,MAAME,EAA0C,CAC5C,KAAM,CAEF,GAAI,KACZ,EACI,MAAO,CACX,CACA,EACA,SAASD,EAA6CF,EAAQC,EAAU,GAAI,CAGxE,GAAI,OAAOA,EAAQ,QAAW,WAAaG,EAA4C,EAAI,CACvFH,EAAU,CACN,GAAGA,CACf,EACQ,IAAII,EAAOF,EAAwC,OAAOF,EAAQ,MAAM,CAAC,EAAED,EAAO,MAAM,GAAG,EAAE,CAAC,CAAC,EAC3FM,EAAmBL,EAAQ,OAAS,MAAQ,MAChDA,EAAQ,UAAYI,GAA0CC,EAC9D,OAAOL,EAAQ,MACnB,CACA,IAAIM,EAAWP,GAAUC,EAAU,OAAO,QAAQA,CAAO,EAAE,KAAK,CAAC,EAAGO,IAAI,EAAE,CAAC,EAAIA,EAAE,CAAC,EAAI,GAAK,CAAC,EAAE,KAAI,EAAK,IACvG,GAAInB,EAAqC,IAAIkB,CAAQ,EAAG,OAAOlB,EAAqC,IAAIkB,CAAQ,EAChH,IAAIE,EAAkB,IAAI,KAAK,eAAeT,EAAQC,CAAO,EAC7D,OAAAZ,EAAqC,IAAIkB,EAAUE,CAAe,EAC3DA,CACX,CACA,IAAIC,EAAgD,KACpD,SAASN,GAA+C,CACpD,OAAIM,GAAiD,OAAMA,EAAgD,IAAI,KAAK,eAAe,QAAS,CACxI,KAAM,UACN,OAAQ,EAChB,CAAK,EAAE,OAAO,IAAI,KAAK,KAAM,EAAG,EAAG,CAAC,CAAC,IAAM,MAChCA,CACX,CACA,IAAIC,EAAmD,KACvD,SAASb,GAAkD,CACvD,OAAIa,GAAoD,OAAMA,EAAmD,IAAI,KAAK,eAAe,KAAM,CAC3I,KAAM,UACN,OAAQ,EAChB,CAAK,EAAE,kBAAkB,YAAc,OAC5BA,CACX,CACA,SAASZ,EAA2CC,EAAQC,EAAS,CACjE,GAAI,CAACA,EAAQ,WAAa,CAACA,EAAQ,KAAM,OAGzCD,EAASA,EAAO,QAAQ,yBAA0B,EAAE,EACpDA,IAAWA,EAAO,SAAS,KAAK,EAAI,GAAK,MAAQ,WACjD,IAAIY,EAAYV,EAA6CF,EAAQ,CACjE,GAAGC,EACH,SAAU,MAClB,CAAK,EACGY,EAAM,SAASD,EAAU,cAAc,IAAI,KAAK,KAAM,EAAG,EAAG,CAAC,CAAC,EAAE,KAAMhB,GAAIA,EAAE,OAAS,MAAM,EAAE,MAAO,EAAE,EACtGkB,EAAM,SAASF,EAAU,cAAc,IAAI,KAAK,KAAM,EAAG,EAAG,EAAE,CAAC,EAAE,KAAMhB,GAAIA,EAAE,OAAS,MAAM,EAAE,MAAO,EAAE,EAC3G,GAAIiB,IAAQ,GAAKC,IAAQ,GAAI,MAAO,MACpC,GAAID,IAAQ,IAAMC,IAAQ,GAAI,MAAO,MACrC,GAAID,IAAQ,GAAKC,IAAQ,GAAI,MAAO,MACpC,GAAID,IAAQ,IAAMC,IAAQ,GAAI,MAAO,MACrC,MAAM,IAAI,MAAM,8BAA8B,CAClD,CClIO,SAASC,EACdd,EACe,CAEf,MAAMe,EAAcC,EAAAA,OAClB,IAAA,EAGAhB,GACAe,EAAY,SACZE,EAAajB,EAAgBe,EAAY,OAAO,IAEhDf,EAAUe,EAAY,SAGxBA,EAAY,QAAUf,EAEtB,KAAM,CAAC,WAAAkB,CAAA,EAAcC,EAAA,EACrB,OAAOC,EAAAA,QACL,IAAM,IAAIC,EAAcH,EAAYlB,CAAO,EAC3C,CAACkB,EAAYlB,CAAO,CAAA,CAExB","x_google_ignoreList":[0]}