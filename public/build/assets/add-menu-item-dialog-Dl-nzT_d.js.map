{"version":3,"file":"add-menu-item-dialog-Dl-nzT_d.js","sources":["../../../common/foundation/resources/client/admin/settings/pages/menu-settings/add-menu-item-dialog.tsx"],"sourcesContent":["import {commonAdminQueries} from '@common/admin/common-admin-queries';\nimport {useAvailableRoutes} from '@common/admin/settings/pages/menu-settings/use-available-routes';\nimport {MenuItemConfig} from '@common/menus/menu-config';\nimport {useQuery} from '@tanstack/react-query';\nimport {Accordion, AccordionItem} from '@ui/accordion/accordion';\nimport {Button} from '@ui/buttons/button';\nimport {Form} from '@ui/forms/form';\nimport {\n  FormTextField,\n  TextField,\n} from '@ui/forms/input-field/text-field/text-field';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {useFilter} from '@ui/i18n/use-filter';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {AddIcon} from '@ui/icons/material/Add';\nimport {List, ListItem} from '@ui/list/list';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {ucFirst} from '@ui/utils/string/uc-first';\nimport {nanoid} from 'nanoid';\nimport {Fragment, ReactNode, useState} from 'react';\nimport {useForm} from 'react-hook-form';\n\ninterface AddMenuItemDialogProps {\n  title?: ReactNode;\n}\nexport function AddMenuItemDialog({\n  title = <Trans message=\"Add menu item\" />,\n}: AddMenuItemDialogProps) {\n  const {type} = useDialogContext();\n  const {data} = useQuery(commonAdminQueries.settings.menuEditorConfig());\n  const routeItems = useAvailableRoutes();\n  const categories = data?.categories || [];\n  const maxHeight =\n    type === 'drawer' ? 'max-h-auto' : 'max-h-240 overflow-y-auto';\n\n  return (\n    <Dialog size={type === 'drawer' ? 'md' : 'sm'}>\n      <DialogHeader>{title}</DialogHeader>\n      <DialogBody>\n        <Accordion variant=\"outline\">\n          <AccordionItem\n            label={<Trans message=\"Link\" />}\n            bodyClassName={maxHeight}\n          >\n            <AddCustomLink />\n          </AccordionItem>\n          <AccordionItem\n            label={<Trans message=\"Route\" />}\n            bodyClassName={maxHeight}\n          >\n            <AddRoute items={routeItems} />\n          </AccordionItem>\n          {categories.map(category => (\n            <AccordionItem\n              bodyClassName={maxHeight}\n              key={category.name}\n              label={<Trans message={category.name} />}\n            >\n              <AddRoute items={category.items} />\n            </AccordionItem>\n          ))}\n        </Accordion>\n      </DialogBody>\n    </Dialog>\n  );\n}\n\nfunction AddCustomLink() {\n  const form = useForm<MenuItemConfig>({\n    defaultValues: {\n      id: nanoid(6),\n      type: 'link',\n      target: '_blank',\n    },\n  });\n  const {close} = useDialogContext();\n\n  return (\n    <Form\n      form={form}\n      onSubmit={value => {\n        close(value);\n      }}\n    >\n      <FormTextField\n        required\n        name=\"label\"\n        label={<Trans message=\"Label\" />}\n        className=\"mb-20\"\n      />\n      <FormTextField\n        required\n        type=\"url\"\n        name=\"action\"\n        placeholder=\"https://\"\n        label={<Trans message=\"Url\" />}\n        className=\"mb-20\"\n      />\n      <div className=\"text-right\">\n        <Button type=\"submit\" variant=\"flat\" color=\"primary\" size=\"xs\">\n          <Trans message=\"Add to menu\" />\n        </Button>\n      </div>\n    </Form>\n  );\n}\n\ninterface AddRouteProps {\n  items: Partial<MenuItemConfig>[];\n}\nfunction AddRoute({items}: AddRouteProps) {\n  const {trans} = useTrans();\n  const {close} = useDialogContext();\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const {contains} = useFilter({\n    sensitivity: 'base',\n  });\n  const matchedItems = items.filter(item =>\n    contains(item.action ?? '', searchQuery),\n  );\n\n  return (\n    <Fragment>\n      <TextField\n        placeholder={trans(message('Search...'))}\n        value={searchQuery}\n        size=\"sm\"\n        onChange={e => setSearchQuery(e.target.value)}\n        className=\"mb-12\"\n      />\n      <List>\n        {matchedItems.map(item => {\n          return (\n            <ListItem\n              key={item.id}\n              startIcon={<AddIcon size=\"sm\" />}\n              onSelected={() => {\n                if (item.label) {\n                  const last = item.label.split('/').pop();\n                  item.label = last ? ucFirst(last) : item.label;\n                  item.id = nanoid(6);\n                }\n                if (!item.target) {\n                  item.target = '_self';\n                }\n                close(item);\n              }}\n            >\n              {item.label}\n            </ListItem>\n          );\n        })}\n      </List>\n    </Fragment>\n  );\n}\n"],"names":["AddMenuItemDialog","title","jsx","Trans","type","useDialogContext","data","useQuery","commonAdminQueries","routeItems","useAvailableRoutes","categories","maxHeight","Dialog","DialogHeader","DialogBody","jsxs","Accordion","AccordionItem","AddCustomLink","AddRoute","category","form","useForm","nanoid","close","Form","value","FormTextField","Button","items","trans","useTrans","searchQuery","setSearchQuery","useState","contains","useFilter","matchedItems","item","Fragment","TextField","message","List","ListItem","AddIcon","last","ucFirst"],"mappings":"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"}