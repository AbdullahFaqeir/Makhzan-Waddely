{"version":3,"file":"schedule-log-datatable-Drv6_p5W.js","sources":["../../../common/foundation/resources/client/datatable/column-templates/boolean-indicator.tsx","../../../common/foundation/resources/client/admin/logging/schedule/schedule-datatable-columns.tsx","../../../common/foundation/resources/client/admin/logging/schedule/timeline.svg","../../../common/foundation/resources/client/admin/logging/schedule/schedule-log-datatable.tsx"],"sourcesContent":["import {CheckIcon} from '@ui/icons/material/Check';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport React from 'react';\n\ninterface BooleanIndicatorProps {\n  value: boolean;\n}\nexport function BooleanIndicator({value}: BooleanIndicatorProps) {\n  if (value) {\n    return <CheckIcon className=\"text-positive icon-md\" />;\n  }\n  return <CloseIcon className=\"text-danger icon-md\" />;\n}\n","import {ColumnConfig} from '@common/datatable/column-config';\nimport {Trans} from '@ui/i18n/trans';\nimport {NameWithAvatar} from '@common/datatable/column-templates/name-with-avatar';\nimport {BooleanIndicator} from '@common/datatable/column-templates/boolean-indicator';\nimport {Tooltip} from '@ui/tooltip/tooltip';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport React from 'react';\nimport {ScheduleLogItem} from '@common/admin/logging/schedule/schedule-log-item';\nimport {useRerunScheduledCommand} from '@common/admin/logging/schedule/use-rerurun-scheduled-command';\nimport {EventRepeatIcon} from '@ui/icons/material/EventRepeat';\nimport {FormattedRelativeTime} from '@ui/i18n/formatted-relative-time';\n\nexport const ScheduleDatatableColumns: ColumnConfig<ScheduleLogItem>[] = [\n  {\n    key: 'command',\n    allowsSorting: true,\n    visibleInMode: 'all',\n    width: 'flex-3 min-w-200',\n    header: () => <Trans message=\"Name\" />,\n    body: item => (\n      <NameWithAvatar label={item.command} description={item.output} />\n    ),\n  },\n  {\n    key: 'ran_at',\n    allowsSorting: true,\n    header: () => <Trans message=\"Last ran at\" />,\n    body: item => <FormattedRelativeTime date={item.ran_at} />,\n  },\n  {\n    key: 'duration',\n    allowsSorting: true,\n    header: () => <Trans message=\"Duration\" />,\n    body: item => `${item.duration}ms`,\n  },\n  {\n    key: 'exit_code',\n    allowsSorting: true,\n    header: () => <Trans message=\"Completed\" />,\n    body: item => <BooleanIndicator value={item.exit_code === 0} />,\n  },\n  {\n    key: 'actions',\n    header: () => <Trans message=\"Actions\" />,\n    hideHeader: true,\n    align: 'end',\n    width: 'w-42 flex-shrink-0',\n    visibleInMode: 'all',\n    body: item => <RerunButton item={item} />,\n  },\n];\n\ninterface RerunButtonProps {\n  item: ScheduleLogItem;\n}\nfunction RerunButton({item}: RerunButtonProps) {\n  const rerunCommand = useRerunScheduledCommand();\n  return (\n    <Tooltip label={<Trans message=\"Rerun now\" />}>\n      <IconButton\n        size=\"md\"\n        className=\"text-muted\"\n        disabled={rerunCommand.isPending}\n        onClick={() => {\n          rerunCommand.mutate({id: item.id});\n        }}\n      >\n        <EventRepeatIcon />\n      </IconButton>\n    </Tooltip>\n  );\n}\n","export default \"__VITE_ASSET__BXJVGCLw__\"","import {commonAdminQueries} from '@common/admin/common-admin-queries';\nimport {ScheduleDatatableColumns} from '@common/admin/logging/schedule/schedule-datatable-columns';\nimport timelineImage from '@common/admin/logging/schedule/timeline.svg';\nimport {GlobalLoadingProgress} from '@common/core/global-loading-progress';\nimport {DataTableAddItemButton} from '@common/datatable/data-table-add-item-button';\nimport {DataTableHeader} from '@common/datatable/data-table-header';\nimport {DataTablePaginationFooter} from '@common/datatable/data-table-pagination-footer';\nimport {useDatatableSearchParams} from '@common/datatable/filters/utils/use-datatable-search-params';\nimport {validateDatatableSearch} from '@common/datatable/filters/utils/validate-datatable-search';\nimport {DataTableEmptyStateMessage} from '@common/datatable/page/data-table-emty-state-message';\nimport {\n  DatatablePageScrollContainer,\n  DatatablePageWithHeaderBody,\n  DatatablePageWithHeaderLayout,\n} from '@common/datatable/page/datatable-page-with-header-layout';\nimport {useDatatableQuery} from '@common/datatable/requests/use-datatable-query';\nimport {Table} from '@common/ui/tables/table';\nimport {Trans} from '@ui/i18n/trans';\nimport {DownloadIcon} from '@ui/icons/material/Download';\n\nexport function Component() {\n  const {\n    searchParams,\n    sortDescriptor,\n    mergeIntoSearchParams,\n    setSearchQuery,\n    isFiltering,\n  } = useDatatableSearchParams(validateDatatableSearch);\n\n  const query = useDatatableQuery({\n    ...commonAdminQueries.logs.cron(searchParams),\n  });\n\n  const actions = (\n    <DataTableAddItemButton\n      elementType=\"a\"\n      href=\"api/v1/logs/schedule/download\"\n      download\n      icon={<DownloadIcon />}\n    >\n      <Trans message=\"Download log\" />\n    </DataTableAddItemButton>\n  );\n\n  return (\n    <DatatablePageWithHeaderLayout>\n      <GlobalLoadingProgress query={query} />\n      <DatatablePageWithHeaderBody>\n        <DataTableHeader\n          searchValue={searchParams.query}\n          onSearchChange={setSearchQuery}\n          actions={actions}\n        />\n        <DatatablePageScrollContainer>\n          <Table\n            columns={ScheduleDatatableColumns}\n            data={query.items}\n            sortDescriptor={sortDescriptor}\n            onSortChange={mergeIntoSearchParams}\n            enableSelection={false}\n          />\n          {query.isEmpty && (\n            <DataTableEmptyStateMessage\n              isFiltering={isFiltering}\n              image={timelineImage}\n              title={<Trans message=\"No scheduled commands have ran yet\" />}\n              filteringTitle={\n                <Trans message=\"No matching scheduled commands\" />\n              }\n            />\n          )}\n          <DataTablePaginationFooter\n            query={query}\n            onPageChange={page => mergeIntoSearchParams({page})}\n            onPerPageChange={perPage => mergeIntoSearchParams({perPage})}\n          />\n        </DatatablePageScrollContainer>\n      </DatatablePageWithHeaderBody>\n    </DatatablePageWithHeaderLayout>\n  );\n}\n"],"names":["BooleanIndicator","value","jsx","CheckIcon","CloseIcon","ScheduleDatatableColumns","Trans","NameWithAvatar","item","FormattedRelativeTime","RerunButton","rerunCommand","useRerunScheduledCommand","Tooltip","IconButton","EventRepeatIcon","timelineImage","Component","searchParams","sortDescriptor","mergeIntoSearchParams","setSearchQuery","isFiltering","useDatatableSearchParams","validateDatatableSearch","query","useDatatableQuery","commonAdminQueries","actions","DataTableAddItemButton","DownloadIcon","DatatablePageWithHeaderLayout","GlobalLoadingProgress","DatatablePageWithHeaderBody","DataTableHeader","DatatablePageScrollContainer","Table","DataTableEmptyStateMessage","DataTablePaginationFooter","page","perPage"],"mappings":"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"}