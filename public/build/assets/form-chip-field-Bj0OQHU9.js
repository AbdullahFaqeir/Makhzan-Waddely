import{j as d,r as x,c as M,ah as U,ab as q,bZ as G,b_ as J,ad as Q,P as X,b0 as Y,b2 as T,aA as ee,aE as ne,ci as se,cs as te,cl as ae,ck as re,ct as le,af as B,ai as oe,cg as ie,aj as ue}from"./main-BdzhGpqn.js";import{I as ce}from"./input-CDTJ1VfY.js";function de({className:n,children:s,size:o,color:l,radius:i,selectable:u,wrap:p=!0,startButton:c}){return d.jsxs("div",{className:M("flex items-center gap-8",p&&"flex-wrap",n),children:[c,x.Children.map(s,a=>{if(x.isValidElement(a))return x.cloneElement(a,{size:o,color:l,selectable:u,radius:i})})]})}function z(n){return{id:n,name:`${n}`,description:`${n}`}}function fe({ref:n,...s}){const o=x.useRef(null),l=U(n),{displayWith:i=R=>R.name,validateWith:u,getItemForPresentation:p,children:c,suggestions:a,isLoading:f,inputValue:r,onInputValueChange:h,onItemSelected:w,placeholder:I,onOpenChange:K,chipSize:y="sm",openMenuOnFocus:v=!0,showEmptyMessage:A,value:C,defaultValue:b,onChange:P,valueKey:j,isAsync:V,allowCustomValue:N=!0,showDropdownArrow:D,onChipClick:L,alwaysShowAvatar:_=!1,readOnly:k,maxItems:W,...F}=s,E=q({...s,flexibleHeight:!0}),[S,$]=he(s),[e,t]=x.useState(!1),m=d.jsx(X,{isIndeterminate:!0,size:"w-24 h-24","aria-label":"loading..."}),g=D?d.jsx(Y,{}):null,{fieldProps:O,inputProps:H}=G({...F,focusRef:l,endAdornment:f&&e?m:g});return d.jsx(J,{fieldClassNames:E,...O,children:d.jsxs(ce,{ref:o,className:M("flex flex-wrap items-center",E.input),onClick:()=>{var R;(R=l.current)==null||R.focus()},children:[d.jsx(pe,{displayChipUsing:i,onChipClick:L,items:S,setItems:$,chipSize:y,alwaysShowAvatar:_,readOnly:k,getItemForPresentation:p}),d.jsx(xe,{size:s.size,showEmptyMessage:A,inputProps:H,inputValue:r,onInputValueChange:h,fieldRef:o,inputRef:l,chips:S,setChips:$,validateWith:u,isLoading:f,suggestions:a,placeholder:I,openMenuOnFocus:v,listboxIsOpen:e,setListboxIsOpen:t,allowCustomValue:N,readOnly:k,children:c})]})})}function pe({items:n,setItems:s,displayChipUsing:o,chipSize:l,onChipClick:i,alwaysShowAvatar:u,readOnly:p,getItemForPresentation:c}){const a=T(),f=x.useCallback(r=>{const h=n.findIndex(I=>I.id===r),w=[...n];return h>-1&&(w.splice(h,1),s(w)),w},[n,s]);return d.jsx(de,{className:M("max-w-full flex-shrink-0 flex-wrap",l==="xs"?"my-6":"my-8"),size:l,selectable:!0,children:n.map(r=>(r=(c==null?void 0:c(r))??r,d.jsx(ee,{errorMessage:r.errorMessage,adornment:r.image||u?d.jsx(ne,{circle:!0,src:r.image,fallback:"initials",label:r.name}):null,onClick:()=>i==null?void 0:i(r),onRemove:p?void 0:()=>{f(r.id).length?a==null||a.focusPrevious({tabbable:!0}):a==null||a.focusLast()},children:o(r)},r.id)))})}function xe(n){const{inputRef:s,fieldRef:o,validateWith:l,setChips:i,chips:u,suggestions:p,inputProps:c,placeholder:a,openMenuOnFocus:f,listboxIsOpen:r,setListboxIsOpen:h,allowCustomValue:w,isLoading:I,size:K,readOnly:y}=n,v=T(),A=x.useCallback(e=>{e=(e||[]).filter(t=>{const m=!t||!t.id||!t.name;return!(u.findIndex(O=>O.id===(t==null?void 0:t.id))>-1)&&!m}),e.length&&(l&&(e=e.map(t=>l(t))),i([...u,...e]))},[u,i,l]),C=se({...n,clearInputOnItemSelection:!0,isOpen:r,onOpenChange:h,items:p,selectionMode:"none",role:"listbox",virtualFocus:!0,onItemSelected:e=>{F(e)}}),{state:{activeIndex:b,setActiveIndex:P,isOpen:j,setIsOpen:V,inputValue:N,setInputValue:D},refs:L,listboxId:_,collection:k,onInputChange:W}=C,F=e=>{const t=k.size&&b!=null?[...k.values()][b]:null;t!=null&&t.item?A([t.item]):w&&A([z(t?t.value:e)]),D(""),P(null),V(!1)};te(()=>{o.current&&L.reference.current!==o.current&&C.reference(o.current)},[o,C,L]);const{handleTriggerKeyDown:E,handleListboxKeyboardNavigation:S}=ae(C),$=oe(()=>{f&&!j&&V(!0)});return d.jsx(re,{listbox:C,mobileOverlay:le,isLoading:I,onPointerDown:e=>{e.preventDefault()},children:d.jsx("input",{readOnly:y,type:"text",className:M("mx-8 my-4 min-w-30 flex-[1_1_60px] bg-transparent text-sm outline-none",K==="xs"?"h-20":"h-30"),placeholder:a,...B(c,{required:!1,ref:s,value:N,onChange:W,onPaste:e=>{const m=e.clipboardData.getData("text").match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(m){e.preventDefault();const g=window.getSelection();g!=null&&g.rangeCount&&(g.deleteFromDocument(),A(m.map(O=>z(O))))}},"aria-autocomplete":"list","aria-controls":j?_:void 0,autoComplete:"off",autoCorrect:"off",spellCheck:"false",onKeyDown:e=>{if(y)return;const t=e.target;if(e.key==="Enter"){e.preventDefault(),F(t.value);return}if(e.key==="Escape"&&j&&(V(!1),D("")),e.key==="ArrowUp"&&j&&(b===0||b==null)){P(null);return}if(b!=null&&(e.key==="ArrowLeft"||e.key==="ArrowRight")){e.preventDefault();return}if((e.key==="ArrowLeft"||e.key==="Backspace"||e.key==="Delete")&&t.selectionStart===0&&b==null&&u.length){v==null||v.focusPrevious({tabbable:!0});return}E(e)||S(e)},onFocus:y?void 0:$,onClick:y?void 0:$})})})}function he({onChange:n,value:s,defaultValue:o,valueKey:l,maxItems:i}){const u=x.useMemo(()=>Z(s),[s]),p=x.useMemo(()=>Z(o),[o]),c=x.useCallback(a=>{let f=l?a.map(r=>r[l]):a;i&&(f=f.slice(0,i)),n==null||n(f)},[n,l]);return Q(u||void 0,p||[],c)}function Z(n){if(n)return Array.isArray(n)?n.map(s=>typeof s!="object"?z(s):s):[z(n)]}function ge({children:n,...s}){const o=ie({...s,multiSelect:!0}),{field:{onChange:l,onBlur:i,value:u=[],ref:p},fieldState:{invalid:c,error:a}}=ue({name:s.name,rules:o}),f={onChange:l,onBlur:i,value:u,invalid:c,errorMessage:a==null?void 0:a.message};return d.jsx(fe,{ref:p,...B(f,s),children:n})}export{fe as C,ge as F,de as a};
