{"version":3,"file":"localization-settings-JcLCqqXv.js","sources":["../../../common/foundation/resources/client/admin/settings/pages/localization-settings.tsx"],"sourcesContent":["import {AdminDocsUrls} from '@app/admin/admin-config';\nimport {AdminSettings} from '@common/admin/settings/admin-settings';\nimport {AdminSettingsLayout} from '@common/admin/settings/layout/settings-layout';\nimport {SettingsPanel} from '@common/admin/settings/layout/settings-panel';\nimport {useAdminSettings} from '@common/admin/settings/requests/use-admin-settings';\nimport {\n  FetchValueListsResponse,\n  valueListsQueryOptions,\n} from '@common/http/value-lists';\nimport {useSuspenseQuery} from '@tanstack/react-query';\nimport {Section} from '@ui/forms/listbox/section';\nimport {FormRadio} from '@ui/forms/radio-group/radio';\nimport {FormRadioGroup} from '@ui/forms/radio-group/radio-group';\nimport {FormSelect, Option} from '@ui/forms/select/select';\nimport {FormSwitch} from '@ui/forms/toggle/switch';\nimport {DateFormatPresets, FormattedDate} from '@ui/i18n/formatted-date';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {useCurrentDateTime} from '@ui/i18n/use-current-date-time';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {useForm} from 'react-hook-form';\n\nexport function Component() {\n  const optionQuery = useSuspenseQuery(\n    valueListsQueryOptions(['timezones', 'localizations']),\n  );\n  const timezones = optionQuery.data.timezones!;\n  const localizations = optionQuery.data.localizations!;\n\n  const {data} = useAdminSettings();\n\n  const form = useForm<AdminSettings>({\n    defaultValues: {\n      client: {\n        dates: {\n          default_timezone: data.client.dates?.default_timezone ?? 'auto',\n          format: data.client.dates?.format ?? 'auto',\n        },\n        locale: {\n          default: data.client.locale?.default ?? 'auto',\n        },\n        i18n: {\n          enable: data.client.i18n.enable ?? false,\n        },\n      },\n    },\n  });\n\n  return (\n    <AdminSettingsLayout\n      title={<Trans message=\"Localization\" />}\n      form={form}\n      docsLink={AdminDocsUrls.settings.localization}\n    >\n      <TimezoneSection timezones={timezones} />\n      <LanguageSection localizations={localizations} />\n      <DateFormatSection />\n      <TranslationsSection />\n    </AdminSettingsLayout>\n  );\n}\n\ninterface TimezoneSectionProps {\n  timezones: NonNullable<FetchValueListsResponse['timezones']>;\n}\nfunction TimezoneSection({timezones}: TimezoneSectionProps) {\n  const {trans} = useTrans();\n  return (\n    <SettingsPanel\n      className=\"mb-24\"\n      title={<Trans message=\"Default Timezone\" />}\n      description={\n        <Trans message=\"Which timezone should be selected by default for new users and guests.\" />\n      }\n    >\n      <FormSelect\n        size=\"sm\"\n        required\n        name=\"client.dates.default_timezone\"\n        label={<Trans message=\"Timezone\" />}\n        showSearchField\n        selectionMode=\"single\"\n        searchPlaceholder={trans(message('Search timezones'))}\n      >\n        <Option key=\"auto\" value=\"auto\">\n          <Trans message=\"Based on browser settings\" />\n        </Option>\n        {Object.entries(timezones).map(([groupName, timezones]) => (\n          <Section key={groupName} label={groupName}>\n            {timezones.map((timezone: {value: string; text: string}) => (\n              <Option key={timezone.value} value={timezone.value}>\n                {timezone.text}\n              </Option>\n            ))}\n          </Section>\n        ))}\n      </FormSelect>\n    </SettingsPanel>\n  );\n}\n\ninterface LanguageSectionProps {\n  localizations: NonNullable<FetchValueListsResponse['localizations']>;\n}\nfunction LanguageSection({localizations}: LanguageSectionProps) {\n  return (\n    <SettingsPanel\n      className=\"mb-24\"\n      title={<Trans message=\"Default Language\" />}\n      description={\n        <Trans message=\"Which localization should be selected by default for new users and guests.\" />\n      }\n    >\n      <FormSelect\n        size=\"sm\"\n        label={<Trans message=\"Language\" />}\n        name=\"client.locale.default\"\n        selectionMode=\"single\"\n      >\n        <Option key=\"auto\" value=\"auto\">\n          <Trans message=\"Based on browser settings\" />\n        </Option>\n        {localizations.map(locale => (\n          <Option key={locale.language} value={locale.language} capitalizeFirst>\n            {locale.name}\n          </Option>\n        ))}\n      </FormSelect>\n    </SettingsPanel>\n  );\n}\n\nfunction DateFormatSection() {\n  const today = useCurrentDateTime();\n  return (\n    <SettingsPanel\n      className=\"mb-24\"\n      title={<Trans message=\"Date Format\" />}\n      description={\n        <Trans message=\"Default verbosity for all dates displayed across the site. Month/day order and separators will be adjusted automatically, based on user's locale.\" />\n      }\n    >\n      <FormRadioGroup\n        required\n        size=\"sm\"\n        name=\"client.dates.format\"\n        orientation=\"vertical\"\n      >\n        <FormRadio key=\"auto\" value=\"auto\">\n          <Trans message=\"Auto\" />\n        </FormRadio>\n        {Object.entries(DateFormatPresets).map(([format, options]) => (\n          <FormRadio key={format} value={format}>\n            <FormattedDate date={today} options={options} />\n          </FormRadio>\n        ))}\n      </FormRadioGroup>\n    </SettingsPanel>\n  );\n}\n\nfunction TranslationsSection() {\n  return (\n    <SettingsPanel\n      className=\"mb-24\"\n      title={<Trans message=\"Translations\" />}\n      description={\n        <Trans message=\"If disabled, site will always be shown in default language and user will not be able to change their locale.\" />\n      }\n    >\n      <FormSwitch name=\"client.i18n.enable\">\n        <Trans message=\"Enable translations\" />\n      </FormSwitch>\n    </SettingsPanel>\n  );\n}\n"],"names":["Component","optionQuery","useSuspenseQuery","valueListsQueryOptions","timezones","localizations","data","useAdminSettings","form","useForm","_a","_b","_c","jsxs","AdminSettingsLayout","jsx","Trans","AdminDocsUrls","TimezoneSection","LanguageSection","DateFormatSection","TranslationsSection","trans","useTrans","SettingsPanel","FormSelect","message","Option","groupName","Section","timezone","locale","today","useCurrentDateTime","FormRadioGroup","FormRadio","DateFormatPresets","format","options","FormattedDate","FormSwitch"],"mappings":"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"}