{"version":3,"file":"reset-password-page-CvkcMLdQ.js","sources":["../../../common/foundation/resources/client/auth/requests/reset-password.ts","../../../common/foundation/resources/client/auth/ui/reset-password-page.tsx"],"sourcesContent":["import {useMutation} from '@tanstack/react-query';\nimport {UseFormReturn} from 'react-hook-form';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {onFormQueryError} from '../../errors/on-form-query-error';\nimport {toast} from '@ui/toast/toast';\nimport {message} from '@ui/i18n/message';\nimport {useNavigate} from '../../ui/navigation/use-navigate';\nimport {apiClient} from '../../http/query-client';\n\ninterface Response extends BackendResponse {\n  bootstrapData: string;\n}\n\nexport interface ResetPasswordPayload {\n  email: string;\n  password: string;\n  password_confirmation: string;\n  token: string;\n}\n\nfunction reset(payload: ResetPasswordPayload): Promise<Response> {\n  return apiClient\n    .post('auth/reset-password', payload)\n    .then(response => response.data);\n}\n\nexport function useResetPassword(form: UseFormReturn<ResetPasswordPayload>) {\n  const navigate = useNavigate();\n  return useMutation({\n    mutationFn: reset,\n    onSuccess: () => {\n      navigate('/login', {replace: true});\n      toast(message('Your password has been reset!'));\n    },\n    onError: r => onFormQueryError(r, form),\n  });\n}\n","import {GuestRoute} from '@common/auth/guards/guest-route';\nimport {Button} from '@ui/buttons/button';\nimport {LinkStyle} from '@ui/buttons/external-link';\nimport {Form} from '@ui/forms/form';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Trans} from '@ui/i18n/trans';\nimport {useForm} from 'react-hook-form';\nimport {Link, useParams} from 'react-router';\nimport {StaticPageTitle} from '../../seo/static-page-title';\nimport {\n  ResetPasswordPayload,\n  useResetPassword,\n} from '../requests/reset-password';\nimport {AuthLayout} from './auth-layout/auth-layout';\n\nexport function Component() {\n  const {token} = useParams();\n  const form = useForm<ResetPasswordPayload>({defaultValues: {token}});\n  const resetPassword = useResetPassword(form);\n\n  const heading = <Trans message=\"Reset your account password\" />;\n\n  const message = (\n    <Trans\n      values={{\n        a: parts => (\n          <Link className={LinkStyle} to=\"/register\">\n            {parts}\n          </Link>\n        ),\n      }}\n      message=\"Don't have an account? <a>Sign up.</a>\"\n    />\n  );\n\n  return (\n    <GuestRoute>\n      <AuthLayout heading={heading} message={message}>\n        <StaticPageTitle>\n          <Trans message=\"Reset Password\" />\n        </StaticPageTitle>\n        <Form\n          form={form}\n          onSubmit={payload => {\n            resetPassword.mutate(payload);\n          }}\n        >\n          <FormTextField\n            className=\"mb-32\"\n            name=\"email\"\n            type=\"email\"\n            label={<Trans message=\"Email\" />}\n            required\n          />\n          <FormTextField\n            className=\"mb-32\"\n            name=\"password\"\n            type=\"password\"\n            label={<Trans message=\"New password\" />}\n            required\n          />\n          <FormTextField\n            className=\"mb-32\"\n            name=\"password_confirmation\"\n            type=\"password\"\n            label={<Trans message=\"Confirm password\" />}\n            required\n          />\n          <Button\n            className=\"block w-full\"\n            type=\"submit\"\n            variant=\"flat\"\n            color=\"primary\"\n            size=\"md\"\n            disabled={resetPassword.isPending}\n          >\n            <Trans message=\"Reset password\" />\n          </Button>\n        </Form>\n      </AuthLayout>\n    </GuestRoute>\n  );\n}\n"],"names":["reset","payload","apiClient","response","useResetPassword","form","navigate","useNavigate","useMutation","toast","message","onFormQueryError","Component","token","useParams","useForm","resetPassword","heading","jsx","Trans","Link","LinkStyle","parts","GuestRoute","jsxs","AuthLayout","StaticPageTitle","Form","FormTextField","Button"],"mappings":"uPAoBA,SAASA,EAAMC,EAAkD,CAC/D,OAAOC,EACJ,KAAK,sBAAuBD,CAAO,EACnC,KAAKE,GAAYA,EAAS,IAAI,CACnC,CAEO,SAASC,EAAiBC,EAA2C,CAC1E,MAAMC,EAAWC,EAAA,EACjB,OAAOC,EAAY,CACjB,WAAYR,EACZ,UAAW,IAAM,CACfM,EAAS,SAAU,CAAC,QAAS,EAAA,CAAK,EAClCG,EAAMC,EAAQ,+BAA+B,CAAC,CAChD,EACA,QAAS,GAAKC,EAAiB,EAAGN,CAAI,CAAA,CACvC,CACH,CCrBO,SAASO,GAAY,CAC1B,KAAM,CAAC,MAAAC,CAAA,EAASC,EAAA,EACVT,EAAOU,EAA8B,CAAC,cAAe,CAAC,MAAAF,CAAA,EAAO,EAC7DG,EAAgBZ,EAAiBC,CAAI,EAErCY,EAAUC,EAAAA,IAACC,EAAA,CAAM,QAAQ,6BAAA,CAA8B,EAEvDT,EACJQ,EAAAA,IAACC,EAAA,CACC,OAAQ,CACN,KACED,EAAAA,IAACE,EAAA,CAAK,UAAWC,EAAW,GAAG,YAC5B,SAAAC,CAAA,CACH,CAAA,EAGJ,QAAQ,wCAAA,CAAA,EAIZ,OACEJ,EAAAA,IAACK,EAAA,CACC,SAAAC,EAAAA,KAACC,EAAA,CAAW,QAAAR,EAAkB,QAAAP,EAC5B,SAAA,CAAAQ,MAACQ,EAAA,CACC,SAAAR,EAAAA,IAACC,EAAA,CAAM,QAAQ,iBAAiB,EAClC,EACAK,EAAAA,KAACG,EAAA,CACC,KAAAtB,EACA,SAAUJ,GAAW,CACnBe,EAAc,OAAOf,CAAO,CAC9B,EAEA,SAAA,CAAAiB,EAAAA,IAACU,EAAA,CACC,UAAU,QACV,KAAK,QACL,KAAK,QACL,MAAOV,EAAAA,IAACC,EAAA,CAAM,QAAQ,OAAA,CAAQ,EAC9B,SAAQ,EAAA,CAAA,EAEVD,EAAAA,IAACU,EAAA,CACC,UAAU,QACV,KAAK,WACL,KAAK,WACL,MAAOV,EAAAA,IAACC,EAAA,CAAM,QAAQ,cAAA,CAAe,EACrC,SAAQ,EAAA,CAAA,EAEVD,EAAAA,IAACU,EAAA,CACC,UAAU,QACV,KAAK,wBACL,KAAK,WACL,MAAOV,EAAAA,IAACC,EAAA,CAAM,QAAQ,kBAAA,CAAmB,EACzC,SAAQ,EAAA,CAAA,EAEVD,EAAAA,IAACW,EAAA,CACC,UAAU,eACV,KAAK,SACL,QAAQ,OACR,MAAM,UACN,KAAK,KACL,SAAUb,EAAc,UAExB,SAAAE,EAAAA,IAACC,EAAA,CAAM,QAAQ,gBAAA,CAAiB,CAAA,CAAA,CAClC,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CACF,CAEJ"}