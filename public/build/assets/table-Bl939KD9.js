import{r as h,ct as ce,j as b,w as ue,c as N,A as de,y as fe,cu as be,cv as X,cw as he,b as xe,G as Y,ag as O,ac as q,af as ge,ae as pe}from"./main-owSUWNVS.js";import{C as Z}from"./checkbox-CiHJ6TYf.js";import{S as me}from"./skeleton-xT-yudp1.js";import{A as we}from"./ArrowDownward-BrhAHC5n.js";import{$ as Q}from"./useEffectEvent-BzNFWHXk.js";import{u as ye}from"./use-pointer-events-BS6HVgE8.js";function ve(e){let{ref:t,onInteractOutside:r,isDisabled:s,onInteractOutsideStart:n}=e,i=h.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),a=Q(o=>{r&&J(o,t)&&(n&&n(o),i.current.isPointerDown=!0)}),l=Q(o=>{r&&r(o)});h.useEffect(()=>{let o=i.current;if(s)return;const c=t.current,g=ce(c);if(typeof PointerEvent<"u"){let u=y=>{o.isPointerDown&&J(y,t)&&l(y),o.isPointerDown=!1};return g.addEventListener("pointerdown",a,!0),g.addEventListener("click",u,!0),()=>{g.removeEventListener("pointerdown",a,!0),g.removeEventListener("click",u,!0)}}},[t,s,a,l])}function J(e,t){if(e.button>0)return!1;if(e.target){const r=e.target.ownerDocument;if(!r||!r.documentElement.contains(e.target)||e.target.closest("[data-react-aria-top-layer]"))return!1}return t.current?!e.composedPath().includes(t.current):!1}const $=h.createContext(null),ke={key:"checkbox",header:()=>b.jsx(Pe,{}),align:"center",width:"w-24 flex-shrink-0",body:(e,t)=>t.isPlaceholder?b.jsx(me,{size:"w-24 h-24",variant:"rect"}):b.jsx(Ce,{item:e})};function Ce({item:e}){const{selectedRows:t,toggleRow:r}=h.useContext($);return b.jsx(Z,{checked:t.includes(e.id),onChange:()=>r(e)})}function Pe(){const{trans:e}=ue(),{data:t,selectedRows:r,onSelectionChange:s}=h.useContext($),n=!!t.length&&t.length===r.length,i=!n&&!!r.length;return b.jsx(Z,{"aria-label":e({message:"Select all"}),isIndeterminate:i,checked:n,onChange:()=>{s(n?[]:t.map(a=>a.id))}})}function _({index:e,isHeader:t}){const{columns:r,cellHeight:s="h-50",headerCellHeight:n="h-46",tableStyle:i}=h.useContext($),a=e===0,l=r.length-1===e,o=r[e],c=t?n:s;return i==="flex"?De(o,c):$e(o,a,l,c)}function $e(e,t,r,s){let n=e==null?void 0:e.padding;return n||(t?n="pl-16 pr-12":r?n="pr-16 pl-12":n="px-12"),N("overflow-hidden whitespace-nowrap outline-none focus-visible:outline focus-visible:outline-offset-2 text-left",s,e==null?void 0:e.maxWidth,e==null?void 0:e.width,n,e==null?void 0:e.className)}function De(e,t){let r="justify-start";(e==null?void 0:e.align)==="center"?r="justify-center":(e==null?void 0:e.align)==="end"&&(r="justify-end");const s=e==null?void 0:e.padding;return N("flex items-center overflow-hidden whitespace-nowrap overflow-ellipsis outline-none focus-visible:outline focus-visible:outline-offset-2",t,(e==null?void 0:e.width)??"flex-1",e==null?void 0:e.maxWidth,e==null?void 0:e.minWidth,r,s,e==null?void 0:e.className)}function Ee({index:e}){const{columns:t,sortDescriptor:r,onSortChange:s,enableSorting:n,tableStyle:i}=h.useContext($),a=t[e],l=_({index:e,isHeader:!0}),[o,c]=h.useState(!1),g=a.sortingKey||a.key,u=a.allowsSorting&&n,{orderBy:y,orderDir:v}=r||{},w=u&&y===g;let x;w&&v==="asc"?x="ascending":w&&v==="desc"?x="descending":u&&(x="none");const k=()=>{if(!u)return;let m;w&&v==="desc"?m={orderDir:"asc",orderBy:g}:w&&v==="asc"?m={orderBy:void 0,orderDir:void 0}:m={orderDir:"desc",orderBy:g},s==null||s(m)},D=w||o,E={visible:{opacity:1,y:0},hidden:{opacity:0,y:"-25%"}},j=i==="html"?"th":"div";return b.jsxs(j,{role:"columnheader",tabIndex:-1,"aria-colindex":e+1,"aria-sort":x,className:N(l,"text-xs font-medium text-muted",u&&"cursor-pointer"),onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},onKeyDown:m=>{(m.key===" "||m.key==="Enter")&&(m.preventDefault(),k())},onClick:k,children:[a.hideHeader?b.jsx("div",{className:"opacity-0",children:a.header()}):a.header(),b.jsx(de,{children:u&&b.jsx(fe.span,{variants:E,animate:D?"visible":"hidden",initial:!1,transition:{type:"tween"},className:"-mt-2 ml-6 inline-block","data-testid":"table-sort-button","aria-hidden":!D,children:b.jsx(we,{size:"xs",className:N("text-muted",v==="asc"&&y===g&&"rotate-180 transition-transform")})},"sort-icon")})]})}function je(){const{columns:e,tableStyle:t,headerRowBg:r}=h.useContext($),s=t==="html"?"thead":h.Fragment,n=t==="html"?"tr":"div";return b.jsx(s,{children:b.jsx(n,{role:"row","aria-rowindex":1,tabIndex:-1,className:N(t==="flex"&&"flex gap-x-16 px-16",r),children:e.map((i,a)=>b.jsx(Ee,{index:a},i.key))})})}function L(e){return be()?e.metaKey:e.ctrlKey}function Se(e){const{cellCount:t,rowCount:r}=e;return{onKeyDown:n=>{switch(n.key){case"ArrowLeft":P(n,{cell:{op:"decrement"}},e);break;case"ArrowRight":P(n,{cell:{op:"increment"}},e);break;case"ArrowUp":P(n,{row:{op:"decrement"}},e);break;case"ArrowDown":P(n,{row:{op:"increment"}},e);break;case"PageUp":P(n,{row:{op:"decrement",count:5}},e);break;case"PageDown":P(n,{row:{op:"increment",count:5}},e);break;case"Tab":Ie(n);break;case"Home":L(n)?P(n,{row:{op:"decrement",count:r},cell:{op:"decrement",count:t}},e):P(n,{cell:{op:"decrement",count:t}},e);break;case"End":L(n)?P(n,{row:{op:"increment",count:r},cell:{op:"increment",count:t}},e):P(n,{cell:{op:"increment",count:t}},e);break}}}}function P(e,t,{cellCount:r,rowCount:s}){var w,x,k,D,E,j,m;if(((w=document.activeElement)==null?void 0:w.tagName)==="input")return;e.preventDefault();const n=e.currentTarget,i=e.target.closest("[aria-colindex]");if(!i||!n)return;const a=i.closest("[aria-rowindex]");if(!a)return;let l=parseInt(a.getAttribute("aria-rowindex")),o=parseInt(i.getAttribute("aria-colindex"));if(Number.isNaN(l)||Number.isNaN(o))return;const c=((x=t.row)==null?void 0:x.count)??1;((k=t.row)==null?void 0:k.op)==="increment"?l=Math.min(s,l+c):((D=t.row)==null?void 0:D.op)==="decrement"&&(l=Math.max(1,l-c));const g=((E=t.cell)==null?void 0:E.count)??1;((j=t.cell)==null?void 0:j.op)==="increment"?o=Math.min(r,o+g):((m=t.cell)==null?void 0:m.op)==="decrement"&&(o=Math.max(1,o-g));const u=n.querySelector(`[aria-rowindex="${l}"] [aria-colindex="${o}"]`);if(!u)return;const v=X(u).nextNode()||u;i.setAttribute("tabindex","-1"),v.setAttribute("tabindex","0"),v.focus()}function Ie(e){const t=e.currentTarget;if(e.shiftKey)t.focus();else{const r=X(t,{tabbable:!0});let s,n;do n=r.lastChild(),n&&(s=n);while(n);s&&!s.contains(document.activeElement)&&he(s)}}function Me({index:e,isSelected:t,isHeader:r}){const s=xe(),n=Y(),{hideBorder:i,enableSelection:a,collapseOnMobile:l,onAction:o,isCollapsedMode:c,tableStyle:g}=h.useContext($);return N(g==="flex"&&"flex gap-x-16","break-inside-avoid outline-none border border-transparent",c&&"rounded-panel",o&&"cursor-pointer",n&&l&&i?"mb-8 pl-8 pr-0 rounded":"px-16",!i&&"border-b-divider",!i&&e===0&&"border-t-divider",t&&!s&&"bg-primary/selected hover:bg-primary/focus focus-visible:bg-primary/focus",t&&s&&"bg-selected hover:bg-focus focus-visible:bg-focus",!t&&!r&&(a||o)&&"focus-visible:bg-focus hover:bg-hover")}function Ne({rowIndex:e,rowIsHovered:t,index:r,item:s,id:n}){const{columns:i,tableStyle:a}=h.useContext($),l=i[r],o=h.useMemo(()=>({index:e,isHovered:t,isPlaceholder:s.isPlaceholder}),[e,t,s.isPlaceholder]),c=_({index:r,isHeader:!1}),g=a==="html"?"td":"div";let u=l.body(s,o);return o.isPlaceholder||(u=b.jsx("div",{className:"min-w-0 overflow-hidden overflow-ellipsis",children:u})),b.jsx(g,{tabIndex:-1,role:"gridcell","aria-colindex":r+1,id:n,className:c,children:u})}function Re(e){return e.shiftKey||L(e)}const He=["button","a","input","select","textarea"];function Te({item:e,index:t,renderAs:r,className:s,style:n}){const{selectedRows:i,columns:a,toggleRow:l,selectRow:o,onAction:c,selectRowOnContextMenu:g,enableSelection:u,selectionStyle:y,hideHeaderRow:v,tableStyle:w}=h.useContext($),x=h.useRef(!1),k=i.includes(e.id),[D,E]=h.useState(!1),j=f=>f.target.closest(He.join(",")),m=f=>{y==="highlight"&&c&&!x.current&&!j(f)&&(f.preventDefault(),f.stopPropagation(),c(e,t))},I=!!i.length,F=f=>{j(f)||(y==="checkbox"?u&&(I||!c)?l(e):c&&c(e,t):y==="highlight"&&(x.current?u&&I?l(e):c==null||c(e,t):u&&o(e,Re(f))))},{domProps:V}=ye({onPointerDown:f=>{x.current=f.pointerType==="touch"},onPress:F,onLongPress:u?()=>{x.current&&l(e)}:void 0}),B=f=>{u&&f.key===" "?(f.preventDefault(),f.stopPropagation(),y==="checkbox"?l(e):o(e)):f.key==="Enter"&&!i.length&&c&&(f.preventDefault(),f.stopPropagation(),c(e,t))},W=f=>{g&&u&&(i.includes(e.id)||o(e)),x.current&&(f.preventDefault(),f.stopPropagation())},G=Me({index:t,isSelected:k}),H=r||(w==="html"?"tr":"div");return b.jsx(H,{role:"row","aria-rowindex":t+1+(v?0:1),"aria-selected":k,tabIndex:-1,className:N(s,G),item:typeof H=="string"?void 0:e,onDoubleClick:O(m),onKeyDown:O(B),onContextMenu:O(W),onPointerEnter:O(()=>E(!0)),onPointerLeave:O(()=>E(!1)),style:n,...V,children:a.map((f,T)=>b.jsx(Ne,{rowIndex:t,rowIsHovered:D,index:T,item:e},`${e.id}-${f.key}`))})}function We({className:e,columns:t,activeColumns:r,collapseOnMobile:s=!0,hideHeaderRow:n=!1,headerRowBg:i,hideBorder:a=!1,data:l,selectedRows:o,defaultSelectedRows:c,onSelectionChange:g,sortDescriptor:u,onSortChange:y,enableSorting:v=!0,onDelete:w,enableSelection:x=!0,selectionStyle:k="checkbox",ariaLabelledBy:D,selectRowOnContextMenu:E,onAction:j,renderRowAs:m,tableBody:I,meta:F,tableRef:V,closeOnInteractOutside:B=!1,cellHeight:W,headerCellHeight:G,tableStyle:H="flex",...f}){const T=Y(),A=!!T&&s;A&&(n=!0,a=!0);const[p,M]=q(o,c||[],g),[ee,te]=q(u,void 0,y),ne=h.useCallback(d=>{const C=[...p];if(!C.includes(d.id))C.push(d.id);else{const S=C.indexOf(d.id);C.splice(S,1)}M(C)},[p,M]),re=h.useCallback((d,C)=>{let S=[];d&&(S=C?[...p==null?void 0:p.filter(R=>R!==d.id),d.id]:[d.id]),M(S)},[p,M]),K=h.useMemo(()=>{const d=t.filter(S=>{if(r&&!r.includes(S.key))return!1;const R=S.visibleInMode||"regular";if(R==="all"||R==="compact"&&A||R==="regular"&&!A)return!0});return r&&d.sort((S,R)=>{const ae=r.indexOf(S.key),le=r.indexOf(R.key);return ae-le}),x&&k!=="highlight"&&!T&&d.unshift(ke),d},[T,t,x,k,A,r]),se={isCollapsedMode:A,cellHeight:W,headerCellHeight:G,headerRowBg:i,hideBorder:a,hideHeaderRow:n,selectedRows:p,onSelectionChange:M,enableSorting:v,enableSelection:x,selectionStyle:k,data:l,columns:K,sortDescriptor:ee,onSortChange:te,toggleRow:ne,selectRow:re,onAction:j,selectRowOnContextMenu:E,meta:F,collapseOnMobile:s,tableStyle:H},oe=Se({cellCount:x?K.length+1:K.length,rowCount:l.length+1}),z={renderRowAs:m};I?I=h.cloneElement(I,z):I=b.jsx(Ae,{...z});const U=ge(V);ve({ref:U,onInteractOutside:d=>{B&&x&&(p!=null&&p.length)&&!d.target.closest('[role="dialog"]')&&M([])}});const ie=H==="html"?"table":"div";return b.jsx($.Provider,{value:se,children:b.jsxs(ie,{...pe(f,oe,{onKeyDown:d=>{d.key==="Escape"?(d.preventDefault(),d.stopPropagation(),p!=null&&p.length&&M([])):d.key==="Delete"?(d.preventDefault(),d.stopPropagation(),p!=null&&p.length&&(w==null||w(l.filter(C=>p==null?void 0:p.includes(C.id))))):L(d)&&d.key==="a"&&(d.preventDefault(),d.stopPropagation(),x&&M(l.map(C=>C.id)))}}),tabIndex:0,role:"grid","aria-rowcount":l.length+1,"aria-colcount":K.length+1,ref:U,"aria-multiselectable":x?!0:void 0,"aria-labelledby":D,className:N(e,"isolate w-full select-none text-sm outline-none focus-visible:ring-2"),children:[!n&&b.jsx(je,{}),I]})})}function Ae({renderRowAs:e}){const{data:t,tableStyle:r}=h.useContext($),s=r==="html"?"tbody":h.Fragment;return b.jsx(s,{children:t.map((n,i)=>b.jsx(Te,{item:n,index:i,renderAs:e},n.id))})}export{We as T,$ as a,L as b,Re as i};
//# sourceMappingURL=table-Bl939KD9.js.map
