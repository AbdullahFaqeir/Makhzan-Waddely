{"version":3,"file":"create-role-page-BUSEGk4O.js","sources":["../../../common/foundation/resources/client/admin/roles/requests/user-create-role.ts","../../../common/foundation/resources/client/admin/roles/crupdate-role-page/create-role-page.tsx"],"sourcesContent":["import {commonAdminQueries} from '@common/admin/common-admin-queries';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {toast} from '@ui/toast/toast';\nimport {UseFormReturn} from 'react-hook-form';\n\nexport interface CreateRolePayload {\n  name: string;\n  description?: string;\n  type?: string;\n  permissions?: {id: number; restrictions?: {name: string; value: any}[]}[];\n}\n\nexport function useCreateRole(form: UseFormReturn<CreateRolePayload>) {\n  const {trans} = useTrans();\n  return useMutation({\n    mutationFn: (payload: CreateRolePayload) =>\n      apiClient.post('roles', payload).then(r => r.data),\n    onSuccess: () => {\n      toast(trans(message('Created new role')));\n      queryClient.invalidateQueries({\n        queryKey: commonAdminQueries.roles.invalidateKey,\n      });\n    },\n    onError: r => onFormQueryError(r, form),\n  });\n}\n","import {useNavigate} from '@common/ui/navigation/use-navigate';\nimport {Breadcrumb} from '@ui/breadcrumbs/breadcrumb';\nimport {BreadcrumbItem} from '@ui/breadcrumbs/breadcrumb-item';\nimport {Trans} from '@ui/i18n/trans';\nimport {useForm} from 'react-hook-form';\nimport {useSearchParams} from 'react-router';\nimport {CrupdateResourceLayout} from '../../crupdate-resource-layout';\nimport {CreateRolePayload, useCreateRole} from '../requests/user-create-role';\nimport {Component as SettingsPanel} from './crupdate-role-settings-panel';\n\nexport function Component() {\n  const [searchParams] = useSearchParams();\n  const defaultType = searchParams.get('type') ?? 'users';\n  const form = useForm<CreateRolePayload>({defaultValues: {type: defaultType}});\n  const createRole = useCreateRole(form);\n  const navigate = useNavigate();\n\n  return (\n    <CrupdateResourceLayout\n      form={form}\n      onSubmit={values => {\n        createRole.mutate(values, {\n          onSuccess: response => {\n            navigate(`/admin/roles/${response.role.id}/edit`);\n          },\n        });\n      }}\n      title={\n        <Breadcrumb size=\"xl\">\n          <BreadcrumbItem to=\"/admin/roles\">\n            <Trans message=\"Roles\" />\n          </BreadcrumbItem>\n          <BreadcrumbItem>\n            <Trans message=\"New\" />\n          </BreadcrumbItem>\n        </Breadcrumb>\n      }\n      isLoading={createRole.isPending}\n    >\n      <SettingsPanel />\n    </CrupdateResourceLayout>\n  );\n}\n"],"names":["useCreateRole","form","trans","useTrans","useMutation","payload","apiClient","toast","message","queryClient","commonAdminQueries","r","onFormQueryError","Component","searchParams","useSearchParams","defaultType","useForm","createRole","navigate","useNavigate","jsx","CrupdateResourceLayout","values","response","jsxs","Breadcrumb","BreadcrumbItem","Trans","SettingsPanel"],"mappings":"myBAgBO,SAASA,EAAcC,EAAwC,CACpE,KAAM,CAAC,MAAAC,CAAA,EAASC,EAAA,EAChB,OAAOC,EAAY,CACjB,WAAaC,GACXC,EAAU,KAAK,QAASD,CAAO,EAAE,KAAK,GAAK,EAAE,IAAI,EACnD,UAAW,IAAM,CACfE,EAAML,EAAMM,EAAQ,kBAAkB,CAAC,CAAC,EACxCC,EAAY,kBAAkB,CAC5B,SAAUC,EAAmB,MAAM,aAAA,CACpC,CACH,EACA,QAASC,GAAKC,EAAiBD,EAAGV,CAAI,CAAA,CACvC,CACH,CCnBO,SAASY,GAAY,CAC1B,KAAM,CAACC,CAAY,EAAIC,EAAA,EACjBC,EAAcF,EAAa,IAAI,MAAM,GAAK,QAC1Cb,EAAOgB,EAA2B,CAAC,cAAe,CAAC,KAAMD,CAAA,EAAa,EACtEE,EAAalB,EAAcC,CAAI,EAC/BkB,EAAWC,EAAA,EAEjB,OACEC,EAAAA,IAACC,EAAA,CACC,KAAArB,EACA,SAAUsB,GAAU,CAClBL,EAAW,OAAOK,EAAQ,CACxB,UAAWC,GAAY,CACrBL,EAAS,gBAAgBK,EAAS,KAAK,EAAE,OAAO,CAClD,CAAA,CACD,CACH,EACA,MACEC,EAAAA,KAACC,EAAA,CAAW,KAAK,KACf,SAAA,CAAAL,EAAAA,IAACM,GAAe,GAAG,eACjB,eAACC,EAAA,CAAM,QAAQ,QAAQ,CAAA,CACzB,QACCD,EAAA,CACC,SAAAN,EAAAA,IAACO,EAAA,CAAM,QAAQ,MAAM,CAAA,CACvB,CAAA,EACF,EAEF,UAAWV,EAAW,UAEtB,eAACW,EAAA,CAAA,CAAc,CAAA,CAAA,CAGrB"}