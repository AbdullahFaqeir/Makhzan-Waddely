{"version":3,"file":"gdpr-settings-BtiVUt_S.js","sources":["../../../common/foundation/resources/client/admin/settings/pages/gdpr-settings.tsx"],"sourcesContent":["import {AdminDocsUrls} from '@app/admin/admin-config';\nimport {AdminSettingsLayout} from '@common/admin/settings/layout/settings-layout';\nimport {SettingsSectionHeader} from '@common/admin/settings/layout/settings-panel';\nimport {useAdminSettings} from '@common/admin/settings/requests/use-admin-settings';\nimport {Accordion, AccordionItem} from '@ui/accordion/accordion';\nimport {Button} from '@ui/buttons/button';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {Item} from '@ui/forms/listbox/item';\nimport {FormSelect} from '@ui/forms/select/select';\nimport {FormSwitch} from '@ui/forms/toggle/switch';\nimport {Trans} from '@ui/i18n/trans';\nimport {AddIcon} from '@ui/icons/material/Add';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {Fragment} from 'react';\nimport {useFieldArray, useForm, useFormContext} from 'react-hook-form';\nimport {MenuItemForm} from '../../menus/menu-item-form';\nimport {AdminSettings} from '../admin-settings';\nimport {AddMenuItemDialog} from './menu-settings/add-menu-item-dialog';\n\nexport function Component() {\n  const {data} = useAdminSettings();\n  const form = useForm<AdminSettings>({\n    defaultValues: {\n      client: {\n        cookie_notice: {\n          enable: data.client.cookie_notice?.enable ?? false,\n          button: data.client.cookie_notice?.button ?? {},\n          position: data.client.cookie_notice?.position ?? 'bottom',\n        },\n        registration: {\n          policies: data.client.registration?.policies ?? [],\n        },\n      },\n    },\n  });\n\n  return (\n    <AdminSettingsLayout\n      form={form}\n      title={<Trans message=\"GDPR\" />}\n      docsLink={AdminDocsUrls.settings.gdpr}\n    >\n      <CookieNoticeSection />\n      <RegistrationPoliciesSection />\n    </AdminSettingsLayout>\n  );\n}\n\nfunction CookieNoticeSection() {\n  const {watch} = useFormContext<AdminSettings>();\n  const noticeEnabled = watch('client.cookie_notice.enable');\n\n  return (\n    <div className=\"mb-44\">\n      <SettingsSectionHeader margin=\"mb-24\" size=\"md\">\n        <Trans message=\"Cookie Notice\" />\n        <Trans message=\"Configure the cookie consent notice shown to visitors from the European Union.\" />\n      </SettingsSectionHeader>\n      <FormSwitch name=\"client.cookie_notice.enable\">\n        <Trans message=\"Enable cookie notice\" />\n      </FormSwitch>\n      {noticeEnabled && (\n        <div className=\"mt-20 rounded-panel border p-20\">\n          <div className=\"mb-20 border-b pb-6\">\n            <div className=\"mb-20 border-b pb-10 text-sm font-medium\">\n              <Trans message=\"Information button\" />\n            </div>\n            <div className=\"mb-20\">\n              <MenuItemForm\n                hideRoleAndPermissionFields\n                formPathPrefix=\"client.cookie_notice.button\"\n              />\n            </div>\n          </div>\n          <FormSelect\n            name=\"client.cookie_notice.position\"\n            selectionMode=\"single\"\n            label={<Trans message=\"Cookie notice position\" />}\n          >\n            <Item value=\"top\">\n              <Trans message=\"Top\" />\n            </Item>\n            <Item value=\"bottom\">\n              <Trans message=\"Bottom\" />\n            </Item>\n          </FormSelect>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction RegistrationPoliciesSection() {\n  const {fields, append, remove} = useFieldArray<\n    AdminSettings,\n    'client.registration.policies'\n  >({\n    name: 'client.registration.policies',\n  });\n\n  return (\n    <Fragment>\n      <SettingsSectionHeader margin=\"my-24\" size=\"md\">\n        <Trans message=\"Registration Policies\" />\n        <Trans message=\"Create policies that will be shown on the registration page. Users will be required to accept them by toggling a checkbox.\" />\n      </SettingsSectionHeader>\n      <Accordion variant=\"outline\">\n        {fields.map((field, index) => (\n          <AccordionItem\n            key={field.id}\n            label={field.label}\n            chevronPosition=\"left\"\n            endAppend={\n              <IconButton\n                variant=\"text\"\n                color=\"danger\"\n                size=\"sm\"\n                onClick={() => remove(index)}\n              >\n                <CloseIcon />\n              </IconButton>\n            }\n          >\n            <MenuItemForm\n              hideRoleAndPermissionFields\n              formPathPrefix={`client.registration.policies.${index}`}\n            />\n          </AccordionItem>\n        ))}\n      </Accordion>\n      <DialogTrigger\n        type=\"modal\"\n        onClose={value => {\n          if (value) {\n            append(value);\n          }\n        }}\n      >\n        <Button\n          className=\"mt-12\"\n          variant=\"link\"\n          color=\"primary\"\n          startIcon={<AddIcon />}\n          size=\"sm\"\n        >\n          <Trans message=\"Add another policy\" />\n        </Button>\n        <AddMenuItemDialog title={<Trans message=\"Add policy\" />} />\n      </DialogTrigger>\n    </Fragment>\n  );\n}\n"],"names":["Component","data","useAdminSettings","form","useForm","_a","_b","_c","_d","jsxs","AdminSettingsLayout","jsx","Trans","AdminDocsUrls","CookieNoticeSection","RegistrationPoliciesSection","watch","useFormContext","noticeEnabled","SettingsSectionHeader","FormSwitch","MenuItemForm","FormSelect","Item","fields","append","remove","useFieldArray","Fragment","Accordion","field","index","AccordionItem","IconButton","CloseIcon","DialogTrigger","value","Button","AddIcon","AddMenuItemDialog"],"mappings":"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"}