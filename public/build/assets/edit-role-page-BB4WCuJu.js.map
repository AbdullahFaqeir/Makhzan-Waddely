{"version":3,"file":"edit-role-page-BB4WCuJu.js","sources":["../../../common/foundation/resources/client/admin/roles/requests/use-update-role.ts","../../../common/foundation/resources/client/admin/roles/crupdate-role-page/edit-role-page.tsx"],"sourcesContent":["import {commonAdminQueries} from '@common/admin/common-admin-queries';\nimport {CreateRolePayload} from '@common/admin/roles/requests/user-create-role';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\nimport {useRequiredParams} from '@common/ui/navigation/use-required-params';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {toast} from '@ui/toast/toast';\n\nexport function useUpdateRole() {\n  const {roleId} = useRequiredParams(['roleId']);\n  const {trans} = useTrans();\n  const navigate = useNavigate();\n  return useMutation({\n    mutationFn: (payload: Partial<CreateRolePayload>) =>\n      apiClient.put(`roles/${roleId}`, payload).then(r => r.data),\n    onSuccess: () => {\n      toast(trans(message('Role updated')));\n      queryClient.invalidateQueries({\n        queryKey: commonAdminQueries.roles.invalidateKey,\n      });\n      navigate('/admin/roles');\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n","import {commonAdminQueries} from '@common/admin/common-admin-queries';\nimport {CreateRolePayload} from '@common/admin/roles/requests/user-create-role';\nimport {useRequiredParams} from '@common/ui/navigation/use-required-params';\nimport {useSuspenseQuery} from '@tanstack/react-query';\nimport {Breadcrumb} from '@ui/breadcrumbs/breadcrumb';\nimport {BreadcrumbItem} from '@ui/breadcrumbs/breadcrumb-item';\nimport {Trans} from '@ui/i18n/trans';\nimport {Tab} from '@ui/tabs/tab';\nimport {TabList} from '@ui/tabs/tab-list';\nimport {Tabs} from '@ui/tabs/tabs';\nimport {useForm} from 'react-hook-form';\nimport {Link, Outlet, useMatch} from 'react-router';\nimport {CrupdateResourceLayout} from '../../crupdate-resource-layout';\nimport {useUpdateRole} from '../requests/use-update-role';\n\nconst tabConfig = [\n  {uri: '', label: {message: 'Settings'}},\n  {uri: 'users', label: {message: 'Users'}},\n];\n\nexport function Component() {\n  const {roleId} = useRequiredParams(['roleId']);\n  const query = useSuspenseQuery(commonAdminQueries.roles.get(roleId));\n  const form = useForm<Partial<CreateRolePayload>>({\n    defaultValues: {\n      name: query.data.role.name,\n      type: query.data.role.type,\n      description: query.data.role.description,\n      permissions: query.data.role.permissions,\n    },\n  });\n  const updateRole = useUpdateRole();\n  const match = useMatch('admin/roles/:roleId/edit/*');\n  const activeTab = match?.pathname.endsWith('users') ? 1 : 0;\n\n  return (\n    <CrupdateResourceLayout\n      isLoading={updateRole.isPending}\n      form={form}\n      onSubmit={values => {\n        updateRole.mutate(values);\n      }}\n      title={\n        <Breadcrumb size=\"xl\">\n          <BreadcrumbItem to=\"/admin/roles\">\n            <Trans message=\"Roles\" />\n          </BreadcrumbItem>\n          <BreadcrumbItem>{query.data.role.name}</BreadcrumbItem>\n        </Breadcrumb>\n      }\n      tabs={\n        <Tabs selectedTab={activeTab}>\n          <TabList className=\"px-24\">\n            {tabConfig.map(tab => (\n              <Tab\n                key={tab.uri}\n                elementType={Link}\n                to={`/admin/roles/${roleId}/edit${\n                  tab.uri ? `/${tab.uri}` : ''\n                }`}\n              >\n                <Trans {...tab.label} />\n              </Tab>\n            ))}\n          </TabList>\n        </Tabs>\n      }\n    >\n      <Outlet />\n    </CrupdateResourceLayout>\n  );\n}\n"],"names":["useUpdateRole","roleId","useRequiredParams","trans","useTrans","navigate","useNavigate","useMutation","payload","apiClient","r","toast","message","queryClient","commonAdminQueries","err","showHttpErrorToast","tabConfig","Component","query","useSuspenseQuery","form","useForm","updateRole","match","useMatch","activeTab","jsx","CrupdateResourceLayout","values","jsxs","Breadcrumb","BreadcrumbItem","Trans","Tabs","TabList","tab","Tab","Link","Outlet"],"mappings":"gqBAWO,SAASA,GAAgB,CAC9B,KAAM,CAAC,OAAAC,CAAA,EAAUC,EAAkB,CAAC,QAAQ,CAAC,EACvC,CAAC,MAAAC,CAAA,EAASC,EAAA,EACVC,EAAWC,EAAA,EACjB,OAAOC,EAAY,CACjB,WAAaC,GACXC,EAAU,IAAI,SAASR,CAAM,GAAIO,CAAO,EAAE,KAAKE,GAAKA,EAAE,IAAI,EAC5D,UAAW,IAAM,CACfC,EAAMR,EAAMS,EAAQ,cAAc,CAAC,CAAC,EACpCC,EAAY,kBAAkB,CAC5B,SAAUC,EAAmB,MAAM,aAAA,CACpC,EACDT,EAAS,cAAc,CACzB,EACA,QAASU,GAAOC,EAAmBD,CAAG,CAAA,CACvC,CACH,CCZA,MAAME,EAAY,CAChB,CAAC,IAAK,GAAI,MAAO,CAAC,QAAS,WAAU,EACrC,CAAC,IAAK,QAAS,MAAO,CAAC,QAAS,QAAO,CACzC,EAEO,SAASC,GAAY,CAC1B,KAAM,CAAC,OAAAjB,CAAA,EAAUC,EAAkB,CAAC,QAAQ,CAAC,EACvCiB,EAAQC,EAAiBN,EAAmB,MAAM,IAAIb,CAAM,CAAC,EAC7DoB,EAAOC,EAAoC,CAC/C,cAAe,CACb,KAAMH,EAAM,KAAK,KAAK,KACtB,KAAMA,EAAM,KAAK,KAAK,KACtB,YAAaA,EAAM,KAAK,KAAK,YAC7B,YAAaA,EAAM,KAAK,KAAK,WAAA,CAC/B,CACD,EACKI,EAAavB,EAAA,EACbwB,EAAQC,EAAS,4BAA4B,EAC7CC,EAAYF,GAAA,MAAAA,EAAO,SAAS,SAAS,SAAW,EAAI,EAE1D,OACEG,EAAAA,IAACC,EAAA,CACC,UAAWL,EAAW,UACtB,KAAAF,EACA,SAAUQ,GAAU,CAClBN,EAAW,OAAOM,CAAM,CAC1B,EACA,MACEC,EAAAA,KAACC,EAAA,CAAW,KAAK,KACf,SAAA,CAAAJ,EAAAA,IAACK,GAAe,GAAG,eACjB,eAACC,EAAA,CAAM,QAAQ,QAAQ,CAAA,CACzB,EACAN,EAAAA,IAACK,EAAA,CAAgB,SAAAb,EAAM,KAAK,KAAK,IAAA,CAAK,CAAA,EACxC,EAEF,KACEQ,EAAAA,IAACO,EAAA,CAAK,YAAaR,EACjB,SAAAC,EAAAA,IAACQ,EAAA,CAAQ,UAAU,QAChB,SAAAlB,EAAU,IAAImB,GACbT,EAAAA,IAACU,EAAA,CAEC,YAAaC,EACb,GAAI,gBAAgBrC,CAAM,QACxBmC,EAAI,IAAM,IAAIA,EAAI,GAAG,GAAK,EAC5B,GAEA,SAAAT,EAAAA,IAACM,EAAA,CAAO,GAAGG,EAAI,KAAA,CAAO,CAAA,EANjBA,EAAI,GAAA,CAQZ,EACH,CAAA,CACF,EAGF,eAACG,EAAA,CAAA,CAAO,CAAA,CAAA,CAGd"}