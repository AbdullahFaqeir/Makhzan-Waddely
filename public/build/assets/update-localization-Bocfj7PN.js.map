{"version":3,"file":"update-localization-Bocfj7PN.js","sources":["../../../common/foundation/resources/client/admin/translations/use-upload-translation-file.ts","../../../common/foundation/resources/client/admin/translations/update-localization.ts"],"sourcesContent":["import {commonAdminQueries} from '@common/admin/common-admin-queries';\nimport {useMutation} from '@tanstack/react-query';\nimport {Localization} from '@ui/i18n/localization';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\nimport {UploadedFile} from '@ui/utils/files/uploaded-file';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {apiClient, queryClient} from '../../http/query-client';\nimport {showHttpErrorToast} from '../../http/show-http-error-toast';\n\ninterface Response extends BackendResponse {\n  localization: Localization;\n}\n\ninterface Payload {\n  file: UploadedFile;\n  localeId: string | number;\n}\n\nexport function useUploadTranslationFile() {\n  return useMutation({\n    mutationFn: (payload: Payload) => uploadFile(payload),\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({\n        queryKey: commonAdminQueries.localizations.invalidateKey,\n      });\n      toast(message('Translation file uploaded'));\n    },\n    onError: r => showHttpErrorToast(r),\n  });\n}\n\nfunction uploadFile({localeId, file}: Payload): Promise<Response> {\n  const data = new FormData();\n  data.append('file', file.native);\n  return apiClient\n    .post(`localizations/${localeId}/upload`, data)\n    .then(r => r.data);\n}\n","import {commonAdminQueries} from '@common/admin/common-admin-queries';\nimport {useMutation} from '@tanstack/react-query';\nimport {Localization} from '@ui/i18n/localization';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\nimport {UseFormReturn} from 'react-hook-form';\nimport {onFormQueryError} from '../../errors/on-form-query-error';\nimport {apiClient, queryClient} from '../../http/query-client';\nimport {showHttpErrorToast} from '../../http/show-http-error-toast';\n\nexport function useUpdateLocalization(\n  form?: UseFormReturn<Partial<Localization>>,\n) {\n  return useMutation({\n    mutationFn: ({id, ...other}: Partial<Localization>) =>\n      apiClient.put(`localizations/${id}`, other).then(r => r.data),\n    onSuccess: () => {\n      toast(message('Localization updated'));\n      queryClient.invalidateQueries({\n        queryKey: commonAdminQueries.localizations.invalidateKey,\n      });\n    },\n    onError: r => (form ? onFormQueryError(r, form) : showHttpErrorToast(r)),\n  });\n}\n"],"names":["useUploadTranslationFile","useMutation","payload","uploadFile","queryClient","commonAdminQueries","toast","message","r","showHttpErrorToast","localeId","file","data","apiClient","useUpdateLocalization","form","id","other","onFormQueryError"],"mappings":"8FAmBO,SAASA,GAA2B,CACzC,OAAOC,EAAY,CACjB,WAAaC,GAAqBC,EAAWD,CAAO,EACpD,UAAW,SAAY,CACrB,MAAME,EAAY,kBAAkB,CAClC,SAAUC,EAAmB,cAAc,aAAA,CAC5C,EACDC,EAAMC,EAAQ,2BAA2B,CAAC,CAC5C,EACA,QAASC,GAAKC,EAAmBD,CAAC,CAAA,CACnC,CACH,CAEA,SAASL,EAAW,CAAC,SAAAO,EAAU,KAAAC,GAAmC,CAChE,MAAMC,EAAO,IAAI,SACjB,OAAAA,EAAK,OAAO,OAAQD,EAAK,MAAM,EACxBE,EACJ,KAAK,iBAAiBH,CAAQ,UAAWE,CAAI,EAC7C,KAAKJ,GAAKA,EAAE,IAAI,CACrB,CC5BO,SAASM,EACdC,EACA,CACA,OAAOd,EAAY,CACjB,WAAY,CAAC,CAAC,GAAAe,EAAI,GAAGC,KACnBJ,EAAU,IAAI,iBAAiBG,CAAE,GAAIC,CAAK,EAAE,KAAKT,GAAKA,EAAE,IAAI,EAC9D,UAAW,IAAM,CACfF,EAAMC,EAAQ,sBAAsB,CAAC,EACrCH,EAAY,kBAAkB,CAC5B,SAAUC,EAAmB,cAAc,aAAA,CAC5C,CACH,EACA,WAAeU,EAAOG,EAAiBV,EAAGO,CAAI,EAAIN,EAAmBD,CAAC,CAAA,CACvE,CACH"}