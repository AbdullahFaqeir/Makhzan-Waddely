import{r as x,cF as P,a7 as F,j as e,M as A,Q as N,T as p,R as B,B as g,a2 as I,am as w,c as k,G as y,D as E,J as f,A as T,w as v,aw as z,S as M,x as C,ab as H,cG as b,a5 as L,K as O,aA as Q,aE as R,aF as V,e as _}from"./main-owSUWNVS.js";import{F as G}from"./FilterAlt-xRRmNiqG.js";import{c as D,F as j,I as K,N as W,D as q,C as J,S as U}from"./select-filter-panel-2MY77qxo.js";import{A as X,a as Y}from"./accordion-CpK0I08P.js";import{C as Z}from"./checkbox-CiHJ6TYf.js";import{S as $}from"./select-Bv69-mBO.js";import{K as ee}from"./KeyboardArrowRight-ChYgp5kQ.js";function fe({query:s}){const[t]=x.useState(()=>new P),a=s.isFetching;return x.useEffect(()=>(a?t.show():t.hide(),()=>{a||t.hide()}),[a,t]),null}function se({filter:s}){return null}function te({filters:s}){const{decodedFilters:t}=D(s),{formId:a}=F(),[o,c]=x.useState(()=>t.map(r=>r.key)),d=e.jsx(g,{size:"xs",variant:"outline",className:"mr-auto",onClick:()=>{c([])},children:e.jsx(p,{message:"Clear"})}),u=e.jsx(g,{size:"xs",variant:"flat",color:"primary",className:"ml-auto",type:"submit",form:a,children:e.jsx(p,{message:"Apply"})});return e.jsxs(A,{className:"min-w-[300px]",maxWidth:"max-w-400",size:"auto",children:[e.jsx(N,{padding:"px-14 py-10",leftAdornment:d,rightAdornment:u,children:e.jsx(p,{message:"Filter"})}),e.jsx(B,{padding:"p-0",children:e.jsx(ae,{filters:s,expandedFilters:o,setExpandedFilters:c})})]})}function ae({filters:s,expandedFilters:t,setExpandedFilters:a}){const{decodedFilters:o,replaceAll:c}=D(s),d={};s.forEach(n=>{const m=o.find(i=>i.key===n.key);d[n.key]=(m==null?void 0:m.value)!==void 0?m:{value:n.control.defaultValue,operator:n.defaultOperator}});const u=I({defaultValues:d}),{formId:r,close:l}=F();return e.jsx(w,{form:u,id:r,onSubmit:n=>{const m=Object.entries(n).filter(([i,h])=>t.includes(i)&&h!==void 0).map(([i,h])=>({key:i,...h}));c(m),l()},children:e.jsx(X,{size:"md",mode:"multiple",expandedValues:t,onExpandedChange:a,children:s.map(n=>e.jsxs(Y,{startIcon:e.jsx(Z,{checked:t.includes(n.key)}),value:n.key,label:e.jsx(p,{...n.label}),bodyClassName:"max-h-288 overflow-y-auto compact-scrollbar",children:[n.description&&e.jsx("div",{className:k("text-xs text-muted",n.control.type!==j.BooleanToggle&&"mb-14"),children:e.jsx(p,{...n.description})}),e.jsx(re,{filter:n})]},n.key))})})}function re({filter:s}){switch(s.control.type){case j.Select:return e.jsx(U,{filter:s});case j.ChipField:return e.jsx(J,{filter:s});case j.DateRangePicker:return e.jsx(q,{filter:s});case j.SelectModel:return e.jsx(W,{filter:s});case j.Input:return e.jsx(K,{filter:s});case j.BooleanToggle:return e.jsx(se,{filter:s});case"custom":const t=s.control.panel;return e.jsx(t,{filter:s});default:return null}}function ne({filters:s,icon:t=e.jsx(G,{}),color:a="primary",variant:o="outline",size:c="sm",disabled:d,className:u}){const r=y(),l=e.jsx(g,{variant:o,color:a,startIcon:t,disabled:d,size:c,className:u,children:e.jsx(p,{message:"Filter"})}),n=e.jsx(f,{color:a,size:"sm",variant:o,disabled:d,className:u,children:t});return e.jsxs(E,{type:"popover",children:[r?n:l,e.jsx(te,{filters:s})]})}function ye(s){var t;return e.jsx(T,{initial:!1,mode:"wait",children:(t=s.selectedItems)!=null&&t.length?x.createElement(le,{...s,key:"selected"}):x.createElement(oe,{...s,key:"default"})})}function oe({searchPlaceholder:s=C("Type to search..."),searchValue:t,onSearchChange:a,actions:o,filters:c,filtersLoading:d}){const{trans:u}=v();return e.jsxs(S,{children:[e.jsx(z,{size:"sm",className:"mr-auto min-w-180 max-w-440 flex-auto",inputWrapperClassName:"mr-24 md:mr-0",placeholder:u(s),startAdornment:e.jsx(M,{size:"sm"}),value:t,onChange:r=>{a(r.target.value)}}),c&&e.jsx(ne,{filters:c,disabled:d}),o]})}function le({selectedActions:s,selectedItems:t}){return e.jsxs(S,{"data-testid":"datatable-selected-header",children:[e.jsx("div",{className:"mr-auto font-medium",children:e.jsx(p,{message:"[one 1 item|other :count items] selected",values:{count:(t==null?void 0:t.length)||1}})}),s]})}function S({children:s,...t}){return e.jsx("div",{className:"hidden-scrollbar relative mb-24 flex h-42 flex-shrink-0 items-center gap-8 overflow-x-auto md:gap-12",...t,children:s})}const ie=15,ce=[{key:15},{key:30},{key:60},{key:100}];function be({query:s,onPerPageChange:t,onPageChange:a,hideIfOnlyOnePage:o,className:c}){var m;const d=y(),u=H(),r=(m=s.data)==null?void 0:m.pagination,l=r!=null&&r.current_page?+r.current_page:1;if(!r||o&&l==1&&!b(r))return null;const n=t?e.jsx($,{selectionMode:"single",minWidth:"min-w-auto",disabled:s.isLoading,labelPosition:"side",size:"xs",label:e.jsx(p,{message:"Items per page"}),selectedValue:r.per_page?+r.per_page:ie,onSelectionChange:i=>t(i),children:ce.map(i=>e.jsx(L,{value:i.key,children:i.key},i.key))}):null;return e.jsxs("div",{className:k("flex h-54 select-none items-center justify-end gap-20 px-20",c),children:[!d&&n,r.from&&r.to&&"total"in r?e.jsx("div",{className:"text-sm",children:e.jsx(p,{message:":from - :to of :total",values:{from:r.from,to:r.to,total:u.format(r.total)}})}):null,e.jsxs("div",{className:"text-muted",children:[e.jsx(f,{disabled:s.isFetching||l<2,onClick:()=>{a==null||a(l-1)},children:e.jsx(O,{})}),e.jsx(f,{disabled:s.isFetching||!b(r),onClick:()=>{a==null||a(l+1)},children:e.jsx(ee,{})})]})]})}function Fe(s){const[t,a]=Q(),o=x.useMemo(()=>s?s(Object.fromEntries(t)):Object.fromEntries(t),[t,s]),c=x.useCallback(r=>{const l={...Object.fromEntries(t),...r},n=s?s(l):l;a(m=>{for(const i in n)n[i]===""||i==="page"&&n[i]=="1"||i==="perPage"&&n[i]=="15"?m.delete(i):m.set(i,n[i]);return m},{replace:!0})},[s,t,a]),d=x.useCallback(r=>{a(l=>(l.delete("page"),l.delete("perPage"),r?l.set("query",r):l.delete("query"),l),{replace:!0})},[a]),u=x.useMemo(()=>({orderBy:o.orderBy,orderDir:o.orderDir}),[o]);return{searchParams:o,mergeIntoSearchParams:c,setSearchQuery:d,sortDescriptor:u,isFiltering:!!(o.query||o.filters)}}function ke(s){const t=y(),{isFiltering:a,title:o,filteringTitle:c,image:d,icon:u,className:r}=s;let l=s.size;return l||(l=t?"sm":"md"),e.jsx(R,{className:r,size:l,imageHeight:u?"h-auto":void 0,image:d?e.jsx(V,{src:d}):x.cloneElement(u,{size:u.props.size||"xl",className:"text-muted"}),title:a&&c?c:o,description:e.jsx(de,{...s})})}function de({isFiltering:s,filteringTitle:t,description:a}){return s?t?e.jsx(p,{message:"Try another search query or different filters"}):void 0:a}function De(s){var a,o;const t=_(s);return{...t,items:((a=t.data)==null?void 0:a.pagination.data)??[],isEmpty:(t.isFetched||t.isPlaceholderData||s.enabled===!1)&&!((o=t.data)!=null&&o.pagination.data.length)}}export{ye as D,fe as G,De as a,ke as b,be as c,Fe as u};
//# sourceMappingURL=use-datatable-query-CxfVxFSv.js.map
