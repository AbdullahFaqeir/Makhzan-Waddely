{"version":3,"mappings":"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","names":["FormattedDuration","memo","minutes","seconds","propsMs","propsStartDate","propsEndDate","verbose","addZeroToFirstUnit","isLive","maxIsLiveMs","minDuration","liveInterval","trans","useTrans","initialMs","useMemo","startDate","parseAbsoluteToLocal","getCurrentDateTime","diff","ms","setMs","useState","useEffect","msRef","useRef","overMaxMs","interval","prev","unsignedMs","parsedMS","formattedValue","formatVerbose","formatCompact","jsx","Fragment","t","output","message","addZero","v","value","AdminReportCardRow","report","isLoading","data","ReportCard","Trans","propsIcon","children","type","currentValue","previousValue","percentageChange","colSpan","rowSpan","icon","isValidElement","cloneElement","IconEl","createSvgIconFromTree","jsxs","clsx","AnimatePresence","m","opacityAnimation","Skeleton","FormattedValue","TrendingIndicator","FormattedBytes","FormattedNumber","props","percentage","calculatePercentage","TrendingUpIcon","TrendingFlatIcon","TrendingDownIcon","monthDayFormat","ReportDateSelector","onChange","disabled","compactOnMobile","enableCompare","granularity","isMobile","useIsMobileMediaQuery","DialogTrigger","Button","DateRangeIcon","FormattedDateTimeRange","DateFormatPresets","DateSelectorDialog","state","useDateRangePickerState","compareHasInitialValue","compareState","DateRangeComparePresets","DateRangeDialog","ChartLayout","title","description","className","contentIsFlex","contentClassName","contentRef","ChartLoadingIndicator","ProgressCircle","FormattedCountryName","countryCode","localeCode","useSelectedLocale","regionNames","formattedName","InfoDialogTriggerIcon","createSvgIcon","InfoDialogTrigger","body","dialogSize","IconButton","Dialog","DialogHeader","DialogBody","loaderUrl","useGoogleGeoChart","placeholderRef","country","onCountrySelected","analytics","useSettings","apiKey","selectedTheme","useThemeSelector","geoChartRef","regionInteractivity","drawGoogleChart","useCallback","seedData","location","backgroundColor","themeValueToHex","options","_a","_b","initGoogleGeoChart","lazyLoader","a","GeoChart","metricData","layoutProps","initialData","InfoTrigger","ArrowBackIcon","LazyChart","lazy","__vitePreload","BaseChart","Suspense","primaryColor","getBootstrapData","ChartColors","formatReportData","shareFirstDatasetLabels","firstDatasetLabels","dataset","datasetIndex","datasetItem","itemIndex","label","generateDatasetLabels","datum","locale","generateTimeLabels","isoDate","isoEndDate","date","endDate","getFormatter","memoize","DateFormatter","b","shallowEqual","BarChart","direction","individualBarColors","formattedData","i","c","isHorizontal","LineChartOptions","LineChart","PolarAreaChartOptions","PolarAreaChart","d","VisitorsReportCharts","totalViews","Endpoint","useAdminReport","payload","useQuery","fetchAnalyticsReport","keepPreviousData","types","dateRange","params","apiClient","response","Component","setDateRange","DateRangePresets","StaticPageTitle","DatatablePageHeaderBar"],"ignoreList":[],"sources":["../../../common/foundation/resources/client/ui/library/i18n/formatted-duration.tsx","../../../common/foundation/resources/client/admin/analytics/admin-report-card-row.tsx","../../../common/foundation/resources/client/admin/analytics/report-date-selector.tsx","../../../common/foundation/resources/client/charts/chart-layout.tsx","../../../common/foundation/resources/client/charts/chart-loading-indicator.tsx","../../../common/foundation/resources/client/ui/library/i18n/formatted-country-name.tsx","../../../common/foundation/resources/client/ui/library/overlays/dialog/info-dialog-trigger/info-dialog-trigger-icon.tsx","../../../common/foundation/resources/client/ui/library/overlays/dialog/info-dialog-trigger/info-dialog-trigger.tsx","../../../common/foundation/resources/client/admin/analytics/geo-chart/use-google-geo-chart.ts","../../../common/foundation/resources/client/admin/analytics/geo-chart/geo-chart.tsx","../../../common/foundation/resources/client/charts/base-chart.tsx","../../../common/foundation/resources/client/charts/chart-colors.tsx","../../../common/foundation/resources/client/charts/data/format-report-data.ts","../../../common/foundation/resources/client/charts/bar-chart.tsx","../../../common/foundation/resources/client/charts/line-chart.tsx","../../../common/foundation/resources/client/charts/polar-area-chart.tsx","../../../common/foundation/resources/client/admin/analytics/visitors-report-charts.tsx","../../../common/foundation/resources/client/admin/analytics/use-admin-report.ts","../../../common/foundation/resources/client/admin/analytics/admin-report-page.tsx"],"sourcesContent":["import {Fragment, memo, useEffect, useMemo, useRef, useState} from 'react';\nimport {useTrans, UseTransReturn} from '@ui/i18n/use-trans';\nimport {message} from '@ui/i18n/message';\nimport {parseAbsoluteToLocal} from '@internationalized/date';\nimport {getCurrentDateTime} from '@ui/i18n/use-current-date-time';\n\ninterface ParsedMS {\n  days: number;\n  hours: number;\n  minutes: number;\n  seconds: number;\n}\n\ninterface FormattedDurationProps {\n  ms?: number;\n  minutes?: number;\n  seconds?: number;\n  startDate?: string;\n  endDate?: string;\n  verbose?: boolean;\n  addZeroToFirstUnit?: boolean;\n  isLive?: boolean;\n  maxIsLiveMs?: number;\n  liveInterval?: number;\n  minDuration?: number;\n}\nexport const FormattedDuration = memo(\n  ({\n    minutes,\n    seconds,\n    ms: propsMs,\n    startDate: propsStartDate,\n    endDate: propsEndDate,\n    verbose = false,\n    addZeroToFirstUnit = true,\n    isLive,\n    maxIsLiveMs,\n    minDuration = 0,\n    liveInterval = 5000,\n  }: FormattedDurationProps) => {\n    const {trans} = useTrans();\n\n    const initialMs = useMemo(() => {\n      if (propsStartDate || propsEndDate) {\n        const startDate = propsStartDate\n          ? parseAbsoluteToLocal(propsStartDate)\n          : getCurrentDateTime();\n        const endDate = propsEndDate\n          ? parseAbsoluteToLocal(propsEndDate)\n          : getCurrentDateTime();\n        const diff = endDate.toDate().getTime() - startDate.toDate().getTime();\n        return diff > minDuration ? diff : minDuration;\n      }\n\n      if (minutes) {\n        return minutes * 60000;\n      } else if (seconds) {\n        return seconds * 1000;\n      }\n\n      if (!propsMs) {\n        return minDuration;\n      }\n\n      return propsMs;\n    }, [minutes, seconds, propsMs, propsStartDate, propsEndDate, minDuration]);\n\n    const [ms, setMs] = useState<number>(initialMs);\n\n    useEffect(() => {\n      setMs(initialMs);\n    }, [initialMs]);\n\n    const msRef = useRef(ms);\n    msRef.current = ms;\n\n    useEffect(() => {\n      const overMaxMs = maxIsLiveMs && msRef.current > maxIsLiveMs;\n      if (isLive && !overMaxMs) {\n        const interval = setInterval(() => {\n          setMs(prev => prev + liveInterval);\n        }, liveInterval);\n        return () => clearInterval(interval);\n      }\n    }, [isLive, liveInterval, maxIsLiveMs, initialMs]);\n\n    const unsignedMs = ms < 0 ? -ms : ms;\n    const parsedMS: ParsedMS = {\n      days: Math.trunc(unsignedMs / 86400000),\n      hours: Math.trunc(unsignedMs / 3600000) % 24,\n      minutes: Math.trunc(unsignedMs / 60000) % 60,\n      seconds: Math.trunc(unsignedMs / 1000) % 60,\n    };\n\n    let formattedValue: string;\n    if (verbose) {\n      formattedValue = formatVerbose(parsedMS, trans);\n    } else {\n      formattedValue = formatCompact(parsedMS, addZeroToFirstUnit);\n    }\n\n    return <Fragment>{formattedValue}</Fragment>;\n  },\n);\n\nfunction formatVerbose(t: ParsedMS, trans: UseTransReturn['trans']) {\n  const output: string[] = [];\n\n  if (t.days) {\n    output.push(`${t.days}${trans(message('d'))}`);\n  }\n  if (t.hours) {\n    output.push(`${t.hours}${trans(message('hr'))}`);\n  }\n  if (t.minutes) {\n    output.push(`${t.minutes}${trans(message('min'))}`);\n  }\n  if (t.seconds && !t.hours) {\n    output.push(`${t.seconds}${trans(message('sec'))}`);\n  }\n\n  return output.join(' ');\n}\n\nfunction formatCompact(t: ParsedMS, addZeroToFirstUnit = true) {\n  const seconds = addZero(t.seconds);\n  let output = '';\n  if (t.days && !output) {\n    output = `${t.days}:${addZero(t.hours)}:${addZero(t.minutes)}:${seconds}`;\n  }\n  if (t.hours && !output) {\n    output = `${addZero(t.hours, addZeroToFirstUnit)}:${addZero(\n      t.minutes,\n    )}:${seconds}`;\n  }\n  if (!output) {\n    output = `${addZero(t.minutes, addZeroToFirstUnit)}:${seconds}`;\n  }\n  return output;\n}\n\nfunction addZero(v: number, addZero = true) {\n  if (!addZero) return v;\n  let value = `${v}`;\n  if (value.length === 1) {\n    value = '0' + value;\n  }\n  return value;\n}\n","import {HeaderCardData} from '@common/admin/analytics/use-admin-report';\nimport React, {\n  cloneElement,\n  Fragment,\n  isValidElement,\n  ReactElement,\n  ReactNode,\n} from 'react';\nimport {TrendingUpIcon} from '@ui/icons/material/TrendingUp';\nimport {TrendingDownIcon} from '@ui/icons/material/TrendingDown';\nimport {createSvgIconFromTree, IconTree} from '@ui/icons/create-svg-icon';\nimport {FormattedNumber} from '@ui/i18n/formatted-number';\nimport {FormattedBytes} from '@ui/i18n/formatted-bytes';\nimport {TrendingFlatIcon} from '@ui/icons/material/TrendingFlat';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {opacityAnimation} from '@ui/animation/opacity-animation';\nimport {Skeleton} from '@ui/skeleton/skeleton';\nimport {SvgIconProps} from '@ui/icons/svg-icon';\nimport clsx from 'clsx';\nimport {Trans} from '@ui/i18n/trans';\nimport {FormattedDuration} from '@ui/i18n/formatted-duration';\n\ninterface AdminHeaderReportProps {\n  report?: HeaderCardData[];\n  isLoading?: boolean;\n}\nexport function AdminReportCardRow({\n  report,\n  isLoading,\n}: AdminHeaderReportProps) {\n  if (!report) return <div className=\"col-span-12 row-span-3\" />;\n  return (\n    <Fragment>\n      {report?.map(data => (\n        <ReportCard\n          key={data.name}\n          icon={data.icon}\n          type={data.type}\n          currentValue={data.currentValue}\n          previousValue={data.previousValue}\n          percentageChange={data.percentageChange}\n          isLoading={isLoading}\n        >\n          <Trans message={data.name} />\n        </ReportCard>\n      ))}\n    </Fragment>\n  );\n}\n\ninterface ReportCardProps {\n  icon?: IconTree[] | ReactElement<SvgIconProps>;\n  type?: 'number' | 'fileSize' | 'percentage' | 'durationInSeconds';\n  currentValue: number | null;\n  previousValue?: number | null;\n  percentageChange?: number;\n  isLoading?: boolean;\n  children: ReactNode;\n  colSpan?: string;\n  rowSpan?: string;\n}\nexport function ReportCard({\n  icon: propsIcon,\n  children,\n  type,\n  currentValue,\n  previousValue,\n  percentageChange,\n  isLoading = false,\n  colSpan = 'col-span-3',\n  rowSpan = 'row-span-3',\n}: ReportCardProps) {\n  let icon;\n  if (propsIcon) {\n    if (isValidElement(propsIcon)) {\n      icon = cloneElement(propsIcon, {size: 'sm'});\n    } else {\n      const IconEl = createSvgIconFromTree(propsIcon);\n      icon = IconEl ? <IconEl size=\"sm\" /> : null;\n    }\n  }\n\n  return (\n    <div\n      className={clsx(\n        'compact-scrollbar flex flex-col justify-between overflow-x-auto overflow-y-hidden whitespace-nowrap rounded-panel border px-20 py-14',\n        colSpan,\n        rowSpan,\n      )}\n    >\n      <div className=\"flex items-center gap-6\">\n        {icon}\n        <h2 className=\"text-sm font-semibold\">{children}</h2>\n      </div>\n      <div className=\"flex gap-10\">\n        <div className=\"text-4xl font-medium text-main\">\n          <AnimatePresence initial={false} mode=\"wait\">\n            {isLoading ? (\n              <m.div key=\"skeleton\" {...opacityAnimation}>\n                <Skeleton className=\"min-w-40\" />\n              </m.div>\n            ) : (\n              <m.div key=\"value\" {...opacityAnimation}>\n                <FormattedValue type={type} value={currentValue} />\n              </m.div>\n            )}\n          </AnimatePresence>\n        </div>\n        {currentValue != null &&\n          (percentageChange != null || previousValue != null) && (\n            <div className=\"flex items-center gap-10\">\n              <TrendingIndicator\n                currentValue={currentValue}\n                previousValue={previousValue}\n                percentageChange={percentageChange}\n              />\n            </div>\n          )}\n      </div>\n    </div>\n  );\n}\n\ninterface FormattedValueProps {\n  type: ReportCardProps['type'];\n  value: ReportCardProps['currentValue'];\n}\nfunction FormattedValue({type, value}: FormattedValueProps) {\n  if (value == null) return 'â€”';\n  switch (type) {\n    case 'fileSize':\n      return <FormattedBytes bytes={value} />;\n    case 'percentage':\n      return (\n        <FormattedNumber\n          value={value}\n          style=\"percent\"\n          maximumFractionDigits={1}\n        />\n      );\n    case 'durationInSeconds':\n      return <FormattedDuration seconds={value as number} verbose />;\n    default:\n      return <FormattedNumber value={value} />;\n  }\n}\n\ninterface TrendingIndicatorProps {\n  currentValue: number;\n  previousValue?: number | null;\n  percentageChange?: number;\n}\nfunction TrendingIndicator(props: TrendingIndicatorProps) {\n  const percentage = calculatePercentage(props);\n  let icon: ReactElement;\n  if (percentage > 0) {\n    icon = <TrendingUpIcon size=\"md\" className=\"text-positive\" />;\n  } else if (percentage === 0) {\n    icon = <TrendingFlatIcon className=\"text-muted\" />;\n  } else {\n    icon = <TrendingDownIcon className=\"text-danger\" />;\n  }\n\n  return (\n    <Fragment>\n      {icon}\n      <div className=\"text-sm font-semibold text-muted\">{percentage}%</div>\n    </Fragment>\n  );\n}\n\nfunction calculatePercentage({\n  percentageChange,\n  previousValue,\n  currentValue,\n}: TrendingIndicatorProps) {\n  if (\n    percentageChange != null ||\n    previousValue == null ||\n    currentValue == null\n  ) {\n    return percentageChange ?? 0;\n  }\n\n  if (previousValue === 0) {\n    return 100;\n  }\n\n  return Math.round(((currentValue - previousValue) / previousValue) * 100);\n}\n","import {Button} from '@ui/buttons/button';\nimport {Granularity} from '@ui/forms/input-field/date/date-picker/use-date-picker-state';\nimport {DateRangeValue} from '@ui/forms/input-field/date/date-range-picker/date-range-value';\nimport {DateRangeComparePresets} from '@ui/forms/input-field/date/date-range-picker/dialog/date-range-compare-presets';\nimport {DateRangeDialog} from '@ui/forms/input-field/date/date-range-picker/dialog/date-range-dialog';\nimport {useDateRangePickerState} from '@ui/forms/input-field/date/date-range-picker/use-date-range-picker-state';\nimport {DateFormatPresets} from '@ui/i18n/formatted-date';\nimport {FormattedDateTimeRange} from '@ui/i18n/formatted-date-time-range';\nimport {DateRangeIcon} from '@ui/icons/material/DateRange';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {useIsMobileMediaQuery} from '@ui/utils/hooks/is-mobile-media-query';\n\nconst monthDayFormat: Intl.DateTimeFormatOptions = {\n  month: 'short',\n  day: '2-digit',\n};\n\ninterface ReportDataSelectorProps {\n  value: DateRangeValue;\n  disabled?: boolean;\n  onChange: (value: DateRangeValue) => void;\n  compactOnMobile?: boolean;\n  enableCompare?: boolean;\n  granularity?: Granularity;\n}\nexport function ReportDateSelector({\n  value,\n  onChange,\n  disabled,\n  compactOnMobile = true,\n  enableCompare = false,\n  granularity = 'minute',\n}: ReportDataSelectorProps) {\n  const isMobile = useIsMobileMediaQuery();\n  return (\n    <DialogTrigger\n      type=\"popover\"\n      onClose={value => {\n        if (value) {\n          onChange(value);\n        }\n      }}\n    >\n      <Button\n        variant=\"outline\"\n        color=\"chip\"\n        endIcon={<DateRangeIcon />}\n        disabled={disabled}\n      >\n        <FormattedDateTimeRange\n          start={value.start}\n          end={value.end}\n          options={\n            isMobile && compactOnMobile\n              ? monthDayFormat\n              : DateFormatPresets.short\n          }\n        />\n      </Button>\n      <DateSelectorDialog\n        value={value}\n        enableCompare={enableCompare}\n        granularity={granularity}\n      />\n    </DialogTrigger>\n  );\n}\n\ninterface DateSelectorDialogProps {\n  value: DateRangeValue;\n  enableCompare: boolean;\n  granularity: Granularity;\n}\nfunction DateSelectorDialog({\n  value,\n  enableCompare,\n  granularity,\n}: DateSelectorDialogProps) {\n  const isMobile = useIsMobileMediaQuery();\n  const state = useDateRangePickerState({\n    granularity,\n    defaultValue: {\n      start: value.start,\n      end: value.end,\n      preset: value.preset,\n    },\n    closeDialogOnSelection: false,\n  });\n  const compareHasInitialValue = !!value.compareStart && !!value.compareEnd;\n  const compareState = useDateRangePickerState({\n    granularity,\n    defaultValue: compareHasInitialValue\n      ? {\n          start: value.compareStart,\n          end: value.compareEnd,\n          preset: value.comparePreset,\n        }\n      : DateRangeComparePresets[0].getRangeValue(state.selectedValue),\n  });\n  return (\n    <DateRangeDialog\n      state={state}\n      compareState={enableCompare ? compareState : undefined}\n      compareVisibleDefault={compareHasInitialValue}\n      showInlineDatePickerField={!isMobile}\n    />\n  );\n}\n","import clsx from 'clsx';\nimport {ReactNode, Ref} from 'react';\n\nexport interface ChartLayoutProps {\n  title: ReactNode;\n  description?: ReactNode;\n  className?: string;\n  children: ReactNode;\n  contentIsFlex?: boolean;\n  contentClassName?: string;\n  contentRef?: Ref<HTMLDivElement>;\n  isLoading?: boolean;\n}\nexport function ChartLayout(props: ChartLayoutProps) {\n  const {\n    title,\n    description,\n    children,\n    className,\n    contentIsFlex = true,\n    contentClassName,\n    contentRef,\n  } = props;\n\n  return (\n    <div\n      className={clsx(\n        'flex flex-auto flex-col rounded-panel border bg-elevated p-20',\n        className,\n      )}\n    >\n      <div className=\"flex flex-shrink-0 items-center justify-between pb-10 text-xs\">\n        <div className=\"text-sm font-semibold\">{title}</div>\n        {description && <div className=\"text-muted\">{description}</div>}\n      </div>\n      <div\n        ref={contentRef}\n        className={clsx(\n          'relative',\n          contentIsFlex && 'flex flex-auto items-center justify-center',\n          contentClassName,\n        )}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}\n","import {ProgressCircle} from '@ui/progress/progress-circle';\nimport {Trans} from '@ui/i18n/trans';\n\nexport function ChartLoadingIndicator() {\n  return (\n    <div className=\"absolute mx-auto flex items-center gap-10 text-sm\">\n      <ProgressCircle isIndeterminate size=\"sm\" />\n      <Trans message=\"Chart loading\" />\n    </div>\n  );\n}\n","import {useSelectedLocale} from '@ui/i18n/selected-locale';\nimport {Fragment, memo} from 'react';\n\ninterface Props {\n  code: string;\n}\nexport const FormattedCountryName = memo(({code: countryCode}: Props) => {\n  const {localeCode} = useSelectedLocale();\n  const regionNames = new Intl.DisplayNames([localeCode], {type: 'region'});\n  let formattedName: string | undefined;\n\n  try {\n    formattedName = regionNames.of(countryCode.toUpperCase());\n  } catch (e) {}\n\n  return <Fragment>{formattedName}</Fragment>;\n});\n","import {createSvgIcon} from '@ui/icons/create-svg-icon';\n\nexport const InfoDialogTriggerIcon = createSvgIcon(\n  <path d=\"M9 8a1 1 0 0 0-1-1H5.5a1 1 0 1 0 0 2H7v4a1 1 0 0 0 2 0zM4 0h8a4 4 0 0 1 4 4v8a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4zm4 5.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z\" />,\n  'InfoDialogTrigger',\n);\n","import {IconButton} from '@ui/buttons/icon-button';\nimport {Dialog, DialogSize} from '@ui/overlays/dialog/dialog';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {InfoDialogTriggerIcon} from '@ui/overlays/dialog/info-dialog-trigger/info-dialog-trigger-icon';\nimport clsx from 'clsx';\nimport {ReactNode} from 'react';\n\ninterface Props {\n  title?: ReactNode;\n  body: ReactNode;\n  dialogSize?: DialogSize;\n  className?: string;\n}\nexport function InfoDialogTrigger({\n  title,\n  body,\n  dialogSize = 'sm',\n  className,\n}: Props) {\n  return (\n    <DialogTrigger type=\"popover\" triggerOnHover>\n      <IconButton\n        className={clsx('ml-4 text-muted opacity-70', className)}\n        iconSize=\"xs\"\n        size=\"2xs\"\n      >\n        <InfoDialogTriggerIcon viewBox=\"0 0 16 16\" />\n      </IconButton>\n      <Dialog size={dialogSize}>\n        {title && (\n          <DialogHeader padding=\"px-18 pt-12\" size=\"md\" hideDismissButton>\n            {title}\n          </DialogHeader>\n        )}\n        <DialogBody>{body}</DialogBody>\n      </Dialog>\n    </DialogTrigger>\n  );\n}\n","import {LocationDatasetItem} from '@common/admin/analytics/report-metric';\nimport {message} from '@ui/i18n/message';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {useSettings} from '@ui/settings/use-settings';\nimport {useThemeSelector} from '@ui/themes/theme-selector-context';\nimport {themeValueToHex} from '@ui/themes/utils/theme-value-to-hex';\nimport lazyLoader from '@ui/utils/loaders/lazy-loader';\nimport {RefObject, useCallback, useEffect, useRef} from 'react';\n\nconst loaderUrl = 'https://www.gstatic.com/charts/loader.js';\n\ninterface UseGoogleGeoChartProps {\n  placeholderRef: RefObject<HTMLDivElement | null>;\n  data: LocationDatasetItem[];\n  onCountrySelected?: (countryCode: string) => void;\n  country?: string;\n}\nexport function useGoogleGeoChart({\n  placeholderRef,\n  data,\n  country,\n  onCountrySelected,\n}: UseGoogleGeoChartProps) {\n  const {trans} = useTrans();\n  const {analytics} = useSettings();\n  const apiKey = analytics?.gchart_api_key;\n  const {selectedTheme} = useThemeSelector();\n  const geoChartRef = useRef<google.visualization.GeoChart>(null);\n  // only allow selecting countries, not cities\n  const regionInteractivity = !!onCountrySelected && !country;\n  const drawGoogleChart = useCallback(() => {\n    if (typeof google === 'undefined') return;\n\n    const seedData = data.map(location => [location.label, location.value]);\n    seedData.unshift([\n      country ? trans(message('City')) : trans(message('Country')),\n      trans(message('Clicks')),\n    ]);\n\n    const backgroundColor = `${themeValueToHex(\n      selectedTheme.values['--be-bg-elevated'],\n    )}`;\n    const chartColor = `${themeValueToHex(\n      selectedTheme.values['--be-primary'],\n    )}`;\n\n    const options: google.visualization.GeoChartOptions = {\n      colorAxis: {colors: [chartColor]},\n      backgroundColor,\n      region: country ? country.toUpperCase() : undefined,\n      resolution: country ? 'provinces' : 'countries',\n      displayMode: country ? 'markers' : 'regions',\n      enableRegionInteractivity: regionInteractivity,\n    };\n\n    if (\n      !geoChartRef.current &&\n      placeholderRef.current &&\n      google?.visualization?.GeoChart\n    ) {\n      geoChartRef.current = new google.visualization.GeoChart(\n        placeholderRef.current,\n      );\n    }\n    geoChartRef.current?.draw(\n      google.visualization.arrayToDataTable(seedData),\n      options,\n    );\n  }, [\n    selectedTheme,\n    data,\n    placeholderRef,\n    trans,\n    country,\n    regionInteractivity,\n  ]);\n\n  const initGoogleGeoChart = useCallback(async () => {\n    if (lazyLoader.isLoadingOrLoaded(loaderUrl)) return;\n    await lazyLoader.loadAsset(loaderUrl, {type: 'js', id: 'google-charts-js'});\n    await google.charts.load('current', {\n      packages: ['geochart'],\n      mapsApiKey: apiKey,\n    });\n    drawGoogleChart();\n  }, [apiKey, drawGoogleChart]);\n\n  useEffect(() => {\n    if (geoChartRef.current && onCountrySelected) {\n      google.visualization.events.addListener(\n        geoChartRef.current,\n        'regionClick',\n        (a: {region: string}) => onCountrySelected?.(a.region),\n      );\n    }\n\n    return () => {\n      if (geoChartRef.current) {\n        google.visualization.events.removeAllListeners(geoChartRef.current);\n      }\n    };\n    // this will correctly run when geochart instance is set on ref\n  }, [onCountrySelected, geoChartRef.current]);\n\n  // on component load: load chart library then draw, otherwise just draw\n  useEffect(() => {\n    initGoogleGeoChart();\n  }, [initGoogleGeoChart]);\n\n  // redraw chart if data or theme changes\n  useEffect(() => {\n    drawGoogleChart();\n  }, [selectedTheme, drawGoogleChart, data]);\n\n  return {drawGoogleChart};\n}\n","import {\n  LocationDatasetItem,\n  ReportMetric,\n} from '@common/admin/analytics/report-metric';\nimport { ChartLayout, ChartLayoutProps } from '@common/charts/chart-layout';\nimport { ChartLoadingIndicator } from '@common/charts/chart-loading-indicator';\nimport { Button } from '@ui/buttons/button';\nimport { FormattedCountryName } from '@ui/i18n/formatted-country-name';\nimport { Trans } from '@ui/i18n/trans';\nimport { ArrowBackIcon } from '@ui/icons/material/ArrowBack';\nimport { InfoDialogTrigger } from '@ui/overlays/dialog/info-dialog-trigger/info-dialog-trigger';\nimport clsx from 'clsx';\nimport { useMemo, useRef } from 'react';\nimport { useGoogleGeoChart } from './use-google-geo-chart';\n\ninterface GeoChartData extends Partial<ChartLayoutProps> {\n  data?: ReportMetric<LocationDatasetItem>;\n  onCountrySelected?: (countryCode: string | undefined) => void;\n  country?: string;\n  colSpan?: string;\n  rowSpan?: string;\n}\nexport function GeoChart({\n  data: metricData,\n  isLoading,\n  onCountrySelected,\n  country,\n  className,\n  colSpan = 'col-span-7',\n  rowSpan = 'row-span-11',\n  ...layoutProps\n}: GeoChartData) {\n  const placeholderRef = useRef<HTMLDivElement>(null);\n  const regionInteractivity = !!onCountrySelected;\n\n  // memo data to avoid redrawing chart on rerender\n  const initialData = metricData?.datasets[0].data;\n  const data = useMemo(() => {\n    return initialData || [];\n  }, [initialData]);\n  useGoogleGeoChart({placeholderRef, data, country, onCountrySelected});\n\n  return (\n    <ChartLayout\n      {...layoutProps}\n      className={clsx(\n        className,\n        colSpan,\n        rowSpan,\n        'compact-scrollbar overflow-x-auto overflow-y-hidden',\n      )}\n      title={\n        <div className=\"flex items-center\">\n          <Trans message=\"Top Locations\" />\n          {country ? (\n            <span className=\"pl-4\">\n              ({<FormattedCountryName code={country} />})\n            </span>\n          ) : null}\n          {regionInteractivity && <InfoTrigger />}\n        </div>\n      }\n      contentIsFlex={isLoading}\n    >\n      {isLoading && <ChartLoadingIndicator />}\n      <div className=\"flex gap-24\">\n        <div\n          ref={placeholderRef}\n          className=\"min-h-[340px] w-[480px] flex-auto\"\n        />\n        <div className=\"w-[170px]\">\n          <div className=\"max-h-[340px] w-full flex-initial overflow-y-auto text-sm\">\n            {data.map(location => (\n              <div\n                key={location.label}\n                className={clsx(\n                  'mb-4 flex items-center gap-4',\n                  regionInteractivity && 'cursor-pointer hover:underline',\n                )}\n                role={regionInteractivity ? 'button' : undefined}\n                onClick={() => {\n                  onCountrySelected?.(location.code);\n                }}\n              >\n                <div className=\"max-w-110 overflow-hidden overflow-ellipsis whitespace-nowrap\">\n                  {location.label}\n                </div>\n                <div>({location.percentage})%</div>\n              </div>\n            ))}\n          </div>\n          {country && (\n            <Button\n              variant=\"outline\"\n              size=\"xs\"\n              className=\"mt-14\"\n              startIcon={<ArrowBackIcon />}\n              onClick={() => {\n                onCountrySelected?.(undefined);\n              }}\n            >\n              <Trans message=\"Back to countries\" />\n            </Button>\n          )}\n        </div>\n      </div>\n    </ChartLayout>\n  );\n}\n\nfunction InfoTrigger() {\n  return (\n    <InfoDialogTrigger\n      title={<Trans message=\"Zooming in\" />}\n      body={\n        <Trans message=\"Click on a country inside the map or country list to zoom in and see city data for that country.\" />\n      }\n    />\n  );\n}\n","import type {ChartData, ChartOptions, ChartType} from 'chart.js';\nimport {lazy, Suspense} from 'react';\nimport {ChartLayout, ChartLayoutProps} from './chart-layout';\nimport {ChartLoadingIndicator} from '@common/charts/chart-loading-indicator';\nimport clsx from 'clsx';\n\nconst LazyChart = lazy(() => import('./lazy-chart'));\n\nexport interface BaseChartProps<Type extends ChartType = ChartType>\n  extends Omit<ChartLayoutProps, 'children'> {\n  type: Type;\n  data: ChartData<Type, unknown>;\n  options?: ChartOptions<Type>;\n  hideLegend?: boolean;\n  rowSpan?: string;\n  colSpan?: string;\n}\nexport function BaseChart<Type extends ChartType = ChartType>(\n  props: BaseChartProps<Type>,\n) {\n  const {\n    title,\n    description,\n    className,\n    rowSpan = 'row-span-11',\n    colSpan = 'col-span-6',\n    contentRef,\n    isLoading,\n  } = props;\n\n  return (\n    <ChartLayout\n      title={title}\n      description={description}\n      className={clsx(className, rowSpan, colSpan)}\n      contentRef={contentRef}\n    >\n      <Suspense fallback={<ChartLoadingIndicator />}>\n        <LazyChart {...props} />\n        {isLoading && <ChartLoadingIndicator />}\n      </Suspense>\n    </ChartLayout>\n  );\n}\n","import {getBootstrapData} from '@ui/bootstrap-data/bootstrap-data-store';\n\nconst primaryColor = getBootstrapData().themes[0].values['--be-primary'];\nexport const ChartColors = [\n  [\n    `rgb(${primaryColor.replaceAll(' ', ',')})`,\n    `rgba(${primaryColor.replaceAll(' ', ',')},0.2)`,\n  ],\n  ['rgb(255,112,67)', 'rgb(255,112,67,0.2)'],\n  ['rgb(255,167,38)', 'rgb(255,167,38,0.2)'],\n  ['rgb(141,110,99)', 'rgb(141,110,99,0.2)'],\n  ['rgb(102,187,106)', 'rgba(102,187,106,0.2)'],\n  ['rgb(92,107,192)', 'rgb(92,107,192,0.2)'],\n];\n","import { DateFormatter, parseAbsoluteToLocal } from '@internationalized/date';\nimport { shallowEqual } from '@ui/utils/shallow-equal';\nimport { ChartType } from 'chart.js';\nimport memoize from 'nano-memoize';\nimport {\n  DatasetItem,\n  RangedDatasetGranularity,\n  ReportMetric,\n} from '../../admin/analytics/report-metric';\nimport {\n  FormattedDatasetItem,\n  FormattedReportData,\n} from './formatted-dataset-item';\n\ninterface Options {\n  localeCode: string;\n  shareFirstDatasetLabels?: boolean;\n}\n\ntype FormattedDatasetLabels = Omit<FormattedDatasetItem, 'value'>;\n\nexport function formatReportData(\n  report: ReportMetric<DatasetItem> | undefined,\n  {localeCode = 'en', shareFirstDatasetLabels = true}: Options,\n): FormattedReportData {\n  if (!report) return {datasets: []};\n\n  const firstDatasetLabels: FormattedDatasetLabels[] = [];\n\n  return {\n    ...report,\n    datasets: report.datasets.map((dataset, datasetIndex) => {\n      const data = dataset.data.map((datasetItem, itemIndex) => {\n        let label: FormattedDatasetLabels;\n        // when there are multiple datasets, we'll need to use labels from the first dataset, so charts are\n        // overlapped over one another, otherwise they will be side by side, if labels in all datasets are not identical.\n        if (datasetIndex === 0 || !shareFirstDatasetLabels) {\n          label = generateDatasetLabels(\n            datasetItem,\n            report.granularity,\n            localeCode,\n          );\n          firstDatasetLabels[itemIndex] = label;\n        } else {\n          label = firstDatasetLabels[itemIndex];\n        }\n        return {\n          ...label,\n          value: datasetItem.value,\n        };\n      });\n\n      return {...dataset, data};\n    }),\n  };\n}\n\nfunction generateDatasetLabels<T extends ChartType = ChartType>(\n  datum: DatasetItem,\n  granularity: RangedDatasetGranularity | undefined,\n  locale: string,\n): FormattedDatasetLabels {\n  if (datum.label) {\n    return {label: datum.label};\n  }\n\n  if (!datum.date) {\n    return {label: ''};\n  }\n\n  return generateTimeLabels(datum, granularity, locale);\n}\n\nfunction generateTimeLabels(\n  {date: isoDate, endDate: isoEndDate}: DatasetItem,\n  granularity: RangedDatasetGranularity | undefined = 'day',\n  locale: string,\n): Omit<FormattedDatasetItem, 'value'> {\n  const date = parseAbsoluteToLocal(isoDate!).toDate();\n  const endDate = isoEndDate ? parseAbsoluteToLocal(isoEndDate).toDate() : null;\n\n  switch (granularity) {\n    case 'minute':\n      return {\n        label: getFormatter(locale, {\n          second: '2-digit',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          day: '2-digit',\n          hour: 'numeric',\n          minute: 'numeric',\n          second: '2-digit',\n        }).format(date),\n      };\n    case 'hour':\n      return {\n        label: getFormatter(locale, {\n          hour: 'numeric',\n          minute: 'numeric',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          month: 'short',\n          day: '2-digit',\n          hour: 'numeric',\n          minute: 'numeric',\n        }).format(date),\n      };\n    case 'day':\n      return {\n        label: getFormatter(locale, {\n          day: '2-digit',\n          weekday: 'short',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          day: '2-digit',\n          weekday: 'short',\n          month: 'short',\n        }).format(date),\n      };\n    case 'week':\n      return {\n        label: getFormatter(locale, {\n          month: 'short',\n          day: '2-digit',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          day: '2-digit',\n          month: 'long',\n          year: 'numeric',\n        }).formatRange(date, endDate as Date),\n      };\n    case 'month':\n      return {\n        label: getFormatter(locale, {\n          month: 'short',\n          year: 'numeric',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          month: 'long',\n          year: 'numeric',\n        }).format(date),\n      };\n    case 'year':\n      return {\n        label: getFormatter(locale, {\n          year: 'numeric',\n        }).format(date),\n        tooltipTitle: getFormatter(locale, {\n          year: 'numeric',\n        }).format(date),\n      };\n  }\n}\n\nconst getFormatter = memoize(\n  (locale, options: Intl.DateTimeFormatOptions) => {\n    return new DateFormatter(locale, options);\n  },\n  {\n    equals: (a, b) => {\n      return shallowEqual(a, b);\n    },\n  },\n);\n","import {BaseChart, BaseChartProps} from './base-chart';\nimport {ChartData, ChartOptions} from 'chart.js';\nimport {ChartColors} from './chart-colors';\nimport {useSelectedLocale} from '@ui/i18n/selected-locale';\nimport {FormattedDatasetItem} from './data/formatted-dataset-item';\nimport {useMemo} from 'react';\nimport {formatReportData} from './data/format-report-data';\nimport {DatasetItem, ReportMetric} from '../admin/analytics/report-metric';\n\ninterface BarChartProps extends Omit<BaseChartProps<'bar'>, 'type' | 'data'> {\n  direction?: 'horizontal' | 'vertical';\n  individualBarColors?: boolean;\n  data?: ReportMetric<DatasetItem>;\n}\nexport function BarChart({\n  data,\n  direction = 'vertical',\n  individualBarColors = false,\n  className,\n  ...props\n}: BarChartProps) {\n  const {localeCode} = useSelectedLocale();\n  const formattedData: ChartData<'bar', FormattedDatasetItem[]> =\n    useMemo(() => {\n      const formattedData = formatReportData(data, {localeCode});\n      formattedData.datasets = formattedData.datasets.map((dataset, i) => ({\n        ...dataset,\n        backgroundColor: individualBarColors\n          ? ChartColors.map(c => c[1])\n          : ChartColors[i][1],\n        borderColor: individualBarColors\n          ? ChartColors.map(c => c[0])\n          : ChartColors[i][0],\n        borderWidth: 2,\n      }));\n      return formattedData;\n    }, [data, localeCode, individualBarColors]);\n\n  const isHorizontal = direction === 'horizontal';\n  const options: ChartOptions<'bar'> = useMemo(() => {\n    return {\n      indexAxis: isHorizontal ? 'y' : 'x',\n      parsing: {\n        xAxisKey: isHorizontal ? 'value' : 'label',\n        yAxisKey: isHorizontal ? 'label' : 'value',\n      },\n    };\n  }, [isHorizontal]);\n\n  return (\n    <BaseChart\n      type=\"bar\"\n      className={className}\n      data={formattedData}\n      options={options}\n      {...props}\n    />\n  );\n}\n","import {BaseChart, BaseChartProps} from './base-chart';\nimport {DatasetItem, ReportMetric} from '../admin/analytics/report-metric';\nimport {useMemo} from 'react';\nimport {formatReportData} from './data/format-report-data';\nimport {useSelectedLocale} from '@ui/i18n/selected-locale';\nimport {ChartData, ChartOptions} from 'chart.js';\nimport {ChartColors} from './chart-colors';\nimport {FormattedDatasetItem} from './data/formatted-dataset-item';\n\nconst LineChartOptions: ChartOptions<'line'> = {\n  parsing: {\n    xAxisKey: 'label',\n    yAxisKey: 'value',\n  },\n  datasets: {\n    line: {\n      fill: 'origin',\n      tension: 0.1,\n      pointBorderWidth: 4,\n      pointHitRadius: 10,\n    },\n  },\n  plugins: {\n    tooltip: {\n      intersect: false,\n      mode: 'index',\n    },\n  },\n};\n\ninterface LineChartProps extends Omit<BaseChartProps<'line'>, 'type' | 'data'> {\n  data?: ReportMetric<DatasetItem>;\n}\nexport function LineChart({data, ...props}: LineChartProps) {\n  const {localeCode} = useSelectedLocale();\n  const formattedData: ChartData<'line', FormattedDatasetItem[]> =\n    useMemo(() => {\n      const formattedData = formatReportData(data, {localeCode});\n      formattedData.datasets = formattedData.datasets.map((dataset, i) => ({\n        ...dataset,\n        backgroundColor: ChartColors[i][1],\n        borderColor: ChartColors[i][0],\n        pointBackgroundColor: ChartColors[i][0],\n      }));\n      return formattedData;\n    }, [data, localeCode]);\n\n  return (\n    <BaseChart\n      {...props}\n      data={formattedData}\n      type=\"line\"\n      options={LineChartOptions}\n    />\n  );\n}\n","import {BaseChart, BaseChartProps} from './base-chart';\nimport {ChartData, ChartOptions} from 'chart.js';\nimport {ChartColors} from './chart-colors';\nimport {useSelectedLocale} from '@ui/i18n/selected-locale';\nimport {useMemo} from 'react';\nimport {formatReportData} from './data/format-report-data';\nimport {DatasetItem, ReportMetric} from '../admin/analytics/report-metric';\nimport {FormattedDatasetItem} from './data/formatted-dataset-item';\n\nconst PolarAreaChartOptions: ChartOptions<'polarArea'> = {\n  parsing: {\n    key: 'value',\n  },\n  plugins: {\n    tooltip: {\n      intersect: true,\n    },\n  },\n};\n\ninterface PolarAreaChartProps\n  extends Omit<BaseChartProps<'polarArea'>, 'type' | 'data'> {\n  data?: ReportMetric<DatasetItem>;\n}\nexport function PolarAreaChart({\n  data,\n  className,\n  ...props\n}: PolarAreaChartProps) {\n  const {localeCode} = useSelectedLocale();\n  const formattedData: ChartData<'polarArea', FormattedDatasetItem[]> =\n    useMemo(() => {\n      const formattedData = formatReportData(data, {localeCode});\n      formattedData.labels = formattedData.datasets[0]?.data.map(d => d.label);\n      formattedData.datasets = formattedData.datasets.map((dataset, i) => ({\n        ...dataset,\n        backgroundColor: ChartColors.map(c => c[1]),\n        borderColor: ChartColors.map(c => c[0]),\n        borderWidth: 2,\n      }));\n      return formattedData;\n    }, [data, localeCode]);\n\n  return (\n    <BaseChart\n      type=\"polarArea\"\n      data={formattedData}\n      options={PolarAreaChartOptions}\n      className={className}\n      {...props}\n    />\n  );\n}\n","import {GeoChart} from '@common/admin/analytics/geo-chart/geo-chart';\nimport {VisitorsReportData} from '@common/admin/analytics/visitors-report-data';\nimport {BarChart} from '@common/charts/bar-chart';\nimport {LineChart} from '@common/charts/line-chart';\nimport {PolarAreaChart} from '@common/charts/polar-area-chart';\nimport {FormattedNumber} from '@ui/i18n/formatted-number';\nimport {Trans} from '@ui/i18n/trans';\nimport {Fragment} from 'react/jsx-runtime';\n\ninterface AdminReportChartsProps {\n  report?: VisitorsReportData;\n  isLoading: boolean;\n}\nexport function VisitorsReportCharts({\n  report,\n  isLoading,\n}: AdminReportChartsProps) {\n  const totalViews = report?.pageViews.total;\n  return (\n    <Fragment>\n      <LineChart\n        colSpan=\"col-span-8\"\n        isLoading={isLoading}\n        data={report?.pageViews}\n        title={<Trans message=\"Pageviews\" />}\n        description={\n          totalViews ? (\n            <Trans\n              message=\":count total views\"\n              values={{count: <FormattedNumber value={totalViews} />}}\n            />\n          ) : null\n        }\n      />\n      <PolarAreaChart\n        colSpan=\"col-span-4\"\n        isLoading={isLoading}\n        data={report?.devices}\n        title={<Trans message=\"Top devices\" />}\n      />\n      <GeoChart\n        colSpan=\"col-span-7\"\n        isLoading={isLoading}\n        data={report?.locations}\n        title={<Trans message=\"Top locations\" />}\n      />\n      <BarChart\n        colSpan=\"col-span-5\"\n        isLoading={isLoading}\n        data={report?.browsers}\n        direction=\"horizontal\"\n        individualBarColors\n        hideLegend\n        title={<Trans message=\"Top browsers\" />}\n      />\n    </Fragment>\n  );\n}\n","import {keepPreviousData, useQuery} from '@tanstack/react-query';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient} from '@common/http/query-client';\nimport {VisitorsReportData} from '@common/admin/analytics/visitors-report-data';\nimport {DateRangeValue} from '@ui/forms/input-field/date/date-range-picker/date-range-value';\nimport {ReactElement} from 'react';\nimport {SvgIconProps} from '@ui/icons/svg-icon';\nimport {IconTree} from '@ui/icons/create-svg-icon';\n\nconst Endpoint = 'admin/reports';\n\nexport interface HeaderCardData {\n  icon: IconTree[] | ReactElement<SvgIconProps>;\n  name: string;\n  type?: 'number' | 'fileSize' | 'percentage';\n  currentValue: number;\n  previousValue?: number;\n  percentageChange?: number;\n}\n\ninterface FetchAnalyticsReportResponse extends BackendResponse {\n  visitorsReport: VisitorsReportData;\n  headerReport: HeaderCardData[];\n}\n\ninterface Payload {\n  types?: ('visitors' | 'header')[];\n  dateRange?: DateRangeValue;\n}\nexport function useAdminReport(payload: Payload = {}) {\n  return useQuery({\n    queryKey: [Endpoint, payload],\n    queryFn: () => fetchAnalyticsReport(payload),\n    placeholderData: keepPreviousData,\n  });\n}\n\nfunction fetchAnalyticsReport({\n  types,\n  dateRange,\n}: Payload): Promise<FetchAnalyticsReportResponse> {\n  const params: Record<string, any> = {};\n  if (types) {\n    params.types = types.join(',');\n  }\n  if (dateRange) {\n    params.startDate = dateRange.start.toAbsoluteString();\n    params.endDate = dateRange.end.toAbsoluteString();\n    params.timezone = dateRange.start.timeZone;\n  }\n  return apiClient.get(Endpoint, {params}).then(response => response.data);\n}\n","import {AdminReportCardRow} from '@common/admin/analytics/admin-report-card-row';\nimport {ReportDateSelector} from '@common/admin/analytics/report-date-selector';\nimport {VisitorsReportCharts} from '@common/admin/analytics/visitors-report-charts';\nimport {DatatablePageHeaderBar} from '@common/datatable/page/datatable-page-with-header-layout';\nimport {DateRangeValue} from '@ui/forms/input-field/date/date-range-picker/date-range-value';\nimport {DateRangePresets} from '@ui/forms/input-field/date/date-range-picker/dialog/date-range-presets';\nimport {Trans} from '@ui/i18n/trans';\nimport {useState} from 'react';\nimport {StaticPageTitle} from '../../seo/static-page-title';\nimport {useAdminReport} from './use-admin-report';\n\nexport function Component() {\n  const [dateRange, setDateRange] = useState<DateRangeValue>(() => {\n    // This week\n    return DateRangePresets[2].getRangeValue();\n  });\n  const {isLoading, data} = useAdminReport({dateRange});\n  const title = <Trans message=\"Visitors report\" />;\n\n  return (\n    <div className=\"flex h-full flex-col\">\n      <StaticPageTitle>{title}</StaticPageTitle>\n      <DatatablePageHeaderBar\n        showSidebarToggleButton\n        title={title}\n        rightContent={\n          <ReportDateSelector value={dateRange} onChange={setDateRange} />\n        }\n      />\n      <div className=\"chart-grid flex-auto overflow-auto p-12 md:p-24\">\n        <AdminReportCardRow report={data?.headerReport} />\n        <VisitorsReportCharts\n          report={data?.visitorsReport}\n          isLoading={isLoading}\n        />\n      </div>\n    </div>\n  );\n}\n"],"file":"assets/admin-report-page-DqeU_Uqz.js"}