{"version":3,"file":"select-filter-panel-2MY77qxo.js","sources":["../../../common/foundation/resources/client/tags/form-normalized-model-chip-field.tsx","../../../common/foundation/resources/client/datatable/filters/panels/chip-field-filter-panel.tsx","../../../common/foundation/resources/client/datatable/filters/backend-filter.ts","../../../common/foundation/resources/client/datatable/filters/backend-filters-url-key.ts","../../../common/foundation/resources/client/datatable/filters/utils/decode-backend-filters.ts","../../../common/foundation/resources/client/datatable/filters/utils/encode-backend-filters.ts","../../../common/foundation/resources/client/datatable/filters/backend-filter-url-params.ts","../../../common/foundation/resources/client/ui/library/forms/input-field/date/date-range-picker/date-range-picker.tsx","../../../common/foundation/resources/client/ui/library/forms/input-field/date/date-range-picker/form-date-range-picker.tsx","../../../common/foundation/resources/client/datatable/filters/panels/date-range-filter-panel.tsx","../../../common/foundation/resources/client/datatable/filters/filter-operator-names.ts","../../../common/foundation/resources/client/datatable/filters/panels/input-filter-panel.tsx","../../../common/foundation/resources/client/ui/normalized-model/use-normalized-model.ts","../../../common/foundation/resources/client/ui/normalized-model/normalized-model-field.tsx","../../../common/foundation/resources/client/datatable/filters/panels/normalized-model-filter-panel.tsx","../../../common/foundation/resources/client/datatable/filters/panels/select-filter-panel.tsx"],"sourcesContent":["import {useNormalizedModels} from '@common/ui/normalized-model/use-normalized-models';\nimport {ChipFieldProps} from '@ui/forms/input-field/chip-field/chip-field';\nimport {FormChipField} from '@ui/forms/input-field/chip-field/form-chip-field';\nimport {InputSize} from '@ui/forms/input-field/input-size';\nimport {Item} from '@ui/forms/listbox/item';\nimport {ReactNode, useState} from 'react';\n\ninterface Props {\n  model?: string;\n  endpoint?: string;\n  name: string;\n  className?: string;\n  label?: ReactNode;\n  placeholder?: string;\n  size?: InputSize;\n  allowCustomValue?: boolean;\n  valueKey?: ChipFieldProps<any>['valueKey'];\n}\nexport function FormNormalizedModelChipField({\n  name,\n  label,\n  placeholder,\n  model,\n  endpoint,\n  className,\n  allowCustomValue = false,\n  size,\n  valueKey,\n}: Props) {\n  const [inputValue, setInputValue] = useState('');\n  const {data, isLoading} = useNormalizedModels(\n    endpoint ? endpoint : `normalized-models/${model}`,\n    {\n      query: inputValue,\n    },\n  );\n  return (\n    <FormChipField\n      className={className}\n      name={name}\n      label={label}\n      size={size}\n      valueKey={valueKey}\n      inputValue={inputValue}\n      onInputValueChange={setInputValue}\n      suggestions={data?.results}\n      placeholder={placeholder}\n      isLoading={isLoading}\n      allowCustomValue={allowCustomValue}\n    >\n      {data?.results.map(result => (\n        <Item\n          value={result}\n          key={result.id}\n          startIcon={\n            result.image ? (\n              <img\n                className=\"h-24 w-24 rounded-full object-cover\"\n                src={result.image}\n                alt=\"\"\n              />\n            ) : undefined\n          }\n        >\n          {result.name}\n        </Item>\n      ))}\n    </FormChipField>\n  );\n}\n","import {FilterChipFieldControl} from '@common/datatable/filters/backend-filter';\nimport {FilterPanelProps} from '@common/datatable/filters/panels/filter-panel-props';\nimport {FormNormalizedModelChipField} from '@common/tags/form-normalized-model-chip-field';\nimport {FormChipField} from '@ui/forms/input-field/chip-field/form-chip-field';\nimport {InputSize} from '@ui/forms/input-field/input-size';\nimport {Item} from '@ui/forms/listbox/item';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\n\ntype ChipFieldFilterValueFieldProps =\n  FilterPanelProps<FilterChipFieldControl> & {\n    name: string;\n    size?: InputSize;\n  };\n\nexport function ChipFieldFilterPanel({\n  filter,\n}: FilterPanelProps<FilterChipFieldControl>) {\n  return (\n    <ChipFieldFilterValueField filter={filter} name={`${filter.key}.value`} />\n  );\n}\n\nexport function ChipFieldFilterValueField({\n  filter,\n  name,\n  size = 'sm',\n}: ChipFieldFilterValueFieldProps) {\n  const {trans} = useTrans();\n  if (filter.control.autocompleteEndpoint) {\n    return (\n      <FormNormalizedModelChipField\n        name={name}\n        size={size}\n        placeholder={\n          filter.control.placeholder\n            ? trans(filter.control.placeholder)\n            : undefined\n        }\n        endpoint={filter.control.autocompleteEndpoint}\n      />\n    );\n  }\n  return (\n    <FormChipField\n      size={size}\n      name={name}\n      valueKey=\"id\"\n      allowCustomValue={false}\n      showDropdownArrow\n      isAsync\n      placeholder={\n        filter.control.placeholder\n          ? trans(filter.control.placeholder)\n          : undefined\n      }\n      displayWith={chip => {\n        const o = filter.control.options?.find(o => o.key === chip.id);\n        if (!o) return undefined;\n        return typeof o.label === 'string' ? o.label : o.label.message;\n      }}\n      suggestions={filter.control.options?.map(o => ({\n        id: o.key,\n        name: typeof o.label === 'string' ? o.label : o.label.message,\n      }))}\n    >\n      {chip => (\n        <Item key={chip.id} value={chip.id}>\n          {<Trans message={chip.name} />}\n        </Item>\n      )}\n    </FormChipField>\n  );\n}\n","import {FilterListControlProps} from '@common/datatable/filters/filter-list/filter-list-control';\nimport {DateValue} from '@internationalized/date';\nimport {ChipValue} from '@ui/forms/input-field/chip-field/chip-field';\nimport {AbsoluteDateRange} from '@ui/forms/input-field/date/date-range-picker/form-date-range-picker';\nimport {MessageDescriptor} from '@ui/i18n/message-descriptor';\nimport {NormalizedModel} from '@ui/types/normalized-model';\nimport {ComponentType} from 'react';\n\nexport interface FilterSelectControl {\n  type: FilterControlType.Select;\n  options: {\n    label: MessageDescriptor | string;\n    key: string | number;\n    value: any;\n    image?: string;\n    description?: string;\n  }[];\n  defaultValue?: string | number | boolean;\n  placeholder?: MessageDescriptor;\n  searchPlaceholder?: MessageDescriptor;\n  showSearchField?: boolean;\n  showAvatar?: boolean;\n}\n\nexport interface FilterNumberInputControl {\n  type: FilterControlType.Input;\n  placeholder?: MessageDescriptor;\n  inputType: 'number';\n  minValue?: number;\n  maxValue?: number;\n  defaultValue: number;\n}\n\nexport interface FilterTextInputControl {\n  type: FilterControlType.Input;\n  placeholder?: MessageDescriptor;\n  inputType: 'string';\n  minLength?: number;\n  maxLength?: number;\n  defaultValue: string;\n}\n\nexport interface FilterSelectModelControl {\n  type: FilterControlType.SelectModel;\n  model: string;\n  endpoint?: string;\n  defaultValue?: NormalizedModel;\n}\n\nexport interface FilterChipFieldControl {\n  type: FilterControlType.ChipField;\n  options?: FilterSelectControl['options'];\n  placeholder?: MessageDescriptor;\n  defaultValue: ChipValue[];\n  autocompleteEndpoint?: string;\n}\n\nexport interface FilterBooleanToggleControl {\n  type: FilterControlType.BooleanToggle;\n  // value can be something other than boolean, toggling will either send that value or nothing\n  defaultValue: string | number | boolean | null;\n}\n\nexport interface DatePickerFilterControl {\n  type: FilterControlType.DateRangePicker;\n  defaultValue: AbsoluteDateRange;\n  min?: DateValue;\n  max?: DateValue;\n}\n\nexport interface CustomFilterControl {\n  type: FilterControlType.Custom;\n  panel: ComponentType<{filter: BackendFilter<CustomFilterControl>}>;\n  listItem: ComponentType<FilterListControlProps<number, CustomFilterControl>>;\n  defaultValue?: any;\n}\n\nexport type FilterControl =\n  | FilterSelectControl\n  | FilterNumberInputControl\n  | FilterTextInputControl\n  | FilterSelectModelControl\n  | FilterChipFieldControl\n  | DatePickerFilterControl\n  | FilterBooleanToggleControl\n  | CustomFilterControl;\n\nexport interface BackendFilter<T = FilterControl> {\n  key: string;\n  label: MessageDescriptor;\n  description?: MessageDescriptor | null;\n  control: T;\n  defaultOperator: FilterOperator;\n  operators?: FilterOperator[];\n  extraFilters?: {key: string; operator: FilterOperator; value: any}[];\n}\n\nexport enum FilterControlType {\n  Select = 'select',\n  DateRangePicker = 'dateRangePicker',\n  SelectModel = 'selectModel',\n  Input = 'input',\n  BooleanToggle = 'booleanToggle',\n  ChipField = 'chipField',\n  Custom = 'custom',\n}\n\nexport enum FilterOperator {\n  eq = '=',\n  ne = '!=',\n  gt = '>',\n  gte = '>=',\n  lt = '<',\n  lte = '<=',\n  has = 'has',\n  notNull = 'notNull',\n  contains = 'contains',\n  notContains = 'notContains',\n  startsWith = 'startsWith',\n  endsWith = 'endsWith',\n  hasAll = 'hasAll',\n  doesntHave = 'doesntHave',\n  between = 'between',\n}\n\nexport const ALL_STRING_OPERATORS = [\n  FilterOperator.eq,\n  FilterOperator.ne,\n  FilterOperator.contains,\n  FilterOperator.notContains,\n  FilterOperator.startsWith,\n  FilterOperator.endsWith,\n  FilterOperator.notNull,\n];\n\nexport const ALL_NUMBER_OPERATORS = [\n  FilterOperator.eq,\n  FilterOperator.ne,\n  FilterOperator.gt,\n  FilterOperator.gte,\n  FilterOperator.lt,\n  FilterOperator.lte,\n  FilterOperator.notNull,\n];\n\nexport const ALL_PRIMITIVE_OPERATORS = [\n  FilterOperator.eq,\n  FilterOperator.ne,\n  FilterOperator.gt,\n  FilterOperator.gte,\n  FilterOperator.lt,\n  FilterOperator.lte,\n  FilterOperator.contains,\n  FilterOperator.notContains,\n  FilterOperator.startsWith,\n  FilterOperator.endsWith,\n  FilterOperator.notNull,\n];\n","export const BackendFiltersUrlKey = 'filters' as const;\n","import {FilterListValue} from './encode-backend-filters';\n\nexport function decodeBackendFilters(\n  encodedFilters: string | null\n): FilterListValue[] {\n  if (!encodedFilters) return [];\n  let filtersFromQuery: FilterListValue[] = [];\n  try {\n    filtersFromQuery = JSON.parse(atob(decodeURIComponent(encodedFilters)));\n    filtersFromQuery.map(filterValue => {\n      // set value key as value so selects work properly\n      if (filterValue.valueKey != null) {\n        filterValue.value = filterValue.valueKey;\n      }\n      return filterValue;\n    });\n  } catch (e) {\n    //\n  }\n  return filtersFromQuery;\n}\n","import {BackendFilter} from '../backend-filter';\n\nexport interface FilterListValue {\n  key: string | number;\n  value: BackendFilter['control']['defaultValue'];\n  operator?: BackendFilter['defaultOperator'];\n  valueKey?: string | number;\n  isInactive?: boolean;\n  extraFilters?: {key: string; operator: string; value: any}[];\n}\n\nexport function encodeBackendFilters(\n  filterValues: FilterListValue[] | null,\n  filters?: BackendFilter[],\n): string {\n  if (!filterValues) return '';\n\n  // prepare values for backend\n  filterValues = !filters\n    ? filterValues\n    : filterValues\n        .filter(item => item.value !== '')\n        .map(item => transformValue(item, filters));\n\n  // remove all placeholder filters\n  filterValues = filterValues.filter(fm => !fm.isInactive);\n\n  if (!filterValues.length) {\n    return '';\n  }\n\n  return encodeURIComponent(btoa(JSON.stringify(filterValues)));\n}\n\nfunction transformValue(\n  filterValue: FilterListValue,\n  filters: BackendFilter[],\n) {\n  const filterConfig = filters.find(f => f.key === filterValue.key);\n  // select components will use a key always, because we can't use objects as\n  // value. Map over select options and replace key with actual value\n  if (filterConfig?.control.type === 'select') {\n    const option = (filterConfig.control.options || []).find(\n      o => o.key === filterValue.value,\n    );\n    // if it's language or country select, there might not be an option\n    if (option) {\n      return {...filterValue, value: option.value, valueKey: option.key};\n    }\n  }\n\n  if (filterConfig?.extraFilters?.length) {\n    filterValue['extraFilters'] = filterConfig.extraFilters;\n  }\n\n  return filterValue;\n}\n","import { Key, useCallback, useMemo } from 'react';\nimport { useSearchParams } from 'react-router';\nimport { BackendFilter } from './backend-filter';\nimport { BackendFiltersUrlKey } from './backend-filters-url-key';\nimport { decodeBackendFilters } from './utils/decode-backend-filters';\nimport {\n  FilterListValue,\n  encodeBackendFilters,\n} from './utils/encode-backend-filters';\n\nexport function useBackendFilterUrlParams(\n  filters?: BackendFilter[],\n  pinnedFilters?: string[],\n) {\n  const [searchParams, setSearchParams] = useSearchParams();\n\n  const encodedFilters = searchParams.get(BackendFiltersUrlKey);\n\n  const decodedFilters: FilterListValue[] = useMemo(() => {\n    if (!filters) return [];\n    const decoded = decodeBackendFilters(encodedFilters);\n\n    // if filter is pinned, and it is not applied yet, add a placeholder\n    (pinnedFilters || []).forEach(key => {\n      if (!decoded.find(f => f.key === key)) {\n        const config = filters.find(f => f.key === key)!;\n        decoded.push({\n          key,\n          value: config.control.defaultValue,\n          operator: config.defaultOperator,\n          isInactive: true,\n        });\n      }\n    });\n\n    // preserve original filter order from configuration\n    decoded.sort(\n      (a, b) =>\n        filters.findIndex(f => f.key === a.key) -\n        filters.findIndex(f => f.key === b.key),\n    );\n\n    return decoded;\n  }, [encodedFilters, pinnedFilters, filters]);\n\n  const getDecodedWithoutKeys = useCallback(\n    (values: (FilterListValue | Key)[]) => {\n      const newFilters = [...decodedFilters];\n      values.forEach(value => {\n        const key = typeof value === 'object' ? value.key : value;\n        const index = newFilters.findIndex(f => f.key === key);\n        if (index > -1) {\n          newFilters.splice(index, 1);\n        }\n      });\n      return newFilters;\n    },\n    [decodedFilters],\n  );\n\n  const replaceAll = useCallback(\n    (filterValues: FilterListValue[]) => {\n      const encodedFilters = encodeBackendFilters(filterValues, filters);\n      if (encodedFilters) {\n        setSearchParams(prev => {\n          prev.delete('page');\n          prev.delete('perPage');\n          prev.set(BackendFiltersUrlKey, encodedFilters);\n          return prev;\n        }, {replace: true});\n      } else {\n        searchParams.delete(BackendFiltersUrlKey);\n        setSearchParams(searchParams, {replace: true});\n      }\n    },\n    [filters, searchParams, setSearchParams],\n  );\n\n  const add = useCallback(\n    (filterValues: FilterListValue[]) => {\n      const existing = getDecodedWithoutKeys(filterValues);\n      const decodedFilters = [...existing, ...filterValues];\n      replaceAll(decodedFilters);\n    },\n    [getDecodedWithoutKeys, replaceAll],\n  );\n\n  const remove = useCallback(\n    (key: Key) => replaceAll(getDecodedWithoutKeys([key])),\n    [getDecodedWithoutKeys, replaceAll],\n  );\n\n  return {\n    add,\n    remove,\n    replaceAll,\n    decodedFilters,\n    encodedFilters,\n  };\n}\n","import {ArrowRightAltIcon} from '@ui/icons/material/ArrowRightAlt';\nimport {DateRangeIcon} from '@ui/icons/material/DateRange';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {useIsMobileMediaQuery} from '@ui/utils/hooks/is-mobile-media-query';\nimport {ComponentPropsWithoutRef, Fragment, MouseEvent, useRef} from 'react';\nimport {DatePickerValueProps} from '../date-picker/use-date-picker-state';\nimport {DateSegmentList} from '../segments/date-segment-list';\nimport {DatePickerField, DatePickerFieldProps} from './date-picker-field';\nimport {DateRangeValue} from './date-range-value';\nimport {DateRangeDialog} from './dialog/date-range-dialog';\nimport {useDateRangePickerState} from './use-date-range-picker-state';\n\nexport interface DateRangePickerProps\n  extends DatePickerValueProps<Partial<DateRangeValue>>,\n    Omit<DatePickerFieldProps, 'children'> {}\nexport function DateRangePicker(props: DateRangePickerProps) {\n  const {granularity, closeDialogOnSelection, ...fieldProps} = props;\n  const state = useDateRangePickerState(props);\n  const inputRef = useRef<HTMLDivElement>(null);\n  const isMobile = useIsMobileMediaQuery();\n  const hideCalendarIcon = isMobile && granularity !== 'day';\n\n  const dialog = (\n    <DialogTrigger\n      offset={8}\n      placement=\"bottom-start\"\n      isOpen={state.calendarIsOpen}\n      onOpenChange={state.setCalendarIsOpen}\n      type=\"popover\"\n      triggerRef={inputRef}\n      returnFocusToTrigger={false}\n      moveFocusToDialog={false}\n    >\n      <DateRangeDialog state={state} />\n    </DialogTrigger>\n  );\n\n  const openOnClick: ComponentPropsWithoutRef<'div'> = {\n    onClick: e => {\n      e.stopPropagation();\n      e.preventDefault();\n      if (!isHourSegment(e)) {\n        state.setCalendarIsOpen(true);\n      } else {\n        state.setCalendarIsOpen(false);\n      }\n    },\n  };\n\n  const value = state.selectedValue;\n  const onChange = state.setSelectedValue;\n\n  return (\n    <Fragment>\n      <DatePickerField\n        ref={inputRef}\n        wrapperProps={openOnClick}\n        endAdornment={!hideCalendarIcon ? <DateRangeIcon /> : undefined}\n        {...fieldProps}\n      >\n        <DateSegmentList\n          isPlaceholder={state.isPlaceholder?.start}\n          state={state}\n          segmentProps={openOnClick}\n          value={value.start}\n          onChange={newValue => {\n            onChange({start: newValue, end: value.end});\n          }}\n        />\n        <ArrowRightAltIcon\n          className=\"block flex-shrink-0 text-muted\"\n          size=\"md\"\n        />\n        <DateSegmentList\n          isPlaceholder={state.isPlaceholder?.end}\n          state={state}\n          segmentProps={openOnClick}\n          value={value.end}\n          onChange={newValue => {\n            onChange({start: value.start, end: newValue});\n          }}\n        />\n      </DatePickerField>\n      {dialog}\n    </Fragment>\n  );\n}\n\nfunction isHourSegment(e: MouseEvent<HTMLDivElement>): boolean {\n  return ['hour', 'minute', 'dayPeriod'].includes(\n    (e.currentTarget as HTMLElement).ariaLabel || '',\n  );\n}\n","import {parseAbsoluteToLocal, ZonedDateTime} from '@internationalized/date';\nimport {DateRangeValue} from './date-range-value';\nimport {useController} from 'react-hook-form';\nimport {mergeProps} from '@react-aria/utils';\nimport React from 'react';\nimport {DateRangePicker, DateRangePickerProps} from './date-range-picker';\n\nexport interface AbsoluteDateRange {\n  start?: string;\n  end?: string;\n  preset?: number;\n}\n\ninterface FormDateRange {\n  start?: string | ZonedDateTime;\n  end?: string | ZonedDateTime;\n  preset?: number;\n}\n\nexport interface FormDateRangePickerProps extends DateRangePickerProps {\n  name: string;\n}\nexport function FormDateRangePicker(props: FormDateRangePickerProps) {\n  const {\n    field: {onChange, onBlur, value, ref},\n    fieldState: {invalid, error},\n  } = useController({\n    name: props.name,\n  });\n\n  const formProps: Partial<DateRangePickerProps> = {\n    onChange: e => {\n      onChange(e ? dateRangeToAbsoluteRange(e) : null);\n    },\n    onBlur,\n    value: absoluteRangeToDateRange(value),\n    invalid,\n    errorMessage: error?.message,\n    inputRef: ref,\n  };\n\n  return <DateRangePicker {...mergeProps(formProps, props)} />;\n}\n\nexport function absoluteRangeToDateRange(props: FormDateRange | null) {\n  const {start, end, preset} = props || {};\n  const dateRange: Partial<DateRangeValue> = {preset};\n  try {\n    if (start) {\n      dateRange.start =\n        typeof start === 'string' ? parseAbsoluteToLocal(start) : start;\n    }\n    if (end) {\n      dateRange.end = typeof end === 'string' ? parseAbsoluteToLocal(end) : end;\n    }\n  } catch (e) {\n    // ignore\n  }\n  return dateRange;\n}\n\nexport function dateRangeToAbsoluteRange({\n  start,\n  end,\n  preset,\n}: Partial<DateRangeValue> = {}): AbsoluteDateRange {\n  const absoluteRange: AbsoluteDateRange = {\n    preset,\n  };\n  if (start) {\n    absoluteRange.start = start.toAbsoluteString();\n  }\n  if (end) {\n    absoluteRange.end = end.toAbsoluteString();\n  }\n  return absoluteRange;\n}\n","import {DatePickerFilterControl} from '@common/datatable/filters/backend-filter';\nimport {FilterPanelProps} from '@common/datatable/filters/panels/filter-panel-props';\nimport {FormDateRangePicker} from '@ui/forms/input-field/date/date-range-picker/form-date-range-picker';\nimport {InputSize} from '@ui/forms/input-field/input-size';\n\ntype DateRangeFilterValueFieldProps =\n  FilterPanelProps<DatePickerFilterControl> & {\n    name: string;\n    size?: InputSize;\n  };\n\nexport function DateRangeFilterValueField({\n  filter,\n  name,\n  size = 'sm',\n}: DateRangeFilterValueFieldProps) {\n  return (\n    <FormDateRangePicker\n      min={filter.control.min}\n      max={filter.control.max}\n      size={size}\n      name={name}\n      granularity=\"day\"\n      closeDialogOnSelection={true}\n    />\n  );\n}\n\nexport function DateRangeFilterPanel({\n  filter,\n}: FilterPanelProps<DatePickerFilterControl>) {\n  return (\n    <DateRangeFilterValueField filter={filter} name={`${filter.key}.value`} />\n  );\n}\n","import {message} from '@ui/i18n/message';\nimport {MessageDescriptor} from '@ui/i18n/message-descriptor';\nimport {FilterOperator} from './backend-filter';\n\nexport const FilterOperatorNames: {[op in FilterOperator]: MessageDescriptor} =\n  {\n    '=': message('is'),\n    '!=': message('is not'),\n    '>': message('is greater than'),\n    '>=': message('is greater than or equal to'),\n    '<': message('is less than'),\n    '<=': message('is less than or equal to'),\n    notNull: message('is not empty'),\n    contains: message('contains'),\n    notContains: message('does not contain'),\n    startsWith: message('starts with'),\n    endsWith: message('ends with'),\n    has: message('Include'),\n    doesntHave: message('Do not include'),\n    between: message('Is between'),\n    hasAll: message('Include all'),\n  };\n","import {\n  FilterNumberInputControl,\n  FilterTextInputControl,\n} from '@common/datatable/filters/backend-filter';\nimport {FilterOperatorNames} from '@common/datatable/filters/filter-operator-names';\nimport {FilterPanelProps} from '@common/datatable/filters/panels/filter-panel-props';\nimport {InputSize} from '@ui/forms/input-field/input-size';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Item} from '@ui/forms/listbox/item';\nimport {FormSelect} from '@ui/forms/select/select';\nimport {Trans} from '@ui/i18n/trans';\nimport {Fragment} from 'react';\nimport {useFormContext, useWatch} from 'react-hook-form';\n\ntype InputFilterValueFieldProps = FilterPanelProps<\n  FilterTextInputControl | FilterNumberInputControl\n> & {\n  name: string;\n  size?: InputSize;\n};\n\nexport function InputFilterPanel({\n  filter,\n}: FilterPanelProps<FilterTextInputControl | FilterNumberInputControl>) {\n  const form = useFormContext();\n  const selectedOperator = useWatch({\n    control: form.control,\n    name: `${filter.key}.operator`,\n  });\n  return (\n    <Fragment>\n      {filter.operators?.length ? (\n        <FormSelect\n          selectionMode=\"single\"\n          name={`${filter.key}.operator`}\n          className=\"mb-14\"\n          size=\"sm\"\n        >\n          {filter.operators?.map(operator => (\n            <Item key={operator} value={operator}>\n              {<Trans {...FilterOperatorNames[operator]} />}\n            </Item>\n          ))}\n        </FormSelect>\n      ) : null}\n      {selectedOperator === 'notNull' ? null : (\n        <InputFilterValueField filter={filter} name={`${filter.key}.value`} />\n      )}\n    </Fragment>\n  );\n}\n\nexport function InputFilterValueField({\n  filter,\n  name,\n  size = 'sm',\n}: InputFilterValueFieldProps) {\n  const control = filter.control;\n  return (\n    <FormTextField\n      size={size}\n      name={name}\n      type={filter.control.inputType}\n      min={'minValue' in control ? control.minValue : undefined}\n      max={'maxValue' in control ? control.maxValue : undefined}\n      minLength={'minLength' in control ? control.minLength : undefined}\n      maxLength={'maxLength' in control ? control.maxLength : undefined}\n    />\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {NormalizedModel} from '@ui/types/normalized-model';\nimport {apiClient} from '../../http/query-client';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\n\ninterface Response extends BackendResponse {\n  model: NormalizedModel;\n}\n\nexport function useNormalizedModel(\n  endpoint: string,\n  queryParams?: Record<string, string>,\n  queryOptions?: {enabled?: boolean},\n) {\n  return useQuery({\n    queryKey: [endpoint, queryParams],\n    queryFn: () => fetchModel(endpoint, queryParams),\n    ...queryOptions,\n  });\n}\n\nasync function fetchModel(\n  endpoint: string,\n  params?: Record<string, string>,\n): Promise<Response> {\n  return apiClient.get(endpoint, {params}).then(r => r.data);\n}\n","import {useNormalizedModel} from '@common/ui/normalized-model/use-normalized-model';\nimport {useNormalizedModels} from '@common/ui/normalized-model/use-normalized-models';\nimport {useControlledState} from '@react-stately/utils';\nimport {opacityAnimation} from '@ui/animation/opacity-animation';\nimport {Avatar} from '@ui/avatar/avatar';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {BaseFieldProps} from '@ui/forms/input-field/base-field-props';\nimport {getInputFieldClassNames} from '@ui/forms/input-field/get-input-field-class-names';\nimport {InputSize} from '@ui/forms/input-field/input-size';\nimport {Item} from '@ui/forms/listbox/item';\nimport {Select} from '@ui/forms/select/select';\nimport {message} from '@ui/i18n/message';\nimport {MessageDescriptor} from '@ui/i18n/message-descriptor';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {EditIcon} from '@ui/icons/material/Edit';\nimport {Skeleton} from '@ui/skeleton/skeleton';\nimport {Tooltip} from '@ui/tooltip/tooltip';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {ReactNode, useRef, useState} from 'react';\nimport {useController, useFormContext} from 'react-hook-form';\n\ninterface NormalizedModelFieldProps {\n  label?: ReactNode;\n  className?: string;\n  background?: BaseFieldProps['background'];\n  value?: string | number;\n  placeholder?: MessageDescriptor;\n  searchPlaceholder?: MessageDescriptor;\n  defaultValue?: string | number;\n  onChange?: (value: string | number) => void;\n  invalid?: boolean;\n  errorMessage?: string;\n  description?: ReactNode;\n  autoFocus?: boolean;\n  queryParams?: Record<string, string>;\n  endpoint: string;\n  disabled?: boolean;\n  required?: boolean;\n  size?: InputSize;\n}\nexport function NormalizedModelField({\n  label,\n  className,\n  background,\n  value,\n  defaultValue = '',\n  placeholder = message('Select item...'),\n  searchPlaceholder = message('Find an item...'),\n  onChange,\n  description,\n  errorMessage,\n  invalid,\n  autoFocus,\n  queryParams,\n  endpoint,\n  disabled,\n  required,\n  size,\n}: NormalizedModelFieldProps) {\n  const inputRef = useRef<HTMLButtonElement>(null);\n  const [inputValue, setInputValue] = useState('');\n  const [selectedValue, setSelectedValue] = useControlledState(\n    value,\n    defaultValue,\n    onChange,\n  );\n  const query = useNormalizedModels(endpoint, {\n    query: inputValue,\n    ...queryParams,\n  });\n  const {trans} = useTrans();\n\n  const fieldClassNames = getInputFieldClassNames({size, background});\n\n  if (selectedValue) {\n    return (\n      <div className={className}>\n        {label && <div className={fieldClassNames.label}>{label}</div>}\n        <div\n          className={clsx(fieldClassNames.input, invalid && 'border-danger')}\n        >\n          <AnimatePresence initial={false} mode=\"wait\">\n            <SelectedModelPreview\n              disabled={disabled}\n              endpoint={endpoint}\n              className={fieldClassNames.input}\n              modelId={selectedValue}\n              queryParams={queryParams}\n              onEditClick={() => {\n                setSelectedValue('');\n                setInputValue('');\n                requestAnimationFrame(() => {\n                  inputRef.current?.focus();\n                  inputRef.current?.click();\n                });\n              }}\n            />\n          </AnimatePresence>\n        </div>\n        {description && !errorMessage && (\n          <div className={fieldClassNames.description}>{description}</div>\n        )}\n        {errorMessage && (\n          <div className={fieldClassNames.error}>{errorMessage}</div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <Select\n      className={className}\n      showSearchField\n      invalid={invalid}\n      errorMessage={errorMessage}\n      description={description}\n      color=\"white\"\n      isAsync\n      background={background}\n      placeholder={trans(placeholder)}\n      searchPlaceholder={trans(searchPlaceholder)}\n      label={label}\n      isLoading={query.isFetching}\n      items={query.data?.results}\n      inputValue={inputValue}\n      onInputValueChange={setInputValue}\n      selectionMode=\"single\"\n      selectedValue={selectedValue}\n      onSelectionChange={setSelectedValue}\n      ref={inputRef}\n      autoFocus={autoFocus}\n      disabled={disabled}\n      required={required}\n    >\n      {model => (\n        <Item\n          value={model.id}\n          key={model.id}\n          description={model.description}\n          startIcon={<Avatar src={model.image} size=\"sm\" label={model.name} />}\n        >\n          {model.name}\n        </Item>\n      )}\n    </Select>\n  );\n}\n\ninterface SelectedModelPreviewProps {\n  modelId: string | number;\n  onEditClick?: () => void;\n  endpoint?: string;\n  disabled?: boolean;\n  queryParams?: NormalizedModelFieldProps['queryParams'];\n  className?: string;\n}\nfunction SelectedModelPreview({\n  modelId,\n  onEditClick,\n  endpoint,\n  disabled,\n  queryParams,\n}: SelectedModelPreviewProps) {\n  const {data, isLoading} = useNormalizedModel(\n    `${endpoint}/${modelId}`,\n    queryParams,\n  );\n\n  if (isLoading || !data?.model) {\n    return <LoadingSkeleton key=\"skeleton\" />;\n  }\n\n  return (\n    <m.div\n      className={clsx(\n        'flex h-full items-center gap-8',\n        disabled && 'pointer-events-none cursor-not-allowed text-disabled',\n      )}\n      key=\"preview\"\n      {...opacityAnimation}\n    >\n      <Avatar src={data.model.image} label={data.model.name} size=\"sm\" />\n      <div>\n        <Tooltip label={data.model.description ?? data.model.name ?? ''}>\n          <div className=\"text-sm leading-4\">{data.model.name}</div>\n        </Tooltip>\n      </div>\n      <Tooltip label={<Trans message=\"Change item\" />}>\n        <IconButton\n          className=\"ml-auto text-muted\"\n          size=\"sm\"\n          onClick={onEditClick}\n          disabled={disabled}\n        >\n          <EditIcon />\n        </IconButton>\n      </Tooltip>\n    </m.div>\n  );\n}\n\nfunction LoadingSkeleton() {\n  return (\n    <m.div className=\"flex h-full items-center gap-8\" {...opacityAnimation}>\n      <Skeleton variant=\"rect\" size=\"w-24 h-24 flex-shrink-0\" />\n      <Skeleton className=\"max-w-100 text-xs\" />\n      <Skeleton variant=\"icon\" size=\"w-24 h-24\" className=\"ml-auto\" />\n    </m.div>\n  );\n}\n\ninterface FormNormalizedModelFieldProps extends NormalizedModelFieldProps {\n  name: string;\n  size?: InputSize;\n}\nexport function FormNormalizedModelField({\n  name,\n  size,\n  ...fieldProps\n}: FormNormalizedModelFieldProps) {\n  const {clearErrors} = useFormContext();\n  const {\n    field: {onChange, value = ''},\n    fieldState: {invalid, error},\n  } = useController({\n    name,\n  });\n\n  return (\n    <NormalizedModelField\n      size={size}\n      value={value}\n      onChange={value => {\n        onChange(value);\n        clearErrors(name);\n      }}\n      invalid={invalid}\n      errorMessage={error?.message}\n      {...fieldProps}\n    />\n  );\n}\n","import {FilterSelectModelControl} from '@common/datatable/filters/backend-filter';\nimport {FormNormalizedModelField} from '@common/ui/normalized-model/normalized-model-field';\nimport {InputSize} from '@ui/forms/input-field/input-size';\nimport {FilterPanelProps} from './filter-panel-props';\n\ntype NormalizedModelFilterValueFieldProps =\n  FilterPanelProps<FilterSelectModelControl> & {\n    name: string;\n    size?: InputSize;\n  };\n\nexport function NormalizedModelFilterPanel({\n  filter,\n}: FilterPanelProps<FilterSelectModelControl>) {\n  return (\n    <NormalizedModelFilterValueField\n      filter={filter}\n      name={`${filter.key}.value`}\n    />\n  );\n}\n\nexport function NormalizedModelFilterValueField({\n  filter,\n  name,\n  size = 'sm',\n}: NormalizedModelFilterValueFieldProps) {\n  return (\n    <FormNormalizedModelField\n      name={name}\n      size={size}\n      endpoint={\n        filter.control.endpoint\n          ? filter.control.endpoint\n          : `normalized-models/${filter.control.model}`\n      }\n    />\n  );\n}\n","import {FilterSelectControl} from '@common/datatable/filters/backend-filter';\nimport {FilterPanelProps} from '@common/datatable/filters/panels/filter-panel-props';\nimport {Avatar} from '@ui/avatar/avatar';\nimport {InputSize} from '@ui/forms/input-field/input-size';\nimport {Item} from '@ui/forms/listbox/item';\nimport {FormSelect} from '@ui/forms/select/select';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\n\nexport function SelectFilterPanel({\n  filter,\n}: FilterPanelProps<FilterSelectControl>) {\n  return (\n    <SelectFilterValueField filter={filter} name={`${filter.key}.value`} />\n  );\n}\n\ntype SelectFiterValueField = FilterPanelProps<FilterSelectControl> & {\n  name: string;\n  size?: InputSize;\n};\nexport function SelectFilterValueField({\n  filter,\n  name,\n  size = 'sm',\n}: SelectFiterValueField) {\n  const {trans} = useTrans();\n  return (\n    <FormSelect\n      size={size}\n      name={name}\n      selectionMode=\"single\"\n      showSearchField={filter.control.showSearchField}\n      placeholder={\n        filter.control.placeholder\n          ? trans(filter.control.placeholder)\n          : undefined\n      }\n      searchPlaceholder={\n        filter.control.searchPlaceholder\n          ? trans(filter.control.searchPlaceholder)\n          : undefined\n      }\n    >\n      {filter.control.options.map(option => (\n        <Item\n          key={option.key}\n          value={option.key}\n          startIcon={\n            filter.control.showAvatar ? (\n              <Avatar\n                size=\"sm\"\n                src={option.image}\n                label={\n                  typeof option.label === 'object'\n                    ? option.label.message\n                    : option.label\n                }\n              />\n            ) : null\n          }\n        >\n          {typeof option.label === 'string' ? (\n            option.label\n          ) : (\n            <Trans {...option.label} />\n          )}\n        </Item>\n      ))}\n    </FormSelect>\n  );\n}\n"],"names":["FormNormalizedModelChipField","name","label","placeholder","model","endpoint","className","allowCustomValue","size","valueKey","inputValue","setInputValue","useState","data","isLoading","useNormalizedModels","jsx","FormChipField","result","Item","ChipFieldFilterPanel","filter","ChipFieldFilterValueField","trans","useTrans","chip","o","_a","Trans","FilterControlType","FilterOperator","BackendFiltersUrlKey","decodeBackendFilters","encodedFilters","filtersFromQuery","filterValue","encodeBackendFilters","filterValues","filters","item","transformValue","fm","filterConfig","f","option","useBackendFilterUrlParams","pinnedFilters","searchParams","setSearchParams","useSearchParams","decodedFilters","useMemo","decoded","key","config","a","b","getDecodedWithoutKeys","useCallback","values","newFilters","value","index","replaceAll","prev","add","remove","DateRangePicker","props","granularity","closeDialogOnSelection","fieldProps","state","useDateRangePickerState","inputRef","useRef","hideCalendarIcon","useIsMobileMediaQuery","dialog","DialogTrigger","DateRangeDialog","openOnClick","e","isHourSegment","onChange","Fragment","jsxs","DatePickerField","DateRangeIcon","DateSegmentList","newValue","ArrowRightAltIcon","_b","FormDateRangePicker","onBlur","ref","invalid","error","useController","formProps","dateRangeToAbsoluteRange","absoluteRangeToDateRange","mergeProps","start","end","preset","dateRange","parseAbsoluteToLocal","absoluteRange","DateRangeFilterValueField","DateRangeFilterPanel","FilterOperatorNames","message","InputFilterPanel","form","useFormContext","selectedOperator","useWatch","FormSelect","operator","InputFilterValueField","control","FormTextField","useNormalizedModel","queryParams","queryOptions","useQuery","fetchModel","params","apiClient","r","NormalizedModelField","background","defaultValue","searchPlaceholder","description","errorMessage","autoFocus","disabled","required","selectedValue","setSelectedValue","useControlledState","query","fieldClassNames","getInputFieldClassNames","clsx","AnimatePresence","SelectedModelPreview","Select","Avatar","modelId","onEditClick","LoadingSkeleton","m","opacityAnimation","Tooltip","IconButton","EditIcon","Skeleton","FormNormalizedModelField","clearErrors","NormalizedModelFilterPanel","NormalizedModelFilterValueField","SelectFilterPanel","SelectFilterValueField"],"mappings":"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"}