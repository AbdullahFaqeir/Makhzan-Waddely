{"version":3,"file":"confirm-plan-cancellation-page-Ouy662Z1.js","sources":["../../../common/foundation/resources/client/billing/billing-page/confirm-plan-cancellation-page.tsx"],"sourcesContent":["import {billingQueries} from '@common/billing/billing-queries';\nimport {useQuery} from '@tanstack/react-query';\nimport {Breadcrumb} from '@ui/breadcrumbs/breadcrumb';\nimport {BreadcrumbItem} from '@ui/breadcrumbs/breadcrumb-item';\nimport {Button} from '@ui/buttons/button';\nimport {FormattedDate} from '@ui/i18n/formatted-date';\nimport {Trans} from '@ui/i18n/trans';\nimport {Fragment} from 'react';\nimport {Link} from 'react-router';\nimport {useNavigate} from '../../ui/navigation/use-navigate';\nimport {FormattedPrice} from '../formatted-price';\nimport {BillingPlanPanel} from './billing-plan-panel';\nimport {useCancelSubscription} from './requests/use-cancel-subscription';\nimport {invalidateBillingUserQuery, useBillingUser} from './use-billing-user';\n\nconst previousUrl = '/billing';\n\nexport function Component() {\n  const navigate = useNavigate();\n  const query = useQuery(billingQueries.products.index());\n  const {subscription} = useBillingUser();\n  const cancelSubscription = useCancelSubscription();\n\n  const product = subscription?.product;\n  const price = subscription?.price;\n\n  if (!query.data) {\n    return null;\n  }\n\n  if (!subscription || !product || !price) {\n    navigate(previousUrl);\n    return null;\n  }\n\n  const renewDate = (\n    <span className=\"whitespace-nowrap\">\n      <FormattedDate date={subscription.renews_at} preset=\"long\" />\n    </span>\n  );\n\n  const handleSubscriptionCancel = () => {\n    cancelSubscription.mutate(\n      {\n        subscriptionId: subscription.id,\n      },\n      {\n        onSuccess: () => {\n          invalidateBillingUserQuery();\n          navigate('/billing');\n        },\n      },\n    );\n  };\n\n  return (\n    <Fragment>\n      <Breadcrumb>\n        <BreadcrumbItem isLink onSelected={() => navigate(previousUrl)}>\n          <Trans message=\"Billing\" />\n        </BreadcrumbItem>\n        <BreadcrumbItem>\n          <Trans message=\"Cancel\" />\n        </BreadcrumbItem>\n      </Breadcrumb>\n      <h1 className=\"my-32 text-3xl font-bold md:my-64\">\n        <Trans message=\"Cancel your plan\" />\n      </h1>\n      <BillingPlanPanel title={<Trans message=\"Current plan\" />}>\n        <div className=\"max-w-[464px]\">\n          <div className=\"text-xl font-bold\">{product.name}</div>\n          <FormattedPrice price={price} className=\"text-lg\" />\n          <div className=\"mb-48 mt-12 border-b pb-24 text-base\">\n            <Trans\n              message=\"Your plan will be canceled, but is still available until the end of your billing period on :date\"\n              values={{date: renewDate}}\n            />\n            <div className=\"mt-20\">\n              <Trans message=\"If you change your mind, you can renew your subscription.\" />\n            </div>\n          </div>\n          <div>\n            <div>\n              <Button\n                variant=\"flat\"\n                color=\"primary\"\n                size=\"md\"\n                className=\"mb-16 w-full\"\n                onClick={handleSubscriptionCancel}\n                disabled={cancelSubscription.isPending}\n              >\n                <Trans message=\"Cancel plan\" />\n              </Button>\n            </div>\n            <div>\n              <Button\n                variant=\"outline\"\n                className=\"w-full\"\n                to={previousUrl}\n                elementType={Link}\n              >\n                <Trans message=\"Go back\" />\n              </Button>\n            </div>\n            <div className=\"mt-12 text-xs text-muted\">\n              <Trans message=\"By cancelling your plan, you agree to our terms of service and privacy policy.\" />\n            </div>\n          </div>\n        </div>\n      </BillingPlanPanel>\n    </Fragment>\n  );\n}\n"],"names":["previousUrl","Component","navigate","useNavigate","query","useQuery","billingQueries","subscription","useBillingUser","cancelSubscription","useCancelSubscription","product","price","renewDate","jsx","FormattedDate","handleSubscriptionCancel","invalidateBillingUserQuery","Fragment","jsxs","Breadcrumb","BreadcrumbItem","Trans","BillingPlanPanel","FormattedPrice","Button","Link"],"mappings":"glBAeA,MAAMA,EAAc,WAEb,SAASC,GAAY,CAC1B,MAAMC,EAAWC,EAAA,EACXC,EAAQC,EAASC,EAAe,SAAS,OAAO,EAChD,CAAC,aAAAC,CAAA,EAAgBC,EAAA,EACjBC,EAAqBC,EAAA,EAErBC,EAAUJ,GAAA,YAAAA,EAAc,QACxBK,EAAQL,GAAA,YAAAA,EAAc,MAE5B,GAAI,CAACH,EAAM,KACT,OAAO,KAGT,GAAI,CAACG,GAAgB,CAACI,GAAW,CAACC,EAChC,OAAAV,EAASF,CAAW,EACb,KAGT,MAAMa,EACJC,EAAAA,IAAC,OAAA,CAAK,UAAU,oBACd,SAAAA,EAAAA,IAACC,EAAA,CAAc,KAAMR,EAAa,UAAW,OAAO,MAAA,CAAO,EAC7D,EAGIS,EAA2B,IAAM,CACrCP,EAAmB,OACjB,CACE,eAAgBF,EAAa,EAAA,EAE/B,CACE,UAAW,IAAM,CACfU,EAAA,EACAf,EAAS,UAAU,CACrB,CAAA,CACF,CAEJ,EAEA,cACGgB,WAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAN,EAAAA,IAACO,EAAA,CAAe,OAAM,GAAC,WAAY,IAAMnB,EAASF,CAAW,EAC3D,SAAAc,EAAAA,IAACQ,EAAA,CAAM,QAAQ,SAAA,CAAU,EAC3B,QACCD,EAAA,CACC,SAAAP,EAAAA,IAACQ,EAAA,CAAM,QAAQ,SAAS,CAAA,CAC1B,CAAA,EACF,EACAR,EAAAA,IAAC,MAAG,UAAU,oCACZ,eAACQ,EAAA,CAAM,QAAQ,mBAAmB,CAAA,CACpC,EACAR,EAAAA,IAACS,EAAA,CAAiB,MAAOT,EAAAA,IAACQ,EAAA,CAAM,QAAQ,cAAA,CAAe,EACrD,SAAAH,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACb,SAAA,CAAAL,EAAAA,IAAC,MAAA,CAAI,UAAU,oBAAqB,SAAAH,EAAQ,KAAK,EACjDG,EAAAA,IAACU,EAAA,CAAe,MAAAZ,EAAc,UAAU,SAAA,CAAU,EAClDO,EAAAA,KAAC,MAAA,CAAI,UAAU,uCACb,SAAA,CAAAL,EAAAA,IAACQ,EAAA,CACC,QAAQ,mGACR,OAAQ,CAAC,KAAMT,CAAA,CAAS,CAAA,EAE1BC,EAAAA,IAAC,OAAI,UAAU,QACb,eAACQ,EAAA,CAAM,QAAQ,4DAA4D,CAAA,CAC7E,CAAA,EACF,SACC,MAAA,CACC,SAAA,CAAAR,MAAC,MAAA,CACC,SAAAA,EAAAA,IAACW,EAAA,CACC,QAAQ,OACR,MAAM,UACN,KAAK,KACL,UAAU,eACV,QAAST,EACT,SAAUP,EAAmB,UAE7B,SAAAK,EAAAA,IAACQ,EAAA,CAAM,QAAQ,aAAA,CAAc,CAAA,CAAA,EAEjC,QACC,MAAA,CACC,SAAAR,EAAAA,IAACW,EAAA,CACC,QAAQ,UACR,UAAU,SACV,GAAIzB,EACJ,YAAa0B,EAEb,SAAAZ,EAAAA,IAACQ,EAAA,CAAM,QAAQ,SAAA,CAAU,CAAA,CAAA,EAE7B,EACAR,EAAAA,IAAC,OAAI,UAAU,2BACb,eAACQ,EAAA,CAAM,QAAQ,iFAAiF,CAAA,CAClG,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,CAEJ"}