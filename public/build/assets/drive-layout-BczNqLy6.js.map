{"version":3,"file":"drive-layout-BczNqLy6.js","sources":["../../../resources/client/drive/details-sidebar/details-sidebar-header.tsx","../../../resources/client/drive/details-sidebar/details-sidebar-section-header.tsx","../../../common/foundation/resources/client/tags/use-taggable-tags.ts","../../../common/foundation/resources/client/tags/use-detach-tag-from-taggables.ts","../../../common/foundation/resources/client/tags/use-attach-tag-to-taggables.ts","../../../common/foundation/resources/client/tags/use-tags.ts","../../../common/foundation/resources/client/tags/manage-tags-dialog.tsx","../../../resources/client/drive/details-sidebar/details-sidebar-tags.tsx","../../../resources/client/drive/files/queries/use-folders.ts","../../../resources/client/drive/files/queries/use-active-page-entries.ts","../../../resources/client/drive/files/use-selected-entries.ts","../../../resources/client/drive/details-sidebar/details-sidebar-properties.tsx","../../../resources/client/drive/details-sidebar/detailed-examination.svg","../../../resources/client/drive/details-sidebar/details-sidebar.tsx","../../../resources/client/drive/entry-actions/entry-action-list.tsx","../../../resources/client/drive/layout/sidebar/folder-tree-drag-id.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/use-drag-monitor.ts","../../../resources/client/drive/file-view/entry-drag-preview.tsx","../../../resources/client/drive/drop-target-mask.tsx","../../../resources/client/drive/files/queries/use-move-entries.ts","../../../resources/client/drive/files/utils/can-move-entries-into.ts","../../../resources/client/drive/files/use-folder-drop-action.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/mouse-selection/use-mouse-selectable.ts","../../../common/foundation/resources/client/ui/library/utils/hooks/is-touch-device.ts","../../../resources/client/drive/file-view/use-file-view-dnd.ts","../../../resources/client/drive/file-view/use-view-item-action-handler.ts","../../../resources/client/drive/file-view/file-grid/file-grid-item.tsx","../../../resources/client/drive/file-view/file-grid/file-grid.tsx","../../../resources/client/drive/file-view/file-table/file-table-row.tsx","../../../resources/client/drive/file-view/file-table/file-table.tsx","../../../resources/client/drive/files/drive-context-menu.tsx","../../../resources/client/drive/layout/sorting/drive-sort-button.tsx","../../../resources/client/drive/page-breadcrumbs.tsx","../../../resources/client/drive/search/drive-search-filters.ts","../../../resources/client/drive/search/search-filter-list.tsx","../../../common/foundation/resources/client/ui/infinite-scroll/infinite-scroll-sentinel.tsx","../../../common/foundation/resources/client/ui/library/interactions/utils/rects-intersect.ts","../../../common/foundation/resources/client/ui/library/interactions/utils/restrict-resizable-within-boundary.ts","../../../common/foundation/resources/client/ui/library/interactions/dnd/mouse-selection/use-mouse-selection-box.ts","../../../resources/client/drive/file-view/file-view.tsx","../../../resources/client/drive/shareable-link/queries/use-entry-shareable-link.ts","../../../resources/client/drive/shareable-link/queries/use-update-shareable-link.ts","../../../resources/client/drive/share-dialog/link-panel/link-settings-dialog.tsx","../../../resources/client/drive/shareable-link/queries/use-delete-shareable-link.ts","../../../common/foundation/resources/client/ui/library/utils/string/random-string.ts","../../../resources/client/drive/share-dialog/link-panel/shareable-link-panel.tsx","../../../common/foundation/resources/client/ui/library/utils/string/is-email.ts","../../../resources/client/drive/files/drive-entry.ts","../../../resources/client/drive/share-dialog/permission-selector.tsx","../../../resources/client/drive/share-dialog/queries/use-change-permission.ts","../../../resources/client/drive/share-dialog/member-list.tsx","../../../resources/client/drive/share-dialog/queries/use-share-entry.ts","../../../resources/client/drive/share-dialog/share-panel.tsx","../../../resources/client/drive/share-dialog/share-dialog.tsx","../../../resources/client/drive/files/dialogs/block-trash-folder-view-dialog.tsx","../../../resources/client/drive/files/dialogs/delete-entries-forever-dialog.tsx","../../../resources/client/drive/files/dialogs/entry-preview-dialog.tsx","../../../resources/client/drive/files/queries/create-folder.ts","../../../resources/client/drive/files/dialogs/new-folder-dialog.tsx","../../../resources/client/drive/files/dialogs/move-entries-dialog/use-move-entries-dialog-folder-search.ts","../../../resources/client/drive/files/dialogs/move-entries-dialog/move-entries-dialog-search.tsx","../../../resources/client/drive/files/dialogs/move-entries-dialog/move-entries-dialog-breadcrumbs.tsx","../../../resources/client/drive/files/dialogs/move-entries-dialog/my-files.svg","../../../resources/client/drive/files/dialogs/move-entries-dialog/use-move-entries-dialog-folders.ts","../../../resources/client/drive/files/dialogs/move-entries-dialog/move-entries-dialog-folder-list.tsx","../../../resources/client/drive/files/dialogs/move-entries-dialog/move-entries-dialog.tsx","../../../resources/client/drive/files/queries/use-rename-entry.ts","../../../resources/client/drive/files/dialogs/rename-entry-dialog.tsx","../../../resources/client/drive/files/dialogs/drive-dialogs-container.tsx","../../../resources/client/drive/search/navbar-search.tsx","../../../common/foundation/resources/client/uploads/uploader/ui/upload-queue-item.tsx","../../../resources/client/drive/uploading/upload-queue.tsx","../../../resources/client/drive/layout/create-new-button.tsx","../../../common/foundation/resources/client/ui/library/buttons/button-group.tsx","../../../common/foundation/resources/client/ui/library/icons/lucide/layout-grid.tsx","../../../common/foundation/resources/client/ui/library/icons/lucide/layout-list.tsx","../../../resources/client/drive/layout/drive-content-header.tsx","../../../common/foundation/resources/client/billing/upgrade/policy-fail-message.tsx","../../../common/foundation/resources/client/workspace/leave-workspace-confirmation.tsx","../../../common/foundation/resources/client/workspace/requests/create-workspace.ts","../../../common/foundation/resources/client/workspace/new-workspace-dialog.tsx","../../../common/foundation/resources/client/workspace/requests/update-workspace.ts","../../../common/foundation/resources/client/workspace/rename-workspace-dialog.tsx","../../../common/foundation/resources/client/workspace/requests/delete-workspace.ts","../../../common/foundation/resources/client/workspace/requests/remove-member.ts","../../../common/foundation/resources/client/workspace/requests/change-role.ts","../../../common/foundation/resources/client/workspace/requests/invite-members.ts","../../../common/foundation/resources/client/workspace/requests/resend-invite.ts","../../../common/foundation/resources/client/workspace/requests/workspace-with-members.ts","../../../common/foundation/resources/client/workspace/workspace-members-dialog.tsx","../../../common/foundation/resources/client/workspace/workspace-selector.tsx","../../../resources/client/drive/layout/sidebar/drive-sidebar-icons.ts","../../../node_modules/performant-array-to-tree/build/arrayToTree.min.js","../../../resources/client/drive/layout/sidebar/use-sidebar-tree-drop-target.ts","../../../common/foundation/resources/client/ui/library/tree/tree-context.tsx","../../../common/foundation/resources/client/ui/library/tree/render-tree.ts","../../../common/foundation/resources/client/ui/library/tree/tree.tsx","../../../common/foundation/resources/client/ui/library/tree/tree-label.tsx","../../../common/foundation/resources/client/ui/library/tree/tree-item.tsx","../../../resources/client/drive/layout/sidebar/folder-tree.tsx","../../../resources/client/drive/menu-positions.ts","../../../resources/client/drive/layout/sidebar/sidebar-menu.tsx","../../../common/foundation/resources/client/ui/library/progress/meter.tsx","../../../resources/client/drive/layout/sidebar/storage-summary/storage-meter.tsx","../../../resources/client/drive/layout/sidebar/sidebar.tsx","../../../resources/client/drive/layout/drive-layout.tsx"],"sourcesContent":["import {DashboardLayoutContext} from '@common/ui/dashboard-layout/dashboard-layout-context';\nimport {FileTypeIcon} from '@common/uploads/components/file-type-icon/file-type-icon';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport {ReactNode, useContext} from 'react';\n\ninterface HeaderProps {\n  entryType: string;\n  entryName: ReactNode;\n}\nexport function DetailsSidebarHeader({entryType, entryName}: HeaderProps) {\n  const {setRightSidenavStatus} = useContext(DashboardLayoutContext);\n  return (\n    <div className=\"mb-38 flex gap-16\">\n      <FileTypeIcon className=\"h-24 w-24\" type={entryType} />\n      <div className=\"mr-auto min-w-0 flex-auto break-words text-base font-medium leading-6 text-main\">\n        {entryName}\n      </div>\n      <IconButton\n        size=\"sm\"\n        iconSize=\"md\"\n        className=\"-mt-6 ml-auto flex-shrink-0\"\n        onClick={() => {\n          setRightSidenavStatus('closed');\n        }}\n      >\n        <CloseIcon />\n      </IconButton>\n    </div>\n  );\n}\n","import clsx from 'clsx';\nimport {ReactNode} from 'react';\n\ninterface Props {\n  children: ReactNode;\n  margin?: string;\n  className?: string;\n}\nexport function DetailsSidebarSectionHeader({\n  children,\n  margin = 'mb-20',\n}: Props) {\n  return (\n    <div className={clsx('text-base font-medium text-main', margin)}>\n      {children}\n    </div>\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {Tag} from '@common/tags/tag';\n\ninterface Response extends BackendResponse {\n  tags: Tag[];\n}\n\ninterface Params {\n  taggableType: string;\n  taggableId: string | number;\n  initialData?: Tag[];\n  notType?: string;\n  type?: string;\n}\n\nexport function useTaggableTags(params: Params) {\n  return useQuery<Response>({\n    queryKey: getQueryKey(params),\n    queryFn: () => fetchTaggableTags(params),\n    initialData: params.initialData ? {tags: params.initialData} : undefined,\n  });\n}\n\nfunction getQueryKey(params: Params) {\n  const {taggableType, taggableId, type, notType} = params;\n  const key = ['tags', 'taggable', taggableType, `${taggableId}`];\n  if (type != null) {\n    key.push(type);\n  }\n  if (notType != null) {\n    key.push(notType);\n  }\n  return key;\n}\n\nexport function invalidateTaggableTagsQuery({\n  taggableType,\n  taggableIds,\n}: {\n  taggableType: string;\n  taggableIds: (string | number)[];\n}) {\n  return Promise.allSettled(\n    taggableIds.map(taggableId =>\n      queryClient.invalidateQueries({\n        queryKey: getQueryKey({taggableType, taggableId}),\n      }),\n    ),\n  );\n}\n\nasync function fetchTaggableTags({\n  taggableType,\n  taggableId,\n  notType,\n  type,\n}: Params) {\n  return apiClient\n    .get<Response>(`taggable/${taggableType}/${taggableId}/list-tags`, {\n      params: {\n        notType,\n        type,\n      },\n    })\n    .then(response => response.data);\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {invalidateTaggableTagsQuery} from '@common/tags/use-taggable-tags';\n\ninterface Payload {\n  tagId: number;\n  taggableIds: (number | string)[];\n  taggableType: string;\n}\n\nexport function useDetachTagFromTaggables() {\n  return useMutation({\n    mutationFn: (payload: Payload) => detachTag(payload),\n    onSuccess: (_, payload) => {\n      invalidateTaggableTagsQuery(payload);\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n\nfunction detachTag(payload: Payload): Promise<BackendResponse> {\n  return apiClient.post(`taggable/detach-tag`, payload).then(r => r.data);\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {apiClient} from '@common/http/query-client';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {Tag} from '@common/tags/tag';\nimport {invalidateTaggableTagsQuery} from '@common/tags/use-taggable-tags';\n\ninterface Response extends BackendResponse {\n  tag: Tag;\n}\n\ninterface Payload {\n  tagName: string;\n  tagType?: string;\n  taggableIds: number[];\n  taggableType: string;\n  userId?: number;\n}\n\nexport function useAttachTagToTaggables() {\n  return useMutation({\n    mutationFn: (payload: Payload) => attachTag(payload),\n    onSuccess: async (_, payload) => {\n      invalidateTaggableTagsQuery(payload);\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n\nfunction attachTag(payload: Payload): Promise<Response> {\n  return apiClient.post(`taggable/attach-tag`, payload).then(r => r.data);\n}\n","import {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {PaginationResponse} from '@common/http/backend-response/pagination-response';\nimport {apiClient} from '@common/http/query-client';\nimport {keepPreviousData, useQuery} from '@tanstack/react-query';\n\ninterface Response extends BackendResponse {\n  pagination: PaginationResponse<{id: number; name: string}>;\n}\n\ninterface Params {\n  type?: string;\n  notType?: string;\n  perPage?: number;\n  query?: string;\n  userId?: number;\n}\n\nexport function useTags(params: Params) {\n  return useQuery({\n    queryKey: ['tags', params],\n    queryFn: ({signal}) => fetchTags(params, signal),\n    placeholderData: keepPreviousData,\n  });\n}\n\nasync function fetchTags(params: Params, signal?: AbortSignal) {\n  if (params.query) {\n    await new Promise(resolve => setTimeout(resolve, 300));\n  }\n  return apiClient\n    .get<Response>(`tags`, {\n      params: {paginate: 'simple', ...params},\n      signal: params.query ? signal : undefined,\n    })\n    .then(response => response.data);\n}\n","import {useAttachTagToTaggables} from '@common/tags/use-attach-tag-to-taggables';\nimport {useDetachTagFromTaggables} from '@common/tags/use-detach-tag-from-taggables';\nimport {useTags} from '@common/tags/use-tags';\nimport {TextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {CheckIcon} from '@ui/icons/material/Check';\nimport {PushPinIcon} from '@ui/icons/material/PushPin';\nimport {SearchIcon} from '@ui/icons/material/Search';\nimport {List, ListItem} from '@ui/list/list';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport clsx from 'clsx';\nimport {useMemo, useState} from 'react';\n\ninterface Props {\n  attachedTags?: {id: number; name: string}[];\n  tagType?: string;\n  notTagType?: string;\n  taggableType?: string;\n  taggableIds?: number[];\n  userId?: number;\n  isLoading?: boolean;\n  onChange?: (tagId: number) => void;\n  onSelected?: (tagName: string) => void;\n}\nexport function ManageTagsDialog({\n  attachedTags: propsAttachedTags,\n  tagType,\n  notTagType,\n  taggableType,\n  taggableIds,\n  userId,\n  isLoading,\n  onChange,\n  onSelected,\n}: Props) {\n  const {trans} = useTrans();\n  const [query, setQuery] = useState('');\n  const {close} = useDialogContext();\n  const {\n    data,\n    isPlaceholderData,\n    isLoading: queryIsLoading,\n  } = useTags({\n    type: tagType,\n    notType: notTagType,\n    query,\n    userId,\n  });\n  const detachTag = useDetachTagFromTaggables();\n  const attachTag = useAttachTagToTaggables();\n\n  // if all tags does not include tag in attached tags, add it to the top\n  const {tags, attachedTagIds} = useMemo(() => {\n    const allTags = data?.pagination.data || [];\n    const attachedTags = propsAttachedTags || [];\n    const attachedTagIds = attachedTags.map(tag => tag.id);\n\n    const tags = allTags.filter(tag => !attachedTagIds.includes(tag.id));\n    tags.unshift(...attachedTags);\n    return {tags, attachedTagIds};\n  }, [propsAttachedTags, data]);\n\n  return (\n    <Dialog>\n      <DialogBody padding=\"p-8\">\n        <form>\n          <TextField\n            placeholder={trans({message: 'Type tag name...'})}\n            inputBorder=\"border-b\"\n            inputRadius=\"rounded-none\"\n            inputRing=\"ring-0\"\n            inputShadow=\"shadow-none\"\n            startAdornment={<SearchIcon />}\n            value={query}\n            onChange={e => setQuery(e.target.value)}\n            endAdornment={\n              isPlaceholderData && (\n                <ProgressCircle isIndeterminate size=\"w-24 h-24\" />\n              )\n            }\n          />\n        </form>\n        <List className=\"compact-scrollbar h-320 overflow-y-auto stable-scrollbar\">\n          {tags.map(tag => {\n            const isAttached = attachedTagIds.includes(tag.id);\n            const isDisabled =\n              attachTag.isPending || detachTag.isPending || isLoading;\n            return (\n              <ListItem\n                isDisabled={isDisabled}\n                onSelected={() => {\n                  if (onSelected) {\n                    onSelected(tag.name);\n                    close();\n                    return;\n                  }\n\n                  if (!taggableIds || !taggableType) {\n                    return;\n                  }\n\n                  if (isAttached) {\n                    detachTag.mutate(\n                      {\n                        tagId: tag.id,\n                        taggableIds,\n                        taggableType,\n                      },\n                      {\n                        onSuccess: () => onChange?.(tag.id),\n                      },\n                    );\n                  } else {\n                    attachTag.mutate(\n                      {\n                        taggableType,\n                        taggableIds,\n                        tagName: tag.name,\n                        userId,\n                        tagType,\n                      },\n                      {\n                        onSuccess: () => onChange?.(tag.id),\n                      },\n                    );\n                  }\n                }}\n                className={clsx(\n                  isAttached &&\n                    (isDisabled ? 'text-primary-light' : 'text-primary'),\n                )}\n                startIcon={<PushPinIcon size=\"xs\" />}\n                key={tag.id}\n                endSection={\n                  isAttached ? (\n                    <CheckIcon size=\"sm\" className=\"block text-primary\" />\n                  ) : (\n                    <div className=\"h-20 w-20\" />\n                  )\n                }\n              >\n                {tag.name}\n              </ListItem>\n            );\n          })}\n          {!isPlaceholderData && !data?.pagination.data.length && query && (\n            <ListItem\n              startIcon={<PushPinIcon size=\"xs\" />}\n              onSelected={() => {\n                if (onSelected) {\n                  onSelected(query);\n                  close();\n                  return;\n                }\n\n                if (!taggableIds || !taggableType) {\n                  return;\n                }\n\n                attachTag.mutate(\n                  {\n                    taggableType,\n                    taggableIds,\n                    tagName: query,\n                    userId,\n                    tagType,\n                  },\n                  {\n                    onSuccess: r => {\n                      setQuery('');\n                      onChange?.(r.tag.id);\n                    },\n                  },\n                );\n              }}\n            >\n              <Trans message={`Create tag \":name\"`} values={{name: query}} />\n            </ListItem>\n          )}\n          {data && !tags.length && !query && (\n            <li className=\"text-center text-muted\">\n              <Trans message=\"No tags found\" />\n            </li>\n          )}\n          {queryIsLoading && (\n            <li className=\"flex justify-center\">\n              <ProgressCircle isIndeterminate size=\"w-24 h24\" />\n            </li>\n          )}\n        </List>\n      </DialogBody>\n    </Dialog>\n  );\n}\n","import {DetailsSidebarSectionHeader} from '@app/drive/details-sidebar/details-sidebar-section-header';\nimport {Trans} from '@ui/i18n/trans';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport React from 'react';\nimport {useDetachTagFromTaggables} from '@common/tags/use-detach-tag-from-taggables';\nimport {useTaggableTags} from '@common/tags/use-taggable-tags';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {Button} from '@ui/buttons/button';\nimport {ManageTagsDialog} from '@common/tags/manage-tags-dialog';\nimport {ChipList} from '@ui/forms/input-field/chip-field/chip-list';\nimport {Chip} from '@ui/forms/input-field/chip-field/chip';\nimport {AddIcon} from '@ui/icons/material/Add';\nimport {useAuth} from '@common/auth/use-auth';\n\ninterface Props {\n  entry: DriveEntry;\n}\nexport function DetailsSidebarTags({entry}: Props) {\n  const {user} = useAuth();\n  const detachTag = useDetachTagFromTaggables();\n  const {data, isFetching} = useTaggableTags({\n    taggableType: 'fileEntry',\n    taggableId: entry.id,\n    initialData: entry.tags?.filter(tag => tag.type !== 'label'),\n    type: 'custom',\n  });\n  return (\n    <div className=\"mt-20 border-t pt-20\">\n      <DetailsSidebarSectionHeader margin=\"mb-10\">\n        <Trans message=\"Tags\" />\n      </DetailsSidebarSectionHeader>\n      <div className=\"flex items-center gap-8\">\n        <ChipList\n          size=\"sm\"\n          radius=\"rounded-button\"\n          startButton={\n            <DialogTrigger type=\"modal\">\n              <Button\n                variant=\"outline\"\n                startIcon={<AddIcon />}\n                size=\"2xs\"\n                className=\"min-h-26\"\n              >\n                <Trans message=\"Add tag\" />\n              </Button>\n              <ManageTagsDialog\n                attachedTags={data?.tags}\n                isLoading={isFetching}\n                tagType=\"custom\"\n                taggableType=\"fileEntry\"\n                taggableIds={[entry.id]}\n                userId={user?.id}\n              />\n            </DialogTrigger>\n          }\n        >\n          {data?.tags.map(tag => (\n            <Chip\n              key={tag.id}\n              disabled={detachTag.isPending || isFetching}\n              onRemove={() => {\n                detachTag.mutate({\n                  tagId: tag.id,\n                  taggableIds: [entry.id],\n                  taggableType: 'fileEntry',\n                });\n              }}\n            >\n              {tag.display_name || tag.name}\n            </Chip>\n          ))}\n        </ChipList>\n      </div>\n    </div>\n  );\n}\n","import {appQueries} from '@app/app-queries';\nimport {DriveFolder} from '@app/drive/files/drive-entry';\nimport {useAuth} from '@common/auth/use-auth';\nimport {useActiveWorkspaceId} from '@common/workspace/active-workspace-id-context';\nimport {useQuery} from '@tanstack/react-query';\n\nexport type UserFoldersApiParams = {\n  userId: number;\n  workspaceId: number | null;\n};\n\nexport type UserFoldersResponse = {\n  folders: DriveFolder[];\n  rootFolder: DriveFolder;\n};\n\nexport function useFolders() {\n  const {user} = useAuth();\n  const {workspaceId} = useActiveWorkspaceId();\n  const params: UserFoldersApiParams = {\n    userId: user!.id,\n    workspaceId,\n  };\n  return useQuery({\n    ...appQueries.userFolders.index(params),\n    enabled: !!user,\n  });\n}\n","import {appQueries} from '@app/app-queries';\nimport {makeFolderPage, SearchPage} from '@app/drive/drive-page/drive-page';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {DriveEntry, DriveFolder} from '@app/drive/files/drive-entry';\nimport {\n  SortColumn,\n  SortDirection,\n} from '@app/drive/layout/sorting/available-sorts';\nimport {LengthAwarePaginationResponse} from '@common/http/backend-response/pagination-response';\nimport {useActiveWorkspaceId} from '@common/workspace/active-workspace-id-context';\nimport {InfiniteData, useInfiniteQuery} from '@tanstack/react-query';\nimport {shallowEqual} from '@ui/utils/shallow-equal';\nimport {useEffect, useMemo} from 'react';\nimport {useSearchParams} from 'react-router';\n\nexport interface DriveApiIndexParams {\n  orderBy?: SortColumn;\n  orderDir?: SortDirection;\n  folderId?: string | number | null;\n  query?: string;\n  filters?: string;\n  deletedOnly?: boolean;\n  starredOnly?: boolean;\n  sharedOnly?: boolean;\n  perPage?: number;\n  page?: number;\n  recentOnly?: boolean;\n  workspaceId?: number | null;\n  section?: string;\n}\n\nexport interface EntriesPaginationResponse\n  extends LengthAwarePaginationResponse<DriveEntry> {\n  folder?: DriveFolder;\n}\n\nconst setActiveFolder = (response: InfiniteData<EntriesPaginationResponse>) => {\n  const firstPage = response.pages[0];\n  const newFolder = firstPage.folder;\n  const currentPage = driveState().activePage;\n\n  if (\n    newFolder &&\n    currentPage &&\n    currentPage.uniqueId === newFolder.hash &&\n    // only update page if once to set the folder or if permissions change, to keep page reference as stable as possible\n    (!currentPage.folder ||\n      !shallowEqual(newFolder.permissions, currentPage.folder?.permissions))\n  ) {\n    driveState().setActivePage(makeFolderPage(newFolder));\n  }\n  return response;\n};\n\nexport function useActivePageEntries() {\n  const page = useDriveStore(s => s.activePage);\n  const sortDescriptor = useDriveStore(s => s.sortDescriptor);\n  const [searchParams] = useSearchParams();\n  const {workspaceId} = useActiveWorkspaceId();\n  const params: DriveApiIndexParams = {\n    section: page?.name,\n    ...page?.queryParams,\n    ...Object.fromEntries(searchParams),\n    folderId: page?.isFolderPage ? page.uniqueId : null,\n    workspaceId,\n    ...sortDescriptor,\n  };\n\n  // if we have no search query, there's no need to call the API, show no results message instead\n  const isDisabledInSearch =\n    page === SearchPage && !params.query && !params.filters;\n\n  const query = useInfiniteQuery({\n    ...appQueries.driveEntries.index(params),\n    enabled: page != null && !isDisabledInSearch,\n  });\n\n  // need to do this in effect, to avoid react errors about\n  // multiple components re-rendering at the same time\n  useEffect(() => {\n    if (query.data?.pages[0].folder) {\n      setActiveFolder(query.data);\n    }\n  }, [query.data]);\n\n  const items = useMemo(() => {\n    return query.data?.pages.flatMap(p => p.data) || [];\n  }, [query.data?.pages]);\n\n  return {\n    ...query,\n    items,\n    isEmpty: !items.length,\n  };\n}\n","import {appQueries} from '@app/app-queries';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {\n  EntriesPaginationResponse,\n  useActivePageEntries,\n} from '@app/drive/files/queries/use-active-page-entries';\nimport {queryClient} from '@common/http/query-client';\nimport {InfiniteData} from '@tanstack/react-query';\n\nexport function useSelectedEntries(): DriveEntry[] {\n  const ids = useDriveStore(s => s.selectedEntries);\n  const {items} = useActivePageEntries();\n  return Array.from(ids)\n    .map(id => items.find(entry => entry.id === id))\n    .filter(e => !!e);\n}\n\nexport function getSelectedEntries(): DriveEntry[] {\n  const ids = Array.from(driveState().selectedEntries);\n\n  const caches = queryClient.getQueriesData<\n    InfiniteData<EntriesPaginationResponse>\n  >({queryKey: appQueries.driveEntries.invalidateKey});\n\n  const selectedEntries: DriveEntry[] = [];\n\n  for (const cache of caches) {\n    const entries = cache[1] ? cache[1].pages.flatMap(p => p.data) : [];\n    for (const entry of entries) {\n      if (\n        ids.includes(entry.id) &&\n        !selectedEntries.find(e => e.id === entry.id)\n      ) {\n        selectedEntries.push(entry);\n      }\n    }\n  }\n\n  return selectedEntries;\n}\n","import {DetailsSidebarHeader} from '@app/drive/details-sidebar/details-sidebar-header';\nimport {DetailsSidebarSectionHeader} from '@app/drive/details-sidebar/details-sidebar-section-header';\nimport {DetailsSidebarTags} from '@app/drive/details-sidebar/details-sidebar-tags';\nimport {\n  getPathForFolder,\n  RootFolderPage,\n} from '@app/drive/drive-page/drive-page';\nimport {driveState} from '@app/drive/drive-store';\nimport {DriveEntry, DriveFolder} from '@app/drive/files/drive-entry';\nimport {useFolders} from '@app/drive/files/queries/use-folders';\nimport {useSelectedEntries} from '@app/drive/files/use-selected-entries';\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\nimport {FileThumbnail} from '@common/uploads/components/file-type-icon/file-thumbnail';\nimport {Avatar} from '@ui/avatar/avatar';\nimport {Button} from '@ui/buttons/button';\nimport {FormattedDate} from '@ui/i18n/formatted-date';\nimport {Trans} from '@ui/i18n/trans';\nimport {FolderIcon} from '@ui/icons/material/Folder';\nimport {GroupsIcon} from '@ui/icons/material/Groups';\nimport {Tooltip} from '@ui/tooltip/tooltip';\nimport {prettyBytes} from '@ui/utils/files/pretty-bytes';\nimport {ReactNode, useMemo} from 'react';\n\ninterface EntryPropertiesProps {\n  entry: DriveEntry;\n}\nexport function DetailsSidebarProperties({entry}: EntryPropertiesProps) {\n  return (\n    <div>\n      <DetailsSidebarHeader entryType={entry.type} entryName={entry.name} />\n      {entry.type === 'image' && (\n        <FileThumbnail\n          className=\"mb-20 overflow-hidden rounded-panel border border-divider-lighter\"\n          file={entry}\n        />\n      )}\n      <div>\n        <DetailsSidebarSectionHeader>\n          <Trans message=\"Who has access\" />\n        </DetailsSidebarSectionHeader>\n        <div className=\"flex items-center gap-14\">\n          {entry.workspace_id ? (\n            <div className=\"flex h-32 w-32 items-center justify-center rounded-full border\">\n              <GroupsIcon className=\"icon-md\" />\n            </div>\n          ) : null}\n          {entry.users.map(user => (\n            <Tooltip label={user.name} key={user.id}>\n              <Avatar src={user.image} label={user.name} size=\"md\" />\n            </Tooltip>\n          ))}\n        </div>\n        {entry.permissions['files.update'] && (\n          <Button\n            className=\"mt-20 block\"\n            variant=\"outline\"\n            size=\"xs\"\n            color=\"primary\"\n            onClick={() => {\n              driveState().setActiveActionDialog('share', [entry]);\n            }}\n          >\n            <Trans message=\"Manage Access\" />\n          </Button>\n        )}\n      </div>\n      <PropertyList entry={entry} />\n      <DetailsSidebarTags entry={entry} />\n    </div>\n  );\n}\n\ninterface Props {\n  entry: DriveEntry;\n}\nfunction PropertyList({entry}: Props) {\n  const parent = useSelectedEntryParent();\n  const navigate = useNavigate();\n  const owner = entry.users.find(user => user.owns_entry);\n  const prettySize = useMemo(\n    () => prettyBytes(entry.file_size),\n    [entry.file_size],\n  );\n\n  return (\n    <div className=\"mt-20 border-t pt-20\">\n      <DetailsSidebarSectionHeader>\n        <Trans message=\"Properties\" />\n      </DetailsSidebarSectionHeader>\n      <PropertyItem\n        label={<Trans message=\"Type\" />}\n        value={\n          <span className=\"capitalize\">\n            <Trans message={entry.type} />\n          </span>\n        }\n      />\n      <PropertyItem\n        label={<Trans message=\"Size\" />}\n        value={entry.file_size ? prettySize : '-'}\n      />\n      <PropertyItem\n        label={<Trans message=\"Location\" />}\n        value={\n          <Button\n            variant=\"link\"\n            startIcon={<FolderIcon />}\n            onClick={() => {\n              navigate(\n                parent ? getPathForFolder(parent.hash) : RootFolderPage.path,\n              );\n            }}\n          >\n            {parent ? parent.name : <Trans message=\"Root\" />}\n          </Button>\n        }\n      />\n      {owner && (\n        <PropertyItem label={<Trans message=\"Owner\" />} value={owner.name} />\n      )}\n      <PropertyItem\n        label={<Trans message=\"Modified\" />}\n        value={<FormattedDate date={entry.updated_at} />}\n      />\n      <PropertyItem\n        label={<Trans message=\"Created\" />}\n        value={<FormattedDate date={entry.updated_at} />}\n      />\n    </div>\n  );\n}\n\ninterface PropertyItemProps {\n  label: ReactNode;\n  value: ReactNode;\n}\nfunction PropertyItem({label, value}: PropertyItemProps) {\n  return (\n    <div className=\"mb-14 flex items-center\">\n      <div className=\"w-1/3 text-xs text-muted\">{label}</div>\n      <div className=\"w-2/3 text-sm text-main\">{value}</div>\n    </div>\n  );\n}\n\nfunction useSelectedEntryParent(): DriveFolder | null | undefined {\n  const entry = useSelectedEntries()[0];\n  const {data} = useFolders();\n  if (!entry || !data?.folders) return;\n  return data.folders.find(e => e.id === entry.parent_id) as DriveFolder;\n}\n","export default \"__VITE_ASSET__B7t71Mua__\"","import {DetailsSidebarHeader} from '@app/drive/details-sidebar/details-sidebar-header';\nimport {DetailsSidebarProperties} from '@app/drive/details-sidebar/details-sidebar-properties';\nimport {Trans} from '@ui/i18n/trans';\nimport {IllustratedMessage} from '@ui/images/illustrated-message';\nimport {SvgImage} from '@ui/images/svg-image';\nimport clsx from 'clsx';\nimport {Fragment} from 'react';\nimport {useSelectedEntries} from '@app/drive/files/use-selected-entries';\nimport detailedExamination from '@app/drive/details-sidebar/detailed-examination.svg';\n\ninterface DetailsSidebarProps {\n  className?: string;\n}\nexport function DetailsSidebar({className}: DetailsSidebarProps) {\n  const selectedEntry = useSelectedEntries()[0];\n  return (\n    <div\n      className={clsx(\n        className,\n        'dashboard-rounded-panel h-full overflow-y-auto border-divider-lighter p-18 text-sm text-muted lg:ml-8',\n      )}\n    >\n      {selectedEntry ? (\n        <DetailsSidebarProperties entry={selectedEntry} />\n      ) : (\n        <NothingSelected />\n      )}\n    </div>\n  );\n}\n\nfunction NothingSelected() {\n  return (\n    <Fragment>\n      <DetailsSidebarHeader\n        entryType=\"folder\"\n        entryName={<Trans message=\"All files\" />}\n      />\n      <IllustratedMessage\n        image={<SvgImage src={detailedExamination} />}\n        description={<Trans message=\"Select file or folder to see details\" />}\n      />\n    </Fragment>\n  );\n}\n","import React, {createElement} from 'react';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {EntryActionMenuTrigger} from '@app/drive/entry-actions/entry-action-menu-trigger';\nimport {MoreVertIcon} from '@ui/icons/material/MoreVert';\nimport {Tooltip} from '@ui/tooltip/tooltip';\nimport {Trans} from '@ui/i18n/trans';\nimport {useSelectedEntries} from '@app/drive/files/use-selected-entries';\nimport {\n  useDeleteEntriesAction,\n  usePreviewAction,\n  useRemoveSharedEntriesAction,\n  useShareAction,\n} from '@app/drive/entry-actions/use-entry-actions';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {EntryAction} from '@app/drive/entry-actions/entry-action';\n\ninterface EntryActionListProps {\n  className?: string;\n}\nexport function EntryActionList({className}: EntryActionListProps) {\n  const selectedEntries = useSelectedEntries();\n\n  if (!selectedEntries.length) {\n    return null;\n  }\n\n  return (\n    <div className={className}>\n      <ActionList entries={selectedEntries} />\n    </div>\n  );\n}\n\ninterface ActionListProps {\n  entries: DriveEntry[];\n}\nfunction ActionList({entries}: ActionListProps) {\n  const preview = usePreviewAction(entries);\n  const share = useShareAction(entries);\n  const deleteAction = useDeleteEntriesAction(entries);\n  const removeShared = useRemoveSharedEntriesAction(entries);\n\n  const actions = [preview, share, deleteAction, removeShared].filter(\n    action => !!action,\n  ) as EntryAction[];\n\n  return (\n    <div className=\"entry-action-list\">\n      {actions.map(action => (\n        <Tooltip key={action.key} label={<Trans {...action.label} />}>\n          <IconButton\n            size=\"sm\"\n            onClick={() => {\n              action.execute();\n            }}\n          >\n            {createElement(action.icon)}\n          </IconButton>\n        </Tooltip>\n      ))}\n      <EntryActionMenuTrigger entries={entries}>\n        <Tooltip label={<Trans message=\"More actions\" />}>\n          <IconButton>\n            <MoreVertIcon />\n          </IconButton>\n        </Tooltip>\n      </EntryActionMenuTrigger>\n    </div>\n  );\n}\n","import {FileEntry} from '@common/uploads/file-entry';\n\nexport function makeFolderTreeDragId(entry: FileEntry) {\n  return `${entry.id}-tree`;\n}\n\nexport function isFolderTreeDragId(id: string | number): boolean {\n  return `${id}`.endsWith('-tree');\n}\n","import {InteractableEvent} from '../interactable-event';\nimport {useEffect, useId, useRef} from 'react';\nimport {dragMonitors, DragSessionStatus} from './drag-state';\nimport {ConnectedDraggable} from './use-draggable';\n\nexport interface DragMonitor {\n  type: string;\n  onDragStart?: (e: InteractableEvent, dragTarget: ConnectedDraggable) => void;\n  onDragMove?: (e: InteractableEvent, dragTarget: ConnectedDraggable) => void;\n  onDragEnd?: (\n    e: InteractableEvent,\n    dragTarget: ConnectedDraggable,\n    status: DragSessionStatus\n  ) => void;\n}\n\nexport function useDragMonitor(monitor: DragMonitor) {\n  const monitorRef = useRef(monitor);\n  const id = useId();\n\n  useEffect(() => {\n    dragMonitors.set(id, monitorRef.current);\n    return () => {\n      dragMonitors.delete(id);\n    };\n  }, [id]);\n}\n","import {\n  isFolderTreeDragId,\n  makeFolderTreeDragId,\n} from '@app/drive/layout/sidebar/folder-tree-drag-id';\nimport {FileTypeIcon} from '@common/uploads/components/file-type-icon/file-type-icon';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport {DragSessionStatus, droppables} from '@ui/interactions/dnd/drag-state';\nimport {useDragMonitor} from '@ui/interactions/dnd/use-drag-monitor';\nimport {ConnectedDraggable} from '@ui/interactions/dnd/use-draggable';\nimport {InteractableEvent} from '@ui/interactions/interactable-event';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {memo, useRef, useState} from 'react';\nimport {useDriveStore} from '@app/drive/drive-store';\n\ninterface Point {\n  x: number;\n  y: number;\n}\n\ninterface DragPreviewState {\n  entries?: FileEntry[];\n  e?: InteractableEvent;\n  status?: DragSessionStatus;\n  draggingTreeItem?: boolean;\n}\n\nexport function EntryDragPreview() {\n  const ref = useRef<HTMLDivElement>(null);\n  const [points, setPoints] = useState<{start?: Point; end?: Point}>();\n  const [state, setState] = useState<DragPreviewState>({});\n\n  useDragMonitor({\n    type: 'fileEntry',\n    onDragStart: (e, dragTarget) => {\n      const target = dragTarget as ConnectedDraggable<FileEntry[]>;\n      if (target) {\n        setState({\n          entries: target.getData(),\n          e,\n          draggingTreeItem: isFolderTreeDragId(target.id as number),\n        });\n        setPoints({start: e});\n      }\n    },\n    onDragMove: e => {\n      setState(prev => {\n        return {...prev, e: e};\n      });\n      setPoints(prev => {\n        return {...prev, end: e};\n      });\n    },\n    onDragEnd: (e, dragTarget, status) => {\n      setState({status});\n    },\n  });\n\n  let preview = null;\n\n  if (state.entries && state.e) {\n    preview = (\n      <div\n        ref={ref}\n        style={\n          state.e\n            ? {\n                transform: `translate(${state.e.x}px, ${state.e.y}px)`,\n                width: `${state.e.rect.width}px`,\n              }\n            : undefined\n        }\n        className=\"pointer-events-none fixed left-0 top-0 isolate\"\n      >\n        {state.entries.map((item, index) => (\n          <EntryPreview\n            key={item.id}\n            index={index}\n            entry={item}\n            points={points}\n            state={state}\n          />\n        ))}\n      </div>\n    );\n  }\n\n  return <AnimatePresence custom={state.status}>{preview}</AnimatePresence>;\n}\n\ninterface EntryPreviewProps {\n  entry: FileEntry;\n  index: number;\n  points?: {start?: Point; end?: Point};\n  state: DragPreviewState;\n}\nconst EntryPreview = memo(\n  ({entry, points, index, state}: EntryPreviewProps) => {\n    const viewMode = useDriveStore(s => s.viewMode);\n    const droppableId = state.draggingTreeItem\n      ? makeFolderTreeDragId(entry)\n      : entry.id;\n    const target = droppables.get(droppableId);\n    if (!target?.rect || !points?.start) return null;\n    const rect = target.rect;\n    const itemCount = state.entries?.length || 0;\n\n    const exitVariant = (status: DragSessionStatus) => {\n      if (status === 'dropSuccess') {\n        return {\n          x: 0,\n          y: 0,\n          opacity: 0,\n          transition: {duration: 0.1, delay: 0},\n        };\n      }\n      return {\n        x: rect.left - (points.end?.x || 0),\n        y: rect.top - (points.end?.y || 0),\n        width: `${state.e?.rect.width}px`,\n      };\n    };\n\n    return (\n      <m.div\n        key={entry.id}\n        transition={{delay: 0.01 * index, bounce: 0, duration: 0.2}}\n        initial={{\n          x: rect.left - points.start.x,\n          y: rect.top - points.start.y,\n          width: `${state.e?.rect.width}px`,\n        }}\n        animate={{\n          x: 0,\n          y: 0,\n          // in list/table mode limit preview size to 288px, but start and end the animation\n          // at full width, so it returns to original position at original size smoothly\n          width: viewMode === 'list' ? 288 : undefined,\n        }}\n        exit={exitVariant as any}\n        style={{\n          // in grid mode simply use the width of the draggable item\n          width: viewMode === 'grid' ? `${state.e?.rect.width}px` : undefined,\n          height: `${state.e?.rect.height}px`,\n        }}\n        className={clsx(\n          'absolute max-h-48 whitespace-nowrap rounded-button border border-primary-light bg-elevated',\n          index < 2 && 'shadow',\n          index === 0 && 'left-0 top-0 z-10',\n          index > 0 && 'left-6 top-6',\n        )}\n      >\n        {itemCount > 1 && index === 0 && <EntryCount count={itemCount} />}\n        <div className=\"flex h-full items-center justify-center gap-10 overflow-hidden bg-primary-light/20 px-16 text-sm\">\n          <FileTypeIcon type={entry.type} />\n          <div className=\"flex-auto overflow-hidden text-ellipsis\">\n            {entry.name}\n          </div>\n        </div>\n      </m.div>\n    );\n  },\n);\n\ninterface EntryCountProps {\n  count: number;\n}\nconst EntryCount = memo(({count}: EntryCountProps) => {\n  return (\n    <m.div\n      key=\"entryCount\"\n      initial={{opacity: 0}}\n      animate={{opacity: 1, transition: {delay: 0.1}}}\n      exit={{opacity: 0}}\n      transition={{duration: 0.1}}\n      className=\"absolute -right-6 -top-6 z-10 z-30 flex h-20 w-20 items-center justify-center rounded-full bg-danger text-sm font-bold text-white shadow-lg\"\n    >\n      {count}\n    </m.div>\n  );\n});\n","import {AnimatePresence, m} from 'framer-motion';\nimport {Trans} from '@ui/i18n/trans';\nimport React from 'react';\nimport {opacityAnimation} from '@ui/animation/opacity-animation';\n\ninterface DropTargetMaskProps {\n  isVisible: boolean;\n}\nexport function DropTargetMask({isVisible}: DropTargetMaskProps) {\n  const mask = (\n    <m.div\n      key=\"dragTargetMask\"\n      {...opacityAnimation}\n      transition={{duration: 0.3}}\n      className=\"pointer-events-none absolute inset-0 min-h-full w-full border-2 border-dashed border-primary bg-primary-light/30\"\n    >\n      <m.div\n        initial={{y: '100%', opacity: 0}}\n        animate={{y: '-10px', opacity: 1}}\n        exit={{y: '100%', opacity: 0}}\n        className=\"fixed bottom-0 left-0 right-0 mx-auto max-w-max rounded bg-primary p-10 text-on-primary\"\n      >\n        <Trans message=\"Drop files to upload them to this folder.\" />\n      </m.div>\n    </m.div>\n  );\n  return <AnimatePresence>{isVisible ? mask : null}</AnimatePresence>;\n}\n","import {driveInvalidateKey} from '@app/app-queries';\nimport {RootFolderPage} from '@app/drive/drive-page/drive-page';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\n\ninterface Response extends BackendResponse {\n  entries: DriveEntry[];\n  destination: FileEntry | null;\n}\n\ninterface Payload {\n  entryIds: number[];\n  destinationId?: number | null;\n}\n\nexport function useMoveEntries() {\n  return useMutation({\n    mutationFn: (payload: Payload) => {\n      toast.loading(\n        message('Moving [one 1 item|other :count items]...', {\n          values: {\n            count: payload.entryIds.length,\n          },\n        }),\n        {disableExitAnimation: true},\n      );\n      return moveEntries(payload);\n    },\n    onSuccess: (r, p) => {\n      queryClient.invalidateQueries({queryKey: driveInvalidateKey});\n      toast(\n        message('Moved [one 1 item|other :count items] to \":destination\"', {\n          values: {\n            count: p.entryIds.length,\n            destination: (r.destination || RootFolderPage.folder).name,\n          },\n        }),\n        {disableEnterAnimation: true},\n      );\n    },\n    onError: err =>\n      showHttpErrorToast(err, message('Could not move items'), null, {\n        disableEnterAnimation: true,\n      }),\n  });\n}\n\nfunction moveEntries(payload: Payload): Promise<Response> {\n  // backend expects null for root folder, it might be zero or empty string on frontend\n  payload.destinationId = !payload.destinationId ? null : payload.destinationId;\n  return apiClient\n    .post('file-entries/move', payload)\n    .then(response => response.data);\n}\n","import {FileEntry} from '@common/uploads/file-entry';\nimport {DriveEntry, DriveFolder} from '@app/drive/files/drive-entry';\n\nexport interface PartialFolder {\n  id: number;\n  hash: string;\n  name: string;\n  path: string;\n  parent_id: number | null;\n  type: string;\n}\n\nexport function canMoveEntriesInto(\n  targets: DriveEntry[],\n  destination: DriveFolder,\n) {\n  if (destination.type !== 'folder') return false;\n\n  // prevent moving if user does not have permissions\n  if (\n    !destination.permissions['files.update'] &&\n    !targets.every(t => t.permissions['files.update'])\n  ) {\n    return false;\n  }\n\n  // should not be able to move folder into its\n  // own child or folder it's already in\n  return targets.every(target => {\n    if (!target) return false;\n    // entry is already in this folder\n    if (\n      destination.id === target.parent_id ||\n      // root folder check\n      (!target.parent_id && destination.id === 0)\n    ) {\n      return false;\n    }\n\n    return !destinationIsInTarget(destination, target);\n  });\n}\n\nfunction destinationIsInTarget(destination: PartialFolder, target: FileEntry) {\n  const destinationPath = (destination.path || '').split('/');\n  const targetPath = (target.path || '').split('/');\n  return targetPath.every((part, index) => {\n    return destinationPath[index] === part;\n  });\n}\n","import {driveState} from '@app/drive/drive-store';\nimport {DriveEntry, DriveFolder} from '@app/drive/files/drive-entry';\nimport {\n  ConnectedDraggable,\n  MixedDraggable,\n} from '@ui/interactions/dnd/use-draggable';\nimport {NativeFileDraggable} from '@ui/interactions/dnd/use-droppable';\nimport {useDriveUploadQueue} from '@app/drive/uploading/use-drive-upload-queue';\nimport {useMoveEntries} from '@app/drive/files/queries/use-move-entries';\nimport {canMoveEntriesInto} from '@app/drive/files/utils/can-move-entries-into';\n\nexport function useFolderDropAction(folder: DriveEntry) {\n  const moveEntries = useMoveEntries();\n  const {uploadFiles} = useDriveUploadQueue();\n\n  const onDrop = async (target: ConnectedDraggable | NativeFileDraggable) => {\n    if (folder.type !== 'folder') return;\n    if (target.type === 'nativeFile') {\n      uploadFiles(await target.getData(), {\n        parentId: folder.id,\n      });\n    } else if (target.type === 'fileEntry') {\n      const entries = target.getData() as DriveEntry[];\n      if (\n        entries?.length &&\n        canMoveEntriesInto(entries, folder as DriveFolder)\n      ) {\n        moveEntries.mutate({\n          destinationId: folder.id,\n          entryIds: entries.map(e => e.id),\n        });\n        driveState().deselectEntries('all');\n      }\n    }\n  };\n\n  return {onDrop};\n}\n\nexport function folderAcceptsDrop(\n  target: MixedDraggable,\n  destination: DriveFolder,\n) {\n  if (target.type === 'fileEntry') {\n    const entries = target.getData() as DriveEntry[];\n    return canMoveEntriesInto(entries, destination);\n  }\n  return true;\n}\n","import { RefObject, useLayoutEffect, useRef } from 'react';\nimport { InteractableRect } from '../../interactable-event';\nimport { droppables } from '../drag-state';\nimport { DraggableId } from '../use-draggable';\n\nexport interface ConnectedMouseSelectable {\n  id: DraggableId;\n  onSelected?: () => void;\n  onDeselected?: () => void;\n  ref: RefObject<HTMLElement | null>;\n  rect?: InteractableRect;\n}\n\nexport const mouseSelectables = new Map<\n  DraggableId,\n  ConnectedMouseSelectable\n>();\n\nexport function useMouseSelectable(options: ConnectedMouseSelectable) {\n  const {id, ref} = options;\n  const optionsRef = useRef(options);\n  optionsRef.current = options;\n\n  useLayoutEffect(() => {\n    if (!ref.current) return;\n    // register droppable regardless if it's enabled or not, it might be used by mouse selection box\n    mouseSelectables.set(id, {\n      ...mouseSelectables.get(id),\n      id,\n      ref,\n      // avoid stale closures\n      onSelected: () => {\n        optionsRef.current.onSelected?.();\n      },\n      onDeselected: () => optionsRef.current.onDeselected?.(),\n    });\n    return () => {\n      droppables.delete(id);\n    };\n  }, [id, optionsRef, ref]);\n}\n","import {useMediaQuery} from '@ui/utils/hooks/use-media-query';\n\nexport function useIsTouchDevice() {\n  return useMediaQuery('((pointer: coarse))');\n}\n","import {\n  ConnectedDraggable,\n  useDraggable,\n} from '@ui/interactions/dnd/use-draggable';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {getSelectedEntries} from '@app/drive/files/use-selected-entries';\nimport {useDroppable} from '@ui/interactions/dnd/use-droppable';\nimport {\n  folderAcceptsDrop,\n  useFolderDropAction,\n} from '@app/drive/files/use-folder-drop-action';\nimport {DriveEntry, DriveFolder} from '@app/drive/files/drive-entry';\nimport {useRef, useState} from 'react';\nimport clsx from 'clsx';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport {useMouseSelectable} from '@ui/interactions/dnd/mouse-selection/use-mouse-selectable';\nimport {TrashPage} from '@app/drive/drive-page/drive-page';\nimport {useIsTouchDevice} from '@ui/utils/hooks/is-touch-device';\n\nexport function useFileViewDnd<T extends HTMLElement = HTMLElement>(\n  destination: DriveEntry,\n) {\n  const isTouchDevice = useIsTouchDevice();\n  const ref = useRef<T>(null);\n  const {onDrop} = useFolderDropAction(destination);\n  const [isDragOver, setIsDragOver] = useState(false);\n  const isDragging = useDriveStore(s =>\n    s.entriesBeingDragged.includes(destination.id),\n  );\n  const activePage = useDriveStore(s => s.activePage);\n\n  const {draggableProps} = useDraggable({\n    disabled: !!isTouchDevice || activePage === TrashPage,\n    id: destination.id,\n    type: 'fileEntry',\n    ref,\n    hidePreview: true,\n    onDragStart: (e, target: ConnectedDraggable<FileEntry[]>) => {\n      if (!driveState().selectedEntries.has(destination.id)) {\n        driveState().selectEntries([destination.id]);\n      }\n      driveState().setEntriesBeingDragged(target.getData().map(e => e.id));\n    },\n    onDragEnd: () => {\n      driveState().setEntriesBeingDragged([]);\n    },\n    getData: () => getSelectedEntries(),\n  });\n\n  const {droppableProps} = useDroppable<T>({\n    id: destination.id,\n    disabled: isTouchDevice || destination.type !== 'folder',\n    ref,\n    types: ['fileEntry', 'nativeFile'],\n    acceptsDrop: target =>\n      folderAcceptsDrop(target, destination as DriveFolder),\n    onDragEnter: () => setIsDragOver(true),\n    onDragLeave: () => setIsDragOver(false),\n    onDrop,\n  });\n\n  useMouseSelectable({\n    id: destination.id,\n    ref,\n    onSelected: () => {\n      driveState().selectEntries([destination.id], true);\n    },\n    onDeselected: () => {\n      driveState().deselectEntries([destination.id]);\n    },\n  });\n\n  const itemClassName = clsx(\n    isDragging && 'opacity-20',\n    isDragOver && 'ring ring-offset-4 ring-primary bg-primary-light/10 rounded',\n  );\n\n  return {\n    draggableProps,\n    droppableProps,\n    isDragOver,\n    isDragging,\n    itemClassName,\n    ref,\n  };\n}\n","import {useCallback} from 'react';\nimport {getPathForFolder, TrashPage} from '@app/drive/drive-page/drive-page';\nimport {driveState} from '@app/drive/drive-store';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {getSelectedEntries} from '@app/drive/files/use-selected-entries';\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\n\nexport function useViewItemActionHandler() {\n  const navigate = useNavigate();\n\n  const performViewItemAction = useCallback(\n    (entry: DriveEntry) => {\n      if (entry && entry.type === 'folder') {\n        if (driveState().activePage === TrashPage) {\n          driveState().setActiveActionDialog('trashFolderBlock', [entry]);\n        } else {\n          navigate(getPathForFolder(entry.hash));\n        }\n      } else {\n        const selectedEntries = getSelectedEntries();\n        driveState().setActiveActionDialog(\n          'preview',\n          selectedEntries.length ? selectedEntries : [entry],\n        );\n      }\n    },\n    [navigate],\n  );\n\n  return {performViewItemAction};\n}\n","import React, {useContext} from 'react';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {mergeProps} from '@react-aria/utils';\nimport {useFileViewDnd} from '@app/drive/file-view/use-file-view-dnd';\nimport {useViewItemActionHandler} from '@app/drive/file-view/use-view-item-action-handler';\nimport {BaseFileGridItem} from '@app/drive/file-view/file-grid/base-file-grid-item';\nimport {EntryActionMenuTrigger} from '@app/drive/entry-actions/entry-action-menu-trigger';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {MoreVertIcon} from '@ui/icons/material/MoreVert';\nimport {Checkbox} from '@ui/forms/toggle/checkbox';\nimport {DashboardLayoutContext} from '@common/ui/dashboard-layout/dashboard-layout-context';\nimport {isCtrlOrShiftPressed} from '@ui/utils/keybinds/is-ctrl-or-shift-pressed';\nimport {usePointerEvents} from '@ui/interactions/use-pointer-events';\nimport {createEventHandler} from '@ui/utils/dom/create-event-handler';\n\ninterface FileGridItemProps {\n  entry: DriveEntry;\n}\nexport function FileGridItem({entry}: FileGridItemProps) {\n  const isSelected = useDriveStore(s => s.selectedEntries.has(entry.id));\n  const {performViewItemAction} = useViewItemActionHandler();\n  const {isMobileMode} = useContext(DashboardLayoutContext);\n\n  const {draggableProps, droppableProps, itemClassName, ref} =\n    useFileViewDnd<HTMLDivElement>(entry);\n\n  const toggleEntry = () => {\n    if (isSelected) {\n      driveState().deselectEntries([entry.id]);\n    } else {\n      driveState().selectEntries([entry.id], true);\n    }\n  };\n\n  const pressHandler = (e: PointerEvent, el: HTMLElement) => {\n    if (isMobileMode) {\n      if (driveState().selectedEntries.size) {\n        toggleEntry();\n      } else {\n        performViewItemAction(entry);\n      }\n    } else {\n      if (isCtrlOrShiftPressed(e)) {\n        toggleEntry();\n      } else {\n        driveState().selectEntries([entry.id]);\n      }\n    }\n  };\n\n  const {domProps: pressProps} = usePointerEvents({\n    onLongPress: isMobileMode ? () => toggleEntry() : undefined,\n    onPress: pressHandler,\n  });\n\n  const keyboardHandler: React.KeyboardEventHandler = e => {\n    if (e.key === 'Enter' || e.key === ' ') {\n      e.preventDefault();\n      e.stopPropagation();\n      performViewItemAction(entry);\n    }\n  };\n\n  const contextMenuHandler: React.MouseEventHandler = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!isMobileMode) {\n      if (!driveState().selectedEntries.has(entry.id)) {\n        driveState().selectEntries([entry.id]);\n      }\n      driveState().setContextMenuData({x: e.clientX, y: e.clientY});\n    }\n  };\n\n  return (\n    <BaseFileGridItem\n      {...mergeProps(draggableProps, droppableProps, pressProps, {\n        onKeyDown: createEventHandler(keyboardHandler),\n      })}\n      ref={ref}\n      entry={entry}\n      isSelected={isSelected}\n      isMobileMode={!!isMobileMode}\n      tabIndex={-1}\n      onDoubleClick={e => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (!isMobileMode) {\n          performViewItemAction(entry);\n        }\n      }}\n      footerAdornment={\n        isMobileMode && (\n          <FooterAdornment entry={entry} isSelected={isSelected} />\n        )\n      }\n      onContextMenu={createEventHandler(contextMenuHandler)}\n      className={itemClassName}\n    />\n  );\n}\n\ninterface FooterProps {\n  entry: DriveEntry;\n  isSelected?: boolean;\n}\nfunction FooterAdornment({entry, isSelected}: FooterProps) {\n  const anySelected = useDriveStore(s => s.selectedEntries.size);\n\n  if (anySelected) {\n    return <Checkbox className=\"mr-8 block\" checked={isSelected} />;\n  }\n\n  return (\n    <EntryActionMenuTrigger entries={[entry]}>\n      <IconButton\n        className=\"text-muted\"\n        onPointerDown={e => {\n          e.stopPropagation();\n        }}\n      >\n        <MoreVertIcon />\n      </IconButton>\n    </EntryActionMenuTrigger>\n  );\n}\n","import {FileGridItem} from '@app/drive/file-view/file-grid/file-grid-item';\nimport React from 'react';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\n\ninterface FileGridProps {\n  entries: DriveEntry[];\n}\nexport function FileGrid({entries}: FileGridProps) {\n  return (\n    <div className=\"file-grid-container\">\n      <div className=\"file-grid\">\n        {entries.map(entry => {\n          return <FileGridItem key={entry.id} entry={entry} />;\n        })}\n      </div>\n    </div>\n  );\n}\n","import {DriveEntry} from '@app/drive/files/drive-entry';\nimport {RowElementProps} from '@common/ui/tables/table-row';\nimport {mergeProps} from '@react-aria/utils';\nimport {useFileViewDnd} from '@app/drive/file-view/use-file-view-dnd';\nimport clsx from 'clsx';\nimport React, {useContext} from 'react';\nimport {driveState} from '@app/drive/drive-store';\nimport {TableContext} from '@common/ui/tables/table-context';\n\nexport function FileTableRow({\n  item,\n  children,\n  className,\n  ...domProps\n}: RowElementProps<DriveEntry>) {\n  const {isCollapsedMode} = useContext(TableContext);\n  const {draggableProps, droppableProps, itemClassName, ref} =\n    useFileViewDnd<HTMLDivElement>(item);\n\n  return (\n    <div\n      className={clsx(className, itemClassName)}\n      ref={ref}\n      {...mergeProps(draggableProps, droppableProps, domProps, {\n        onContextMenu: (e: React.MouseEvent) => {\n          e.preventDefault();\n          e.stopPropagation();\n          if (!isCollapsedMode) {\n            if (!driveState().selectedEntries.has(item.id)) {\n              driveState().selectEntries([item.id]);\n            }\n            driveState().setContextMenuData({x: e.clientX, y: e.clientY});\n          }\n        },\n      })}\n    >\n      {children}\n    </div>\n  );\n}\n","import {DriveEntry} from '@app/drive/files/drive-entry';\nimport React, {useMemo} from 'react';\nimport {Table} from '@common/ui/tables/table';\nimport {\n  DriveSortDescriptor,\n  driveState,\n  useDriveStore,\n} from '@app/drive/drive-store';\nimport {FileTableRow} from '@app/drive/file-view/file-table/file-table-row';\nimport {useViewItemActionHandler} from '@app/drive/file-view/use-view-item-action-handler';\nimport {fileTableColumns} from '@app/drive/file-view/file-table/file-table-columns';\n\ninterface Props {\n  entries: DriveEntry[];\n}\nexport function FileTable({entries}: Props) {\n  const {performViewItemAction} = useViewItemActionHandler();\n  const selectedEntries = useDriveStore(s => s.selectedEntries);\n  const sortDescriptor = useDriveStore(s => s.sortDescriptor);\n\n  const selectedRows = useMemo(() => {\n    return [...selectedEntries];\n  }, [selectedEntries]);\n\n  return (\n    <Table\n      columns={fileTableColumns}\n      data={entries}\n      sortDescriptor={sortDescriptor}\n      onSortChange={value => {\n        driveState().setSortDescriptor(value as DriveSortDescriptor);\n      }}\n      onAction={performViewItemAction}\n      selectedRows={selectedRows}\n      selectionStyle=\"highlight\"\n      renderRowAs={FileTableRow}\n      onSelectionChange={value => {\n        driveState().selectEntries(value as number[]);\n      }}\n    />\n  );\n}\n","import {Trans} from '@ui/i18n/trans';\nimport {ContextMenu} from '@ui/menu/context-menu';\nimport {MenuItem} from '@ui/menu/menu-trigger';\nimport {createElement} from 'react';\nimport {DrivePage, RootFolderPage} from '@app/drive/drive-page/drive-page';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {EntryAction} from '@app/drive/entry-actions/entry-action';\nimport {useDrivePageActions} from '@app/drive/entry-actions/use-drive-page-actions';\nimport {useEntryActions} from '@app/drive/entry-actions/use-entry-actions';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {useSelectedEntries} from '@app/drive/files/use-selected-entries';\n\nexport function DriveContextMenu() {\n  const selectedEntries = useSelectedEntries();\n  const activePage = useDriveStore(s => s.activePage);\n  const data = useDriveStore(s => s.contextMenuData);\n  const entries = data?.entry ? [data.entry] : selectedEntries;\n\n  // right-clicked root folder\n  if (data?.entry?.id === 0) {\n    return <PageContextMenu position={data} page={RootFolderPage} />;\n  }\n\n  if (data && entries.length) {\n    return <EntriesContextMenu entries={entries} position={data} />;\n  }\n\n  if (data && activePage) {\n    return <PageContextMenu position={data} page={activePage} />;\n  }\n\n  return null;\n}\n\ninterface EntriesContextMenuProps {\n  position: {x: number; y: number};\n  entries: DriveEntry[];\n}\nfunction EntriesContextMenu({entries, position}: EntriesContextMenuProps) {\n  const actions = useEntryActions(entries);\n  return <BaseContextMenu position={position} actions={actions} />;\n}\n\ninterface PageContextMenuProps {\n  position: {x: number; y: number};\n  page: DrivePage;\n}\nfunction PageContextMenu({page, position}: PageContextMenuProps) {\n  const actions = useDrivePageActions(page);\n  return <BaseContextMenu position={position} actions={actions} />;\n}\n\ninterface BaseContextMenuProps {\n  position: {x: number; y: number};\n  actions: EntryAction[];\n}\nfunction BaseContextMenu({position, actions}: BaseContextMenuProps) {\n  return (\n    <ContextMenu\n      floatingMinWidth=\"min-w-224\"\n      position={position}\n      onOpenChange={isOpen => {\n        if (!isOpen) {\n          driveState().setContextMenuData(null);\n        }\n      }}\n    >\n      {actions.map(action => (\n        <MenuItem\n          value={action.key}\n          key={action.key}\n          onSelected={action.execute}\n          startIcon={createElement(action.icon)}\n        >\n          <Trans {...action.label} />\n        </MenuItem>\n      ))}\n    </ContextMenu>\n  );\n}\n","import {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {EntriesSortButton} from '@app/drive/layout/sorting/entries-sort-button';\nimport React from 'react';\n\ninterface DriveSortButtonProps {\n  isDisabled?: boolean;\n}\nexport function DriveSortButton({isDisabled}: DriveSortButtonProps) {\n  const descriptor = useDriveStore(s => s.sortDescriptor);\n  return (\n    <EntriesSortButton\n      isDisabled={isDisabled}\n      descriptor={descriptor}\n      onChange={value => {\n        driveState().setSortDescriptor(value);\n      }}\n    />\n  );\n}\n","import {\n  DrivePage,\n  makeFolderPage,\n  RootFolderPage,\n  SharesPage,\n  TrashPage,\n} from '@app/drive/drive-page/drive-page';\nimport {useDriveStore} from '@app/drive/drive-store';\nimport {EntryActionMenuTrigger} from '@app/drive/entry-actions/entry-action-menu-trigger';\nimport {useFolderPath} from '@app/drive/files/queries/use-folder-path';\nimport {useAuth} from '@common/auth/use-auth';\nimport {DashboardLayoutContext} from '@common/ui/dashboard-layout/dashboard-layout-context';\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\nimport {useActiveWorkspace} from '@common/workspace/active-workspace-id-context';\nimport {Breadcrumb} from '@ui/breadcrumbs/breadcrumb';\nimport {BreadcrumbItem} from '@ui/breadcrumbs/breadcrumb-item';\nimport {ButtonBase} from '@ui/buttons/button-base';\nimport {MessageDescriptor} from '@ui/i18n/message-descriptor';\nimport {MixedText} from '@ui/i18n/mixed-text';\nimport {ArrowDropDownIcon} from '@ui/icons/material/ArrowDropDown';\nimport {ReactNode, useContext} from 'react';\n\ninterface ItemConfig {\n  page: DrivePage;\n  label: MessageDescriptor | string;\n}\n\ninterface PageBreadcrumbsProps {\n  className?: string;\n}\nexport function PageBreadcrumbs({className}: PageBreadcrumbsProps) {\n  const {isMobileMode} = useContext(DashboardLayoutContext);\n  const navigate = useNavigate();\n  const page = useDriveStore(s => s.activePage);\n  const folder = page?.folder;\n  const query = useFolderPath({\n    hash: folder?.hash,\n    isEnabled: folder?.hash !== RootFolderPage.folder.hash,\n  });\n  const workspace = useActiveWorkspace();\n  const rootItem = useRootItem();\n  // wait until path, folder and workspace load fully\n  const isLoading =\n    !page ||\n    !workspace ||\n    (page.isFolderPage && !folder) ||\n    query.fetchStatus !== 'idle';\n\n  let content: ReactNode;\n\n  if (isLoading) {\n    content = null;\n  } else {\n    const items: ItemConfig[] = rootItem ? [rootItem] : [];\n\n    if (query.data) {\n      query.data.path.forEach(parent => {\n        items.push({\n          page: makeFolderPage(parent),\n          label: parent.name,\n        });\n      });\n    }\n\n    content = (\n      <Breadcrumb\n        className={className}\n        size={isMobileMode ? 'md' : 'lg'}\n        currentIsClickable\n      >\n        {items.map((item, index) => {\n          const isLast = index === items.length - 1;\n          if (!isLast) {\n            return (\n              <BreadcrumbItem\n                key={item.page.uniqueId}\n                onSelected={() => {\n                  navigate(item.page.path);\n                }}\n              >\n                <MixedText value={item.label} />\n              </BreadcrumbItem>\n            );\n          }\n\n          return (\n            <BreadcrumbItem key={item.page.uniqueId}>\n              {({isMenuItem}) => {\n                if (\n                  isMenuItem ||\n                  (!item.page.folder && item.page !== TrashPage)\n                ) {\n                  return <MixedText value={item.label} />;\n                }\n                return (\n                  <EntryActionMenuTrigger page={item.page} showIfNoActions>\n                    <ButtonBase className=\"flex items-center gap-2 rounded focus-visible:ring-offset-4\">\n                      <MixedText value={item.label} />\n                      <ArrowDropDownIcon className=\"text-muted icon-md\" />\n                    </ButtonBase>\n                  </EntryActionMenuTrigger>\n                );\n              }}\n            </BreadcrumbItem>\n          );\n        })}\n      </Breadcrumb>\n    );\n  }\n\n  return content;\n}\n\nfunction useRootItem(): ItemConfig | null {\n  const page = useDriveStore(s => s.activePage);\n  const workspace = useActiveWorkspace();\n  const {user} = useAuth();\n\n  if (!page) return null;\n\n  // in workspace\n  if (workspace && !workspace.default) {\n    if (\n      page?.isFolderPage &&\n      (page?.name === RootFolderPage.name ||\n        page.folder?.workspace_id === workspace.id)\n    ) {\n      return {label: workspace.name, page: RootFolderPage};\n    }\n  }\n\n  if (page?.isFolderPage) {\n    const owner = page.folder?.users.find(u => u.owns_entry);\n    // inside shared folder\n    if (owner?.id !== user?.id) {\n      return {label: SharesPage.label, page: SharesPage};\n    }\n    // if folder is currently active, root item will always be root folder page\n    return {label: RootFolderPage.label, page: RootFolderPage};\n  }\n\n  // if folder page is not active, we are already at the root\n  return {label: page.label, page};\n}\n","import {\n  BackendFilter,\n  FilterControlType,\n  FilterOperator,\n} from '@common/datatable/filters/backend-filter';\nimport {FILE_ENTRY_TYPE_FILTER} from '@common/admin/file-entry/file-entry-index-filters';\nimport {message} from '@ui/i18n/message';\nimport {\n  createdAtFilter,\n  updatedAtFilter,\n} from '@common/datatable/filters/timestamp-filters';\n\nexport const driveSearchFilters: BackendFilter[] = [\n  FILE_ENTRY_TYPE_FILTER,\n  {\n    key: 'owner_id',\n    label: message('Owner'),\n    description: message('User file was uploaded by'),\n    defaultOperator: FilterOperator.eq,\n    control: {\n      type: FilterControlType.Select,\n      defaultValue: '02',\n      options: [\n        {\n          key: '01',\n          label: message('anyone'),\n          value: {value: null, operator: '!='},\n        },\n        {\n          key: '02',\n          label: message('me'),\n          value: '{authId}',\n        },\n        {\n          key: '03',\n          label: message('not me'),\n          value: {value: '{authId}', operator: '!='},\n        },\n      ],\n    },\n  },\n  createdAtFilter({\n    description: message('Date file was uploaded'),\n  }),\n  updatedAtFilter({\n    description: message('Date file was last changed'),\n  }),\n  {\n    key: 'deleted_at',\n    label: message('In trash'),\n    description: message('Only show files that are in the trash'),\n    defaultOperator: FilterOperator.ne,\n    control: {\n      type: FilterControlType.BooleanToggle,\n      defaultValue: null,\n    },\n  },\n  {\n    key: 'shareableLink',\n    label: message('Has shareable link'),\n    description: message('Only show files that have a shareable link'),\n    defaultOperator: FilterOperator.has,\n    control: {\n      type: FilterControlType.BooleanToggle,\n      defaultValue: '*',\n    },\n  },\n  {\n    control: {\n      type: FilterControlType.BooleanToggle,\n      defaultValue: true,\n    },\n    key: 'sharedByMe',\n    label: message('Shared by me'),\n    description: message('Only show files that are shared with someone'),\n    defaultOperator: FilterOperator.eq,\n  },\n];\n","import React, {useContext, useState} from 'react';\nimport {driveSearchFilters} from '@app/drive/search/drive-search-filters';\nimport {useDriveStore} from '@app/drive/drive-store';\nimport {SearchPage} from '@app/drive/drive-page/drive-page';\nimport {TextField} from '@ui/forms/input-field/text-field/text-field';\nimport {SearchIcon} from '@ui/icons/material/Search';\nimport {FilterList} from '@common/datatable/filters/filter-list/filter-list';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {useSearchParams} from 'react-router';\nimport {message} from '@ui/i18n/message';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {DashboardLayoutContext} from '@common/ui/dashboard-layout/dashboard-layout-context';\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\n\nconst alwaysShownFilters = driveSearchFilters.map(f => f.key);\n\nexport function SearchFilterList() {\n  const activePage = useDriveStore(s => s.activePage);\n  const {isMobileMode} = useContext(DashboardLayoutContext);\n  const {trans} = useTrans();\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const [inputValue, setInputValue] = useState(searchParams.get('query') || '');\n\n  if (activePage !== SearchPage) {\n    return null;\n  }\n\n  return (\n    <div className=\"mb-30 mt-10 px-10 md:px-26\">\n      {isMobileMode && (\n        <form\n          className=\"contents\"\n          onSubmit={e => {\n            e.preventDefault();\n            // blur input so mobile keyboard is hidden\n            if (document.activeElement?.tagName === 'INPUT') {\n              (document.activeElement as HTMLInputElement).blur();\n            }\n            navigate(\n              {\n                pathname: SearchPage.path,\n                search: `?query=${inputValue}`,\n              },\n              {replace: true},\n            );\n          }}\n        >\n          <TextField\n            autoFocus\n            className=\"mb-20\"\n            startAdornment={\n              <IconButton type=\"submit\">\n                <SearchIcon />\n              </IconButton>\n            }\n            placeholder={trans(message('Type to search'))}\n            value={inputValue}\n            onChange={e => setInputValue(e.target.value)}\n          />\n        </form>\n      )}\n      <FilterList\n        filters={driveSearchFilters}\n        pinnedFilters={alwaysShownFilters}\n      />\n    </div>\n  );\n}\n","import {UseSuspenseInfiniteQueryResult} from '@tanstack/react-query';\nimport {UseInfiniteQueryResult} from '@tanstack/react-query/src/types';\nimport {opacityAnimation} from '@ui/animation/opacity-animation';\nimport {Button} from '@ui/buttons/button';\nimport {Trans} from '@ui/i18n/trans';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport React, {ReactNode, useEffect, useRef, useState} from 'react';\n\nexport interface InfiniteScrollSentinelProps {\n  loaderMarginTop?: string;\n  children?: ReactNode;\n  loadMoreExtraContent?: ReactNode;\n  query: UseInfiniteQueryResult | UseSuspenseInfiniteQueryResult;\n  style?: React.CSSProperties;\n  className?: string;\n  variant?: 'infiniteScroll' | 'loadMore';\n  size?: 'sm' | 'md';\n}\nexport function InfiniteScrollSentinel({\n  query: {isInitialLoading, fetchNextPage, isFetchingNextPage, hasNextPage},\n  children,\n  loaderMarginTop = 'mt-24',\n  style,\n  className,\n  variant: _variant = 'infiniteScroll',\n  loadMoreExtraContent,\n  size = 'sm',\n}: InfiniteScrollSentinelProps) {\n  const sentinelRef = useRef<HTMLDivElement>(null);\n  const isLoading = isFetchingNextPage || isInitialLoading;\n  const [loadMoreClickCount, setLoadMoreClickCount] = useState(0);\n  const innerVariant =\n    _variant === 'loadMore' && loadMoreClickCount < 3\n      ? 'loadMore'\n      : 'infiniteScroll';\n\n  // don't lazy load unless sentinel has left the view after last lazy load\n  // 1. will prevent lazy loading until initial data is rendered and pushes sentinel out of view\n  // 2. when sentinel is top (chat interface) prevent load until container is scrolled to the bottom\n  // 3. when sentinel is bottom, prevent double lazy load if \"isLoading\" is false, but sentinel is still in view\n  const leftViewAfterLoading = useRef(false);\n\n  useEffect(() => {\n    const sentinelEl = sentinelRef.current;\n    if (!sentinelEl || innerVariant === 'loadMore') return;\n    const observer = new IntersectionObserver(([entry]) => {\n      if (entry.isIntersecting) {\n        if (!leftViewAfterLoading.current) return;\n\n        if (hasNextPage && !isLoading) {\n          leftViewAfterLoading.current = false;\n          fetchNextPage();\n        }\n      } else {\n        leftViewAfterLoading.current = true;\n      }\n    });\n\n    observer.observe(sentinelEl);\n    return () => {\n      observer.unobserve(sentinelEl);\n    };\n  }, [fetchNextPage, hasNextPage, isLoading, innerVariant]);\n\n  let content: ReactNode;\n\n  if (children) {\n    // children might already be wrapped in AnimatePresence, so only wrap default loader with it\n    content = isFetchingNextPage ? children : null;\n  } else if (innerVariant === 'loadMore') {\n    content = !isInitialLoading && hasNextPage && (\n      <div className={clsx('flex items-center gap-8', loaderMarginTop)}>\n        {loadMoreExtraContent}\n        <Button\n          size={size === 'md' ? 'sm' : 'xs'}\n          className={clsx(\n            size === 'sm' ? 'min-h-24 min-w-96' : 'min-h-36 min-w-112',\n          )}\n          variant=\"outline\"\n          color=\"primary\"\n          onClick={() => {\n            fetchNextPage();\n            setLoadMoreClickCount(loadMoreClickCount + 1);\n          }}\n          disabled={isLoading}\n        >\n          {loadMoreClickCount >= 2 && !isFetchingNextPage ? (\n            <Trans message=\"Load all\" />\n          ) : (\n            <Trans message=\"Show more\" />\n          )}\n        </Button>\n      </div>\n    );\n  } else {\n    content = (\n      <AnimatePresence>\n        {isFetchingNextPage && (\n          <m.div\n            className={clsx('flex w-full justify-center', loaderMarginTop)}\n            {...opacityAnimation}\n          >\n            <ProgressCircle size={size} isIndeterminate aria-label=\"loading\" />\n          </m.div>\n        )}\n      </AnimatePresence>\n    );\n  }\n\n  return (\n    <div\n      style={style}\n      className={clsx('w-full', className, hasNextPage && 'min-h-36')}\n      role=\"presentation\"\n    >\n      <div ref={sentinelRef} aria-hidden />\n      {content}\n    </div>\n  );\n}\n","import {InteractableRect} from '../interactable-event';\n\nexport function rectsIntersect(\n  rectA?: InteractableRect,\n  rectB?: InteractableRect\n) {\n  if (!rectA || !rectB) return false;\n  return (\n    rectA.left <= rectB.left + rectB.width &&\n    rectA.left + rectA.width >= rectB.left &&\n    rectA.top <= rectB.top + rectB.height &&\n    rectA.top + rectA.height >= rectB.top\n  );\n}\n","import {InteractableRect} from '../interactable-event';\n\nexport function restrictResizableWithinBoundary(\n  rect: InteractableRect,\n  boundaryRect: InteractableRect\n) {\n  const boundedRect = {...rect};\n\n  // restrict to left edge of boundary\n  boundedRect.left = Math.max(0, boundedRect.left);\n  // compensate width when left is bounded\n  const leftRestriction = boundedRect.left - rect.left;\n  if (leftRestriction > 0) {\n    boundedRect.width -= leftRestriction;\n  }\n\n  // restrict to top edge of boundary\n  boundedRect.top = Math.max(0, boundedRect.top);\n  // compensate height when top is bounded\n  const topRestriction = boundedRect.top - rect.top;\n  if (topRestriction > 0) {\n    boundedRect.height -= topRestriction;\n  }\n\n  // restrict to right edge of boundary\n  boundedRect.width = Math.min(\n    boundedRect.width,\n    boundaryRect.width - boundedRect.left\n  );\n\n  // restrict to bottom edge of boundary\n  boundedRect.height = Math.min(\n    boundedRect.height,\n    boundaryRect.height - boundedRect.top\n  );\n\n  return boundedRect;\n}\n","import React, { RefObject, useRef } from 'react';\nimport { activeInteraction } from '../../active-interaction';\nimport { InteractableRect } from '../../interactable-event';\nimport { usePointerEvents } from '../../use-pointer-events';\nimport { rectsIntersect } from '../../utils/rects-intersect';\nimport { restrictResizableWithinBoundary } from '../../utils/restrict-resizable-within-boundary';\nimport { updateRects } from '../update-rects';\nimport { DraggableId } from '../use-draggable';\nimport { mouseSelectables } from './use-mouse-selectable';\n\ninterface SelectionState {\n  startPoint?: {x: number; y: number; scrollTop: number};\n  endPoint?: {x: number; y: number};\n  boundaryRect?: InteractableRect & {heightWithoutScroll: number};\n  scrollListener?: EventListener;\n  rafId?: number;\n  selectedIds?: Set<DraggableId>;\n}\n\ninterface Props {\n  onPointerDown?: (e: React.PointerEvent) => void;\n  containerRef?: RefObject<HTMLDivElement | null>;\n}\nexport function useMouseSelectionBox({onPointerDown, ...props}: Props = {}) {\n  const defaultRef = useRef<HTMLDivElement>(null);\n  const containerRef = props.containerRef || defaultRef;\n  const boxRef = useRef<HTMLDivElement>(null);\n\n  let state = useRef<SelectionState>({}).current;\n\n  const drawSelectionBox = () => {\n    if (state.rafId) {\n      cancelAnimationFrame(state.rafId);\n    }\n\n    if (!state.startPoint || !state.endPoint || !state.boundaryRect) return;\n\n    const startPoint = state.startPoint;\n    const endPoint = state.endPoint;\n    const initialScrollTop = startPoint.scrollTop || 0;\n    const currentScrollTop = containerRef.current?.scrollTop || 0;\n\n    const newRect = {\n      left: Math.min(startPoint.x, endPoint.x),\n      top: Math.min(startPoint.y, endPoint.y),\n      width: Math.abs(startPoint.x - endPoint.x),\n      height: Math.abs(startPoint.y - endPoint.y),\n    };\n\n    // convert box coords to be relative to container and not viewport\n    newRect.left -= state.boundaryRect.left;\n    newRect.top -= state.boundaryRect.top;\n\n    // take initial scroll of container into account\n    newRect.top += initialScrollTop;\n\n    // scroll diff between drag start and now (auto scroll or mouse wheel)\n    const scrollDiff = currentScrollTop - initialScrollTop;\n    const scrollValue = Math.abs(scrollDiff);\n\n    // top needs to be changed only if scroll direction is top\n    if (scrollDiff < 0) {\n      newRect.top -= scrollValue;\n    }\n\n    // height needs to be changed regardless of direction and method\n    newRect.height += scrollValue;\n\n    const boundedRect = state.boundaryRect\n      ? restrictResizableWithinBoundary(newRect, state.boundaryRect)\n      : {...newRect};\n\n    if (boxRef.current) {\n      state.rafId = requestAnimationFrame(() => {\n        if (boxRef.current) {\n          boxRef.current.style.display = `block`;\n          boxRef.current.style.transform = `translate(${boundedRect.left}px, ${boundedRect.top}px)`;\n          boxRef.current.style.width = `${boundedRect.width}px`;\n          boxRef.current.style.height = `${boundedRect.height}px`;\n        }\n        state.rafId = undefined;\n      });\n    }\n\n    // convert rect back to absolute for intersection testing\n    const absoluteRect = {\n      ...boundedRect,\n      left: boundedRect.left + state.boundaryRect.left,\n      top: boundedRect.top + state.boundaryRect.top - currentScrollTop,\n    };\n\n    for (const [, selectable] of mouseSelectables) {\n      const intersect = rectsIntersect(selectable.rect, absoluteRect);\n      if (intersect && !state.selectedIds?.has(selectable.id)) {\n        state.selectedIds?.add(selectable.id);\n        selectable.onSelected?.();\n      } else if (!intersect && state.selectedIds?.has(selectable.id)) {\n        state.selectedIds?.delete(selectable.id);\n        selectable.onDeselected?.();\n      }\n    }\n  };\n\n  const pointerEvents = usePointerEvents({\n    minimumMovement: 4,\n    onPointerDown,\n    onMoveStart: e => {\n      if (activeInteraction) {\n        return false;\n      }\n      updateRects(mouseSelectables);\n      state = {\n        selectedIds: new Set(),\n      };\n      const el = containerRef.current;\n      state.startPoint = {\n        x: e.clientX,\n        y: e.clientY,\n        scrollTop: el?.scrollTop || 0,\n      };\n\n      state.scrollListener = e => {\n        if (!state.startPoint) return;\n        // update rects on scroll, because we are using relative position\n        updateRects(mouseSelectables);\n        if (state.boundaryRect?.height) {\n          state.boundaryRect.height = (e.target as HTMLElement).scrollHeight;\n        }\n        // draw selection box (for autoscroll and mousewheel)\n        drawSelectionBox();\n      };\n\n      if (el) {\n        const rect = el.getBoundingClientRect();\n        el.addEventListener('scroll', state.scrollListener);\n        state.boundaryRect = {\n          top: rect.top,\n          left: rect.left,\n          height: el.scrollHeight,\n          heightWithoutScroll: rect.height,\n          width: el.scrollWidth,\n        };\n      }\n    },\n    onMove: e => {\n      state.endPoint = {x: e.clientX, y: e.clientY};\n\n      if (state.boundaryRect && containerRef.current) {\n        const reachedBottomEdge =\n          e.clientY + 20 >\n          state.boundaryRect.heightWithoutScroll + state.boundaryRect.top;\n        const reachedTopEdge = e.clientY - 20 < state.boundaryRect.top;\n\n        if (reachedBottomEdge) {\n          containerRef.current.scrollBy({top: 10});\n        } else if (reachedTopEdge) {\n          containerRef.current.scrollBy({top: -10});\n        }\n      }\n\n      drawSelectionBox();\n    },\n    onMoveEnd: () => {\n      if (state.rafId) {\n        cancelAnimationFrame(state.rafId);\n      }\n      if (containerRef.current && state.scrollListener) {\n        containerRef.current.removeEventListener(\n          'scroll',\n          state.scrollListener\n        );\n      }\n      if (boxRef.current) {\n        boxRef.current.style.display = `none`;\n        boxRef.current.style.transform = '';\n        boxRef.current.style.width = '';\n        boxRef.current.style.height = '';\n      }\n      state = {};\n    },\n  });\n\n  return {\n    containerProps: {\n      ...pointerEvents.domProps,\n      ref: containerRef,\n    },\n    boxProps: {ref: boxRef},\n  };\n}\n","import {TrashPage} from '@app/drive/drive-page/drive-page';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {DropTargetMask} from '@app/drive/drop-target-mask';\nimport {EntryActionList} from '@app/drive/entry-actions/entry-action-list';\nimport {FileGrid} from '@app/drive/file-view/file-grid/file-grid';\nimport {FileTable} from '@app/drive/file-view/file-table/file-table';\nimport {DriveContextMenu} from '@app/drive/files/drive-context-menu';\nimport {useActivePageEntries} from '@app/drive/files/queries/use-active-page-entries';\nimport {useDeleteEntries} from '@app/drive/files/queries/use-delete-entries';\nimport {getSelectedEntries} from '@app/drive/files/use-selected-entries';\nimport {DriveSortButton} from '@app/drive/layout/sorting/drive-sort-button';\nimport {PageBreadcrumbs} from '@app/drive/page-breadcrumbs';\nimport {SearchFilterList} from '@app/drive/search/search-filter-list';\nimport {useDriveUploadQueue} from '@app/drive/uploading/use-drive-upload-queue';\nimport {AdHost} from '@common/admin/ads/ad-host';\nimport {DashboardLayoutContext} from '@common/ui/dashboard-layout/dashboard-layout-context';\nimport {InfiniteScrollSentinel} from '@common/ui/infinite-scroll/infinite-scroll-sentinel';\nimport {mergeProps} from '@react-aria/utils';\nimport {Trans} from '@ui/i18n/trans';\nimport {IllustratedMessage} from '@ui/images/illustrated-message';\nimport {SvgImage} from '@ui/images/svg-image';\nimport {useMouseSelectionBox} from '@ui/interactions/dnd/mouse-selection/use-mouse-selection-box';\nimport {MixedDraggable} from '@ui/interactions/dnd/use-draggable';\nimport {useDroppable} from '@ui/interactions/dnd/use-droppable';\nimport {createEventHandler} from '@ui/utils/dom/create-event-handler';\nimport {isCtrlKeyPressed} from '@ui/utils/keybinds/is-ctrl-key-pressed';\nimport clsx from 'clsx';\nimport {\n  KeyboardEventHandler,\n  MouseEventHandler,\n  ReactNode,\n  useContext,\n  useRef,\n  useState,\n} from 'react';\nimport {useSearchParams} from 'react-router';\n\ninterface FileViewProps {\n  className?: string;\n}\nexport function FileView({className}: FileViewProps) {\n  const [params] = useSearchParams();\n  const isSearchingOrFiltering =\n    !!params.get('query') || !!params.get('filters');\n  const containerRef = useRef<HTMLDivElement>(null);\n  const query = useActivePageEntries();\n  const {uploadFiles} = useDriveUploadQueue();\n  const deleteEntries = useDeleteEntries();\n  const activePage = useDriveStore(s => s.activePage);\n  const [isDragOver, setIsDragOver] = useState(false);\n  const viewMode = useDriveStore(s => s.viewMode);\n  const {isMobileMode} = useContext(DashboardLayoutContext);\n\n  const {containerProps, boxProps} = useMouseSelectionBox({\n    containerRef,\n    onPointerDown: e => {\n      if (!(e.target as HTMLElement).closest('.entry-action-list')) {\n        driveState().deselectEntries('all');\n      }\n    },\n  });\n\n  const {droppableProps} = useDroppable({\n    id: 'driveRoot',\n    ref: containerRef,\n    types: ['nativeFile'],\n    disabled: !activePage?.canUpload,\n    onDragEnter: () => {\n      setIsDragOver(true);\n    },\n    onDragLeave: () => {\n      setIsDragOver(false);\n    },\n    onDrop: async (draggable: MixedDraggable) => {\n      if (draggable.type === 'nativeFile') {\n        uploadFiles(await draggable.getData());\n      }\n    },\n  });\n\n  if (!activePage) return null;\n\n  let content: ReactNode;\n  if (query.isEmpty && (!query.isLoading || query.fetchStatus === 'idle')) {\n    const noContentMessage = activePage.noContentMessage(\n      isSearchingOrFiltering,\n    );\n    content = (\n      <IllustratedMessage\n        className=\"mt-40\"\n        image={<SvgImage src={noContentMessage.image} />}\n        title={<Trans {...noContentMessage.title} />}\n        description={<Trans {...noContentMessage.description} />}\n      />\n    );\n  } else if (!query.isLoading) {\n    content =\n      viewMode === 'list' ? (\n        <FileTable entries={query.items} />\n      ) : (\n        <FileGrid entries={query.items} />\n      );\n  }\n\n  const handleContextMenu: MouseEventHandler = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    driveState().deselectEntries('all');\n    driveState().setContextMenuData({x: e.clientX, y: e.clientY});\n  };\n\n  const handleKeybinds: KeyboardEventHandler = e => {\n    if (e.key === 'a' && isCtrlKeyPressed(e)) {\n      e.preventDefault();\n      e.stopPropagation();\n      driveState().selectEntries(query.items.map(entry => entry.id));\n    }\n    if (e.key === 'Delete') {\n      e.preventDefault();\n      e.stopPropagation();\n      if (driveState().selectedEntries.size && !deleteEntries.isPending) {\n        if (activePage === TrashPage) {\n          driveState().setActiveActionDialog(\n            'confirmAndDeleteForever',\n            getSelectedEntries(),\n          );\n        } else {\n          deleteEntries.mutate({\n            entryIds: [...driveState().selectedEntries],\n            deleteForever: activePage === TrashPage,\n          });\n          driveState().selectEntries([]);\n        }\n      }\n    }\n  };\n\n  return (\n    <div\n      className={clsx(\n        'compact-scrollbar relative flex-auto overflow-y-auto outline-none stable-scrollbar',\n        className,\n      )}\n      tabIndex={-1}\n      {...mergeProps(containerProps, droppableProps, {\n        onKeyDown: createEventHandler(handleKeybinds),\n      })}\n      onContextMenu={handleContextMenu}\n    >\n      <div className=\"relative flex min-h-full flex-col pt-10\">\n        {isMobileMode ? (\n          <PageBreadcrumbs className=\"mb-10 px-14\" />\n        ) : (\n          <Toolbar />\n        )}\n        <SearchFilterList />\n        <div className=\"relative flex-auto px-18 pb-18 md:px-24\">\n          <AdHost slot=\"drive\" className=\"mb-24\" />\n          {content}\n          <InfiniteScrollSentinel query={query} />\n        </div>\n        <div\n          {...boxProps}\n          className=\"pointer-events-none absolute left-0 top-0 z-10 hidden border border-primary-light bg-primary-light/20 shadow-md\"\n        />\n        <DriveContextMenu />\n        <DropTargetMask isVisible={isDragOver} />\n      </div>\n    </div>\n  );\n}\n\nfunction Toolbar() {\n  const activePage = useDriveStore(s => s.activePage);\n  return (\n    <div className=\"my-10 flex min-h-42 items-center justify-between gap-40 px-10 text-muted md:px-18\">\n      <DriveSortButton isDisabled={activePage?.disableSort} />\n      <EntryActionList className=\"text-muted\" />\n    </div>\n  );\n}\n","import {appQueries} from '@app/app-queries';\nimport {ShareableLink} from '@app/drive/shareable-link/shareable-link';\nimport {useQuery} from '@tanstack/react-query';\n\nexport type FetchShareableLinkResponse = {\n  link: ShareableLink | null;\n};\n\nexport function useEntryShareableLink(entryId: number) {\n  return useQuery({\n    ...appQueries.shareableLinks.getEntryShareableLink(entryId),\n    enabled: !!entryId,\n  });\n}\n","import {appQueries} from '@app/app-queries';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {useMutation} from '@tanstack/react-query';\nimport {UseFormReturn} from 'react-hook-form';\nimport {FetchShareableLinkResponse} from './use-entry-shareable-link';\n\nexport type UpdateShareableLinkPayload = {\n  allowEdit: boolean;\n  allowDownload: boolean;\n  allowDirect: boolean;\n  expiresAt: string;\n  password: string;\n  entryId: number;\n};\n\nfunction updateShareableLink({\n  entryId,\n  ...payload\n}: UpdateShareableLinkPayload): Promise<FetchShareableLinkResponse> {\n  return apiClient\n    .put(`file-entries/${entryId}/shareable-link`, payload)\n    .then(response => response.data);\n}\n\nexport function useUpdateShareableLink(\n  form: UseFormReturn<UpdateShareableLinkPayload>,\n) {\n  return useMutation({\n    mutationFn: (payload: UpdateShareableLinkPayload) =>\n      updateShareableLink(payload),\n    onSuccess: (data, {entryId}) => {\n      queryClient.setQueryData<FetchShareableLinkResponse>(\n        appQueries.shareableLinks.getEntryShareableLink(entryId).queryKey,\n        data,\n      );\n    },\n    onError: r => onFormQueryError(r, form),\n  });\n}\n","import type {ShareDialogActivePanel} from '@app/drive/share-dialog/share-dialog';\nimport {useEntryShareableLink} from '@app/drive/shareable-link/queries/use-entry-shareable-link';\nimport {\n  UpdateShareableLinkPayload,\n  useUpdateShareableLink,\n} from '@app/drive/shareable-link/queries/use-update-shareable-link';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport {getLocalTimeZone, now} from '@internationalized/date';\nimport {Button} from '@ui/buttons/button';\nimport {Form} from '@ui/forms/form';\nimport {FormDatePicker} from '@ui/forms/input-field/date/date-picker/date-picker';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {FormSwitch, Switch} from '@ui/forms/toggle/switch';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {ArrowBackIcon} from '@ui/icons/material/ArrowBack';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {DialogFooter} from '@ui/overlays/dialog/dialog-footer';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {useSettings} from '@ui/settings/use-settings';\nimport {toast} from '@ui/toast/toast';\nimport clsx from 'clsx';\nimport {m} from 'framer-motion';\nimport {Fragment, ReactElement, useState} from 'react';\nimport {useForm} from 'react-hook-form';\n\ninterface LinkSettingsDialogProps {\n  className?: string;\n  setActivePanel: (name: ShareDialogActivePanel) => void;\n  entry: FileEntry;\n}\nexport function LinkSettingsDialog({\n  className,\n  setActivePanel,\n  entry,\n}: LinkSettingsDialogProps) {\n  const {drive} = useSettings();\n  const enableDirectLinks = drive?.direct_links ?? false;\n  const {formId} = useDialogContext();\n  const {data} = useEntryShareableLink(entry.id);\n  const link = data?.link;\n  const form = useForm<UpdateShareableLinkPayload>({\n    defaultValues: {\n      allowDownload: link?.allow_download,\n      allowEdit: link?.allow_edit,\n      allowDirect: link?.allow_direct,\n      expiresAt: link?.expires_at,\n      entryId: entry.id,\n    },\n  });\n  const updateLink = useUpdateShareableLink(form);\n\n  return (\n    <Fragment>\n      <DialogHeader\n        onDismiss={() => {\n          setActivePanel('main');\n        }}\n      >\n        <Trans message=\"Shareable Link Settings\" />\n      </DialogHeader>\n      <DialogBody>\n        <m.div\n          key=\"link-settings-content\"\n          className=\"min-h-[335px]\"\n          animate={{opacity: 1, y: 0}}\n          initial={{opacity: 0, y: 20}}\n          exit={{opacity: 0, y: -20}}\n          transition={{duration: 0.1}}\n        >\n          <Form\n            id={formId}\n            className={className}\n            form={form}\n            onSubmit={value => {\n              updateLink.mutate(value, {\n                onSuccess: () => {\n                  setActivePanel('main');\n                  toast(message('Link settings saved'));\n                },\n              });\n            }}\n          >\n            <LinkExpirationOption showField={!!link?.expires_at} />\n            <LinkPasswordOption showField={!!link?.password} />\n            <LinkOption>\n              <Trans message=\"Allow download\" />\n              <FormSwitch name=\"allowDownload\">\n                <Trans message=\"Users with link can download this item\" />\n              </FormSwitch>\n            </LinkOption>\n            <LinkOption showBorder={enableDirectLinks}>\n              <Trans message=\"Allow import\" />\n              <FormSwitch name=\"allowEdit\">\n                <Trans message=\"Users with link can import this item into their own drive\" />\n              </FormSwitch>\n            </LinkOption>\n            {enableDirectLinks && (\n              <LinkOption showBorder={false}>\n                <Trans message=\"Allow direct access\" />\n                <FormSwitch name=\"allowDirect\">\n                  <Trans message=\"Allow accessing contents of the file directly using this link\" />\n                </FormSwitch>\n              </LinkOption>\n            )}\n          </Form>\n        </m.div>\n      </DialogBody>\n      <DialogFooter>\n        <Button\n          type=\"button\"\n          startIcon={<ArrowBackIcon />}\n          onClick={() => {\n            setActivePanel('main');\n          }}\n        >\n          <Trans message=\"Back\" />\n        </Button>\n        <Button\n          type=\"submit\"\n          form={formId}\n          variant=\"flat\"\n          color=\"primary\"\n          disabled={updateLink.isPending}\n        >\n          <Trans message=\"Save\" />\n        </Button>\n      </DialogFooter>\n    </Fragment>\n  );\n}\n\nconst minDate = now(getLocalTimeZone());\n\ninterface LinkExpirationOptionProps {\n  showField: boolean;\n}\nfunction LinkExpirationOption({\n  showField: showFieldDefault,\n}: LinkExpirationOptionProps) {\n  const {trans} = useTrans();\n  const [showField, setShowField] = useState(showFieldDefault);\n  return (\n    <LinkOption>\n      <Trans message=\"Link expiration\" />\n      <div>\n        <Switch\n          checked={showField}\n          onChange={e => {\n            setShowField(e.target.checked);\n          }}\n        >\n          <Trans message=\"Link is valid until\" />\n        </Switch>\n        {showField && (\n          <FormDatePicker\n            min={minDate}\n            name=\"expiresAt\"\n            granularity=\"minute\"\n            className=\"mt-20\"\n            aria-label={trans({\n              message: 'Link expiration date and time',\n            })}\n          />\n        )}\n      </div>\n    </LinkOption>\n  );\n}\n\ninterface LinkPasswordOptionProps {\n  showField: boolean;\n}\nfunction LinkPasswordOption({\n  showField: showFieldDefault,\n}: LinkPasswordOptionProps) {\n  const {trans} = useTrans();\n  const [showField, setShowField] = useState(showFieldDefault);\n  return (\n    <LinkOption>\n      <Trans message=\"Password protect\" />\n      <div>\n        <Switch\n          checked={showField}\n          onChange={e => {\n            setShowField(e.target.checked);\n          }}\n        >\n          <Trans message=\"Users will need to enter password in order to view this link\" />\n        </Switch>\n        {showField && (\n          <FormTextField\n            type=\"password\"\n            autoFocus\n            name=\"password\"\n            className=\"mt-20\"\n            aria-label={trans({message: 'Link password'})}\n            description={\n              <Trans message=\"Password will not be requested when viewing the link as file owner.\" />\n            }\n            placeholder={trans({\n              message: 'Enter new password...',\n            })}\n          />\n        )}\n      </div>\n    </LinkOption>\n  );\n}\n\ninterface LinkOptionProps {\n  children: [ReactElement, ReactElement];\n  showBorder?: boolean;\n}\nfunction LinkOption({children, showBorder = true}: LinkOptionProps) {\n  const [title, content] = children;\n  return (\n    <div className={clsx(showBorder && 'mb-20 border-b pb-20')}>\n      <div className=\"mb-8 text-sm font-medium\">{title}</div>\n      {content}\n    </div>\n  );\n}\n","import {appQueries} from '@app/app-queries';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {FetchShareableLinkResponse} from './use-entry-shareable-link';\n\ninterface DeleteLinkParams {\n  entryId: number;\n}\n\nfunction deleteShareableLink({\n  entryId,\n}: DeleteLinkParams): Promise<BackendResponse> {\n  return apiClient\n    .delete(`file-entries/${entryId}/shareable-link`)\n    .then(r => r.data);\n}\n\ninterface Payload {\n  entryId: number;\n}\nexport function useDeleteShareableLink() {\n  return useMutation({\n    mutationFn: ({entryId}: Payload) => deleteShareableLink({entryId}),\n    onSuccess: (response, {entryId}) => {\n      queryClient.setQueryData<FetchShareableLinkResponse>(\n        appQueries.shareableLinks.getEntryShareableLink(entryId).queryKey,\n        {...response, link: null},\n      );\n    },\n    onError: err => showHttpErrorToast(err, message('Could not delete link')),\n  });\n}\n","export function randomString(length: number = 36) {\n  let random = '';\n  const possible =\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n  for (let i = 0; i < length; i += 1) {\n    random += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n\n  return random;\n}\n","import {useActiveDialogEntry} from '@app/drive/drive-store';\nimport {\n  getDirectLink,\n  getShareableLink,\n} from '@app/drive/entry-actions/get-public-access-link';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport type {ShareDialogActivePanel} from '@app/drive/share-dialog/share-dialog';\nimport {useCreateShareableLink} from '@app/drive/shareable-link/queries/create-shareable-link';\nimport {useDeleteShareableLink} from '@app/drive/shareable-link/queries/use-delete-shareable-link';\nimport {useEntryShareableLink} from '@app/drive/shareable-link/queries/use-entry-shareable-link';\nimport {ShareableLink} from '@app/drive/shareable-link/shareable-link';\nimport {Button} from '@ui/buttons/button';\nimport {TextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Switch} from '@ui/forms/toggle/switch';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {ContentCopyIcon} from '@ui/icons/material/ContentCopy';\nimport {useSettings} from '@ui/settings/use-settings';\nimport useClipboard from '@ui/utils/hooks/use-clipboard';\nimport {randomString} from '@ui/utils/string/random-string';\n\ninterface ShareableLinkPanelProps {\n  setActivePanel: (name: ShareDialogActivePanel) => void;\n  entry: DriveEntry;\n}\nexport function ShareableLinkPanel({\n  setActivePanel,\n  entry,\n}: ShareableLinkPanelProps) {\n  const query = useEntryShareableLink(entry.id);\n  const linkExists = !!query.data?.link;\n  const createLink = useCreateShareableLink();\n  const deleteLink = useDeleteShareableLink();\n  const isLoading =\n    query.isLoading || createLink.isPending || deleteLink.isPending;\n  return (\n    <div>\n      <div className=\"mb-14 font-semibold\">\n        <Trans message=\"Public access\" />\n      </div>\n      <div className=\"flex items-center justify-between gap-14 px-2 pb-4\">\n        <Switch\n          checked={linkExists}\n          disabled={isLoading}\n          onChange={() => {\n            if (linkExists) {\n              deleteLink.mutate({entryId: entry.id});\n            } else {\n              createLink.mutate({entryId: entry.id, enableDirectLinks: true});\n            }\n          }}\n        >\n          {linkExists ? (\n            <Trans message=\"Shareable link is created\" />\n          ) : (\n            <Trans message=\"Create shareable link\" />\n          )}\n        </Switch>\n        {linkExists && (\n          <Button\n            variant=\"link\"\n            color=\"primary\"\n            onClick={() => {\n              setActivePanel('linkSettings');\n            }}\n          >\n            <Trans message=\"Link settings\" />\n          </Button>\n        )}\n      </div>\n      <ShareableLinkInput link={query.data?.link} />\n    </div>\n  );\n}\n\ninterface ShareableLinkInputProps {\n  link?: ShareableLink | null;\n}\nfunction ShareableLinkInput({link}: ShareableLinkInputProps) {\n  const {drive} = useSettings();\n  const {trans} = useTrans();\n  const entry = useActiveDialogEntry();\n  const hash = link?.hash || entry?.hash || randomString();\n  const linkUrl = getShareableLink(hash);\n  const [isCopied, setCopied] = useClipboard(linkUrl, {\n    successDuration: 1000,\n  });\n  return (\n    <div>\n      <TextField\n        disabled={!link}\n        className=\"mt-10\"\n        readOnly\n        value={linkUrl}\n        aria-label={trans({message: 'Shareable link'})}\n        onFocus={e => {\n          (e.target as HTMLInputElement).select();\n        }}\n        endAdornment={\n          <Button\n            className=\"mr-6\"\n            size=\"xs\"\n            variant=\"flat\"\n            color=\"primary\"\n            onClick={setCopied}\n            startIcon={<ContentCopyIcon />}\n          >\n            {isCopied ? <Trans message=\"Copied!\" /> : <Trans message=\"Copy\" />}\n          </Button>\n        }\n      />\n      {link && entry && drive?.direct_links && entry.type !== 'folder' ? (\n        <CopyDirectLinkButton link={link} entry={entry} />\n      ) : null}\n    </div>\n  );\n}\n\ntype CopyDirectLinkButtonProps = {\n  link: ShareableLink;\n  entry: DriveEntry;\n};\nfunction CopyDirectLinkButton({link, entry}: CopyDirectLinkButtonProps) {\n  const [isCopied, setCopied] = useClipboard(getDirectLink(link, entry), {\n    successDuration: 1000,\n  });\n  return (\n    <Button\n      variant=\"outline\"\n      className=\"mt-10\"\n      size=\"xs\"\n      onClick={() => setCopied()}\n    >\n      {isCopied ? (\n        <Trans message=\"Copied direct link!\" />\n      ) : (\n        <Trans message=\"Copy direct link\" />\n      )}\n    </Button>\n  );\n}\n","const matcher =\n  /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n\nexport function isEmail(string?: string): boolean {\n  if (!string) return false;\n  if (string.length > 320) return false;\n  return matcher.test(string);\n}\n","import {FileEntry} from '@common/uploads/file-entry';\n\nexport interface DriveEntry extends FileEntry {\n  users: DriveEntryUser[];\n  workspace_id?: number;\n  permissions: {\n    'files.create': boolean;\n    'files.update': boolean;\n    'files.delete': boolean;\n    'files.download': boolean;\n  };\n}\n\nexport interface DriveFolder extends DriveEntry {\n  type: 'folder';\n  model_type?: string;\n}\n\nexport interface DriveEntryUser {\n  id: number;\n  email: string;\n  name: string;\n  image?: string;\n  owns_entry: boolean;\n  entry_permissions: DriveEntryPermissions;\n}\n\nexport interface DriveEntryPermissions {\n  edit?: boolean;\n  view?: boolean;\n  download?: boolean;\n}\n\nexport const DRIVE_ENTRY_FULL_PERMISSIONS = {\n  edit: true,\n  view: true,\n  download: true,\n};\n","import {Button} from '@ui/buttons/button';\nimport {ArrowDropDownIcon} from '@ui/icons/material/ArrowDropDown';\nimport {\n  DRIVE_ENTRY_FULL_PERMISSIONS,\n  DriveEntryPermissions,\n  DriveEntryUser,\n} from '@app/drive/files/drive-entry';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {MessageDescriptor} from '@ui/i18n/message-descriptor';\nimport {Menu, MenuItem, MenuTrigger} from '@ui/menu/menu-trigger';\n\nexport interface PermissionSelectorItem {\n  key: keyof DriveEntryPermissions;\n  value: DriveEntryPermissions;\n  label: MessageDescriptor;\n}\n\nexport const PermissionSelectorItems: PermissionSelectorItem[] = [\n  {\n    key: 'view',\n    value: {view: true},\n    label: message('Can view'),\n  },\n  {\n    key: 'download',\n    value: {view: true, download: true},\n    label: message('Can Download'),\n  },\n  {\n    key: 'edit',\n    value: DRIVE_ENTRY_FULL_PERMISSIONS,\n    label: message('Can edit'),\n  },\n];\n\ninterface Props {\n  onChange: (value: PermissionSelectorItem) => void;\n  value: PermissionSelectorItem;\n  isDisabled?: boolean;\n}\nexport function PermissionSelector({value, onChange, isDisabled}: Props) {\n  return (\n    <MenuTrigger\n      selectedValue={value.key}\n      selectionMode=\"single\"\n      onSelectionChange={key => {\n        if (key !== value.key) {\n          onChange(PermissionSelectorItems.find(p => p.key === key)!);\n        }\n      }}\n    >\n      <Button\n        variant=\"flat\"\n        color=\"chip\"\n        size=\"xs\"\n        endIcon={<ArrowDropDownIcon />}\n        disabled={isDisabled}\n      >\n        <Trans {...value.label} />\n      </Button>\n      <Menu>\n        {PermissionSelectorItems.map(item => {\n          return (\n            <MenuItem key={item.key} value={item.key}>\n              <Trans {...item.label} />\n            </MenuItem>\n          );\n        })}\n      </Menu>\n    </MenuTrigger>\n  );\n}\n\nexport function getPermissionItemForUser(\n  user: DriveEntryUser,\n): PermissionSelectorItem {\n  const {download, edit} = user.entry_permissions;\n  if (edit) {\n    return PermissionSelectorItems.find(item => item.key === 'edit')!;\n  }\n  if (download) {\n    return PermissionSelectorItems.find(item => item.key === 'download')!;\n  }\n  return PermissionSelectorItems.find(item => item.key === 'view')!;\n}\n","import {driveInvalidateKey} from '@app/app-queries';\nimport {DriveEntryPermissions} from '@app/drive/files/drive-entry';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\n\nexport interface ChangePermissionsPayload {\n  userId: number;\n  permissions: DriveEntryPermissions;\n  entryId: number;\n}\n\nexport function useChangePermission() {\n  return useMutation({\n    mutationFn: (payload: ChangePermissionsPayload) =>\n      changePermission(payload),\n    onSuccess: () => {\n      queryClient.invalidateQueries({queryKey: driveInvalidateKey});\n      toast(message('Updated user permissions'));\n    },\n    onError: err =>\n      showHttpErrorToast(err, message('Could not update permissions')),\n  });\n}\n\nfunction changePermission({\n  entryId,\n  ...payload\n}: ChangePermissionsPayload): Promise<BackendResponse> {\n  return apiClient\n    .put(`file-entries/${entryId}/change-permissions`, payload)\n    .then(response => response.data);\n}\n","import {UserAvatar} from '@common/auth/user-avatar';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport {toast} from '@ui/toast/toast';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {useState} from 'react';\nimport {DriveEntry, DriveEntryUser} from '@app/drive/files/drive-entry';\nimport {\n  getPermissionItemForUser,\n  PermissionSelector,\n  PermissionSelectorItem,\n} from './permission-selector';\nimport {useChangePermission} from './queries/use-change-permission';\nimport {useUnshareEntries} from './queries/use-unshare-entries';\n\ninterface MemberListProps {\n  className?: string;\n  entry: DriveEntry;\n}\n\nexport function MemberList({className, entry}: MemberListProps) {\n  if (!entry) return null;\n\n  const users = entry.users;\n\n  return (\n    <div className={clsx(className, 'overflow-hidden')}>\n      <div className=\"mb-14 text-sm font-semibold\">\n        <Trans message=\"People with access\" />\n      </div>\n      <AnimatePresence initial={false}>\n        {users.map(user => (\n          <MemberListItem key={user.id} user={user} entry={entry} />\n        ))}\n      </AnimatePresence>\n    </div>\n  );\n}\n\ninterface MemberListItemProps {\n  user: DriveEntryUser;\n  entry: DriveEntry;\n}\nfunction MemberListItem({user, entry}: MemberListItemProps) {\n  return (\n    <m.div\n      initial={{x: '-100%', opacity: 0}}\n      animate={{x: 0, opacity: 1}}\n      exit={{x: '100%', opacity: 0}}\n      transition={{type: 'tween', duration: 0.125}}\n      className=\"mb-20 flex items-center gap-14 text-sm\"\n      key={user.id}\n    >\n      <UserAvatar user={user as any} circle size=\"w-44 h-44\" />\n      <div>\n        <div>{user.name}</div>\n        <div className=\"text-muted\">{user.email}</div>\n      </div>\n      <div className=\"ml-auto\">\n        {user.owns_entry ? (\n          <span className=\"text-muted\">\n            <Trans message=\"Owner\" />\n          </span>\n        ) : (\n          <ActionButtons user={user} entry={entry} />\n        )}\n      </div>\n    </m.div>\n  );\n}\n\ninterface ActionButtonsProps {\n  user: DriveEntryUser;\n  entry: DriveEntry;\n}\nfunction ActionButtons({user, entry}: ActionButtonsProps) {\n  const changePermissions = useChangePermission();\n  const unshareEntry = useUnshareEntries();\n  const [activePermission, setActivePermission] =\n    useState<PermissionSelectorItem>(() => {\n      return getPermissionItemForUser(user);\n    });\n\n  return (\n    <div className=\"flex items-center gap-10\">\n      <PermissionSelector\n        isDisabled={changePermissions.isPending}\n        onChange={item => {\n          changePermissions.mutate({\n            userId: user.id,\n            permissions: item.value,\n            entryId: entry.id,\n          });\n          setActivePermission(item);\n        }}\n        value={activePermission}\n      />\n      <IconButton\n        disabled={unshareEntry.isPending}\n        onClick={() => {\n          unshareEntry.mutate(\n            {userId: user.id, entryIds: [entry.id]},\n            {\n              onSuccess: () => {\n                toast(message('Member removed'));\n              },\n              onError: err =>\n                showHttpErrorToast(err, message('Could not remove member')),\n            },\n          );\n        }}\n      >\n        <CloseIcon />\n      </IconButton>\n    </div>\n  );\n}\n","import {driveInvalidateKey} from '@app/app-queries';\nimport {DriveEntryPermissions} from '@app/drive/files/drive-entry';\nimport {BackendErrorResponse} from '@common/errors/backend-error-response';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {showHttpErrorToast} from '@common/http/show-http-error-toast';\nimport {useMutation} from '@tanstack/react-query';\nimport {toast} from '@ui/toast/toast';\nimport axios from 'axios';\n\nexport interface ShareEntryPayload {\n  emails: string[];\n  permissions: DriveEntryPermissions;\n  entryId: number;\n}\n\nfunction shareEntry({\n  entryId,\n  ...payload\n}: ShareEntryPayload): Promise<BackendResponse> {\n  return apiClient\n    .post(`file-entries/${entryId}/share`, payload)\n    .then(response => response.data);\n}\n\nexport function useShareEntry() {\n  return useMutation({\n    mutationFn: (payload: ShareEntryPayload) => shareEntry(payload),\n    onSuccess: () => {\n      queryClient.invalidateQueries({queryKey: driveInvalidateKey});\n    },\n    onError: err => {\n      if (axios.isAxiosError(err) && err.response) {\n        const response = err.response.data as BackendErrorResponse;\n        if (response.errors?.emails) {\n          toast.danger(response.errors?.emails[0]);\n        } else {\n          showHttpErrorToast(err);\n        }\n      }\n    },\n  });\n}\n","import {useNormalizedModels} from '@common/ui/normalized-model/use-normalized-models';\nimport {Avatar} from '@ui/avatar/avatar';\nimport {Button} from '@ui/buttons/button';\nimport {\n  ChipField,\n  ChipValue,\n} from '@ui/forms/input-field/chip-field/chip-field';\nimport {Item} from '@ui/forms/listbox/item';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {useSettings} from '@ui/settings/use-settings';\nimport {isEmail} from '@ui/utils/string/is-email';\nimport {useState} from 'react';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {MemberList} from './member-list';\nimport {\n  PermissionSelector,\n  PermissionSelectorItem,\n  PermissionSelectorItems,\n} from './permission-selector';\nimport {useShareEntry} from './queries/use-share-entry';\n\ninterface SharePanelProps {\n  className?: string;\n  entry: DriveEntry;\n}\nexport function SharePanel({className, entry}: SharePanelProps) {\n  const {trans} = useTrans();\n  const {share} = useSettings();\n  const shareEntry = useShareEntry();\n  const [chips, setChips] = useState<ChipValue[]>([]);\n  const [isSharing, setIsSharing] = useState(false);\n  const [selectedPermission, setSelectedPermission] =\n    useState<PermissionSelectorItem>(PermissionSelectorItems[0]);\n  const allEmailsValid = chips.every(chip => !chip.invalid);\n  const [inputValue, setInputValue] = useState('');\n  const query = useNormalizedModels(\n    'normalized-models/user',\n    {perPage: 7, query: inputValue},\n    {enabled: share?.suggest_emails},\n  );\n\n  // show user's email, instead of name in the chip\n  const displayWith = (chip: ChipValue) => chip.description || chip.name;\n\n  return (\n    <div className={className}>\n      <ChipField\n        value={chips}\n        onChange={setChips}\n        isAsync\n        isLoading={query.fetchStatus === 'fetching'}\n        inputValue={inputValue}\n        onInputValueChange={setInputValue}\n        suggestions={query.data?.results}\n        displayWith={displayWith}\n        validateWith={chip => {\n          const invalid = !isEmail(chip.description);\n          return {\n            ...chip,\n            invalid,\n            errorMessage: invalid\n              ? trans({message: 'Not a valid email'})\n              : undefined,\n          };\n        }}\n        placeholder={trans({message: 'Enter email addresses'})}\n        label={<Trans message=\"Invite people\" />}\n        labelClassName=\"font-semibold\"\n      >\n        {user => (\n          <Item\n            value={user.id}\n            startIcon={<Avatar circle src={user.image} alt=\"\" />}\n            description={user.description}\n          >\n            {user.name}\n          </Item>\n        )}\n      </ChipField>\n      <div className=\"mt-14 flex items-center justify-between gap-14\">\n        <PermissionSelector\n          onChange={setSelectedPermission}\n          value={selectedPermission}\n        />\n        {chips.length ? (\n          <Button\n            variant=\"flat\"\n            color=\"primary\"\n            size=\"sm\"\n            disabled={isSharing || !allEmailsValid}\n            onClick={() => {\n              setIsSharing(true);\n              shareEntry.mutate(\n                {\n                  emails: chips.map(c => displayWith(c)),\n                  permissions: selectedPermission.value,\n                  entryId: entry.id,\n                },\n                {\n                  onSuccess: () => {\n                    setChips([]);\n                  },\n                  onSettled: () => {\n                    setIsSharing(false);\n                  },\n                },\n              );\n            }}\n          >\n            <Trans message=\"Share\" />\n          </Button>\n        ) : null}\n      </div>\n      <MemberList className=\"mt-30\" entry={entry} />\n    </div>\n  );\n}\n","import {appQueries} from '@app/app-queries';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {LinkSettingsDialog} from '@app/drive/share-dialog/link-panel/link-settings-dialog';\nimport {ShareableLinkPanel} from '@app/drive/share-dialog/link-panel/shareable-link-panel';\nimport {SharePanel} from '@app/drive/share-dialog/share-panel';\nimport {useQuery} from '@tanstack/react-query';\nimport {Trans} from '@ui/i18n/trans';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {Fragment, useState} from 'react';\n\nexport type ShareDialogActivePanel = 'main' | 'linkSettings';\n\ninterface ShareDialogProps {\n  entry: DriveEntry;\n}\nexport function ShareDialog({entry: initialEntry}: ShareDialogProps) {\n  const {\n    data: {fileEntry},\n  } = useQuery({\n    ...appQueries.driveEntries.get(initialEntry.id),\n    initialData: {fileEntry: initialEntry},\n  });\n\n  const [activePanel, setActivePanel] =\n    useState<ShareDialogActivePanel>('main');\n\n  return (\n    <Dialog size=\"lg\">\n      <AnimatePresence initial={false} mode=\"wait\">\n        {activePanel === 'linkSettings' ? (\n          <LinkSettingsDialog\n            key=\"one\"\n            setActivePanel={setActivePanel}\n            entry={fileEntry}\n          />\n        ) : (\n          <MainDialog\n            key=\"two\"\n            setActivePanel={setActivePanel}\n            entry={fileEntry}\n          />\n        )}\n      </AnimatePresence>\n    </Dialog>\n  );\n}\n\ninterface MainDialogProps {\n  setActivePanel: (name: ShareDialogActivePanel) => void;\n  entry: DriveEntry;\n}\nfunction MainDialog({setActivePanel, entry}: MainDialogProps) {\n  return (\n    <Fragment>\n      <DialogHeader>\n        <Trans message=\"Share :name\" values={{name: entry.name}} />\n      </DialogHeader>\n      <DialogBody className=\"relative\">\n        <m.div\n          key=\"share-content\"\n          animate={{opacity: 1, y: 0}}\n          initial={{opacity: 0, y: 20}}\n          exit={{opacity: 0, y: -20}}\n          transition={{duration: 0.1}}\n        >\n          <SharePanel className=\"mb-30 border-b pb-30\" entry={entry} />\n          <ShareableLinkPanel setActivePanel={setActivePanel} entry={entry} />\n        </m.div>\n      </DialogBody>\n    </Fragment>\n  );\n}\n","import {DriveEntry} from '@app/drive/files/drive-entry';\nimport {ConfirmationDialog} from '@ui/overlays/dialog/confirmation-dialog';\nimport {Trans} from '@ui/i18n/trans';\nimport {driveState} from '@app/drive/drive-store';\nimport {useRestoreEntries} from '@app/drive/files/queries/use-restore-entries';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\n\ninterface DeleteEntriesForeverDialogProps {\n  entries: DriveEntry[];\n}\nexport function BlockTrashFolderViewDialog({\n  entries,\n}: DeleteEntriesForeverDialogProps) {\n  const restoreEntries = useRestoreEntries();\n  const {close} = useDialogContext();\n\n  return (\n    <ConfirmationDialog\n      title={<Trans message=\"This folder is in your trash\" />}\n      body={<Trans message=\"To view this folder, restore it from the trash.\" />}\n      confirm={<Trans message=\"Restore\" />}\n      isLoading={restoreEntries.isPending}\n      onConfirm={() => {\n        restoreEntries.mutate(\n          {\n            entryIds: entries.map(e => e.id),\n          },\n          {\n            onSuccess: () => {\n              close();\n              driveState().selectEntries([]);\n            },\n          },\n        );\n      }}\n    />\n  );\n}\n","import {DriveEntry} from '@app/drive/files/drive-entry';\nimport {ConfirmationDialog} from '@ui/overlays/dialog/confirmation-dialog';\nimport {Trans} from '@ui/i18n/trans';\nimport {useDeleteEntries} from '@app/drive/files/queries/use-delete-entries';\nimport {driveState} from '@app/drive/drive-store';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\n\ninterface DeleteEntriesForeverDialogProps {\n  entries: DriveEntry[];\n}\nexport function DeleteEntriesForeverDialog({\n  entries,\n}: DeleteEntriesForeverDialogProps) {\n  const deleteEntries = useDeleteEntries();\n  const {close} = useDialogContext();\n\n  const message =\n    entries.length === 1 ? (\n      <Trans\n        message=\":name will be deleted forever and you won't be able to restore it.\"\n        values={{name: entries[0].name}}\n      />\n    ) : (\n      <Trans\n        message=\":count items will be deleted forever and you won't be able to restore them.\"\n        values={{count: entries.length}}\n      />\n    );\n\n  return (\n    <ConfirmationDialog\n      isDanger\n      title={<Trans message=\"Delete forever?\" />}\n      body={message}\n      confirm={<Trans message=\"Delete forever\" />}\n      isLoading={deleteEntries.isPending}\n      onConfirm={() => {\n        deleteEntries.mutate(\n          {\n            entryIds: entries.map(e => e.id),\n            deleteForever: true,\n          },\n          {\n            onSuccess: () => {\n              close();\n              driveState().selectEntries([]);\n            },\n          },\n        );\n      }}\n    />\n  );\n}\n","import {useShareAction} from '@app/drive/entry-actions/use-entry-actions';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\nimport {useActivePageEntries} from '@app/drive/files/queries/use-active-page-entries';\nimport {FilePreviewDialog} from '@common/uploads/components/file-preview/file-preview-dialog';\nimport {Button} from '@ui/buttons/button';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {Trans} from '@ui/i18n/trans';\nimport {createElement, Fragment, useState} from 'react';\n\ninterface EntryPreviewDialogProps {\n  selectedEntry: DriveEntry;\n}\nexport function EntryPreviewDialog({selectedEntry}: EntryPreviewDialogProps) {\n  const files = useActivePageEntries().items.filter(\n    entry => entry.type !== 'folder',\n  );\n  const defaultActiveIndex = files.findIndex(\n    file => file.id === selectedEntry?.id,\n  );\n  const [activeIndex, setActiveIndex] = useState(defaultActiveIndex);\n  return (\n    <FilePreviewDialog\n      allowDownload={selectedEntry.permissions['files.download']}\n      headerActionsLeft={\n        <DriveActions activeIndex={activeIndex} entries={files} />\n      }\n      activeIndex={activeIndex}\n      onActiveIndexChange={setActiveIndex}\n      entries={files}\n    />\n  );\n}\n\ninterface DriveActionsProps {\n  activeIndex: number;\n  entries: DriveEntry[];\n}\nfunction DriveActions({activeIndex, entries}: DriveActionsProps) {\n  const selectedEntry = entries[activeIndex];\n  const share = useShareAction([selectedEntry]);\n  if (!selectedEntry || !share) return null;\n\n  return (\n    <Fragment>\n      <IconButton\n        className=\"md:hidden\"\n        onClick={() => {\n          share.execute();\n        }}\n      >\n        {createElement(share.icon)}\n      </IconButton>\n      <Button\n        className=\"max-md:hidden\"\n        variant=\"text\"\n        startIcon={createElement(share.icon)}\n        onClick={() => {\n          share.execute();\n        }}\n      >\n        <Trans {...share.label} />\n      </Button>\n    </Fragment>\n  );\n}\n","import {driveInvalidateKey} from '@app/app-queries';\nimport {DriveFolder} from '@app/drive/files/drive-entry';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {useMutation} from '@tanstack/react-query';\nimport {UseFormReturn} from 'react-hook-form';\n\ninterface Response extends BackendResponse {\n  folder: DriveFolder;\n}\n\ninterface CreateFolderProps {\n  name: string;\n  parentId?: number | null;\n}\n\nfunction createFolder({name, parentId}: CreateFolderProps): Promise<Response> {\n  return apiClient\n    .post('folders', {\n      name,\n      parentId: parentId === 0 ? null : parentId,\n    })\n    .then(response => response.data);\n}\n\nexport function useCreateFolder(form: UseFormReturn<any>) {\n  return useMutation({\n    mutationFn: ({name, parentId}: CreateFolderProps) => {\n      return createFolder({name, parentId});\n    },\n    onSuccess: () =>\n      queryClient.invalidateQueries({queryKey: driveInvalidateKey}),\n    onError: r => onFormQueryError(r, form),\n  });\n}\n","import React from 'react';\nimport {useForm} from 'react-hook-form';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Button} from '@ui/buttons/button';\nimport {toast} from '@ui/toast/toast';\nimport {Form} from '@ui/forms/form';\nimport {useCreateFolder} from '@app/drive/files/queries/create-folder';\nimport {DialogFooter} from '@ui/overlays/dialog/dialog-footer';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {Trans} from '@ui/i18n/trans';\nimport {message} from '@ui/i18n/message';\nimport {useTrans} from '@ui/i18n/use-trans';\n\ninterface FormValue {\n  name?: string;\n}\n\ninterface NewFolderDialogProps {\n  parentId: number;\n}\nexport function NewFolderDialog({parentId}: NewFolderDialogProps) {\n  const {close, formId} = useDialogContext();\n  const {trans} = useTrans();\n  const form = useForm({\n    defaultValues: {\n      name: trans({message: 'Untitled Folder'}),\n    },\n  });\n  const createFolder = useCreateFolder(form);\n\n  const onSubmit = (value: Required<FormValue>) => {\n    createFolder.mutate(\n      {...value, parentId},\n      {\n        onSuccess: response => {\n          close(response.folder);\n          toast(message('Folder created'));\n        },\n      },\n    );\n  };\n\n  return (\n    <Dialog>\n      <DialogHeader>\n        <Trans message=\"New Folder\" />\n      </DialogHeader>\n      <DialogBody>\n        <Form onSubmit={onSubmit} form={form} id={formId}>\n          <FormTextField\n            placeholder={trans({\n              message: 'Enter a name...',\n            })}\n            aria-label=\"Entry name\"\n            autoFocus\n            autoSelectText\n            name=\"name\"\n            required\n            minLength={3}\n            maxLength={200}\n          />\n        </Form>\n      </DialogBody>\n      <DialogFooter>\n        <Button variant=\"flat\" onClick={() => close()}>\n          <Trans message=\"Cancel\" />\n        </Button>\n        <Button\n          form={formId}\n          type=\"submit\"\n          variant=\"flat\"\n          color=\"primary\"\n          disabled={createFolder.isPending}\n        >\n          <Trans message=\"Create\" />\n        </Button>\n      </DialogFooter>\n    </Dialog>\n  );\n}\n","import {appQueries} from '@app/app-queries';\nimport {DriveFolder} from '@app/drive/files/drive-entry';\nimport {DriveApiIndexParams} from '@app/drive/files/queries/use-active-page-entries';\nimport {encodeBackendFilters} from '@common/datatable/filters/utils/encode-backend-filters';\nimport {useActiveWorkspaceId} from '@common/workspace/active-workspace-id-context';\nimport {keepPreviousData, useInfiniteQuery} from '@tanstack/react-query';\nimport {useMemo} from 'react';\n\ninterface Props {\n  query?: string;\n}\nexport function useMoveEntriesDialogFolderSearch({query}: Props) {\n  const {workspaceId} = useActiveWorkspaceId();\n  const params = useMemo(() => {\n    return {\n      section: 'search',\n      workspaceId,\n      query,\n      filters: encodeBackendFilters([\n        {\n          key: 'type',\n          value: 'folder',\n        },\n      ]),\n    } as DriveApiIndexParams;\n  }, [workspaceId, query]);\n\n  return useInfiniteQuery({\n    ...appQueries.driveEntries.index<DriveFolder>(params),\n    enabled: !!query,\n    placeholderData: keepPreviousData,\n  });\n}\n","import {useMoveEntriesDialogFolderSearch} from '@app/drive/files/dialogs/move-entries-dialog/use-move-entries-dialog-folder-search';\nimport {DriveFolder} from '@app/drive/files/drive-entry';\nimport {ComboBox} from '@ui/forms/combobox/combobox';\nimport {Item} from '@ui/forms/listbox/item';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {SearchIcon} from '@ui/icons/material/Search';\nimport {useState} from 'react';\n\ninterface SearchComboBoxProps {\n  onFolderSelected: (folder: DriveFolder) => void;\n}\nexport function MoveEntriesDialogSearch({\n  onFolderSelected,\n}: SearchComboBoxProps) {\n  const {trans} = useTrans();\n  const searchLabel = trans({message: 'Search folders'});\n  const [query, setQuery] = useState('');\n  const {isFetching, data} = useMoveEntriesDialogFolderSearch({query});\n  const folders = data?.pages[0]?.data;\n  return (\n    <ComboBox\n      size=\"sm\"\n      maxItems={10}\n      placeholder={searchLabel}\n      aria-label={searchLabel}\n      className=\"pt-20\"\n      endAdornmentIcon={<SearchIcon />}\n      isAsync\n      isLoading={isFetching}\n      inputValue={query}\n      onInputValueChange={setQuery}\n      blurReferenceOnItemSelection\n      clearInputOnItemSelection\n      selectionMode=\"none\"\n      openMenuOnFocus={false}\n    >\n      {folders?.map(folder => (\n        <Item\n          key={folder.id}\n          value={folder.id}\n          textLabel={folder.name}\n          onSelected={() => {\n            onFolderSelected(folder);\n          }}\n        >\n          {folder.name}\n        </Item>\n      ))}\n    </ComboBox>\n  );\n}\n","import React from 'react';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {ArrowBackIcon} from '@ui/icons/material/ArrowBack';\nimport {Breadcrumb} from '@ui/breadcrumbs/breadcrumb';\nimport {FolderIcon} from '@ui/icons/material/Folder';\nimport {BreadcrumbItem} from '@ui/breadcrumbs/breadcrumb-item';\nimport {useFolderPath} from '@app/drive/files/queries/use-folder-path';\nimport {RootFolderPage} from '@app/drive/drive-page/drive-page';\nimport {Trans} from '@ui/i18n/trans';\nimport {DriveFolder} from '@app/drive/files/drive-entry';\n\ninterface FolderBreadCrumbsProps {\n  selectedFolder: DriveFolder;\n  onFolderSelected: (folder: DriveFolder) => void;\n}\nexport function MoveEntriesDialogBreadcrumbs({\n  selectedFolder,\n  onFolderSelected,\n}: FolderBreadCrumbsProps) {\n  const {data} = useFolderPath({\n    hash: selectedFolder.hash,\n    isEnabled: selectedFolder?.hash !== RootFolderPage.folder.hash,\n  });\n\n  let previous: DriveFolder | null = null;\n  if (data?.path) {\n    if (data.path.length === 1) {\n      previous = RootFolderPage.folder;\n    } else {\n      previous = data.path[data.path.length - 2];\n    }\n  }\n\n  return (\n    <div className=\"flex items-center gap-6 border-b pb-10\">\n      <IconButton\n        className=\"flex-shrink-0\"\n        variant=\"outline\"\n        size=\"xs\"\n        disabled={!previous}\n        onClick={() => {\n          if (previous) {\n            onFolderSelected(previous);\n          }\n        }}\n      >\n        <ArrowBackIcon />\n      </IconButton>\n      <Breadcrumb size=\"sm\" className=\"flex-auto\">\n        <BreadcrumbItem\n          onSelected={() => {\n            onFolderSelected(RootFolderPage.folder);\n          }}\n          className=\"flex items-center gap-8\"\n        >\n          <FolderIcon className=\"icon-sm\" />\n          <Trans message={RootFolderPage.folder.name} />\n        </BreadcrumbItem>\n        {data?.path.map(item => (\n          <BreadcrumbItem\n            onSelected={() => {\n              onFolderSelected(item);\n            }}\n            key={item.id || 'root'}\n            className=\"flex items-center gap-8\"\n          >\n            {!item.id && <FolderIcon className=\"icon-sm\" />}\n            {item.name}\n          </BreadcrumbItem>\n        ))}\n      </Breadcrumb>\n    </div>\n  );\n}\n","export default \"__VITE_ASSET__DD09Ui_A__\"","import {appQueries} from '@app/app-queries';\nimport {DriveFolder} from '@app/drive/files/drive-entry';\nimport {DriveApiIndexParams} from '@app/drive/files/queries/use-active-page-entries';\nimport {PartialFolder} from '@app/drive/files/utils/can-move-entries-into';\nimport {encodeBackendFilters} from '@common/datatable/filters/utils/encode-backend-filters';\nimport {useActiveWorkspaceId} from '@common/workspace/active-workspace-id-context';\nimport {useInfiniteQuery} from '@tanstack/react-query';\nimport {useMemo} from 'react';\n\ninterface Props {\n  selectedFolder: PartialFolder;\n  movingSharedFiles: boolean;\n}\nexport function useMoveEntriesDialogFolders({\n  selectedFolder,\n  movingSharedFiles,\n}: Props) {\n  const {workspaceId} = useActiveWorkspaceId();\n  const params = useMemo(() => {\n    const filters = encodeBackendFilters([\n      {\n        key: 'type',\n        value: 'folder',\n      },\n    ]);\n    return {\n      section: 'folder',\n      folderId:\n        selectedFolder.hash == '0' && movingSharedFiles\n          ? 'sharedWithMe'\n          : selectedFolder.hash,\n      workspaceId,\n      filters,\n    } as DriveApiIndexParams;\n  }, [workspaceId, selectedFolder.hash, movingSharedFiles]);\n\n  return useInfiniteQuery(appQueries.driveEntries.index<DriveFolder>(params));\n}\n","import React, {Fragment, ReactElement} from 'react';\nimport {FileTypeIcon} from '@common/uploads/components/file-type-icon/file-type-icon';\nimport {ChevronRightIcon} from '@ui/icons/material/ChevronRight';\nimport {Trans} from '@ui/i18n/trans';\nimport myFilesSvg from './my-files.svg';\nimport {useMoveEntriesDialogFolders} from '@app/drive/files/dialogs/move-entries-dialog/use-move-entries-dialog-folders';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport {InfiniteScrollSentinel} from '@common/ui/infinite-scroll/infinite-scroll-sentinel';\nimport {DriveFolder} from '@app/drive/files/drive-entry';\nimport {SvgImage} from '@ui/images/svg-image';\nimport {IllustratedMessage} from '@ui/images/illustrated-message';\nimport {List, ListItem} from '@ui/list/list';\n\ninterface Props {\n  selectedFolder: DriveFolder;\n  onFolderSelected: (folder: DriveFolder) => void;\n  movingSharedFiles: boolean;\n}\nexport function MoveEntriesDialogFolderList({\n  onFolderSelected,\n  selectedFolder,\n  movingSharedFiles,\n}: Props) {\n  const query = useMoveEntriesDialogFolders({\n    selectedFolder,\n    movingSharedFiles,\n  });\n  let content: ReactElement;\n\n  if (query.isLoading) {\n    content = (\n      <div className=\"flex h-full w-full items-center justify-center\">\n        <ProgressCircle isIndeterminate size=\"md\" />\n      </div>\n    );\n  } else if (query.data?.pages[0]?.data.length === 0) {\n    content = (\n      <IllustratedMessage\n        size=\"xs\"\n        className=\"pb-20 pt-64\"\n        image={<SvgImage src={myFilesSvg} />}\n        title={\n          <Trans\n            message={`There are no subfolders in \":folder\"`}\n            values={{folder: selectedFolder.name}}\n          />\n        }\n      />\n    );\n  } else {\n    content = (\n      <Fragment>\n        <List>\n          {query.data?.pages\n            .flatMap(r => r.data)\n            .map(folder => (\n              <ListItem\n                className=\"min-h-48 border-b\"\n                key={folder.id}\n                onSelected={() => {\n                  onFolderSelected(folder);\n                }}\n                startIcon={<FileTypeIcon type=\"folder\" />}\n                endIcon={<ChevronRightIcon size=\"md\" />}\n              >\n                {folder.name}\n              </ListItem>\n            ))}\n        </List>\n        <InfiniteScrollSentinel query={query} />\n      </Fragment>\n    );\n  }\n\n  return <div className=\"h-288 overflow-y-auto\">{content}</div>;\n}\n","import React, {useState} from 'react';\nimport {Button} from '@ui/buttons/button';\nimport {useMoveEntries} from '@app/drive/files/queries/use-move-entries';\nimport {NewFolderDialog} from '@app/drive/files/dialogs/new-folder-dialog';\nimport {CreateNewFolderIcon} from '@ui/icons/material/CreateNewFolder';\nimport {MoveEntriesDialogSearch} from '@app/drive/files/dialogs/move-entries-dialog/move-entries-dialog-search';\nimport {MoveEntriesDialogBreadcrumbs} from '@app/drive/files/dialogs/move-entries-dialog/move-entries-dialog-breadcrumbs';\nimport {MoveEntriesDialogFolderList} from '@app/drive/files/dialogs/move-entries-dialog/move-entries-dialog-folder-list';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {DialogFooter} from '@ui/overlays/dialog/dialog-footer';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {Trans} from '@ui/i18n/trans';\nimport {RootFolderPage} from '@app/drive/drive-page/drive-page';\nimport {DriveEntry, DriveFolder} from '@app/drive/files/drive-entry';\nimport {useDriveStore} from '@app/drive/drive-store';\nimport {canMoveEntriesInto} from '@app/drive/files/utils/can-move-entries-into';\nimport {useAuth} from '@common/auth/use-auth';\n\ninterface MoveEntriesDialogProps {\n  entries: DriveEntry[];\n}\nexport function MoveEntriesDialog({entries}: MoveEntriesDialogProps) {\n  const {user} = useAuth();\n  const activePage = useDriveStore(s => s.activePage);\n  const [selectedFolder, setSelectedFolder] = useState<DriveFolder>(\n    activePage?.folder || RootFolderPage.folder,\n  );\n  const movingSharedFiles = entries.some(\n    e => !e.users.find(u => u.id === user!.id)?.owns_entry,\n  );\n\n  return (\n    <Dialog size=\"lg\">\n      <DialogHeader>\n        <Trans\n          message=\"Move [one :name|other :count items]\"\n          values={{\n            count: entries.length,\n            name: entries[0].name,\n          }}\n        />\n      </DialogHeader>\n      <DialogBody>\n        <div className=\"text-sm\">\n          <Trans message=\"Select a destination folder.\" />\n        </div>\n        <MoveEntriesDialogSearch onFolderSelected={setSelectedFolder} />\n        <div className=\"mb-20 mt-40\">\n          <MoveEntriesDialogBreadcrumbs\n            selectedFolder={selectedFolder}\n            onFolderSelected={setSelectedFolder}\n          />\n          <MoveEntriesDialogFolderList\n            movingSharedFiles={movingSharedFiles}\n            selectedFolder={selectedFolder}\n            onFolderSelected={setSelectedFolder}\n          />\n        </div>\n      </DialogBody>\n      <Footer\n        selectedFolder={selectedFolder}\n        setSelectedFolder={setSelectedFolder}\n        entries={entries}\n      />\n    </Dialog>\n  );\n}\n\ninterface FooterProps {\n  selectedFolder: DriveFolder;\n  setSelectedFolder: (folder: DriveFolder) => void;\n  entries: DriveEntry[];\n}\nfunction Footer({selectedFolder, setSelectedFolder, entries}: FooterProps) {\n  const {close} = useDialogContext();\n  const moveEntries = useMoveEntries();\n  return (\n    <DialogFooter\n      className=\"border-t\"\n      startAction={\n        <DialogTrigger\n          type=\"modal\"\n          onClose={folder => {\n            if (folder) {\n              setSelectedFolder(folder);\n            }\n          }}\n        >\n          <Button startIcon={<CreateNewFolderIcon />} variant=\"text\">\n            <Trans message=\"New Folder\" />\n          </Button>\n          <NewFolderDialog parentId={selectedFolder.id} />\n        </DialogTrigger>\n      }\n    >\n      <Button className=\"max-md:hidden\" variant=\"flat\" onClick={() => close()}>\n        <Trans message=\"Cancel\" />\n      </Button>\n      <Button\n        type=\"submit\"\n        variant=\"flat\"\n        color=\"primary\"\n        disabled={\n          !canMoveEntriesInto(entries, selectedFolder) || moveEntries.isPending\n        }\n        onClick={() => {\n          moveEntries.mutate(\n            {\n              destinationId: selectedFolder.id,\n              entryIds: entries.map(e => e.id),\n            },\n            {onSuccess: close},\n          );\n        }}\n      >\n        <Trans message=\"Move here\" />\n      </Button>\n    </DialogFooter>\n  );\n}\n","import {driveInvalidateKey} from '@app/app-queries';\nimport {onFormQueryError} from '@common/errors/on-form-query-error';\nimport {BackendResponse} from '@common/http/backend-response/backend-response';\nimport {apiClient, queryClient} from '@common/http/query-client';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport {useMutation} from '@tanstack/react-query';\nimport {message} from '@ui/i18n/message';\nimport {toast} from '@ui/toast/toast';\nimport {UseFormReturn} from 'react-hook-form';\n\ninterface Response extends BackendResponse {\n  fileEntry: FileEntry;\n}\n\ninterface Payload {\n  entryId: number;\n  name: string;\n  initialName: string;\n}\n\nexport function useRenameEntry(form: UseFormReturn<any>) {\n  return useMutation({\n    mutationFn: (payload: Payload) => renameEntry(payload),\n    onSuccess: (r, p) => {\n      queryClient.invalidateQueries({queryKey: driveInvalidateKey});\n      toast(\n        message(':oldName renamed to :newName', {\n          values: {oldName: p.initialName, newName: r.fileEntry.name},\n        }),\n      );\n    },\n    onError: err => onFormQueryError(err, form),\n  });\n}\n\nfunction renameEntry({entryId, ...payload}: Payload): Promise<Response> {\n  return apiClient\n    .put(`file-entries/${entryId}`, payload)\n    .then(response => response.data);\n}\n","import React from 'react';\nimport {useForm} from 'react-hook-form';\nimport {useRenameEntry} from '@app/drive/files/queries/use-rename-entry';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Button} from '@ui/buttons/button';\nimport {Form} from '@ui/forms/form';\nimport {DialogFooter} from '@ui/overlays/dialog/dialog-footer';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {Trans} from '@ui/i18n/trans';\nimport {DriveEntry} from '@app/drive/files/drive-entry';\n\ninterface FormValue {\n  name?: string;\n}\n\ninterface RenameEntryDialogProps {\n  entries: DriveEntry[];\n}\nexport function RenameEntryDialog({entries}: RenameEntryDialogProps) {\n  const {close, formId} = useDialogContext();\n  const initialName = entries[0]?.name;\n  const form = useForm({defaultValues: {name: initialName}});\n  const renameEntry = useRenameEntry(form);\n\n  const onSubmit = (e: Required<FormValue>) => {\n    renameEntry.mutate(\n      {\n        entryId: entries[0].id,\n        name: e.name,\n        initialName,\n      },\n      {onSuccess: close},\n    );\n  };\n\n  return (\n    <Dialog>\n      <DialogHeader>\n        <Trans message=\"Rename\" />\n      </DialogHeader>\n      <DialogBody>\n        <Form onSubmit={onSubmit} form={form} id={formId}>\n          <FormTextField\n            placeholder=\"Enter a name...\"\n            aria-label=\"Entry name\"\n            autoFocus\n            name=\"name\"\n            required\n            minLength={3}\n            maxLength={200}\n          />\n        </Form>\n      </DialogBody>\n      <DialogFooter>\n        <Button variant=\"flat\" onClick={() => close()}>\n          <Trans message=\"Cancel\" />\n        </Button>\n        <Button\n          form={formId}\n          type=\"submit\"\n          variant=\"flat\"\n          color=\"primary\"\n          disabled={renameEntry.isPending || !form.formState.isDirty}\n        >\n          <Trans message=\"Save\" />\n        </Button>\n      </DialogFooter>\n    </Dialog>\n  );\n}\n","import {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {ReactElement} from 'react';\nimport {ActiveActionDialog, driveState, useDriveStore} from '@app/drive/drive-store';\nimport {ShareDialog} from '@app/drive/share-dialog/share-dialog';\nimport {BlockTrashFolderViewDialog} from '@app/drive/files/dialogs/block-trash-folder-view-dialog';\nimport {DeleteEntriesForeverDialog} from '@app/drive/files/dialogs/delete-entries-forever-dialog';\nimport {EntryPreviewDialog} from '@app/drive/files/dialogs/entry-preview-dialog';\nimport {MoveEntriesDialog} from '@app/drive/files/dialogs/move-entries-dialog/move-entries-dialog';\nimport {NewFolderDialog} from '@app/drive/files/dialogs/new-folder-dialog';\nimport {RenameEntryDialog} from '@app/drive/files/dialogs/rename-entry-dialog';\n\nexport function DriveDialogsContainer() {\n  const activeDialog = useDriveStore(s => s.activeActionDialog);\n  const dialog = getDialog(activeDialog);\n\n  return (\n    <DialogTrigger\n      type=\"modal\"\n      isOpen={!!dialog}\n      onClose={() => {\n        driveState().setActiveActionDialog(null);\n      }}\n    >\n      {dialog}\n    </DialogTrigger>\n  );\n}\n\nfunction getDialog(dialog?: ActiveActionDialog | null): ReactElement | null {\n  switch (dialog?.name) {\n    case 'rename':\n      return <RenameEntryDialog entries={dialog.entries} />;\n    case 'newFolder':\n      return <NewFolderDialog parentId={dialog.entries[0]?.id} />;\n    case 'preview':\n      return <EntryPreviewDialog selectedEntry={dialog.entries[0]} />;\n    case 'share':\n      return <ShareDialog entry={dialog.entries[0]} />;\n    case 'moveTo':\n      return <MoveEntriesDialog entries={dialog.entries} />;\n    case 'confirmAndDeleteForever':\n      return <DeleteEntriesForeverDialog entries={dialog.entries} />;\n    case 'trashFolderBlock':\n      return <BlockTrashFolderViewDialog entries={dialog.entries} />;\n    default:\n      return null;\n  }\n}\n","import {useNavigate} from '@common/ui/navigation/use-navigate';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {TextField} from '@ui/forms/input-field/text-field/text-field';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {SearchIcon} from '@ui/icons/material/Search';\nimport {useState} from 'react';\nimport {useSearchParams} from 'react-router';\nimport {SearchPage} from '@app/drive/drive-page/drive-page';\nimport {useDriveStore} from '@app/drive/drive-store';\n\nexport function NavbarSearch() {\n  const {trans} = useTrans();\n  const navigate = useNavigate();\n  const activePage = useDriveStore(s => s.activePage);\n  const [searchParams] = useSearchParams();\n  const [inputValue, setInputValue] = useState(searchParams.get('query') || '');\n\n  return (\n    <form\n      className=\"ml-10 flex-auto\"\n      onSubmit={e => {\n        e.preventDefault();\n        navigate(\n          {\n            pathname: SearchPage.path,\n            search: `?query=${inputValue}`,\n          },\n          {replace: true},\n        );\n      }}\n    >\n      <TextField\n        size=\"lg\"\n        background=\"bg-elevated\"\n        inputRadius=\"rounded-full\"\n        inputBorder=\"border border-divider-lighter\"\n        inputShadow=\"shadow-sm\"\n        inputClassName=\"max-h-46 placeholder:text-main/50\"\n        value={inputValue}\n        onChange={e => setInputValue(e.target.value)}\n        onFocus={() => {\n          if (activePage !== SearchPage) {\n            navigate(SearchPage.path);\n          }\n        }}\n        startAdornment={\n          <IconButton type=\"submit\">\n            <SearchIcon />\n          </IconButton>\n        }\n        className=\"max-w-720 flex-auto\"\n        placeholder={trans({message: 'Search files and folders'})}\n        aria-label={trans({message: 'Search files and folders'})}\n      />\n    </form>\n  );\n}\n","import {FileTypeIcon} from '@common/uploads/components/file-type-icon/file-type-icon';\nimport {useFileUploadStore} from '@common/uploads/uploader/file-upload-provider';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {message} from '@ui/i18n/message';\nimport {MixedText} from '@ui/i18n/mixed-text';\nimport {Trans} from '@ui/i18n/trans';\nimport {CheckCircleIcon} from '@ui/icons/material/CheckCircle';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport {ErrorIcon} from '@ui/icons/material/Error';\nimport {WarningIcon} from '@ui/icons/material/Warning';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport {Tooltip} from '@ui/tooltip/tooltip';\nimport {prettyBytes} from '@ui/utils/files/pretty-bytes';\nimport {\n  UploadedFile,\n  UploadedFileFromEntry,\n} from '@ui/utils/files/uploaded-file';\nimport {shallowEqual} from '@ui/utils/shallow-equal';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {\n  ComponentPropsWithoutRef,\n  CSSProperties,\n  Fragment,\n  memo,\n  ReactElement,\n  useMemo,\n  useState,\n} from 'react';\nimport {useShallow} from 'zustand/react/shallow';\n\ninterface Props {\n  file: UploadedFile | UploadedFileFromEntry;\n  className?: string;\n  style?: CSSProperties;\n}\nexport const UploadQueueItem = memo(({file, className, style}: Props) => {\n  return (\n    <div className={clsx('flex items-center gap-14', className)} style={style}>\n      <div className=\"shrink-0 rounded border p-8\">\n        <FileTypeIcon className=\"h-22 w-22\" mime={file.mime} />\n      </div>\n      <div className=\"min-w-0 flex-auto pr-10\">\n        <div className=\"mb-2 flex min-w-0 items-center gap-10\">\n          <div className=\"min-w-0 flex-auto overflow-hidden overflow-ellipsis whitespace-nowrap font-medium\">\n            {file.name}\n          </div>\n        </div>\n        <SizeInfo file={file} />\n      </div>\n      <div className=\"mr-10\">\n        <FileStatus file={file} />\n      </div>\n    </div>\n  );\n}, shallowEqual);\n\ninterface SizeInfoProps {\n  file: UploadedFile | UploadedFileFromEntry;\n}\nfunction SizeInfo({file}: SizeInfoProps) {\n  const fileUpload = useFileUploadStore(\n    useShallow(s => s.fileUploads.get(file.id)),\n  );\n  const bytesUploaded = fileUpload?.bytesUploaded || 0;\n\n  const totalBytes = useMemo(() => prettyBytes(file.size), [file]);\n  const uploadedBytes = useMemo(\n    () => prettyBytes(bytesUploaded),\n    [bytesUploaded],\n  );\n\n  let statusMessage: ReactElement;\n  if (fileUpload?.status === 'completed') {\n    statusMessage = <Trans message=\"Upload complete\" />;\n  } else if (fileUpload?.status === 'aborted') {\n    statusMessage = <Trans message=\"Upload cancelled\" />;\n  } else if (fileUpload?.status === 'failed') {\n    statusMessage = <Trans message=\"Upload failed\" />;\n  } else if (fileUpload?.status === 'pending') {\n    statusMessage = <Fragment>{totalBytes}</Fragment>;\n  } else {\n    statusMessage = (\n      <Trans\n        message=\":bytesUploaded of :totalBytes\"\n        values={{\n          bytesUploaded: uploadedBytes,\n          totalBytes,\n        }}\n      />\n    );\n  }\n\n  return <div className=\"text-xs text-muted\">{statusMessage}</div>;\n}\n\ninterface FileStatusProps {\n  file: UploadedFile | UploadedFileFromEntry;\n}\nfunction FileStatus({file}: FileStatusProps) {\n  const fileUpload = useFileUploadStore(\n    useShallow(s => s.fileUploads.get(file.id)),\n  );\n  const abortUpload = useFileUploadStore(s => s.abortUpload);\n  const percentage = fileUpload?.percentage || 0;\n  const status = fileUpload?.status;\n  const errorMessage = fileUpload?.errorMessage;\n\n  const [isHovered, setIsHovered] = useState(false);\n\n  const abortButton = (\n    <IconButton\n      size=\"xs\"\n      iconSize=\"sm\"\n      onClick={() => {\n        abortUpload(file.id);\n      }}\n    >\n      <CloseIcon />\n    </IconButton>\n  );\n\n  const progressButton = (\n    <ProgressCircle\n      aria-label=\"Upload progress\"\n      size=\"w-24 h-24\"\n      value={percentage}\n      isIndeterminate={percentage === 100}\n      trackWidth={3}\n    />\n  );\n\n  let statusButton: ReactElement;\n  if (status === 'failed') {\n    const errMessage =\n      errorMessage || message('This file could not be uploaded');\n    statusButton = (\n      <AnimatedStatus>\n        <Tooltip variant=\"danger\" label={<MixedText value={errMessage} />}>\n          <ErrorIcon className=\"text-danger\" size=\"md\" />\n        </Tooltip>\n      </AnimatedStatus>\n    );\n  } else if (status === 'aborted') {\n    statusButton = (\n      <AnimatedStatus>\n        <WarningIcon className=\"text-warning\" size=\"md\" />\n      </AnimatedStatus>\n    );\n  } else if (status === 'completed') {\n    statusButton = (\n      <AnimatedStatus>\n        <CheckCircleIcon size=\"md\" className=\"text-positive\" />\n      </AnimatedStatus>\n    );\n  } else if (status === 'pending') {\n    statusButton = <AnimatedStatus>{abortButton}</AnimatedStatus>;\n  } else {\n    statusButton = (\n      <AnimatedStatus\n        onPointerEnter={e => {\n          if (e.pointerType === 'mouse') {\n            setIsHovered(true);\n          }\n        }}\n        onPointerLeave={e => {\n          if (e.pointerType === 'mouse') {\n            setIsHovered(false);\n          }\n        }}\n      >\n        {isHovered ? abortButton : progressButton}\n      </AnimatedStatus>\n    );\n  }\n\n  return <AnimatePresence>{statusButton}</AnimatePresence>;\n}\n\ninterface AnimatedStatusProps\n  extends Omit<\n    ComponentPropsWithoutRef<'div'>,\n    'onAnimationStart' | 'onDragStart' | 'onDragEnd' | 'onDrag'\n  > {\n  children: ReactElement;\n}\nfunction AnimatedStatus({children, ...domProps}: AnimatedStatusProps) {\n  return (\n    <m.div\n      {...domProps}\n      initial={{scale: 0, opacity: 0}}\n      animate={{scale: 1, opacity: 1}}\n      exit={{scale: 0, opacity: 0}}\n    >\n      {children}\n    </m.div>\n  );\n}\n","import {useFileUploadStore} from '@common/uploads/uploader/file-upload-provider';\nimport {UploadQueueItem} from '@common/uploads/uploader/ui/upload-queue-item';\nimport {useVirtualizer} from '@tanstack/react-virtual';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {Trans} from '@ui/i18n/trans';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {ReactElement, useRef} from 'react';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\n\nexport function UploadQueue() {\n  const isOpen = useDriveStore(s => s.uploadQueueIsOpen);\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <m.div\n          key=\"upload-queue\"\n          className=\"fixed bottom-16 right-16 z-modal w-375 overflow-hidden rounded-panel border bg text-sm shadow-xl\"\n          initial={{y: '100%', opacity: 0}}\n          animate={{y: 0, opacity: 1}}\n          exit={{y: '100%', opacity: 0}}\n        >\n          <Header />\n          <UploadList />\n        </m.div>\n      )}\n    </AnimatePresence>\n  );\n}\n\nexport function Header() {\n  const inProgressUploadsCount = useFileUploadStore(s => s.activeUploadsCount);\n  const completedUploadsCount = useFileUploadStore(\n    s => s.completedUploadsCount,\n  );\n  const clearInactive = useFileUploadStore(s => s.clearInactive);\n\n  let message: ReactElement;\n  if (inProgressUploadsCount) {\n    message = (\n      <Trans\n        message=\"Uploading :count files\"\n        values={{count: inProgressUploadsCount}}\n      />\n    );\n  } else if (completedUploadsCount) {\n    message = (\n      <Trans\n        message=\"Uploaded :count files\"\n        values={{count: completedUploadsCount}}\n      />\n    );\n  } else {\n    message = <Trans message=\"No active uploads\" />;\n  }\n\n  // only allow closing upload queue if there are no active uploads\n  return (\n    <div className=\"flex min-h-[45px] items-center justify-between gap-10 border-b bg-alt px-10 py-4\">\n      {message}\n      {inProgressUploadsCount === 0 ? (\n        <IconButton\n          size=\"sm\"\n          onClick={() => {\n            driveState().setUploadQueueIsOpen(false);\n            // wait for upload queue panel animation to complete, then clear inactive uploads\n            setTimeout(() => {\n              clearInactive();\n            }, 200);\n          }}\n        >\n          <CloseIcon />\n        </IconButton>\n      ) : undefined}\n    </div>\n  );\n}\n\nfunction UploadList() {\n  const uploads = useFileUploadStore(s => s.fileUploads);\n  const uploadsArray = [...uploads.values()];\n  const ref = useRef<HTMLDivElement>(null);\n  const virtualizer = useVirtualizer({\n    count: uploads.size,\n    getScrollElement: () => ref.current,\n    estimateSize: () => 60,\n    overscan: 4,\n  });\n\n  return (\n    <div className=\"max-h-320 overflow-y-auto\" ref={ref}>\n      <div\n        className=\"relative w-full\"\n        style={{\n          height: `${virtualizer.getTotalSize()}px`,\n        }}\n      >\n        {virtualizer.getVirtualItems().map(virtualItem => {\n          const upload = uploadsArray[virtualItem.index];\n          return (\n            <UploadQueueItem\n              key={upload.file.id}\n              file={upload.file}\n              className=\"absolute left-0 top-0 w-full p-10\"\n              style={{\n                height: `${virtualItem.size}px`,\n                transform: `translateY(${virtualItem.start}px)`,\n              }}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n","import {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {useDriveUploadQueue} from '@app/drive/uploading/use-drive-upload-queue';\nimport {Button} from '@ui/buttons/button';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {Trans} from '@ui/i18n/trans';\nimport {AddIcon} from '@ui/icons/material/Add';\nimport {CreateNewFolderIcon} from '@ui/icons/material/CreateNewFolder';\nimport {DriveFolderUploadIcon} from '@ui/icons/material/DriveFolderUpload';\nimport {FileUploadIcon} from '@ui/icons/material/FileUpload';\nimport {UploadFileIcon} from '@ui/icons/material/UploadFile';\nimport {Menu, MenuItem, MenuTrigger} from '@ui/menu/menu-trigger';\nimport {openUploadWindow} from '@ui/utils/files/open-upload-window';\n\ninterface CreateNewButtonProps {\n  isCompact?: boolean;\n  className?: string;\n}\nexport function CreateNewButton({isCompact, className}: CreateNewButtonProps) {\n  const activePage = useDriveStore(s => s.activePage);\n  const {uploadFiles} = useDriveUploadQueue();\n\n  const button = isCompact ? (\n    <IconButton size=\"md\" disabled={!activePage?.canUpload}>\n      <AddIcon />\n    </IconButton>\n  ) : (\n    <Button\n      className=\"w-full\"\n      color=\"primary\"\n      variant=\"flat\"\n      size=\"sm\"\n      startIcon={<FileUploadIcon />}\n      disabled={!activePage?.canUpload}\n    >\n      <Trans message=\"Upload\" />\n    </Button>\n  );\n\n  return (\n    <div className={className}>\n      <MenuTrigger\n        onItemSelected={async value => {\n          if (value === 'uploadFiles') {\n            uploadFiles(await openUploadWindow({multiple: true}));\n          } else if (value === 'uploadFolder') {\n            uploadFiles(await openUploadWindow({directory: true}));\n          } else if (value === 'newFolder') {\n            const activeFolder = driveState().activePage?.folder;\n            driveState().setActiveActionDialog(\n              'newFolder',\n              activeFolder ? [activeFolder] : [],\n            );\n          }\n        }}\n      >\n        {button}\n        <Menu>\n          <MenuItem value=\"uploadFiles\" startIcon={<UploadFileIcon />}>\n            <Trans message=\"Upload files\" />\n          </MenuItem>\n          <MenuItem value=\"uploadFolder\" startIcon={<DriveFolderUploadIcon />}>\n            <Trans message=\"Upload folder\" />\n          </MenuItem>\n          <MenuItem value=\"newFolder\" startIcon={<CreateNewFolderIcon />}>\n            <Trans message=\"Create folder\" />\n          </MenuItem>\n        </Menu>\n      </MenuTrigger>\n    </div>\n  );\n}\n","import clsx from 'clsx';\nimport React from 'react';\nimport {ButtonProps} from './button';\nimport {ButtonSize} from './button-size';\nimport {ButtonColor, ButtonVariant} from './get-shared-button-style';\n\nexport interface ButtonGroupProps {\n  children: React.ReactNode[];\n  color?: ButtonColor;\n  variant?: ButtonVariant;\n  size?: ButtonSize;\n  radius?: string;\n  className?: string;\n  value?: any;\n  onChange?: (newValue: any) => void;\n  multiple?: boolean;\n  disabled?: boolean;\n}\nexport function ButtonGroup({\n  children,\n  color,\n  variant,\n  radius = 'rounded-button',\n  size,\n  className,\n  value,\n  onChange,\n  multiple,\n  disabled,\n}: ButtonGroupProps) {\n  const isActive = (childValue: any): boolean => {\n    // assume that button group is not used as a toggle group, if there is no value given\n    if (value === undefined) return false;\n    if (multiple) {\n      return (value as any[]).includes(childValue);\n    }\n    return childValue === value;\n  };\n\n  const toggleMultipleValue = (childValue: any) => {\n    const newValue = [...value];\n    const childIndex = value.indexOf(childValue);\n    if (childIndex > -1) {\n      newValue.splice(childIndex, 1);\n    } else {\n      newValue.push(childValue);\n    }\n    return newValue;\n  };\n\n  const buttons = React.Children.map(children, (button, i) => {\n    if (React.isValidElement(button)) {\n      const buttonProps = button.props as ButtonProps;\n      const active = isActive(buttonProps.value);\n      const adjustedColor = active ? 'primary' : color;\n      return React.cloneElement<ButtonProps>(button as any, {\n        color: active ? 'primary' : color,\n        variant,\n        size,\n        radius: null,\n        disabled: buttonProps.disabled || disabled,\n        ...buttonProps,\n        onClick: e => {\n          if (buttonProps.onClick) {\n            buttonProps.onClick(e);\n          }\n          if (!onChange) return;\n          if (multiple) {\n            onChange?.(toggleMultipleValue(buttonProps.value));\n          } else {\n            onChange?.(buttonProps.value);\n          }\n        },\n        className: clsx(\n          buttonProps.className,\n          // borders are hidden via negative margin, make sure both are visible for active item\n          active ? 'z-20' : 'z-10',\n          getStyle(i, children, radius, adjustedColor),\n        ),\n      });\n    }\n  });\n  return (\n    <div className={clsx(radius, 'isolate inline-flex', className)}>\n      {buttons}\n    </div>\n  );\n}\n\nfunction getStyle(\n  i: number,\n  children: ButtonGroupProps['children'],\n  radius: ButtonGroupProps['radius'],\n  color?: ButtonColor,\n): string {\n  // first\n  if (i === 0) {\n    return clsx(\n      radius,\n      'rounded-tr-none rounded-br-none',\n      !color && 'border-r-transparent disabled:border-r-transparent',\n    );\n  }\n  // last\n  if (i === children.length - 1) {\n    return clsx(radius, 'rounded-tl-none rounded-bl-none -ml-1');\n  }\n  return clsx(\n    'rounded-none -ml-1',\n    !color && 'border-r-transparent disabled:border-r-transparent',\n  );\n}\n","import {LucideIconWrapper} from '@ui/icons/lucide/lucide-icon-wrapper';\nimport {SvgIconProps} from '@ui/icons/svg-icon';\nimport {forwardRef} from 'react';\n\nexport const LayoutGridIcon = forwardRef<SVGSVGElement, SvgIconProps>(\n  (props, ref) => (\n    <LucideIconWrapper {...props} ref={ref}>\n      <rect width=\"7\" height=\"7\" x=\"3\" y=\"3\" rx=\"1\" />\n      <rect width=\"7\" height=\"7\" x=\"14\" y=\"3\" rx=\"1\" />\n      <rect width=\"7\" height=\"7\" x=\"14\" y=\"14\" rx=\"1\" />\n      <rect width=\"7\" height=\"7\" x=\"3\" y=\"14\" rx=\"1\" />\n    </LucideIconWrapper>\n  ),\n);\n","import {LucideIconWrapper} from '@ui/icons/lucide/lucide-icon-wrapper';\nimport {SvgIconProps} from '@ui/icons/svg-icon';\nimport {forwardRef} from 'react';\n\nexport const LayoutListIcon = forwardRef<SVGSVGElement, SvgIconProps>(\n  (props, ref) => (\n    <LucideIconWrapper {...props} ref={ref}>\n      <rect width=\"7\" height=\"7\" x=\"3\" y=\"3\" rx=\"1\" />\n      <rect width=\"7\" height=\"7\" x=\"3\" y=\"14\" rx=\"1\" />\n      <path d=\"M14 4h7\" />\n      <path d=\"M14 9h7\" />\n      <path d=\"M14 15h7\" />\n      <path d=\"M14 20h7\" />\n    </LucideIconWrapper>\n  ),\n);\n","import {DashboardContentHeader} from '@common/ui/dashboard-layout/dashboard-content-header';\nimport {DashboardLayoutContext} from '@common/ui/dashboard-layout/dashboard-layout-context';\nimport {ButtonGroup} from '@ui/buttons/button-group';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {Trans} from '@ui/i18n/trans';\nimport {LayoutGridIcon} from '@ui/icons/lucide/layout-grid';\nimport {LayoutListIcon} from '@ui/icons/lucide/layout-list';\nimport {InfoIcon} from '@ui/icons/material/Info';\nimport {Tooltip} from '@ui/tooltip/tooltip';\nimport {useContext} from 'react';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {PageBreadcrumbs} from '@app/drive/page-breadcrumbs';\nimport {DriveSortButton} from '@app/drive/layout/sorting/drive-sort-button';\n\nexport function DriveContentHeader() {\n  const {isMobileMode} = useContext(DashboardLayoutContext);\n  const activePage = useDriveStore(s => s.activePage);\n  return (\n    <DashboardContentHeader className=\"flex h-60 flex-shrink-0 items-center gap-20 border-b border-divider-lighter px-8 py-4 md:px-26\">\n      {isMobileMode ? (\n        <DriveSortButton isDisabled={activePage?.disableSort} />\n      ) : (\n        <PageBreadcrumbs />\n      )}\n      <div className=\"ml-auto flex flex-shrink-0 items-center gap-6\">\n        <ToggleViewModeButton />\n        <ToggleDetailsButton />\n      </div>\n    </DashboardContentHeader>\n  );\n}\n\nfunction ToggleViewModeButton() {\n  const viewMode = useDriveStore(s => s.viewMode);\n  const tooltip =\n    viewMode === 'grid' ? (\n      <Trans message=\"List view\" />\n    ) : (\n      <Trans message=\"Grid view\" />\n    );\n\n  return (\n    <ButtonGroup\n      size=\"xs\"\n      variant=\"outline\"\n      radius=\"rounded-full\"\n      value={viewMode}\n      onChange={value => {\n        driveState().setViewMode(value);\n      }}\n    >\n      <IconButton value=\"list\" className=\"min-w-54\">\n        <LayoutListIcon />\n      </IconButton>\n      <IconButton value=\"grid\" className=\"min-w-54\">\n        <LayoutGridIcon />\n      </IconButton>\n    </ButtonGroup>\n  );\n}\n\nfunction ToggleDetailsButton() {\n  const {rightSidenavStatus: status, setRightSidenavStatus} = useContext(\n    DashboardLayoutContext,\n  );\n  const tooltip = status ? (\n    <Trans message=\"Hide details\" />\n  ) : (\n    <Trans message=\"Show details\" />\n  );\n  return (\n    <Tooltip label={tooltip}>\n      <IconButton\n        radius=\"rounded-full\"\n        size=\"sm\"\n        color={status === 'open' ? 'primary' : null}\n        onClick={() => {\n          setRightSidenavStatus(status === 'open' ? 'closed' : 'open');\n        }}\n      >\n        <InfoIcon />\n      </IconButton>\n    </Tooltip>\n  );\n}\n","import {PolicyFailReason} from '@common/billing/upgrade/policy-fail-reason';\nimport {\n  SectionHelper,\n  SectionHelperProps,\n} from '@common/ui/other/section-helper';\nimport {LinkStyle} from '@ui/buttons/external-link';\nimport {Trans} from '@ui/i18n/trans';\nimport {useSettings} from '@ui/settings/use-settings';\nimport {ReactElement, ReactNode} from 'react';\nimport {Link} from 'react-router';\n\ninterface Props {\n  className?: string;\n  // plural name in lowercase (e.g. 'projects')\n  resourceName?: ReactElement | string;\n  reason?: PolicyFailReason;\n  size?: SectionHelperProps['size'];\n  color?: SectionHelperProps['color'];\n  message?: ReactNode;\n}\nexport function PolicyFailMessage({\n  resourceName,\n  className,\n  size = 'md',\n  color = 'bgAlt',\n  reason = 'overQuota',\n  ...other\n}: Props) {\n  const message = other.message ?? (\n    <MessageText resourceName={resourceName!} reason={reason} />\n  );\n\n  return (\n    <SectionHelper\n      color={color}\n      size={size}\n      className={className}\n      description={message}\n    />\n  );\n}\n\ninterface MessageTextProps {\n  resourceName: ReactElement | string;\n  reason?: PolicyFailReason;\n}\nfunction MessageText({resourceName, reason}: MessageTextProps) {\n  const {billing} = useSettings();\n\n  if (reason === 'noWorkspacePermission') {\n    return (\n      <Trans\n        message=\"You can't create new :name in this workspace.\"\n        values={{name: resourceName}}\n      />\n    );\n  }\n\n  const upgradeMsgValues = {\n    name: resourceName,\n    a: (text: ReactNode) => (\n      <Link className={LinkStyle} to=\"/pricing\">\n        {text}\n      </Link>\n    ),\n  };\n\n  if (reason === 'overQuota' && billing.enable) {\n    return (\n      <Trans\n        message=\"Your plan is at its maximum number of :name allowed. <a>Upgrade to add more.</a>\"\n        values={upgradeMsgValues}\n      />\n    );\n  }\n\n  if (reason === 'noPermission' && billing.enable) {\n    return (\n      <Trans\n        message=\"To unlock ability to create :name. <a>Upgrade your plan.</a>\"\n        values={upgradeMsgValues}\n      />\n    );\n  }\n\n  return (\n    <Trans\n      message=\"You don't have permissions to create :name.\"\n      values={{name: resourceName}}\n    />\n  );\n}\n","import {ConfirmationDialog} from '@ui/overlays/dialog/confirmation-dialog';\nimport {Trans} from '@ui/i18n/trans';\n\ninterface Props {\n  onConfirm?: () => void;\n  isLoading?: boolean;\n}\nexport function LeaveWorkspaceConfirmation({onConfirm, isLoading}: Props) {\n  return (\n    <ConfirmationDialog\n      isDanger\n      title={<Trans message=\"Leave workspace\" />}\n      isLoading={isLoading}\n      onConfirm={onConfirm}\n      body={\n        <div>\n          <Trans message=\"Are you sure you want to leave this workspace?\" />\n          <div className=\"mt-8 font-semibold\">\n            <Trans message=\"All resources you've created in the workspace will be transferred to workspace owner.\" />\n          </div>\n        </div>\n      }\n      confirm={<Trans message=\"Leave\" />}\n    />\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {UseFormReturn} from 'react-hook-form';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {toast} from '@ui/toast/toast';\nimport {apiClient, queryClient} from '../../http/query-client';\nimport {WorkspaceQueryKeys} from './workspace-query-keys';\nimport {Workspace} from '../types/workspace';\nimport {onFormQueryError} from '../../errors/on-form-query-error';\nimport {message} from '@ui/i18n/message';\n\ninterface Response extends BackendResponse {\n  workspace: Workspace;\n}\n\ninterface Props {\n  name: string;\n}\n\nexport function useCreateWorkspace(form: UseFormReturn<Props>) {\n  return useMutation({\n    mutationFn: (props: Props) => createWorkspace(props),\n    onSuccess: () => {\n      toast(message('Created workspace'));\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.fetchUserWorkspaces,\n      });\n    },\n    onError: r => onFormQueryError(r, form),\n  });\n}\n\nfunction createWorkspace(props: Props): Promise<Response> {\n  return apiClient.post('workspace', props).then(r => r.data);\n}\n","import {useForm} from 'react-hook-form';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Form} from '@ui/forms/form';\nimport {Button} from '@ui/buttons/button';\nimport {useCreateWorkspace} from './requests/create-workspace';\nimport {DialogFooter} from '@ui/overlays/dialog/dialog-footer';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {Trans} from '@ui/i18n/trans';\n\nexport function NewWorkspaceDialog() {\n  const form = useForm<{name: string}>();\n  const {formId, close} = useDialogContext();\n  const createWorkspace = useCreateWorkspace(form);\n\n  return (\n    <Dialog>\n      <DialogHeader>\n        <Trans message=\"Create workspace\" />\n      </DialogHeader>\n      <DialogBody>\n        <Form\n          form={form}\n          id={formId}\n          onSubmit={() => {\n            createWorkspace.mutate(form.getValues(), {\n              onSuccess: response => {\n                close(response.workspace.id);\n              },\n            });\n          }}\n        >\n          <FormTextField\n            name=\"name\"\n            autoFocus\n            label={<Trans message=\"Workspace name\" />}\n            minLength={3}\n            required\n          />\n        </Form>\n      </DialogBody>\n      <DialogFooter>\n        <Button variant=\"text\" onClick={close}>\n          <Trans message=\"Cancel\" />\n        </Button>\n        <Button\n          variant=\"flat\"\n          color=\"primary\"\n          type=\"submit\"\n          form={formId}\n          disabled={createWorkspace.isPending}\n        >\n          <Trans message=\"Create\" />\n        </Button>\n      </DialogFooter>\n    </Dialog>\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {UseFormReturn} from 'react-hook-form';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {toast} from '@ui/toast/toast';\nimport {apiClient, queryClient} from '../../http/query-client';\nimport {WorkspaceQueryKeys} from './workspace-query-keys';\nimport {Workspace} from '../types/workspace';\nimport {onFormQueryError} from '../../errors/on-form-query-error';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {message} from '@ui/i18n/message';\n\ninterface Response extends BackendResponse {\n  workspace: Workspace;\n}\n\nexport interface UpdateWorkspacePayload {\n  id: number;\n  name: string;\n}\n\nfunction updateWorkspace({\n  id,\n  ...props\n}: UpdateWorkspacePayload): Promise<Response> {\n  return apiClient.put(`workspace/${id}`, props).then(r => r.data);\n}\n\nexport function useUpdateWorkspace(\n  form: UseFormReturn<UpdateWorkspacePayload>,\n) {\n  const {close} = useDialogContext();\n  return useMutation({\n    mutationFn: (props: UpdateWorkspacePayload) => updateWorkspace(props),\n    onSuccess: response => {\n      close();\n      toast(message('Updated workspace'));\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.fetchUserWorkspaces,\n      });\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.workspaceWithMembers(\n          response.workspace.id,\n        ),\n      });\n    },\n    onError: r => onFormQueryError(r, form),\n  });\n}\n","import {useForm} from 'react-hook-form';\nimport {FormTextField} from '@ui/forms/input-field/text-field/text-field';\nimport {Form} from '@ui/forms/form';\nimport {Button} from '@ui/buttons/button';\nimport {DialogFooter} from '@ui/overlays/dialog/dialog-footer';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {\n  UpdateWorkspacePayload,\n  useUpdateWorkspace,\n} from './requests/update-workspace';\nimport {Workspace} from './types/workspace';\nimport {Trans} from '@ui/i18n/trans';\n\ninterface Props {\n  workspace: Workspace;\n}\nexport function RenameWorkspaceDialog({workspace}: Props) {\n  const form = useForm<UpdateWorkspacePayload>({\n    defaultValues: {id: workspace.id, name: workspace.name},\n  });\n  const {formId, close} = useDialogContext();\n  const updateWorkspace = useUpdateWorkspace(form);\n\n  return (\n    <Dialog>\n      <DialogHeader>\n        <Trans message=\"Rename workspace\" />\n      </DialogHeader>\n      <DialogBody>\n        <Form\n          form={form}\n          id={formId}\n          onSubmit={() => {\n            updateWorkspace.mutate(form.getValues());\n          }}\n        >\n          <FormTextField\n            name=\"name\"\n            autoFocus\n            label={<Trans message=\"Name\" />}\n            minLength={3}\n            required\n          />\n        </Form>\n      </DialogBody>\n      <DialogFooter>\n        <Button variant=\"text\" onClick={close}>\n          <Trans message=\"Cancel\" />\n        </Button>\n        <Button\n          variant=\"flat\"\n          color=\"primary\"\n          type=\"submit\"\n          form={formId}\n          disabled={updateWorkspace.isPending}\n        >\n          <Trans message=\"Rename\" />\n        </Button>\n      </DialogFooter>\n    </Dialog>\n  );\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {toast} from '@ui/toast/toast';\nimport {apiClient, queryClient} from '../../http/query-client';\nimport {WorkspaceQueryKeys} from './workspace-query-keys';\nimport {useActiveWorkspaceId} from '../active-workspace-id-context';\nimport {PersonalWorkspace} from '../user-workspaces';\nimport {message} from '@ui/i18n/message';\nimport {showHttpErrorToast} from '../../http/show-http-error-toast';\n\ninterface Response extends BackendResponse {}\n\nexport interface DeleteWorkspacePayload {\n  id: number;\n}\n\nfunction deleteWorkspace({id}: DeleteWorkspacePayload): Promise<Response> {\n  return apiClient.delete(`workspace/${id}`).then(r => r.data);\n}\n\nexport function useDeleteWorkspace() {\n  const {workspaceId, setWorkspaceId} = useActiveWorkspaceId();\n  return useMutation({\n    mutationFn: (props: DeleteWorkspacePayload) => deleteWorkspace(props),\n    onSuccess: (r, payload) => {\n      toast(message('Deleted workspace'));\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.fetchUserWorkspaces,\n      });\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.workspaceWithMembers(payload.id),\n      });\n\n      // if user deleted workspace that is currently active, switch to personal workspace\n      if (workspaceId === payload.id) {\n        setWorkspaceId(PersonalWorkspace.id);\n      }\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {apiClient, queryClient} from '../../http/query-client';\nimport {WorkspaceQueryKeys} from './workspace-query-keys';\nimport {useAuth} from '../../auth/use-auth';\nimport {useActiveWorkspaceId} from '../active-workspace-id-context';\nimport {PersonalWorkspace} from '../user-workspaces';\nimport {showHttpErrorToast} from '../../http/show-http-error-toast';\n\ninterface Response extends BackendResponse {}\n\ninterface Props {\n  workspaceId: number;\n  memberId: number | string;\n  memberType: 'invite' | 'member';\n}\n\nfunction removeMember({\n  workspaceId,\n  memberId,\n  memberType,\n}: Props): Promise<Response> {\n  const endpoint =\n    memberType === 'invite'\n      ? `workspace/invite/${memberId}`\n      : `workspace/${workspaceId}/member/${memberId}`;\n  return apiClient.delete(endpoint).then(r => r.data);\n}\n\nexport function useRemoveMember() {\n  const {workspaceId, setWorkspaceId} = useActiveWorkspaceId();\n  const {user} = useAuth();\n  return useMutation({\n    mutationFn: (props: Props) => removeMember(props),\n    onSuccess: (response, props) => {\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.fetchUserWorkspaces,\n      });\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.workspaceWithMembers(props.workspaceId),\n      });\n\n      // if user left workspace that is currently active, switch to personal workspace\n      if (props.memberId === user?.id && workspaceId === props.workspaceId) {\n        setWorkspaceId(PersonalWorkspace.id);\n      }\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {toast} from '@ui/toast/toast';\nimport {apiClient, queryClient} from '../../http/query-client';\nimport {WorkspaceQueryKeys} from './workspace-query-keys';\nimport {WorkspaceMember} from '../types/workspace-member';\nimport {WorkspaceInvite} from '../types/workspace-invite';\nimport {message} from '@ui/i18n/message';\nimport {showHttpErrorToast} from '../../http/show-http-error-toast';\n\ninterface Response extends BackendResponse {}\n\ninterface Props {\n  workspaceId: number;\n  member: WorkspaceMember | WorkspaceInvite;\n  roleId: number;\n}\n\nfunction ChangeRole({workspaceId, member, ...other}: Props): Promise<Response> {\n  const modelType = member.model_type;\n  const memberId =\n    member.model_type === 'invite' ? member.id : member.member_id;\n  return apiClient\n    .post(\n      `workspace/${workspaceId}/${modelType}/${memberId}/change-role`,\n      other,\n    )\n    .then(r => r.data);\n}\n\nexport function useChangeRole() {\n  return useMutation({\n    mutationFn: (props: Props) => ChangeRole(props),\n    onSuccess: (response, props) => {\n      toast(message('Role changed'));\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.workspaceWithMembers(props.workspaceId),\n      });\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {apiClient, queryClient} from '../../http/query-client';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {WorkspaceInvite} from '../types/workspace-invite';\nimport {WorkspaceQueryKeys} from './workspace-query-keys';\nimport {showHttpErrorToast} from '../../http/show-http-error-toast';\n\ninterface Response extends BackendResponse {\n  invites: WorkspaceInvite[];\n}\n\ninterface Props {\n  workspaceId: number;\n  emails: string[];\n  roleId: number;\n}\n\nfunction InviteMembers({workspaceId, ...other}: Props): Promise<Response> {\n  return apiClient\n    .post(`workspace/${workspaceId}/invite`, other)\n    .then(r => r.data);\n}\n\nexport function useInviteMembers() {\n  return useMutation({\n    mutationFn: (props: Props) => InviteMembers(props),\n    onSuccess: (response, props) => {\n      queryClient.invalidateQueries({\n        queryKey: WorkspaceQueryKeys.workspaceWithMembers(props.workspaceId),\n      });\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n","import {useMutation} from '@tanstack/react-query';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {WorkspaceInvite} from '../types/workspace-invite';\nimport {toast} from '@ui/toast/toast';\nimport {apiClient} from '../../http/query-client';\nimport {showHttpErrorToast} from '../../http/show-http-error-toast';\n\ninterface Response extends BackendResponse {\n  invite: WorkspaceInvite;\n}\n\ninterface Props {\n  workspaceId: number;\n  inviteId: string;\n}\n\nfunction ResendInvite({\n  workspaceId,\n  inviteId,\n  ...other\n}: Props): Promise<Response> {\n  return apiClient\n    .post(`workspace/${workspaceId}/${inviteId}/resend`, other)\n    .then(r => r.data);\n}\n\nexport function useResendInvite() {\n  return useMutation({\n    mutationFn: (props: Props) => ResendInvite(props),\n    onSuccess: () => {\n      toast('Invite sent');\n    },\n    onError: err => showHttpErrorToast(err),\n  });\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {WorkspaceQueryKeys} from './workspace-query-keys';\nimport {Workspace} from '../types/workspace';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {apiClient} from '../../http/query-client';\n\nexport interface FetchWorkspaceWithMembersResponse extends BackendResponse {\n  workspace: Workspace;\n}\n\nfunction fetchWorkspaceWithMembers(\n  workspaceId: number,\n): Promise<FetchWorkspaceWithMembersResponse> {\n  return apiClient\n    .get(`workspace/${workspaceId}`)\n    .then(response => response.data);\n}\n\nexport function useWorkspaceWithMembers(workspaceId: number) {\n  return useQuery({\n    queryKey: WorkspaceQueryKeys.workspaceWithMembers(workspaceId),\n    queryFn: () => fetchWorkspaceWithMembers(workspaceId),\n  });\n}\n","import {Avatar} from '@ui/avatar/avatar';\nimport {Button} from '@ui/buttons/button';\nimport {ButtonSize} from '@ui/buttons/button-size';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {\n  ChipField,\n  ChipValue,\n} from '@ui/forms/input-field/chip-field/chip-field';\nimport {message} from '@ui/i18n/message';\nimport {Trans} from '@ui/i18n/trans';\nimport {useTrans} from '@ui/i18n/use-trans';\nimport {ArrowDropDownIcon} from '@ui/icons/material/ArrowDropDown';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport {ExitToAppIcon} from '@ui/icons/material/ExitToApp';\nimport {GroupIcon} from '@ui/icons/material/Group';\nimport {Menu, MenuItem, MenuTrigger} from '@ui/menu/menu-trigger';\nimport {ConfirmationDialog} from '@ui/overlays/dialog/confirmation-dialog';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {DialogHeader} from '@ui/overlays/dialog/dialog-header';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {ProgressCircle} from '@ui/progress/progress-circle';\nimport {toast} from '@ui/toast/toast';\nimport {isEmail} from '@ui/utils/string/is-email';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {useEffect, useState} from 'react';\nimport {useAuth} from '../auth/use-auth';\nimport {useValueLists} from '../http/value-lists';\nimport {LeaveWorkspaceConfirmation} from './leave-workspace-confirmation';\nimport {useChangeRole} from './requests/change-role';\nimport {useInviteMembers} from './requests/invite-members';\nimport {useRemoveMember} from './requests/remove-member';\nimport {useResendInvite} from './requests/resend-invite';\nimport {useWorkspaceWithMembers} from './requests/workspace-with-members';\nimport {Workspace} from './types/workspace';\nimport {WorkspaceInvite} from './types/workspace-invite';\nimport {WorkspaceMember} from './types/workspace-member';\n\ninterface WorkspaceMembersDialogProps {\n  workspace: Workspace;\n}\nexport function WorkspaceMembersDialog({\n  workspace,\n}: WorkspaceMembersDialogProps) {\n  const {data, isLoading} = useWorkspaceWithMembers(workspace.id);\n  return (\n    <Dialog size=\"lg\">\n      <DialogHeader>\n        <Trans message=\"Manage workspace members\" />\n      </DialogHeader>\n      <DialogBody>\n        {isLoading ? (\n          <div className=\"flex min-h-[238px] items-center justify-center\">\n            <ProgressCircle isIndeterminate aria-label=\"Loading workspace...\" />\n          </div>\n        ) : (\n          <Manager workspace={data!.workspace} />\n        )}\n      </DialogBody>\n    </Dialog>\n  );\n}\n\ninterface ManagerProps {\n  workspace: Workspace;\n}\nfunction Manager({workspace}: ManagerProps) {\n  const {user} = useAuth();\n  const can = usePermissions(workspace);\n  const members: (WorkspaceMember | WorkspaceInvite)[] = [\n    ...(workspace.members || []),\n    ...(workspace.invites || []),\n  ];\n  const shouldHideOtherMembers = !can.update && !can.delete;\n\n  return (\n    <div>\n      {can.invite && <InviteChipField workspace={workspace} />}\n      <div className=\"mb-14 flex items-center gap-10 text-base\">\n        <GroupIcon className=\"icon-sm\" />\n        <Trans\n          message=\"Members of `:workspace`\"\n          values={{workspace: workspace.name}}\n        />\n      </div>\n      <AnimatePresence initial={false}>\n        {members.map(member => {\n          if (shouldHideOtherMembers && member.id !== user?.id) {\n            return null;\n          }\n          return (\n            <MemberListItem\n              key={`${member.model_type}.${member.id}`}\n              workspace={workspace}\n              member={member}\n            />\n          );\n        })}\n        {shouldHideOtherMembers && (\n          <div className=\"text-muted\">\n            <Trans\n              message=\"And [one one other member|:count other members]\"\n              values={{count: members.length}}\n            />\n          </div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n\ninterface MemberListItemProps {\n  member: WorkspaceMember | WorkspaceInvite;\n  workspace: Workspace;\n}\nfunction MemberListItem({workspace, member}: MemberListItemProps) {\n  return (\n    <m.div\n      initial={{x: '-100%', opacity: 0}}\n      animate={{x: 0, opacity: 1}}\n      exit={{x: '100%', opacity: 0}}\n      transition={{type: 'tween', duration: 0.125}}\n      className=\"mb-20 flex items-start gap-14 text-sm\"\n      key={`${member.model_type}.${member.id}`}\n    >\n      <Avatar\n        className=\"flex-shrink-0\"\n        size=\"lg\"\n        circle\n        label={member.name}\n        src={member.image}\n        fallback=\"initials\"\n      />\n      <div className=\"min-w-0 flex-auto items-center justify-between gap-14 md:flex\">\n        <div className=\"mb-10 overflow-hidden md:mb-0 md:mr-10\">\n          <div className=\"flex items-center justify-start gap-6\">\n            <div className=\"overflow-hidden text-ellipsis whitespace-nowrap\">\n              {member.name}\n            </div>\n            <MemberDisplayNameAppend workspace={workspace} member={member} />\n          </div>\n          <div className=\"text-muted\">{member.email}</div>\n        </div>\n        <MemberActions workspace={workspace} member={member} />\n      </div>\n    </m.div>\n  );\n}\n\nfunction usePermissions(workspace: Workspace) {\n  const {user: authUser} = useAuth();\n  const response = {update: false, invite: false, delete: false};\n  const permissions = ['update', 'invite', 'delete'] as const;\n  const authMember = workspace.members?.find(mb => mb.id === authUser?.id);\n\n  if (authMember) {\n    permissions.forEach(permission => {\n      response[permission] =\n        authMember.is_owner ||\n        !!authMember.permissions?.find(\n          p => p.name === `workspace_members.${permission}`,\n        );\n    });\n  }\n\n  return response;\n}\n\ninterface MemberActionsProps {\n  workspace: Workspace;\n  member: WorkspaceMember | WorkspaceInvite;\n}\nfunction MemberActions({workspace, member}: MemberActionsProps) {\n  const [selectedRole, setSelectedRole] = useState<number>(member.role_id);\n  const changeRole = useChangeRole();\n  const {user} = useAuth();\n\n  const can = usePermissions(workspace);\n  const isOwner = member.model_type === 'member' && member.is_owner;\n  const isCurrentUser =\n    member.model_type === 'member' && user?.id === member.id;\n\n  const roleSelector =\n    !can.update || isOwner || isCurrentUser ? (\n      <div className=\"ml-auto text-muted first:capitalize\">\n        <Trans message={member.role_name} />\n      </div>\n    ) : (\n      <RoleMenuTrigger\n        className=\"ml-auto flex-shrink-0\"\n        size=\"xs\"\n        value={selectedRole}\n        isDisabled={changeRole.isPending}\n        onChange={roleId => {\n          setSelectedRole(roleId);\n          changeRole.mutate({\n            roleId,\n            workspaceId: workspace.id,\n            member,\n          });\n        }}\n      />\n    );\n\n  return (\n    <>\n      {roleSelector}\n      {!isOwner && (isCurrentUser || can.delete) && (\n        <RemoveMemberButton\n          type={isCurrentUser ? 'leave' : 'remove'}\n          member={member}\n          workspace={workspace}\n        />\n      )}\n    </>\n  );\n}\n\ninterface InviteChipFieldProps {\n  workspace: Workspace;\n}\nfunction InviteChipField({workspace}: InviteChipFieldProps) {\n  const {trans} = useTrans();\n  const [chips, setChips] = useState<ChipValue[]>([]);\n  const allEmailsValid = chips.every(chip => !chip.invalid);\n  const displayWith = (chip: ChipValue) => chip.description || chip.name;\n  const [selectedRole, setSelectedRole] = useState<number>();\n  const inviteMembers = useInviteMembers();\n  const {data} = useValueLists(['workspaceRoles']);\n\n  useEffect(() => {\n    if (!selectedRole && data?.workspaceRoles?.length) {\n      setSelectedRole(data.workspaceRoles[0].id);\n    }\n  }, [data, selectedRole]);\n\n  return (\n    <div className=\"mb-30\">\n      <ChipField\n        value={chips}\n        onChange={setChips}\n        displayWith={displayWith}\n        validateWith={chip => {\n          const invalid = !isEmail(chip.description);\n          return {\n            ...chip,\n            invalid,\n            errorMessage: invalid\n              ? trans({message: 'Not a valid email'})\n              : undefined,\n          };\n        }}\n        placeholder={trans({message: 'Enter email addresses'})}\n        label={<Trans message=\"Invite people\" />}\n      />\n      <div className=\"mt-14 flex items-center justify-between gap-14\">\n        <RoleMenuTrigger onChange={setSelectedRole} value={selectedRole} />\n        {chips.length && selectedRole ? (\n          <Button\n            variant=\"flat\"\n            color=\"primary\"\n            size=\"sm\"\n            disabled={inviteMembers.isPending || !allEmailsValid}\n            onClick={() => {\n              inviteMembers.mutate(\n                {\n                  emails: chips.map(c => displayWith(c)),\n                  roleId: selectedRole,\n                  workspaceId: workspace.id,\n                },\n                {\n                  onSuccess: () => {\n                    setChips([]);\n                  },\n                },\n              );\n            }}\n          >\n            <Trans message=\"Invite\" />\n          </Button>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\ninterface RemoveMemberButtonProps {\n  member: WorkspaceMember | WorkspaceInvite;\n  workspace: Workspace;\n  type: 'leave' | 'remove';\n}\nfunction RemoveMemberButton({\n  member,\n  workspace,\n  type,\n}: RemoveMemberButtonProps) {\n  const removeMember = useRemoveMember();\n  const {close} = useDialogContext();\n  return (\n    <DialogTrigger\n      type=\"modal\"\n      onClose={isConfirmed => {\n        if (isConfirmed) {\n          removeMember.mutate({\n            workspaceId: workspace.id,\n            memberId: member.id,\n            memberType: member.model_type,\n          });\n          if (type === 'leave') {\n            close();\n            toast(message('Left workspace'));\n          }\n        }\n      }}\n    >\n      <IconButton\n        size=\"md\"\n        className=\"flex-shrink-0 text-muted\"\n        disabled={removeMember.isPending}\n      >\n        {type === 'leave' ? <ExitToAppIcon /> : <CloseIcon />}\n      </IconButton>\n      {type === 'leave' ? (\n        <LeaveWorkspaceConfirmation />\n      ) : (\n        <RemoveMemberConfirmation member={member} />\n      )}\n    </DialogTrigger>\n  );\n}\n\ninterface RemoveMemberConfirmationProps {\n  member: WorkspaceMember | WorkspaceInvite;\n}\nfunction RemoveMemberConfirmation({member}: RemoveMemberConfirmationProps) {\n  return (\n    <ConfirmationDialog\n      isDanger\n      title={<Trans message=\"Remove member\" />}\n      body={\n        <div>\n          <Trans\n            message=\"Are you sure you want to remove `:name`?\"\n            values={{name: member.name}}\n          />\n          <div className=\"mt-8 font-semibold\">\n            <Trans\n              message=\"All workspace resources created by `:name` will be transferred to workspace owner.\"\n              values={{\n                name: member.name,\n              }}\n            />\n          </div>\n        </div>\n      }\n      confirm={<Trans message=\"Remove\" />}\n    />\n  );\n}\n\ninterface RoleMenuTriggerProps {\n  onChange: (value: number) => void;\n  value?: number;\n  size?: ButtonSize;\n  className?: string;\n  isDisabled?: boolean;\n}\nfunction RoleMenuTrigger({\n  value,\n  onChange,\n  size = 'xs',\n  className,\n  isDisabled,\n}: RoleMenuTriggerProps) {\n  const {data} = useValueLists(['workspaceRoles']);\n  const role = data?.workspaceRoles?.find(r => r.id === value);\n  if (!value || !role || !data?.workspaceRoles) return null;\n\n  return (\n    <MenuTrigger\n      selectionMode=\"single\"\n      selectedValue={value}\n      onSelectionChange={newValue => {\n        onChange(newValue as number);\n      }}\n    >\n      <Button\n        className={className}\n        size={size}\n        variant=\"flat\"\n        color=\"chip\"\n        disabled={isDisabled}\n        endIcon={<ArrowDropDownIcon />}\n      >\n        <Trans message={role.name} />\n      </Button>\n      <Menu>\n        {data.workspaceRoles.map(r => (\n          <MenuItem value={r.id} key={r.id} description={r.description}>\n            <Trans message={r.name} />\n          </MenuItem>\n        ))}\n      </Menu>\n    </MenuTrigger>\n  );\n}\n\ninterface MemberDisplayNameAppendProps {\n  member: WorkspaceMember | WorkspaceInvite;\n  workspace: Workspace;\n}\nfunction MemberDisplayNameAppend({\n  member,\n  workspace,\n}: MemberDisplayNameAppendProps) {\n  const {user} = useAuth();\n  const can = usePermissions(workspace);\n\n  if (user?.id === member.id) {\n    return (\n      <div className=\"font-medium\">\n        (<Trans message=\"You\" />)\n      </div>\n    );\n  }\n  if (member.model_type === 'invite') {\n    return (\n      <div className=\"flex items-center gap-4\">\n        <div></div>\n        <div className=\"font-medium\">\n          <Trans message=\"Invited\" />\n        </div>\n        {can.invite ? (\n          <>\n            <div></div>\n            <ResendInviteDialogTrigger member={member} workspace={workspace} />\n          </>\n        ) : null}\n      </div>\n    );\n  }\n  return null;\n}\n\nfunction ResendInviteDialogTrigger({\n  member,\n  workspace,\n}: MemberDisplayNameAppendProps) {\n  const resendInvite = useResendInvite();\n  return (\n    <DialogTrigger\n      type=\"modal\"\n      onClose={isConfirmed => {\n        if (isConfirmed) {\n          resendInvite.mutate({\n            workspaceId: workspace.id,\n            inviteId: member.id as string,\n          });\n        }\n      }}\n    >\n      <Button\n        variant=\"link\"\n        size=\"sm\"\n        color=\"primary\"\n        disabled={resendInvite.isPending}\n      >\n        <Trans message=\"Resend invite\" />\n      </Button>\n      <ConfirmationDialog\n        title={<Trans message=\"Resend invite\" />}\n        body={\n          <Trans message=\"Are you sure you want to send this invite again?\" />\n        }\n        confirm={<Trans message=\"Send\" />}\n      />\n    </DialogTrigger>\n  );\n}\n","import {PolicyFailMessage} from '@common/billing/upgrade/policy-fail-message';\nimport {Button, ButtonProps} from '@ui/buttons/button';\nimport {ButtonBase} from '@ui/buttons/button-base';\nimport {Trans} from '@ui/i18n/trans';\nimport {AddIcon} from '@ui/icons/material/Add';\nimport {CheckIcon} from '@ui/icons/material/Check';\nimport {DeleteIcon} from '@ui/icons/material/Delete';\nimport {EditIcon} from '@ui/icons/material/Edit';\nimport {ExitToAppIcon} from '@ui/icons/material/ExitToApp';\nimport {KeyboardArrowDownIcon} from '@ui/icons/material/KeyboardArrowDown';\nimport {PersonAddIcon} from '@ui/icons/material/PersonAdd';\nimport {UnfoldMoreIcon} from '@ui/icons/material/UnfoldMore';\nimport {Menu, MenuItem, MenuTrigger} from '@ui/menu/menu-trigger';\nimport {ConfirmationDialog} from '@ui/overlays/dialog/confirmation-dialog';\nimport {Dialog} from '@ui/overlays/dialog/dialog';\nimport {DialogBody} from '@ui/overlays/dialog/dialog-body';\nimport {useDialogContext} from '@ui/overlays/dialog/dialog-context';\nimport {DialogTrigger} from '@ui/overlays/dialog/dialog-trigger';\nimport {openDialog} from '@ui/overlays/store/dialog-store';\nimport clsx from 'clsx';\nimport {\n  cloneElement,\n  forwardRef,\n  Fragment,\n  ReactElement,\n  useEffect,\n  useState,\n} from 'react';\nimport {useAuth} from '../auth/use-auth';\nimport {\n  useActiveWorkspace,\n  useActiveWorkspaceId,\n} from './active-workspace-id-context';\nimport {LeaveWorkspaceConfirmation} from './leave-workspace-confirmation';\nimport {NewWorkspaceDialog} from './new-workspace-dialog';\nimport {RenameWorkspaceDialog} from './rename-workspace-dialog';\nimport {useDeleteWorkspace} from './requests/delete-workspace';\nimport {useRemoveMember} from './requests/remove-member';\nimport {Workspace} from './types/workspace';\nimport {PersonalWorkspace, useUserWorkspaces} from './user-workspaces';\nimport {WorkspaceMembersDialog} from './workspace-members-dialog';\n\ninterface WorkspaceSelectorProps {\n  className?: string;\n  onChange?: (id: number) => void;\n  trigger?: ReactElement<ButtonProps>;\n  placement?: 'top' | 'bottom';\n}\nexport function WorkspaceSelector({\n  onChange,\n  className,\n  trigger,\n  placement = 'top',\n}: WorkspaceSelectorProps) {\n  const {data: workspaces, isFetched, isFetching} = useUserWorkspaces();\n  const {setWorkspaceId} = useActiveWorkspaceId();\n  const activeWorkspace = useActiveWorkspace();\n  const [selectorIsOpen, setSelectorIsOpen] = useState(false);\n  const {hasPermission} = useAuth();\n\n  // if user no longer has access to previously selected workspace, select personal one\n  useEffect(() => {\n    // make sure we don't unset active workspace while user workspaces are being re-fetched\n    if (isFetched && !isFetching && !activeWorkspace) {\n      setWorkspaceId(PersonalWorkspace.id);\n    }\n  }, [activeWorkspace, workspaces, setWorkspaceId, isFetched, isFetching]);\n\n  if (\n    // if we have a custom trigger, leave rendering up to the customer trigger\n    !trigger &&\n    (!activeWorkspace ||\n      (!hasPermission('workspaces.create') && workspaces?.length === 1))\n  ) {\n    return null;\n  }\n\n  return (\n    <Fragment>\n      <DialogTrigger\n        type=\"popover\"\n        placement={placement}\n        isOpen={selectorIsOpen}\n        onClose={() => {\n          setSelectorIsOpen(false);\n        }}\n      >\n        {trigger ? (\n          cloneElement(trigger, {\n            onClick: () => setSelectorIsOpen(!selectorIsOpen),\n          })\n        ) : (\n          <DefaultTrigger\n            onClick={() => setSelectorIsOpen(!selectorIsOpen)}\n            workspace={activeWorkspace!}\n            className={className}\n          />\n        )}\n        <Dialog size=\"min-w-320\">\n          <DialogBody padding=\"p-10\">\n            <div className=\"mb-16 border-b pb-10\">\n              {workspaces?.map(workspace => (\n                <WorkspaceItem\n                  key={workspace.id}\n                  workspace={workspace}\n                  setSelectorIsOpen={setSelectorIsOpen}\n                  onChange={onChange}\n                />\n              ))}\n            </div>\n            <div className=\"mb-4 px-4 text-center\">\n              <CreateWorkspaceButton\n                onClick={() => setSelectorIsOpen(false)}\n                onCreated={id => onChange?.(id)}\n                workspaceCount={workspaces ? workspaces.length - 1 : 0}\n              />\n            </div>\n          </DialogBody>\n        </Dialog>\n      </DialogTrigger>\n    </Fragment>\n  );\n}\n\ninterface CreateWorkspaceButtonProps {\n  onClick: () => void;\n  onCreated?: (id: number) => void;\n  workspaceCount: number;\n}\nfunction CreateWorkspaceButton({\n  onClick,\n  onCreated,\n  workspaceCount,\n}: CreateWorkspaceButtonProps) {\n  const {setWorkspaceId} = useActiveWorkspaceId();\n  const {checkOverQuotaOrNoPermission} = useAuth();\n  const {overQuotaOrNoPermission} = checkOverQuotaOrNoPermission(\n    'workspaces.create',\n    'count',\n    workspaceCount,\n  );\n\n  return (\n    <Fragment>\n      <Button\n        disabled={overQuotaOrNoPermission}\n        onClick={async e => {\n          e.preventDefault();\n          e.stopPropagation();\n          onClick();\n          const workspaceId = await openDialog(NewWorkspaceDialog);\n          if (workspaceId) {\n            setWorkspaceId(workspaceId);\n            onCreated?.(workspaceId);\n          }\n        }}\n        variant=\"outline\"\n        startIcon={<AddIcon />}\n        color=\"primary\"\n        className=\"h-40 w-full\"\n      >\n        <Trans message=\"Create new workspace\" />\n      </Button>\n      {overQuotaOrNoPermission && (\n        <PolicyFailMessage\n          size=\"sm\"\n          className=\"mt-12 max-w-288\"\n          resourceName={<Trans message=\"worksapces\" />}\n        />\n      )}\n    </Fragment>\n  );\n}\n\ninterface DefaultTriggerProps {\n  onClick: () => void;\n  workspace: Workspace;\n  className?: string;\n}\nconst DefaultTrigger = forwardRef<HTMLButtonElement, DefaultTriggerProps>(\n  ({workspace, className, onClick, ...other}, ref) => {\n    return (\n      <ButtonBase\n        ref={ref}\n        onClick={onClick}\n        className={clsx(\n          'flex items-center gap-10 rounded ring-inset hover:bg-hover focus-visible:ring-2',\n          className,\n        )}\n        {...other}\n      >\n        <span className=\"mr-auto block flex-auto overflow-hidden text-left\">\n          <span className=\"block overflow-hidden overflow-ellipsis text-sm font-medium text-main\">\n            {workspace.default ? (\n              <Trans message={workspace.name} />\n            ) : (\n              workspace.name\n            )}\n          </span>\n          <span className=\"block text-xs text-muted\">\n            {workspace.default ? (\n              <Trans message=\"Personal workspace\" />\n            ) : (\n              <Trans\n                message=\":count members\"\n                values={{count: workspace.members_count}}\n              />\n            )}\n          </span>\n        </span>\n        <UnfoldMoreIcon className=\"shrink-0 icon-md\" />\n      </ButtonBase>\n    );\n  },\n);\n\ninterface WorkspaceItemProps {\n  workspace: Workspace;\n  onChange: WorkspaceSelectorProps['onChange'];\n  setSelectorIsOpen: (value: boolean) => void;\n}\nfunction WorkspaceItem({\n  workspace,\n  onChange,\n  setSelectorIsOpen,\n}: WorkspaceItemProps) {\n  const {workspaceId, setWorkspaceId} = useActiveWorkspaceId();\n  const isActive = workspaceId === workspace.id;\n\n  return (\n    <div\n      onClick={() => {\n        setWorkspaceId(workspace.id);\n        onChange?.(workspace.id);\n        setSelectorIsOpen(false);\n      }}\n      className={clsx(\n        'mb-4 flex cursor-pointer items-center gap-12 rounded-lg p-10 text-left',\n        isActive && 'bg-primary/5',\n        !isActive && 'hover:bg-hover',\n      )}\n    >\n      <CheckIcon\n        size=\"sm\"\n        className={clsx('flex-shrink-0 text-primary', !isActive && 'invisible')}\n      />\n      <div className=\"flex-auto\">\n        <div className={clsx('text-sm', isActive && 'font-semibold')}>\n          {workspace.name}\n        </div>\n        <div className=\"text-sm text-muted\">\n          {workspace.default ? (\n            <Trans message=\"Personal workspace\" />\n          ) : (\n            <Trans\n              message=\":count members\"\n              values={{count: workspace.members_count}}\n            />\n          )}\n        </div>\n      </div>\n      {workspace.id !== 0 && (\n        <ManageButton\n          setSelectorIsOpen={setSelectorIsOpen}\n          workspace={workspace}\n          onChange={onChange}\n        />\n      )}\n    </div>\n  );\n}\n\ninterface LeaveWorkspaceDialogProps {\n  workspace: Workspace;\n  onChange?: (id: number) => void;\n}\nfunction LeaveWorkspaceDialog({\n  workspace,\n  onChange,\n}: LeaveWorkspaceDialogProps) {\n  const removeMember = useRemoveMember();\n  const {user} = useAuth();\n  const {close} = useDialogContext();\n  return (\n    <LeaveWorkspaceConfirmation\n      isLoading={removeMember.isPending}\n      onConfirm={() => {\n        removeMember.mutate(\n          {\n            workspaceId: workspace.id,\n            memberId: user!.id,\n            memberType: 'member',\n          },\n          {\n            onSuccess: () => {\n              close();\n              onChange?.(PersonalWorkspace.id);\n            },\n          },\n        );\n      }}\n    />\n  );\n}\n\ninterface DeleteWorkspaceConfirmationProps {\n  workspace: Workspace;\n  onChange?: (id: number) => void;\n}\nfunction DeleteWorkspaceConfirmation({\n  workspace,\n  onChange,\n}: DeleteWorkspaceConfirmationProps) {\n  const deleteWorkspace = useDeleteWorkspace();\n  const {close} = useDialogContext();\n  return (\n    <ConfirmationDialog\n      isDanger\n      title={<Trans message=\"Delete workspace\" />}\n      body={\n        <Trans\n          message=\"Are you sure you want to delete :name?\"\n          values={{name: workspace.name}}\n        />\n      }\n      confirm={<Trans message=\"Delete\" />}\n      isLoading={deleteWorkspace.isPending}\n      onConfirm={() => {\n        deleteWorkspace.mutate(\n          {id: workspace.id},\n          {\n            onSuccess: () => {\n              close();\n              onChange?.(PersonalWorkspace.id);\n            },\n          },\n        );\n      }}\n    />\n  );\n}\n\ninterface ManageButtonProps {\n  setSelectorIsOpen: (value: boolean) => void;\n  workspace: Workspace;\n  onChange?: (id: number) => void;\n}\nfunction ManageButton({\n  setSelectorIsOpen,\n  workspace,\n  onChange,\n}: ManageButtonProps) {\n  const {user} = useAuth();\n\n  return (\n    <MenuTrigger onItemSelected={() => setSelectorIsOpen(false)}>\n      <Button\n        onClick={e => {\n          e.preventDefault();\n          e.stopPropagation();\n        }}\n        color=\"primary\"\n        size=\"xs\"\n        variant=\"outline\"\n        endIcon={<KeyboardArrowDownIcon />}\n      >\n        <Trans message=\"Manage\" />\n      </Button>\n      <Menu>\n        <MenuItem\n          onClick={e => {\n            e.stopPropagation();\n            openDialog(WorkspaceMembersDialog, {workspace});\n          }}\n          value=\"workspaceMembers\"\n          startIcon={<PersonAddIcon />}\n        >\n          <Trans message=\"Members\" />\n        </MenuItem>\n        {workspace.owner_id === user?.id && (\n          <MenuItem\n            onClick={e => {\n              e.stopPropagation();\n              openDialog(RenameWorkspaceDialog, {workspace});\n            }}\n            value=\"updateWorkspace\"\n            startIcon={<EditIcon />}\n          >\n            <Trans message=\"Rename\" />\n          </MenuItem>\n        )}\n        {workspace.owner_id !== user?.id && (\n          <MenuItem\n            onClick={e => {\n              e.stopPropagation();\n              openDialog(LeaveWorkspaceDialog, {workspace, onChange});\n            }}\n            value=\"leaveWorkspace\"\n            startIcon={<ExitToAppIcon />}\n          >\n            <Trans message=\"Leave\" />\n          </MenuItem>\n        )}\n        {workspace.owner_id === user?.id && (\n          <MenuItem\n            onClick={e => {\n              e.stopPropagation();\n              openDialog(DeleteWorkspaceConfirmation, {workspace, onChange});\n            }}\n            value=\"deleteWorkspace\"\n            startIcon={<DeleteIcon />}\n          >\n            <Trans message=\"Delete\" />\n          </MenuItem>\n        )}\n      </Menu>\n    </MenuTrigger>\n  );\n}\n","import {DeleteIcon} from '@ui/icons/material/Delete';\nimport {GroupIcon} from '@ui/icons/material/Group';\nimport {HistoryIcon} from '@ui/icons/material/History';\nimport {StarOutlineIcon} from '@ui/icons/material/StarOutline';\n\nexport const driveSidebarIcons = {\n  '/drive/recent': HistoryIcon,\n  '/drive/starred': StarOutlineIcon,\n  '/drive/shares': GroupIcon,\n  '/drive/trash': DeleteIcon,\n};\n","\"use strict\";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)},defaultConfig=(Object.defineProperty(exports,\"__esModule\",{value:!0}),{id:\"id\",parentId:\"parentId\",dataField:\"data\",childrenField:\"children\",throwIfOrphans:!1,rootParentIds:{\"\":!(exports.countNodes=exports.arrayToTree=void 0)},nestedIds:!0,assign:!1});function arrayToTree(c,e){void 0===e&&(e={});for(var r,t=__assign(__assign({},defaultConfig),e),n=[],o={},a=t.throwIfOrphans?new Set:null,s=0,h=c;s<h.length;s++){var i=h[s],d=t.nestedIds?getNestedProperty(i,t.id):i[t.id],l=t.nestedIds?getNestedProperty(i,t.parentId):i[t.parentId];if(t.rootParentIds[d])throw new Error(\"The item array contains a node whose parentId both exists in another node and is in \"+'`rootParentIds` (`itemId`: \"'.concat(d,'\", `rootParentIds`: ').concat(Object.keys(t.rootParentIds).map(function(e){return'\"'.concat(e,'\"')}).join(\", \"),\").\"));Object.prototype.hasOwnProperty.call(o,d)||(o[d]=((r={})[t.childrenField]=[],r)),a&&a.delete(d),t.dataField?o[d][t.dataField]=i:t.assign?o[d]=Object.assign(i,((r={})[t.childrenField]=o[d][t.childrenField],r)):o[d]=__assign(__assign({},i),((i={})[t.childrenField]=o[d][t.childrenField],i));i=o[d];null==l||t.rootParentIds[l]?n.push(i):(Object.prototype.hasOwnProperty.call(o,l)||(o[l]=((d={})[t.childrenField]=[],d),a&&a.add(l)),o[l][t.childrenField].push(i))}if(null!=a&&a.size)throw new Error(\"The items array contains orphans that point to the following parentIds: \"+\"[\".concat(Array.from(a),\"]. These parentIds do not exist in the items array. Hint: prevent orphans to result \")+\"in an error by passing the following option: { throwIfOrphans: false }\");if(t.throwIfOrphans&&countNodes(n,t.childrenField)<Object.keys(o).length)throw new Error(\"The items array contains nodes with a circular parent/child relationship.\");return n}function countNodes(e,t){return e.reduce(function(e,r){return e+1+(r[t]&&countNodes(r[t],t))},0)}function getNestedProperty(e,r){return r.split(\".\").reduce(function(e,r){return e&&e[r]},e)}exports.arrayToTree=arrayToTree,exports.countNodes=countNodes;","import { useDroppable } from '@ui/interactions/dnd/use-droppable';\nimport { RefObject, useState } from 'react';\nimport { driveState } from '@app/drive/drive-store';\nimport { DriveFolder } from '@app/drive/files/drive-entry';\nimport {\n  folderAcceptsDrop,\n  useFolderDropAction,\n} from '@app/drive/files/use-folder-drop-action';\nimport { makeFolderTreeDragId } from '@app/drive/layout/sidebar/folder-tree-drag-id';\n\ninterface Props {\n  folder: DriveFolder;\n  ref: RefObject<HTMLDivElement | null>;\n}\nexport function useSidebarTreeDropTarget({folder, ref}: Props) {\n  const [isDragOver, setIsDragOver] = useState(false);\n  const {onDrop} = useFolderDropAction(folder);\n\n  const dropProps = useDroppable({\n    id: makeFolderTreeDragId(folder),\n    ref,\n    types: ['fileEntry', 'nativeFile'],\n    acceptsDrop: draggable => folderAcceptsDrop(draggable, folder),\n    onDragEnter: draggable => {\n      if (folderAcceptsDrop(draggable, folder)) {\n        setIsDragOver(true);\n      }\n    },\n    onDragLeave: () => {\n      setIsDragOver(false);\n    },\n    onDropActivate: () => {\n      if (!driveState().sidebarExpandedKeys.includes(folder.id)) {\n        driveState().setSidebarExpandedKeys([\n          ...driveState().sidebarExpandedKeys,\n          folder.id,\n        ]);\n      }\n    },\n    onDrop,\n  });\n\n  return {...dropProps, isDragOver};\n}\n","import {createContext, Key} from 'react';\n\nexport interface TreeContextValue {\n  expandedKeys: Key[];\n  setExpandedKeys: (value: Key[]) => void;\n  selectedKeys: Key[];\n  setSelectedKeys: (value: Key[]) => void;\n  focusedNode?: Key;\n  setFocusedNode: (node?: Key) => void;\n}\n\nexport const TreeContext = createContext<TreeContextValue>(null!);\n","import {TreeItemRenderer} from './tree-item';\nimport {cloneElement} from 'react';\nimport {TreeNode} from './tree';\n\ninterface RenderTreeProps<T extends TreeNode> {\n  nodes: T[];\n  parentNode?: T;\n  itemRenderer: TreeItemRenderer<T>;\n  level?: number;\n}\nexport function renderTree<T extends TreeNode>({\n  nodes,\n  itemRenderer,\n  parentNode,\n  level,\n}: RenderTreeProps<T>) {\n  return nodes.map((node, index) => {\n    return cloneElement(itemRenderer(node), {\n      level: level == undefined ? 0 : level + 1,\n      index,\n      node,\n      parentNode,\n      key: node.id,\n      itemRenderer,\n    });\n  });\n}\n","import React, {Key, useState} from 'react';\nimport {useControlledState} from '@react-stately/utils';\nimport {FocusScope} from '@react-aria/focus';\nimport {TreeContext, TreeContextValue} from './tree-context';\nimport {TreeItemRenderer} from './tree-item';\nimport {renderTree} from './render-tree';\n\nexport interface TreeNode {\n  id: number | string;\n  children: TreeNode[];\n}\n\ninterface TreeProps<T extends TreeNode> {\n  children: TreeItemRenderer<T>;\n  nodes: T[];\n  selectedKeys?: Key[];\n  expandedKeys?: Key[];\n  defaultExpandedKeys?: Key[];\n  onExpandedKeysChange?: (value: Key[]) => void;\n  defaultSelectedKeys?: Key[];\n  onSelectedKeysChange?: (value: Key[]) => void;\n}\nexport function Tree<T extends TreeNode>({\n  children,\n  nodes,\n  ...props\n}: TreeProps<T>) {\n  const [expandedKeys, setExpandedKeys] = useControlledState(\n    props.expandedKeys,\n    props.defaultSelectedKeys,\n    props.onExpandedKeysChange\n  );\n  const [selectedKeys, setSelectedKeys] = useControlledState(\n    props.selectedKeys,\n    props.defaultSelectedKeys,\n    props.onSelectedKeysChange\n  );\n  const [focusedNode, setFocusedNode] = useState<Key | undefined>();\n\n  const value: TreeContextValue = {\n    expandedKeys,\n    setExpandedKeys,\n    selectedKeys,\n    setSelectedKeys,\n    focusedNode,\n    setFocusedNode,\n  };\n\n  return (\n    <TreeContext.Provider value={value}>\n      <FocusScope>\n        <TreeRoot nodes={nodes} itemRenderer={children} />\n      </FocusScope>\n    </TreeContext.Provider>\n  );\n}\n\ninterface TreeRootProps<T extends TreeNode> {\n  nodes: TreeNode[];\n  itemRenderer: TreeItemRenderer<T>;\n}\nfunction TreeRoot<T extends TreeNode>(props: TreeRootProps<T>) {\n  return (\n    <ul className=\"overflow-hidden text-sm\" role=\"tree\">\n      {renderTree(props)}\n    </ul>\n  );\n}\n","import {ArrowRightIcon} from '@ui/icons/material/ArrowRight';\nimport clsx from 'clsx';\nimport {forwardRef, MouseEventHandler, ReactNode, useContext} from 'react';\nimport {TreeContext} from './tree-context';\n\ninterface TreeLabelProps {\n  level?: number;\n  node: any;\n  icon?: ReactNode;\n  label?: ReactNode;\n  className?: string;\n}\nexport const TreeLabel = forwardRef<HTMLDivElement, TreeLabelProps>(\n  ({icon, label, level = 0, node, className, ...domProps}, ref) => {\n    const {expandedKeys, setExpandedKeys, selectedKeys, setSelectedKeys} =\n      useContext(TreeContext);\n    const isExpanded = expandedKeys.includes(node.id);\n    const isSelected = selectedKeys.includes(node.id);\n\n    const handleExpandIconClick: MouseEventHandler = e => {\n      e.stopPropagation();\n      const index = expandedKeys.indexOf(node.id);\n      const newExpandedKeys = [...expandedKeys];\n      if (index > -1) {\n        newExpandedKeys.splice(index, 1);\n      } else {\n        newExpandedKeys.push(node.id);\n      }\n      setExpandedKeys(newExpandedKeys);\n    };\n\n    return (\n      <div\n        {...domProps}\n        ref={ref}\n        onClick={e => {\n          e.stopPropagation();\n          setSelectedKeys([node.id]);\n        }}\n        className={clsx(\n          'header tree-label flex cursor-pointer flex-nowrap items-center gap-4 overflow-hidden text-ellipsis whitespace-nowrap rounded-button py-6',\n          className,\n          isSelected && 'bg-primary/selected font-bold text-primary',\n          !isSelected && 'hover:bg-hover',\n        )}\n      >\n        {level > 0 && (\n          <div className=\"flex\">\n            {Array.from({length: level}).map((_, i) => {\n              return <div key={i} className=\"h-24 w-24\" />;\n            })}\n          </div>\n        )}\n        <div onClick={handleExpandIconClick}>\n          <ArrowRightIcon\n            className={clsx(\n              'cursor-default transition-transform icon-sm',\n              isExpanded && 'rotate-90',\n            )}\n          />\n        </div>\n        {icon}\n        <div className=\"overflow-hidden text-ellipsis pr-6\">{label}</div>\n      </div>\n    );\n  },\n);\nTreeLabel.displayName = 'TreeLabel';\n","import React, {\n  HTMLAttributes,\n  ReactElement,\n  ReactNode,\n  Ref,\n  useContext,\n  useEffect,\n} from 'react';\nimport {useFocusManager} from '@react-aria/focus';\nimport {TreeContext} from './tree-context';\nimport {createEventHandler} from '@ui/utils/dom/create-event-handler';\nimport clsx from 'clsx';\nimport {AnimatePresence, m} from 'framer-motion';\nimport {TreeNode} from './tree';\nimport {renderTree} from './render-tree';\nimport {TreeLabel} from './tree-label';\n\nexport type TreeItemRenderer<T extends TreeNode> = (\n  node: any,\n) => ReactElement<TreeItemProps<T>>;\n\nexport interface TreeItemProps<T extends TreeNode>\n  extends HTMLAttributes<HTMLElement> {\n  label: ReactNode;\n  icon: ReactNode;\n  node?: T;\n  parentNode?: T;\n  level?: number;\n  index?: number;\n  itemRenderer?: TreeItemRenderer<T>;\n  labelRef?: Ref<HTMLDivElement>;\n  labelClassName?: string;\n  className?: string;\n}\nexport function TreeItem<T extends TreeNode>({\n  label,\n  icon,\n  node,\n  level,\n  index,\n  itemRenderer,\n  labelRef,\n  labelClassName,\n  className,\n  parentNode,\n  ...domProps\n}: TreeItemProps<T>) {\n  const focusManager = useFocusManager();\n  const {\n    expandedKeys,\n    selectedKeys,\n    focusedNode,\n    setFocusedNode,\n    setExpandedKeys,\n    setSelectedKeys,\n  } = useContext(TreeContext);\n\n  // clear focused node on unmount\n  useEffect(() => {\n    return () => {\n      if (focusedNode === node?.id) {\n        setFocusedNode(undefined);\n      }\n    };\n  }, [focusedNode, node?.id, setFocusedNode]);\n\n  if (!node || !itemRenderer) return null;\n\n  const hasChildren = node.children.length;\n  const isExpanded = hasChildren && expandedKeys.includes(node.id);\n  const isSelected = selectedKeys.includes(node.id);\n  const isFirstNode = level === 0 && index === 0;\n  const isFocused =\n    focusedNode == undefined ? isFirstNode : focusedNode === node.id;\n\n  const onKeyDown = (e: React.KeyboardEvent<HTMLUListElement>) => {\n    if (focusedNode == null) return;\n    switch (e.key) {\n      // select the node\n      case 'Enter':\n      case ' ':\n        e.stopPropagation();\n        e.preventDefault();\n        setSelectedKeys([focusedNode]);\n        break;\n\n      // expand node, or move focus to first (and only first) child\n      case 'ArrowRight':\n        e.stopPropagation();\n        e.preventDefault();\n\n        if (!hasChildren) return;\n\n        if (!isExpanded) {\n          setExpandedKeys([...expandedKeys, focusedNode]);\n        } else {\n          focusManager?.focusNext();\n        }\n        break;\n\n      // collapse node, or move focus to parent node\n      case 'ArrowLeft':\n        e.stopPropagation();\n        e.preventDefault();\n\n        if (isExpanded) {\n          const index = expandedKeys.indexOf(focusedNode);\n          const newKeys = [...expandedKeys];\n          newKeys.splice(index, 1);\n          setExpandedKeys(newKeys);\n        } else if (parentNode) {\n          const parentEl =\n            document.activeElement?.parentElement?.closest('[tabindex]');\n          if (parentEl) {\n            (parentEl as HTMLElement).focus();\n          }\n        }\n        break;\n\n      // focus next visible node, recursively\n      case 'ArrowDown':\n        e.stopPropagation();\n        e.preventDefault();\n        focusManager?.focusNext();\n        break;\n\n      // focus previous visible node, recursively\n      case 'ArrowUp':\n        e.stopPropagation();\n        e.preventDefault();\n        focusManager?.focusPrevious();\n        break;\n\n      // focus first visible node\n      case 'Home':\n        e.stopPropagation();\n        e.preventDefault();\n        focusManager?.focusFirst();\n        break;\n\n      // focus last visible node\n      case 'End':\n        e.stopPropagation();\n        e.preventDefault();\n        focusManager?.focusLast();\n        break;\n\n      // expand all sibling nodes\n      case '*':\n        e.stopPropagation();\n        e.preventDefault();\n\n        if (parentNode?.children) {\n          const newKeys = [...expandedKeys];\n          parentNode.children.forEach(childNode => {\n            if (\n              childNode.children.length &&\n              !expandedKeys.includes(childNode.id)\n            ) {\n              newKeys.push(childNode.id);\n            }\n          });\n          if (newKeys.length !== expandedKeys.length) {\n            setExpandedKeys(newKeys);\n          }\n        }\n        break;\n    }\n  };\n\n  return (\n    <li\n      role=\"treeitem\"\n      aria-expanded={isExpanded ? 'true' : 'false'}\n      aria-selected={isSelected}\n      tabIndex={isFocused ? 0 : -1}\n      onKeyDown={createEventHandler(onKeyDown)}\n      onFocus={e => {\n        e.stopPropagation();\n        setFocusedNode(node.id);\n      }}\n      onBlur={e => {\n        e.stopPropagation();\n        // only clear focus state when focus moves outside the tree\n        if (!e.currentTarget.contains(e.relatedTarget)) {\n          setFocusedNode(undefined);\n        }\n      }}\n      className={clsx(\n        'outline-none',\n        // focus direct .tree-label child when this element has :focus-visible\n        '[&>.tree-label]:focus-visible:ring [&>.tree-label]:focus-visible:ring-2 [&>.tree-label]:focus-visible:ring-inset',\n        className,\n      )}\n    >\n      <TreeLabel\n        ref={labelRef}\n        className={labelClassName}\n        node={node}\n        level={level}\n        label={label}\n        icon={icon}\n        {...domProps}\n      />\n      <AnimatePresence initial={false}>\n        {isExpanded ? (\n          <m.ul\n            key={`${node.id}-group`}\n            role=\"group\"\n            initial=\"closed\"\n            animate=\"open\"\n            exit=\"closed\"\n            variants={{\n              open: {opacity: 1, height: 'auto'},\n              closed: {opacity: 0, height: 0, overflow: 'hidden'},\n            }}\n          >\n            {renderTree({\n              nodes: node.children,\n              parentNode: node,\n              itemRenderer,\n              level,\n            })}\n          </m.ul>\n        ) : null}\n      </AnimatePresence>\n    </li>\n  );\n}\n","import React, {useMemo, useRef} from 'react';\nimport {arrayToTree} from 'performant-array-to-tree';\nimport {useFolders} from '@app/drive/files/queries/use-folders';\nimport {DriveFolder} from '@app/drive/files/drive-entry';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {FolderIcon} from '@ui/icons/material/Folder';\nimport {getPathForFolder, RootFolderPage} from '@app/drive/drive-page/drive-page';\nimport {mergeProps} from '@react-aria/utils';\nimport {\n  ConnectedDraggable,\n  useDraggable,\n} from '@ui/interactions/dnd/use-draggable';\nimport {useSidebarTreeDropTarget} from '@app/drive/layout/sidebar/use-sidebar-tree-drop-target';\nimport {makeFolderTreeDragId} from '@app/drive/layout/sidebar/folder-tree-drag-id';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport clsx from 'clsx';\nimport {BackupIcon} from '@ui/icons/material/Backup';\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\nimport {Tree} from '@ui/tree/tree';\nimport {TreeItem, TreeItemProps} from '@ui/tree/tree-item';\n\ninterface TreeFolder extends DriveFolder {\n  children: TreeFolder[];\n}\n\nexport function FolderTree() {\n  const navigate = useNavigate();\n  const {data} = useFolders();\n  const expandedKeys = useDriveStore(s => s.sidebarExpandedKeys);\n\n  const activePage = useDriveStore(s => s.activePage);\n  let selectedKeys: number[] = [];\n  if (activePage?.isFolderPage) {\n    selectedKeys = activePage.folder ? [activePage.folder.id] : [];\n  }\n\n  const tree = useMemo(() => {\n    const folders = arrayToTree(data?.folders || [], {\n      parentId: 'parent_id',\n      dataField: null,\n    }) as TreeFolder[];\n    const rootFolder = {\n      ...RootFolderPage.folder,\n      children: folders,\n    };\n    return [rootFolder];\n  }, [data?.folders]);\n\n  return (\n    <Tree\n      nodes={tree}\n      expandedKeys={expandedKeys}\n      onExpandedKeysChange={keys => {\n        driveState().setSidebarExpandedKeys(keys);\n      }}\n      selectedKeys={selectedKeys}\n      onSelectedKeysChange={([id]) => {\n        const entryHash = findHash(id as number, tree);\n        if (entryHash) {\n          navigate(getPathForFolder(entryHash));\n        } else {\n          navigate(RootFolderPage.path);\n        }\n      }}\n    >\n      {() => <FolderTreeItem />}\n    </Tree>\n  );\n}\n\n// props will be passed by tree via cloneElement\nfunction FolderTreeItem(props: Partial<TreeItemProps<TreeFolder>>) {\n  const {node} = props as Required<TreeItemProps<TreeFolder>>;\n  const labelRef = useRef<HTMLDivElement>(null);\n  const isRootFolder = node.id === 0;\n  const isDragging = useDriveStore(s =>\n    s.entriesBeingDragged.includes(node.id),\n  );\n\n  const {draggableProps} = useDraggable({\n    type: 'fileEntry',\n    id: makeFolderTreeDragId(node),\n    ref: labelRef,\n    disabled: isRootFolder,\n    hidePreview: true,\n    onDragStart: (e, draggable) => {\n      const d = draggable as ConnectedDraggable<FileEntry[]>;\n      driveState().setEntriesBeingDragged(d.getData().map(e => e.id));\n      driveState().selectEntries([]);\n    },\n    onDragEnd: () => {\n      driveState().setEntriesBeingDragged([]);\n    },\n    getData: () => [node],\n  });\n\n  const {droppableProps, isDragOver} = useSidebarTreeDropTarget({\n    folder: node,\n    ref: labelRef,\n  });\n\n  return (\n    <TreeItem\n      {...mergeProps(draggableProps, droppableProps, props)}\n      onContextMenu={e => {\n        e.preventDefault();\n        e.stopPropagation();\n        driveState().deselectEntries('all');\n        driveState().setContextMenuData({\n          x: e.clientX,\n          y: e.clientY,\n          entry: node,\n        });\n      }}\n      labelRef={labelRef}\n      className={isRootFolder ? 'focus-visible:ring-2' : undefined}\n      labelClassName={clsx(\n        isDragOver && 'bg-primary/selected ring ring-2 ring-inset ring-primary',\n        isDragging && 'opacity-30',\n        isRootFolder && 'h-40',\n      )}\n      icon={\n        isRootFolder ? (\n          <BackupIcon size=\"md\" className=\"mr-6\" />\n        ) : (\n          <FolderIcon size=\"sm\" className=\"mr-4\" />\n        )\n      }\n      label={node.name}\n    />\n  );\n}\n\nconst findHash = (id: number, nodes: FileEntry[]): string | undefined => {\n  for (const item of nodes) {\n    if (item.id === id) {\n      return item.hash;\n    } else if (item.children) {\n      const hash = findHash(id, item.children);\n      if (hash) {\n        return hash;\n      }\n    }\n  }\n};\n","export enum MenuPositions {\n  DriveSidebar = 'drive-sidebar',\n}\n","import {useDeleteEntries} from '@app/drive/files/queries/use-delete-entries';\nimport {driveSidebarIcons} from '@app/drive/layout/sidebar/drive-sidebar-icons';\nimport {FolderTree} from '@app/drive/layout/sidebar/folder-tree';\nimport {CustomMenu, CustomMenuItem} from '@common/menus/custom-menu';\nimport {MenuItemConfig} from '@common/menus/menu-config';\nimport {useDroppable} from '@common/ui/library/interactions/dnd/use-droppable';\nimport {FileEntry} from '@common/uploads/file-entry';\nimport clsx from 'clsx';\nimport {ComponentPropsWithoutRef, forwardRef, useRef, useState} from 'react';\nimport {MenuPositions} from '@app/drive/menu-positions';\n\nexport function SidebarMenu() {\n  return (\n    <div className=\"mt-26 px-12 text-muted\">\n      <FolderTree />\n      <CustomMenu\n        defaultIcons={driveSidebarIcons}\n        menu={MenuPositions.DriveSidebar}\n        orientation=\"vertical\"\n        gap=\"gap-0\"\n      >\n        {item => {\n          if (item.action === '/drive/trash') {\n            return <TrashMenuItem key={item.id} item={item} />;\n          }\n          return <MenuItem key={item.id} item={item} />;\n        }}\n      </CustomMenu>\n    </div>\n  );\n}\n\ninterface MenuItemProps extends ComponentPropsWithoutRef<'a'> {\n  item: MenuItemConfig;\n  className?: string;\n}\nexport const MenuItem = forwardRef<HTMLAnchorElement, MenuItemProps>(\n  ({item, className, ...domProps}, ref) => {\n    return (\n      <CustomMenuItem\n        defaultIcons={driveSidebarIcons}\n        className={({isActive}) =>\n          clsx(\n            className,\n            'my-4 h-40 w-full rounded-button px-24',\n            isActive\n              ? 'cursor-default bg-primary/selected font-bold text-primary'\n              : 'hover:bg-hover',\n          )\n        }\n        item={item}\n        ref={ref}\n        {...domProps}\n      />\n    );\n  },\n);\n\ninterface TrashMenuItemProps {\n  item: MenuItemConfig;\n}\nfunction TrashMenuItem({item}: TrashMenuItemProps) {\n  const deleteEntries = useDeleteEntries();\n  const [isDragOver, setIsDragOver] = useState(false);\n  const ref = useRef<HTMLAnchorElement>(null);\n\n  const {droppableProps} = useDroppable({\n    id: 'trash',\n    types: ['fileEntry'],\n    ref,\n    onDragEnter: () => {\n      setIsDragOver(true);\n    },\n    onDragLeave: () => {\n      setIsDragOver(false);\n    },\n    onDrop: draggable => {\n      const entryIds = (draggable.getData() as FileEntry[]).map(e => e.id);\n      deleteEntries.mutate({entryIds, deleteForever: false});\n    },\n  });\n  return (\n    <MenuItem\n      className={clsx(isDragOver && 'bg-primary/selected')}\n      ref={ref}\n      {...droppableProps}\n      item={item}\n    />\n  );\n}\n","import React from 'react';\nimport {\n  ProgressBarBase,\n  ProgressBarBaseProps\n} from '@ui/progress/progress-bar-base';\n\nexport function Meter(props: ProgressBarBaseProps) {\n  return <ProgressBarBase {...props} role=\"meter progressbar\" />;\n}\n","import React from 'react';\nimport {useStorageSummary} from './storage-summary';\nimport {StorageIcon} from '@ui/icons/material/Storage';\nimport {Meter} from '@ui/progress/meter';\nimport {Trans} from '@ui/i18n/trans';\nimport clsx from 'clsx';\n\nexport function StorageMeter() {\n  const {isLoading, data} = useStorageSummary();\n\n  // prevent translation placeholders from showing if summary is not loaded yet\n  const label = (\n    <span className={clsx('whitespace-nowrap', isLoading && 'invisible')}>\n      <Trans\n        message=\":used of :available used\"\n        values={{\n          used: data?.usedFormatted,\n          available: data?.availableFormatted,\n        }}\n      />\n    </span>\n  );\n  return (\n    <div className=\"mt-24 flex items-start gap-16 border-t pl-24 pt-24\">\n      <StorageIcon className=\"-mt-4 icon-md\" />\n      <Meter\n        className=\"max-w-144 flex-auto\"\n        size=\"xs\"\n        value={data?.percentage}\n        label={label}\n        showValueLabel={false}\n        labelPosition=\"bottom\"\n      />\n    </div>\n  );\n}\n","import {useAuth} from '@common/auth/use-auth';\nimport {useNavigate} from '@common/ui/navigation/use-navigate';\nimport {WorkspaceSelector} from '@common/workspace/workspace-selector';\nimport {Button} from '@ui/buttons/button';\nimport {Trans} from '@ui/i18n/trans';\nimport {useSettings} from '@ui/settings/use-settings';\nimport clsx from 'clsx';\nimport {Link} from 'react-router';\nimport {RootFolderPage} from '@app/drive/drive-page/drive-page';\nimport {CreateNewButton} from '@app/drive/layout/create-new-button';\nimport {SidebarMenu} from '@app/drive/layout/sidebar/sidebar-menu';\nimport {StorageMeter} from '@app/drive/layout/sidebar/storage-summary/storage-meter';\n\ninterface SidebarProps {\n  className?: string;\n}\nexport function Sidebar({className}: SidebarProps) {\n  const {isSubscribed} = useAuth();\n  const {billing} = useSettings();\n  return (\n    <div\n      className={clsx(\n        className,\n        'flex flex-col gap-20 border-divider-lighter bg text-sm font-medium text-muted lg:mr-8 lg:bg-transparent',\n      )}\n    >\n      <div className=\"compact-scrollbar flex-auto overflow-y-auto\">\n        <CreateNewButton className=\"px-12 pt-28 text-center\" />\n        <SidebarMenu />\n        <StorageMeter />\n        {billing.enable ? (\n          <div className=\"mt-14 pl-60\">\n            <Button\n              elementType={Link}\n              to={isSubscribed ? '/billing/change-plan' : '/pricing'}\n              variant=\"outline\"\n              color=\"primary\"\n              size=\"xs\"\n            >\n              <Trans message=\"Upgrade\" />\n            </Button>\n          </div>\n        ) : null}\n      </div>\n      <WorkspaceSwitcher />\n    </div>\n  );\n}\n\nfunction WorkspaceSwitcher() {\n  const navigate = useNavigate();\n  return (\n    <WorkspaceSelector\n      onChange={() => {\n        navigate(RootFolderPage.path);\n      }}\n      className=\"mt-auto w-full flex-shrink-0 border-t px-24 py-18\"\n    />\n  );\n}\n","import {StaticPageTitle} from '@common/seo/static-page-title';\nimport {DashboardContent} from '@common/ui/dashboard-layout/dashboard-content';\nimport {DashboardLayout} from '@common/ui/dashboard-layout/dashboard-layout';\nimport {DashboardLayoutContext} from '@common/ui/dashboard-layout/dashboard-layout-context';\nimport {DashboardNavbar} from '@common/ui/dashboard-layout/dashboard-navbar';\nimport {DashboardSidenav} from '@common/ui/dashboard-layout/dashboard-sidenav';\nimport {FileEntryUrlsContext} from '@common/uploads/file-entry-urls';\nimport {FileUploadProvider} from '@common/uploads/uploader/file-upload-provider';\nimport {FileUploadStoreOptions} from '@common/uploads/uploader/file-upload-store';\nimport {getActiveWorkspaceId} from '@common/workspace/active-workspace-id';\nimport {useActiveWorkspaceId} from '@common/workspace/active-workspace-id-context';\nimport {IconButton} from '@ui/buttons/icon-button';\nimport {Trans} from '@ui/i18n/trans';\nimport {CloseIcon} from '@ui/icons/material/Close';\nimport {SearchIcon} from '@ui/icons/material/Search';\nimport {Fragment, useContext, useEffect, useMemo} from 'react';\nimport {Link, useLocation, useParams} from 'react-router';\nimport {DetailsSidebar} from '@app/drive/details-sidebar/details-sidebar';\nimport {\n  DRIVE_PAGES,\n  makePartialFolderPage,\n  SearchPage,\n} from '@app/drive/drive-page/drive-page';\nimport {driveState, useDriveStore} from '@app/drive/drive-store';\nimport {EntryActionList} from '@app/drive/entry-actions/entry-action-list';\nimport {EntryDragPreview} from '@app/drive/file-view/entry-drag-preview';\nimport {FileView} from '@app/drive/file-view/file-view';\nimport {DriveDialogsContainer} from '@app/drive/files/dialogs/drive-dialogs-container';\nimport {NavbarSearch} from '@app/drive/search/navbar-search';\nimport {UploadQueue} from '@app/drive/uploading/upload-queue';\nimport {CreateNewButton} from '@app/drive/layout/create-new-button';\nimport {DriveContentHeader} from '@app/drive/layout/drive-content-header';\nimport {Sidebar} from '@app/drive/layout/sidebar/sidebar';\n\nconst uploadStoreOptions: FileUploadStoreOptions = {\n  modifyUploadedFile: uploadedFile => {\n    const workspaceId = getActiveWorkspaceId();\n    uploadedFile.fingerprint = `${uploadedFile.fingerprint}-w-${workspaceId}`;\n    return uploadedFile;\n  },\n};\n\nexport function Component() {\n  const {pathname} = useLocation();\n  const {hash} = useParams();\n  const {workspaceId} = useActiveWorkspaceId();\n  const activePage = useDriveStore(s => s.activePage);\n\n  useEffect(() => {\n    driveState().setActivePage(\n      DRIVE_PAGES.find(p => p.path === pathname) ||\n        makePartialFolderPage(hash!),\n    );\n  }, [pathname, hash]);\n\n  const urlsContextValue = useMemo(() => {\n    return {workspaceId};\n  }, [workspaceId]);\n\n  useEffect(() => {\n    return () => {\n      driveState().reset();\n    };\n  }, []);\n\n  return (\n    <Fragment>\n      {activePage?.label && (\n        <StaticPageTitle>\n          <Trans\n            message={\n              typeof activePage.label === 'string'\n                ? activePage.label\n                : activePage.label.message\n            }\n          />\n        </StaticPageTitle>\n      )}\n      <FileUploadProvider options={uploadStoreOptions}>\n        <FileEntryUrlsContext.Provider value={urlsContextValue}>\n          <DashboardLayout\n            className=\"lg:bg-alt lg:p-8 lg:dark:bg\"\n            name=\"drive\"\n            onDragOver={e => {\n              e.preventDefault();\n              e.stopPropagation();\n              e.dataTransfer.dropEffect = 'none';\n            }}\n            onDrop={e => {\n              // prevent files from desktop from blowing away the document\n              e.preventDefault();\n            }}\n          >\n            <Navbar />\n            <DashboardSidenav position=\"left\" size=\"md\">\n              <Sidebar />\n            </DashboardSidenav>\n            <DashboardContent isScrollable={false}>\n              <div className=\"dashboard-rounded-panel flex h-full flex-col border-divider-lighter\">\n                <DriveContentHeader />\n                <FileView />\n              </div>\n            </DashboardContent>\n            <UploadQueue />\n            <DriveDialogsContainer />\n            <DashboardSidenav position=\"right\" size=\"lg\">\n              <DetailsSidebar />\n            </DashboardSidenav>\n          </DashboardLayout>\n        </FileEntryUrlsContext.Provider>\n        <EntryDragPreview />\n      </FileUploadProvider>\n    </Fragment>\n  );\n}\n\nfunction Navbar() {\n  const {isMobileMode} = useContext(DashboardLayoutContext);\n  const activePage = useDriveStore(s => s.activePage);\n\n  const children = isMobileMode ? null : <NavbarSearch />;\n  const searchButton = (\n    <IconButton elementType={Link} to={SearchPage.path}>\n      <SearchIcon />\n    </IconButton>\n  );\n\n  const mobileRightChildren = (\n    <Fragment>\n      {activePage !== SearchPage && searchButton}\n      <CreateNewButton isCompact />\n    </Fragment>\n  );\n\n  return (\n    <Fragment>\n      <DashboardNavbar\n        rightChildren={isMobileMode && mobileRightChildren}\n        menuPosition=\"drive-navbar\"\n        color=\"transparent\"\n        darkModeColor=\"transparent\"\n        logoColor=\"matchMode\"\n        border=\"border-b lg:border-none\"\n        textColor=\"text-main\"\n        size={null}\n        className=\"mb-8\"\n      >\n        {children}\n      </DashboardNavbar>\n      {isMobileMode && <FloatingActionList />}\n    </Fragment>\n  );\n}\n\nfunction FloatingActionList() {\n  const entriesSelected = useDriveStore(s => s.selectedEntries.size);\n  if (!entriesSelected) return null;\n  return (\n    <div className=\"fixed right-0 top-0 z-10 flex h-54 w-full items-center justify-center gap-10 rounded bg-primary px-6 text-on-primary shadow-xl\">\n      <IconButton\n        onClick={() => {\n          driveState().selectEntries([]);\n        }}\n      >\n        <CloseIcon />\n      </IconButton>\n      <Trans message=\":count selected\" values={{count: entriesSelected}} />\n      <EntryActionList className=\"ml-auto\" />\n    </div>\n  );\n}\n"],"names":["DetailsSidebarHeader","entryType","entryName","setRightSidenavStatus","useContext","DashboardLayoutContext","jsxs","jsx","FileTypeIcon","IconButton","CloseIcon","DetailsSidebarSectionHeader","children","margin","clsx","useTaggableTags","params","useQuery","getQueryKey","fetchTaggableTags","taggableType","taggableId","type","notType","key","invalidateTaggableTagsQuery","taggableIds","queryClient","apiClient","response","useDetachTagFromTaggables","useMutation","payload","detachTag","_","err","showHttpErrorToast","r","useAttachTagToTaggables","attachTag","useTags","signal","fetchTags","keepPreviousData","resolve","ManageTagsDialog","propsAttachedTags","tagType","notTagType","userId","isLoading","onChange","onSelected","trans","useTrans","query","setQuery","useState","close","useDialogContext","data","isPlaceholderData","queryIsLoading","tags","attachedTagIds","useMemo","allTags","attachedTags","tag","Dialog","DialogBody","TextField","SearchIcon","e","ProgressCircle","List","isAttached","isDisabled","ListItem","PushPinIcon","CheckIcon","Trans","DetailsSidebarTags","entry","user","useAuth","isFetching","_a","ChipList","DialogTrigger","Button","AddIcon","Chip","useFolders","workspaceId","useActiveWorkspaceId","appQueries","setActiveFolder","newFolder","currentPage","driveState","shallowEqual","makeFolderPage","useActivePageEntries","page","useDriveStore","s","sortDescriptor","searchParams","useSearchParams","isDisabledInSearch","SearchPage","useInfiniteQuery","useEffect","items","p","useSelectedEntries","ids","id","getSelectedEntries","caches","selectedEntries","cache","entries","DetailsSidebarProperties","FileThumbnail","GroupsIcon","Tooltip","Avatar","PropertyList","parent","useSelectedEntryParent","navigate","useNavigate","owner","prettySize","prettyBytes","PropertyItem","FolderIcon","getPathForFolder","RootFolderPage","FormattedDate","label","value","detailedExamination","DetailsSidebar","className","selectedEntry","NothingSelected","Fragment","IllustratedMessage","SvgImage","EntryActionList","ActionList","preview","usePreviewAction","share","useShareAction","deleteAction","useDeleteEntriesAction","removeShared","useRemoveSharedEntriesAction","actions","action","createElement","EntryActionMenuTrigger","MoreVertIcon","makeFolderTreeDragId","isFolderTreeDragId","useDragMonitor","monitor","monitorRef","useRef","useId","dragMonitors","EntryDragPreview","ref","points","setPoints","state","setState","dragTarget","target","prev","status","item","index","EntryPreview","AnimatePresence","memo","viewMode","droppableId","droppables","rect","itemCount","exitVariant","_b","_c","m","_d","EntryCount","count","DropTargetMask","isVisible","mask","opacityAnimation","useMoveEntries","toast","message","moveEntries","driveInvalidateKey","canMoveEntriesInto","targets","destination","t","destinationIsInTarget","destinationPath","part","useFolderDropAction","folder","uploadFiles","useDriveUploadQueue","folderAcceptsDrop","mouseSelectables","useMouseSelectable","options","optionsRef","useLayoutEffect","useIsTouchDevice","useMediaQuery","useFileViewDnd","isTouchDevice","onDrop","isDragOver","setIsDragOver","isDragging","activePage","draggableProps","useDraggable","TrashPage","droppableProps","useDroppable","itemClassName","useViewItemActionHandler","useCallback","FileGridItem","isSelected","performViewItemAction","isMobileMode","toggleEntry","pressHandler","el","isCtrlOrShiftPressed","pressProps","usePointerEvents","keyboardHandler","contextMenuHandler","BaseFileGridItem","mergeProps","createEventHandler","FooterAdornment","Checkbox","FileGrid","FileTableRow","domProps","isCollapsedMode","TableContext","FileTable","selectedRows","Table","fileTableColumns","DriveContextMenu","PageContextMenu","EntriesContextMenu","position","useEntryActions","BaseContextMenu","useDrivePageActions","ContextMenu","isOpen","MenuItem","DriveSortButton","descriptor","EntriesSortButton","PageBreadcrumbs","useFolderPath","workspace","useActiveWorkspace","rootItem","useRootItem","content","Breadcrumb","BreadcrumbItem","isMenuItem","MixedText","ButtonBase","ArrowDropDownIcon","u","SharesPage","driveSearchFilters","FILE_ENTRY_TYPE_FILTER","FilterOperator","FilterControlType","createdAtFilter","updatedAtFilter","alwaysShownFilters","f","SearchFilterList","inputValue","setInputValue","FilterList","InfiniteScrollSentinel","isInitialLoading","fetchNextPage","isFetchingNextPage","hasNextPage","loaderMarginTop","style","_variant","loadMoreExtraContent","size","sentinelRef","loadMoreClickCount","setLoadMoreClickCount","innerVariant","leftViewAfterLoading","sentinelEl","observer","rectsIntersect","rectA","rectB","restrictResizableWithinBoundary","boundaryRect","boundedRect","leftRestriction","topRestriction","useMouseSelectionBox","onPointerDown","props","defaultRef","containerRef","boxRef","drawSelectionBox","startPoint","endPoint","initialScrollTop","currentScrollTop","newRect","scrollDiff","scrollValue","absoluteRect","selectable","intersect","_e","_f","_g","activeInteraction","updateRects","reachedBottomEdge","reachedTopEdge","FileView","isSearchingOrFiltering","deleteEntries","useDeleteEntries","containerProps","boxProps","draggable","noContentMessage","handleContextMenu","handleKeybinds","isCtrlKeyPressed","Toolbar","AdHost","useEntryShareableLink","entryId","updateShareableLink","useUpdateShareableLink","form","onFormQueryError","LinkSettingsDialog","setActivePanel","drive","useSettings","enableDirectLinks","formId","link","useForm","updateLink","DialogHeader","Form","LinkExpirationOption","LinkPasswordOption","LinkOption","FormSwitch","DialogFooter","ArrowBackIcon","minDate","now","getLocalTimeZone","showFieldDefault","showField","setShowField","Switch","FormDatePicker","FormTextField","showBorder","title","deleteShareableLink","useDeleteShareableLink","randomString","length","random","possible","i","ShareableLinkPanel","linkExists","createLink","useCreateShareableLink","deleteLink","ShareableLinkInput","useActiveDialogEntry","hash","linkUrl","getShareableLink","isCopied","setCopied","useClipboard","ContentCopyIcon","CopyDirectLinkButton","getDirectLink","matcher","isEmail","string","DRIVE_ENTRY_FULL_PERMISSIONS","PermissionSelectorItems","PermissionSelector","MenuTrigger","Menu","getPermissionItemForUser","download","edit","useChangePermission","changePermission","MemberList","users","MemberListItem","UserAvatar","ActionButtons","changePermissions","unshareEntry","useUnshareEntries","activePermission","setActivePermission","shareEntry","useShareEntry","axios","SharePanel","chips","setChips","isSharing","setIsSharing","selectedPermission","setSelectedPermission","allEmailsValid","chip","useNormalizedModels","displayWith","ChipField","invalid","Item","c","ShareDialog","initialEntry","fileEntry","activePanel","MainDialog","BlockTrashFolderViewDialog","restoreEntries","useRestoreEntries","ConfirmationDialog","DeleteEntriesForeverDialog","EntryPreviewDialog","files","defaultActiveIndex","file","activeIndex","setActiveIndex","FilePreviewDialog","DriveActions","createFolder","name","parentId","useCreateFolder","NewFolderDialog","onSubmit","useMoveEntriesDialogFolderSearch","encodeBackendFilters","MoveEntriesDialogSearch","onFolderSelected","searchLabel","folders","ComboBox","MoveEntriesDialogBreadcrumbs","selectedFolder","previous","myFilesSvg","useMoveEntriesDialogFolders","movingSharedFiles","filters","MoveEntriesDialogFolderList","ChevronRightIcon","MoveEntriesDialog","setSelectedFolder","Footer","CreateNewFolderIcon","useRenameEntry","renameEntry","RenameEntryDialog","initialName","DriveDialogsContainer","activeDialog","dialog","getDialog","NavbarSearch","UploadQueueItem","SizeInfo","FileStatus","fileUpload","useFileUploadStore","useShallow","bytesUploaded","totalBytes","uploadedBytes","statusMessage","abortUpload","percentage","errorMessage","isHovered","setIsHovered","abortButton","progressButton","statusButton","errMessage","AnimatedStatus","ErrorIcon","WarningIcon","CheckCircleIcon","UploadQueue","Header","UploadList","inProgressUploadsCount","completedUploadsCount","clearInactive","uploads","uploadsArray","virtualizer","useVirtualizer","virtualItem","upload","CreateNewButton","isCompact","button","FileUploadIcon","openUploadWindow","activeFolder","UploadFileIcon","DriveFolderUploadIcon","ButtonGroup","color","variant","radius","multiple","disabled","isActive","childValue","toggleMultipleValue","newValue","childIndex","buttons","React","buttonProps","active","adjustedColor","getStyle","LayoutGridIcon","forwardRef","LucideIconWrapper","LayoutListIcon","DriveContentHeader","DashboardContentHeader","ToggleViewModeButton","ToggleDetailsButton","tooltip","InfoIcon","PolicyFailMessage","resourceName","reason","other","MessageText","SectionHelper","billing","upgradeMsgValues","text","Link","LinkStyle","LeaveWorkspaceConfirmation","onConfirm","useCreateWorkspace","createWorkspace","WorkspaceQueryKeys","NewWorkspaceDialog","updateWorkspace","useUpdateWorkspace","RenameWorkspaceDialog","deleteWorkspace","useDeleteWorkspace","setWorkspaceId","PersonalWorkspace","removeMember","memberId","memberType","endpoint","useRemoveMember","ChangeRole","member","modelType","useChangeRole","InviteMembers","useInviteMembers","ResendInvite","inviteId","useResendInvite","fetchWorkspaceWithMembers","useWorkspaceWithMembers","WorkspaceMembersDialog","Manager","can","usePermissions","members","shouldHideOtherMembers","InviteChipField","GroupIcon","MemberDisplayNameAppend","MemberActions","authUser","permissions","authMember","mb","permission","selectedRole","setSelectedRole","changeRole","isOwner","isCurrentUser","roleSelector","RoleMenuTrigger","roleId","RemoveMemberButton","inviteMembers","useValueLists","isConfirmed","ExitToAppIcon","RemoveMemberConfirmation","role","ResendInviteDialogTrigger","resendInvite","WorkspaceSelector","trigger","placement","workspaces","isFetched","useUserWorkspaces","activeWorkspace","selectorIsOpen","setSelectorIsOpen","hasPermission","cloneElement","DefaultTrigger","WorkspaceItem","CreateWorkspaceButton","onClick","onCreated","workspaceCount","checkOverQuotaOrNoPermission","overQuotaOrNoPermission","openDialog","UnfoldMoreIcon","ManageButton","LeaveWorkspaceDialog","DeleteWorkspaceConfirmation","KeyboardArrowDownIcon","PersonAddIcon","EditIcon","DeleteIcon","driveSidebarIcons","HistoryIcon","StarOutlineIcon","__assign","this","n","o","defaultConfig","exports","arrayToTree","a","h","d","getNestedProperty","l","countNodes","useSidebarTreeDropTarget","TreeContext","createContext","renderTree","nodes","itemRenderer","parentNode","level","node","Tree","expandedKeys","setExpandedKeys","useControlledState","selectedKeys","setSelectedKeys","focusedNode","setFocusedNode","FocusScope","TreeRoot","TreeLabel","icon","isExpanded","handleExpandIconClick","newExpandedKeys","ArrowRightIcon","TreeItem","labelRef","labelClassName","focusManager","useFocusManager","hasChildren","isFirstNode","isFocused","onKeyDown","newKeys","parentEl","childNode","FolderTree","tree","keys","entryHash","findHash","FolderTreeItem","isRootFolder","BackupIcon","MenuPositions","SidebarMenu","CustomMenu","TrashMenuItem","CustomMenuItem","entryIds","Meter","ProgressBarBase","StorageMeter","useStorageSummary","StorageIcon","Sidebar","isSubscribed","WorkspaceSwitcher","uploadStoreOptions","uploadedFile","getActiveWorkspaceId","Component","pathname","useLocation","useParams","DRIVE_PAGES","makePartialFolderPage","urlsContextValue","StaticPageTitle","FileUploadProvider","FileEntryUrlsContext","DashboardLayout","Navbar","DashboardSidenav","DashboardContent","searchButton","mobileRightChildren","DashboardNavbar","FloatingActionList","entriesSelected"],"mappings":"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","x_google_ignoreList":[92]}