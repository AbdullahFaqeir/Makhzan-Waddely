import{w as h,aF as x,ap as j,aq as b,aJ as f,x as v,k as w,b5 as y,e as P,j as e,bp as B,r as N,T as a,B as u,L as C}from"./main-BdzhGpqn.js";import{b as F}from"./billing-queries-7PHfszbY.js";import{B as I,a as c}from"./breadcrumb-DXXuqeGE.js";import{F as k}from"./formatted-date-hsbUwQxj.js";import{F as S}from"./formatted-price-DRpdBayZ.js";import{B as T}from"./billing-plan-panel-CqoXwQGC.js";import{i as E,u as L}from"./use-billing-user-CsDaiuR1.js";import"./useEffectEvent-D8HiMrwe.js";import"./ChevronRight-C9FQjnQQ.js";import"./MoreHoriz-uyJcPOJk.js";import"./use-date-formatter-BlrPWK68.js";function Q(){const{trans:r}=h(),n=x();return j({mutationFn:s=>U(s),onSuccess:()=>{f(r(v("Plan changed."))),E(),n("/billing")},onError:s=>b(s)})}function U({subscriptionId:r,...n}){return w.post(`billing/subscriptions/${r}/change-plan`,n).then(s=>s.data)}const d="/billing/change-plan";function A(){const{productId:r,priceId:n}=y(),s=x(),m=P(F.products.index()),{subscription:i}=L(),p=Q();if(!m.data||(i==null?void 0:i.price_id)==n)return e.jsx(B,{to:"/billing/change-plan",replace:!0});const t=m.data.products.find(o=>`${o.id}`===r),l=t==null?void 0:t.prices.find(o=>`${o.id}`===n);if(!t||!l||!i)return s(d),null;const g=e.jsxs("span",{className:"whitespace-nowrap",children:[e.jsx(k,{date:i.renews_at,preset:"long"}),";"]});return e.jsxs(N.Fragment,{children:[e.jsxs(I,{children:[e.jsx(c,{isLink:!0,onSelected:()=>s("/billing"),children:e.jsx(a,{message:"Billing"})}),e.jsx(c,{onSelected:()=>s(d),children:e.jsx(a,{message:"Plans"})}),e.jsx(c,{children:e.jsx(a,{message:"Confirm"})})]}),e.jsx("h1",{className:"my-32 text-3xl font-bold md:my-64",children:e.jsx(a,{message:"Confirm your new plan"})}),e.jsx(T,{title:e.jsx(a,{message:"Changing to"}),children:e.jsxs("div",{className:"max-w-[464px]",children:[e.jsx("div",{className:"text-xl font-bold",children:t.name}),e.jsx(S,{price:l,className:"text-lg"}),e.jsx("div",{className:"mb-48 mt-12 border-b pb-24 text-base",children:e.jsx(a,{message:"You will be charged the new price starting :date",values:{date:g}})}),e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(u,{variant:"flat",color:"primary",size:"md",className:"mb-16 w-full",onClick:()=>{p.mutate({subscriptionId:i.id,newProductId:t.id,newPriceId:l.id})},disabled:p.isPending,children:e.jsx(a,{message:"Confirm"})})}),e.jsx("div",{children:e.jsx(u,{variant:"outline",className:"w-full",to:d,elementType:C,children:e.jsx(a,{message:"Go back"})})}),e.jsx("div",{className:"mt-12 text-xs text-muted",children:e.jsx(a,{message:"By confirming your new plan, you agree to our terms of Service and privacy policy."})})]})]})})]})}export{A as Component};
