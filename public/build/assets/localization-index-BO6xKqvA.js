import{Y as q,c4 as N,an as f,ap as E,aH as y,x as g,cc as x,k as b,w as D,a7 as h,a2 as S,j as e,M as w,Q as C,T as s,R as L,am as v,a3 as z,a5 as m,B as u,r as U,cE as A,D as j,aB as B,J as T,L as F,ao as H,av as Q,ai as $,aj as K,ar as R}from"./main-TIUJvpaR.js";import{a as V,T as W}from"./admin-config-DnlTcyOh.js";import{D as G}from"./settings-links-DfKKjWK1.js";import{u as J,a as O}from"./update-localization-CYCP8I2y.js";import{u as Y,a as _,G as X,D as Z,b as ee,c as ae}from"./use-datatable-query-GunfT5m0.js";import{a as se,D as te,b as oe,c as ne}from"./datatable-page-with-header-layout-Bbr3vl7W.js";import{T as ie}from"./table-Bwvbdqc8.js";import{F as re}from"./file-upload-provider-B_bRCnuD.js";import{F as le}from"./formatted-date-CsxGDhkC.js";import{M as ce}from"./MoreVert-CnEfcu2X.js";import{C as de}from"./confirmation-dialog-Ds1Wl8FN.js";import{d as me}from"./download-file-from-url-BVaKcxRP.js";import{F as ue}from"./file-input-config-DrcTpI3-.js";import{o as ge}from"./open-upload-window-DllX9uve.js";import{D as pe}from"./data-table-add-item-button-rLvL8LGv.js";import{F as P}from"./select-T49HzTXy.js";import{D as I}from"./dialog-footer-yCpPZGPO.js";import{g as xe}from"./countries-383H_XpF.js";import"./external-link-DvqU4uvd.js";import"./FilterAlt-TOiEFGZR.js";import"./select-filter-panel-Bmcw5umN.js";import"./use-normalized-models-DEvVtvvO.js";import"./form-chip-field-ebQy8_UE.js";import"./input-C85ULg8F.js";import"./ArrowRightAlt-CPRMvsTm.js";import"./DateRange-LhM59-62.js";import"./use-base-date-picker-state-DYQU3Rut.js";import"./use-date-formatter-hhGEq_P-.js";import"./KeyboardArrowRight-C0U0wgwT.js";import"./use-date-range-picker-state-Df5vuAtM.js";import"./list-DlNGU0yW.js";import"./switch-Bj7wwiPq.js";import"./use-current-date-time-BdzpdEnL.js";import"./Edit-_sVfUVPu.js";import"./skeleton-uSF3jNnm.js";import"./accordion-CabB8onw.js";import"./checkbox-kZVscZNC.js";import"./CheckBoxOutlineBlank-p6gxL9Ym.js";import"./dashboard-layout-context-DA6Q35rI.js";import"./use-toggle-dashboard-left-sidebar-BuzWlDo2.js";import"./ArrowDownward-B1kd_Dtq.js";import"./useEffectEvent-Bgk8rSJ3.js";import"./use-pointer-events-B6G-2ez3.js";import"./useGlobalListeners-_BzTaAbJ.js";import"./uploaded-file-CLeM2EFo.js";import"./pretty-bytes-bO14ePu9.js";import"./Add-CRE_6SK0.js";const he=""+new URL("around-the-world-DwONd8Eq.svg",import.meta.url).href,M=q((a="en")=>{const o=new Intl.DisplayNames([a],{type:"language"}),t=xe(a),i=[],r=[];for(let c=0;c<t.length;c++){const l=t[c].code.toLowerCase(),n=new Intl.Locale("und",{region:l}).maximize().language;try{const d=o.of(n);d&&!r.includes(n)&&n!==d&&(r.push(n),i.push({code:n,name:d}))}catch{}}return i});function je(a){return b.post("localizations",a).then(o=>o.data)}function fe(a){const o=N();return f({mutationFn:t=>je(t),onSuccess:()=>{y(g("Localization created")),o.invalidateQueries({queryKey:x.localizations.invalidateKey})},onError:t=>E(t,a)})}function ye(){const{trans:a}=D(),{formId:o,close:t}=h(),i=S({defaultValues:{language:"en"}}),r=M(),c=fe(i);return e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(s,{message:"Create localization"})}),e.jsx(L,{children:e.jsxs(v,{form:i,id:o,onSubmit:l=>{c.mutate(l,{onSuccess:t})},children:[e.jsx(z,{autoFocus:!0,name:"name",label:e.jsx(s,{message:"Name"}),className:"mb-30",required:!0}),e.jsx(P,{required:!0,name:"language",label:e.jsx(s,{message:"Language"}),selectionMode:"single",showSearchField:!0,searchPlaceholder:a(g("Search languages")),children:r.map(l=>e.jsx(m,{value:l.code,children:l.name},l.code))})]})}),e.jsxs(I,{children:[e.jsx(u,{onClick:t,children:e.jsx(s,{message:"Cancel"})}),e.jsx(u,{variant:"flat",color:"primary",type:"submit",form:o,disabled:c.isPending,children:e.jsx(s,{message:"Save"})})]})]})}function be({localization:a}){const{trans:o}=D(),{formId:t,close:i}=h(),r=S({defaultValues:{id:a.id,name:a.name,language:a.language}}),c=M(),l=J(r);return e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(s,{message:"Update localization"})}),e.jsx(L,{children:e.jsxs(v,{form:r,id:t,onSubmit:n=>{l.mutate(n,{onSuccess:i})},children:[e.jsx(z,{name:"name",label:e.jsx(s,{message:"Name"}),className:"mb-30",required:!0}),e.jsx(P,{required:!0,name:"language",label:e.jsx(s,{message:"Language"}),selectionMode:"single",showSearchField:!0,searchPlaceholder:o(g("Search languages")),children:c.map(n=>e.jsx(m,{value:n.code,children:n.name},n.code))})]})}),e.jsxs(I,{children:[e.jsx(u,{onClick:i,children:e.jsx(s,{message:"Cancel"})}),e.jsx(u,{variant:"flat",color:"primary",type:"submit",form:t,disabled:l.isPending,children:e.jsx(s,{message:"Save"})})]})]})}const De=[{key:"name",allowsSorting:!0,sortingKey:"name",visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Name"}),body:a=>a.name},{key:"language",allowsSorting:!0,sortingKey:"language",header:()=>e.jsx(s,{message:"Language code"}),body:a=>a.language},{key:"updatedAt",allowsSorting:!0,width:"w-100",header:()=>e.jsx(s,{message:"Last updated"}),body:a=>e.jsx(le,{date:a.updated_at})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-84 flex-shrink-0",visibleInMode:"all",body:a=>e.jsxs("div",{className:"text-muted",children:[e.jsx(B,{label:e.jsx(s,{message:"Translate"}),children:e.jsx(T,{size:"md",elementType:F,to:`${a.id}/translate`,children:e.jsx(W,{})})}),e.jsx(re,{children:e.jsx(Se,{locale:a})})]})}];function ja(){const[a,o]=U.useState([]),{searchParams:t,sortDescriptor:i,mergeIntoSearchParams:r,setSearchQuery:c,isFiltering:l}=Y(A),n=_(x.localizations.index(t)),d=e.jsxs(j,{type:"modal",children:[e.jsx(u,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx(we,{selectedIds:a,onDelete:()=>o([])})]}),k=e.jsxs(j,{type:"modal",children:[e.jsx(pe,{children:e.jsx(s,{message:"Add new localization"})}),e.jsx(ye,{})]});return e.jsxs(se,{children:[e.jsx(X,{query:n}),e.jsx(te,{title:e.jsx(s,{message:"Localizations"}),showSidebarToggleButton:!0,rightContent:e.jsx(G,{variant:"button",link:V.pages.translations,size:"xs"})}),e.jsxs(oe,{children:[e.jsx(Z,{searchValue:t.query,onSearchChange:c,actions:k,selectedItems:a,selectedActions:d}),e.jsxs(ne,{children:[e.jsx(ie,{columns:De,data:n.items,sortDescriptor:i,onSortChange:r,enableSelection:!0,selectedRows:a,onSelectionChange:o,cellHeight:"h-60"}),n.isEmpty&&e.jsx(ee,{isFiltering:l,image:he,title:e.jsx(s,{message:"No localizations have been created yet"}),filteringTitle:e.jsx(s,{message:"No matching localizations"})}),e.jsx(ae,{query:n,onPageChange:p=>r({page:p}),onPerPageChange:p=>r({perPage:p})})]})]})]})}function Se({locale:a}){const o=O();return e.jsxs($,{children:[e.jsx(T,{disabled:o.isPending,children:e.jsx(ce,{})}),e.jsxs(K,{children:[e.jsx(m,{value:"translate",elementType:F,to:`${a.id}/translate`,children:e.jsx(s,{message:"Translate"})}),e.jsx(m,{value:"rename",onSelected:()=>R(be,{localization:a}),children:e.jsx(s,{message:"Rename"})}),e.jsx(m,{value:"download",onSelected:()=>me(`api/v1/localizations/${a.id}/download`),children:e.jsx(s,{message:"Download"})}),e.jsx(m,{value:"upload",onSelected:async()=>{const t=await ge({types:[ue.json]});t.length==1&&o.mutate({localeId:a.id,file:t[0]})},children:e.jsx(s,{message:"Upload"})})]})]})}function we({selectedIds:a,onDelete:o}){const{close:t}=h(),i=f({mutationFn:()=>b.delete(`localizations/${a.join(",")}`),onSuccess:async()=>{await Q.invalidateQueries({queryKey:x.localizations.invalidateKey}),y(g("Localizations deleted")),o(),t()},onError:r=>H(r)});return e.jsx(de,{isDanger:!0,isLoading:i.isPending,title:e.jsx(s,{message:"Delete localizations"}),body:e.jsx(s,{message:"Are you sure you want to delete selected localizations?",values:{count:a.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>i.mutate()})}export{ja as Component,we as DeleteLocalizationsDialog};
