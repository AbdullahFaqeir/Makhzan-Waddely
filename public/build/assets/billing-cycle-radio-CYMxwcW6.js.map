{"version":3,"file":"billing-cycle-radio-CYMxwcW6.js","sources":["../../../common/foundation/resources/client/billing/pricing-table/find-best-price.ts","../../../common/foundation/resources/client/billing/pricing-table/upsell-label.tsx","../../../common/foundation/resources/client/billing/pricing-table/billing-cycle-radio.tsx"],"sourcesContent":["import {Price} from '../price';\n\nexport type UpsellBillingCycle = 'monthly' | 'yearly';\n\nexport function findBestPrice(\n  token: UpsellBillingCycle,\n  prices: Price[]\n): Price | undefined {\n  if (token === 'monthly') {\n    const match = findMonthlyPrice(prices);\n    if (match) return match;\n  }\n\n  if (token === 'yearly') {\n    const match = findYearlyPrice(prices);\n    if (match) return match;\n  }\n\n  return prices[0];\n}\n\nfunction findYearlyPrice(prices: Price[]) {\n  return prices.find(price => {\n    if (price.interval === 'month' && price.interval_count >= 12) {\n      return price;\n    }\n    if (price.interval === 'year' && price.interval_count >= 1) {\n      return price;\n    }\n  });\n}\n\nfunction findMonthlyPrice(prices: Price[]) {\n  return prices.find(price => {\n    if (price.interval === 'day' && price.interval_count >= 30) {\n      return price;\n    }\n    if (price.interval === 'month' && price.interval_count >= 1) {\n      return price;\n    }\n  });\n}\n","// find the highest percentage decrease between monthly and yearly prices of specified products\nimport {Product} from '../product';\nimport {findBestPrice} from './find-best-price';\nimport {Fragment, memo} from 'react';\nimport {Trans} from '@ui/i18n/trans';\n\ninterface UpsellLabelProps {\n  products?: Product[];\n}\nexport const UpsellLabel = memo(({products}: UpsellLabelProps) => {\n  const upsellPercentage = calcHighestUpsellPercentage(products);\n\n  if (upsellPercentage <= 0) {\n    return null;\n  }\n\n  return (\n    <Fragment>\n      <span className=\"font-medium text-positive-darker\">\n        {' '}\n        (\n        <Trans\n          message=\"Save up to :percentage%\"\n          values={{percentage: upsellPercentage}}\n        />\n        )\n      </span>\n    </Fragment>\n  );\n});\n\nfunction calcHighestUpsellPercentage(products?: Product[]) {\n  if (!products?.length) return 0;\n\n  const decreases = products.map(product => {\n    if (product.hidden) return 0;\n\n    const monthly = findBestPrice('monthly', product.prices);\n    const yearly = findBestPrice('yearly', product.prices);\n\n    if (!monthly || !yearly) return 0;\n\n    // monthly plan per year amount\n    const monthlyAmount = monthly.amount * 12;\n    const yearlyAmount = yearly.amount;\n\n    const savingsPercentage = Math.round(\n      ((monthlyAmount - yearlyAmount) / monthlyAmount) * 100,\n    );\n\n    if (savingsPercentage > 0 && savingsPercentage <= 200) {\n      return savingsPercentage;\n    }\n\n    return 0;\n  });\n\n  return Math.max(Math.max(...decreases), 0);\n}\n","import {Radio} from '@ui/forms/radio-group/radio';\nimport {RadioGroup, RadioGroupProps} from '@ui/forms/radio-group/radio-group';\nimport {Trans} from '@ui/i18n/trans';\nimport {Product} from '../product';\nimport {UpsellBillingCycle} from './find-best-price';\nimport {UpsellLabel} from './upsell-label';\n\ninterface BillingCycleRadioProps\n  extends Omit<RadioGroupProps, 'children' | 'onChange'> {\n  selectedCycle: UpsellBillingCycle;\n  onChange: (value: UpsellBillingCycle) => void;\n  products?: Product[];\n}\nexport function BillingCycleRadio({\n  selectedCycle,\n  onChange,\n  products,\n  ...radioGroupProps\n}: BillingCycleRadioProps) {\n  return (\n    <RadioGroup\n      {...radioGroupProps}\n      value={selectedCycle}\n      onChange={value => onChange(value as UpsellBillingCycle)}\n    >\n      <Radio value=\"yearly\">\n        <Trans message=\"Annual\" />\n        <UpsellLabel products={products} />\n      </Radio>\n      <Radio value=\"monthly\">\n        <Trans message=\"Monthly\" />\n      </Radio>\n    </RadioGroup>\n  );\n}\n"],"names":["findBestPrice","token","prices","match","findMonthlyPrice","findYearlyPrice","price","UpsellLabel","memo","products","upsellPercentage","calcHighestUpsellPercentage","jsx","Fragment","jsxs","Trans","decreases","product","monthly","yearly","monthlyAmount","yearlyAmount","savingsPercentage","BillingCycleRadio","selectedCycle","onChange","radioGroupProps","RadioGroup","value","Radio"],"mappings":"0GAIO,SAASA,EACdC,EACAC,EACmB,CACnB,GAAID,IAAU,UAAW,CACvB,MAAME,EAAQC,EAAiBF,CAAM,EACrC,GAAIC,EAAO,OAAOA,CACpB,CAEA,GAAIF,IAAU,SAAU,CACtB,MAAME,EAAQE,EAAgBH,CAAM,EACpC,GAAIC,EAAO,OAAOA,CACpB,CAEA,OAAOD,EAAO,CAAC,CACjB,CAEA,SAASG,EAAgBH,EAAiB,CACxC,OAAOA,EAAO,KAAKI,GAAS,CAI1B,GAHIA,EAAM,WAAa,SAAWA,EAAM,gBAAkB,IAGtDA,EAAM,WAAa,QAAUA,EAAM,gBAAkB,EACvD,OAAOA,CAEX,CAAC,CACH,CAEA,SAASF,EAAiBF,EAAiB,CACzC,OAAOA,EAAO,KAAKI,GAAS,CAI1B,GAHIA,EAAM,WAAa,OAASA,EAAM,gBAAkB,IAGpDA,EAAM,WAAa,SAAWA,EAAM,gBAAkB,EACxD,OAAOA,CAEX,CAAC,CACH,CChCO,MAAMC,EAAcC,EAAAA,KAAK,CAAC,CAAC,SAAAC,KAAgC,CAChE,MAAMC,EAAmBC,EAA4BF,CAAQ,EAE7D,OAAIC,GAAoB,EACf,KAIPE,EAAAA,IAACC,WAAA,CACC,SAAAC,EAAAA,KAAC,OAAA,CAAK,UAAU,mCACb,SAAA,CAAA,IAAI,IAELF,EAAAA,IAACG,EAAA,CACC,QAAQ,0BACR,OAAQ,CAAC,WAAYL,CAAA,CAAgB,CAAA,EACrC,GAAA,CAAA,CAEJ,CAAA,CACF,CAEJ,CAAC,EAED,SAASC,EAA4BF,EAAsB,CACzD,GAAI,EAACA,GAAA,MAAAA,EAAU,QAAQ,MAAO,GAE9B,MAAMO,EAAYP,EAAS,IAAIQ,GAAW,CACxC,GAAIA,EAAQ,OAAQ,MAAO,GAE3B,MAAMC,EAAUlB,EAAc,UAAWiB,EAAQ,MAAM,EACjDE,EAASnB,EAAc,SAAUiB,EAAQ,MAAM,EAErD,GAAI,CAACC,GAAW,CAACC,EAAQ,MAAO,GAGhC,MAAMC,EAAgBF,EAAQ,OAAS,GACjCG,EAAeF,EAAO,OAEtBG,EAAoB,KAAK,OAC3BF,EAAgBC,GAAgBD,EAAiB,GAAA,EAGrD,OAAIE,EAAoB,GAAKA,GAAqB,IACzCA,EAGF,CACT,CAAC,EAED,OAAO,KAAK,IAAI,KAAK,IAAI,GAAGN,CAAS,EAAG,CAAC,CAC3C,CC7CO,SAASO,EAAkB,CAChC,cAAAC,EACA,SAAAC,EACA,SAAAhB,EACA,GAAGiB,CACL,EAA2B,CACzB,OACEZ,EAAAA,KAACa,EAAA,CACE,GAAGD,EACJ,MAAOF,EACP,SAAUI,GAASH,EAASG,CAA2B,EAEvD,SAAA,CAAAd,EAAAA,KAACe,EAAA,CAAM,MAAM,SACX,SAAA,CAAAjB,EAAAA,IAACG,EAAA,CAAM,QAAQ,QAAA,CAAS,EACxBH,MAACL,GAAY,SAAAE,CAAA,CAAoB,CAAA,EACnC,EACAG,EAAAA,IAACiB,GAAM,MAAM,UACX,eAACd,EAAA,CAAM,QAAQ,UAAU,CAAA,CAC3B,CAAA,CAAA,CAAA,CAGN"}