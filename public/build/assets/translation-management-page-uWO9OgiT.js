import{a7 as b,a2 as v,j as e,M as w,Q as y,T as t,R as z,am as S,a3 as j,B as u,cc as N,r as x,aD as T,G as D,w as F,aw as C,S as I,D as L,J as h,ak as M,ai as k,aj as A,a5 as f}from"./main-owSUWNVS.js";import{u as B,a as E}from"./update-localization-Bocfj7PN.js";import{u as U}from"./index-B47cMynY.js";import{A as V}from"./Add-BV-9IpU7.js";import{M as q}from"./MoreVert-Btfc9NhN.js";import{d as H}from"./download-file-from-url-BVaKcxRP.js";import{o as P}from"./open-upload-window-Ckg_K7W2.js";import{D as R}from"./dialog-footer-D_t7V-bM.js";import{S as $}from"./section-helper-nxxDgZEf.js";import{D as Q}from"./datatable-page-with-header-layout-68nRfBM1.js";import{u as G}from"./use-required-params-BWJ6Ts-l.js";import{u as J}from"./useSuspenseQuery-BjTtEPeK.js";import{B as O,a as g}from"./breadcrumb-Bnfa8bCQ.js";import{F as W}from"./file-input-config-DrcTpI3-.js";import"./uploaded-file-0zTC6Yq4.js";import"./dashboard-layout-context-Cg5RoSzJ.js";import"./use-toggle-dashboard-left-sidebar-B95u609v.js";import"./useEffectEvent-BzNFWHXk.js";import"./ChevronRight-C9FzEt6s.js";import"./MoreHoriz-DuK_U7d6.js";function Y(){const{formId:o,close:s}=b(),i=v();return e.jsxs(w,{children:[e.jsx(y,{children:e.jsx(t,{message:"Add translation"})}),e.jsx(z,{children:e.jsxs(S,{form:i,id:o,onSubmit:r=>{s(r)},children:[e.jsx($,{className:"mb-30",title:e.jsx(t,{message:"Add a new translation, if it does not exist already."}),description:e.jsx(t,{message:"This should only need to be done for things like custom menu items."})}),e.jsx(j,{inputElementType:"textarea",rows:2,autoFocus:!0,name:"key",label:e.jsx(t,{message:"Translation key"}),className:"mb-30",required:!0}),e.jsx(j,{inputElementType:"textarea",rows:2,name:"value",label:e.jsx(t,{message:"Translation value"}),required:!0})]})}),e.jsxs(R,{children:[e.jsx(u,{onClick:s,children:e.jsx(t,{message:"Cancel"})}),e.jsx(u,{variant:"flat",color:"primary",type:"submit",form:o,children:e.jsx(t,{message:"Add"})})]})]})}function be(){const{localeId:o}=G(["localeId"]),s=J(N.localizations.get(o)),[i,r]=x.useState(s.data.localization.lines||{}),c=T(),d=B(),[l,a]=x.useState("");return e.jsxs("form",{className:"flex h-full flex-col",onSubmit:n=>{n.preventDefault(),d.mutate({id:s.data.localization.id,lines:i},{onSuccess:()=>{c("/admin/localizations")}})},children:[e.jsx(Q,{showSidebarToggleButton:!0,title:e.jsxs(O,{size:"xl",children:[e.jsx(g,{onSelected:()=>{c("/admin/localizations")},children:e.jsx(t,{message:"Localizations"})}),e.jsx(g,{children:e.jsx(t,{message:":locale translations",values:{locale:s.data.localization.name}})})]})}),e.jsx(K,{localization:s.data.localization,setLines:r,lines:i,searchQuery:l,setSearchQuery:a,isLoading:d.isPending}),e.jsx(X,{lines:i,setLines:r,searchQuery:l})]})}function K({localization:o,searchQuery:s,setSearchQuery:i,isLoading:r,lines:c,setLines:d}){const l=D(),{trans:a}=F();return e.jsx("div",{className:"flex-shrink-0 p-14 md:p-24",children:e.jsxs("div",{className:"flex items-center gap-32 md:gap-12",children:[e.jsx("div",{className:"max-w-440 flex-auto",children:e.jsx(C,{value:s,onChange:n=>i(n.target.value),startAdornment:e.jsx(I,{}),placeholder:a({message:"Type to search..."})})}),e.jsxs(L,{type:"modal",onClose:n=>{if(n){const m={...c};m[n.key]=n.value,d(m)}},children:[!l&&e.jsx(u,{className:"ml-auto",variant:"outline",color:"primary",startIcon:e.jsx(V,{}),children:e.jsx(t,{message:"Add new"})}),e.jsx(Y,{})]}),e.jsx(Z,{locale:o}),e.jsx(u,{variant:"flat",color:"primary",type:"submit",disabled:r,children:l?e.jsx(t,{message:"Save"}):e.jsx(t,{message:"Save translations"})})]})})}function X({searchQuery:o,lines:s,setLines:i}){const r=x.useMemo(()=>Object.entries(s).filter(([l,a])=>{const n=o==null?void 0:o.toLowerCase();return!n||(l==null?void 0:l.toLowerCase().includes(n))||(a==null?void 0:a.toLowerCase().includes(n))}),[s,o]),c=x.useRef(null),d=U({count:r.length,getScrollElement:()=>c.current,estimateSize:()=>123});return e.jsx("div",{className:"flex-auto overflow-y-auto px-14 md:px-24",ref:c,children:e.jsx("div",{className:"relative w-full",style:{height:`${d.getTotalSize()}px`},children:d.getVirtualItems().map(l=>{const[a,n]=r[l.index];return e.jsx("div",{className:"absolute left-0 top-0 w-full",style:{height:`${l.size}px`,transform:`translateY(${l.start}px)`},children:e.jsxs("div",{className:"mb-10 rounded border md:mr-10",children:[e.jsxs("div",{className:"flex items-center justify-between gap-24 border-b px-10 py-2",children:[e.jsx("label",{className:"flex-auto text-xs font-semibold",htmlFor:a,children:a}),e.jsx(h,{size:"xs",className:"text-muted",onClick:()=>{const m={...s};delete m[a],i(m)},children:e.jsx(M,{})})]}),e.jsx("div",{children:e.jsx("textarea",{id:a,name:a,defaultValue:n,className:"block w-full resize-none rounded bg-inherit p-10 text-sm outline-none focus-visible:ring-2",rows:2,onChange:m=>{const p={...s};p[a]=m.target.value,i(p)}})})]})},a)})})})}function Z({locale:o}){const s=E();return e.jsxs(k,{children:[e.jsx(h,{variant:"outline",size:"sm",color:"primary",disabled:s.isPending,children:e.jsx(q,{})}),e.jsxs(A,{children:[e.jsx(f,{value:"download",onSelected:()=>H(`api/v1/localizations/${o.id}/download`),children:e.jsx(t,{message:"Download"})}),e.jsx(f,{value:"upload",onSelected:async()=>{const i=await P({types:[W.json]});i.length==1&&s.mutate({localeId:o.id,file:i[0]})},children:e.jsx(t,{message:"Upload"})})]})]})}export{be as Component};
//# sourceMappingURL=translation-management-page-uWO9OgiT.js.map
